(()=>{var Ar=Object.create,Le=Object.defineProperty;var Tr=Object.getOwnPropertyDescriptor;var Sr=Object.getOwnPropertyNames;var Or=Object.getPrototypeOf,Lr=Object.prototype.hasOwnProperty;var Rr=e=>Le(e,"__esModule",{value:!0});var $=(e,t)=>()=>(e&&(t=e(e=0)),t),H=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Pr=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Sr(t))!Lr.call(e,n)&&n!=="default"&&Le(e,n,{get:()=>t[n],enumerable:!(r=Tr(t,n))||r.enumerable});return e},J=e=>Pr(Rr(Le(e!=null?Ar(Or(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var Z=H(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});G.setMatrixArrayType=Ir;G.toRadian=Wr;G.equals=Er;G.RANDOM=G.ARRAY_TYPE=G.EPSILON=void 0;var Ye=1e-6;G.EPSILON=Ye;var He=typeof Float32Array!="undefined"?Float32Array:Array;G.ARRAY_TYPE=He;var qr=Math.random;G.RANDOM=qr;function Ir(e){G.ARRAY_TYPE=He=e}var Cr=Math.PI/180;function Wr(e){return e*Cr}function Er(e,t){return Math.abs(e-t)<=Ye*Math.max(1,Math.abs(e),Math.abs(t))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)})});var Be=H(F=>{"use strict";function ue(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ue=function(r){return typeof r}:ue=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ue(e)}Object.defineProperty(F,"__esModule",{value:!0});F.create=Dr;F.clone=kr;F.copy=Fr;F.identity=jr;F.fromValues=zr;F.set=Yr;F.transpose=Hr;F.invert=Vr;F.adjoint=Nr;F.determinant=Xr;F.multiply=Ve;F.rotate=Br;F.scale=Gr;F.fromRotation=Qr;F.fromScaling=Ur;F.str=Zr;F.frob=$r;F.LDU=Jr;F.add=Kr;F.subtract=Ne;F.exactEquals=en;F.equals=tn;F.multiplyScalar=rn;F.multiplyScalarAndAdd=nn;F.sub=F.mul=void 0;var se=an(Z());function Xe(){if(typeof WeakMap!="function")return null;var e=new WeakMap;return Xe=function(){return e},e}function an(e){if(e&&e.__esModule)return e;if(e===null||ue(e)!=="object"&&typeof e!="function")return{default:e};var t=Xe();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=n?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function Dr(){var e=new se.ARRAY_TYPE(4);return se.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function kr(e){var t=new se.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Fr(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function jr(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function zr(e,t,r,n){var a=new se.ARRAY_TYPE(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a}function Yr(e,t,r,n,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e}function Hr(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}function Vr(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=r*s-a*n;return c?(c=1/c,e[0]=s*c,e[1]=-n*c,e[2]=-a*c,e[3]=r*c,e):null}function Nr(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e}function Xr(e){return e[0]*e[3]-e[2]*e[1]}function Ve(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=r[0],h=r[1],u=r[2],i=r[3];return e[0]=n*l+s*h,e[1]=a*l+c*h,e[2]=n*u+s*i,e[3]=a*u+c*i,e}function Br(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=Math.sin(r),h=Math.cos(r);return e[0]=n*h+s*l,e[1]=a*h+c*l,e[2]=n*-l+s*h,e[3]=a*-l+c*h,e}function Gr(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=r[0],h=r[1];return e[0]=n*l,e[1]=a*l,e[2]=s*h,e[3]=c*h,e}function Qr(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e}function Ur(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e}function Zr(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function $r(e){return Math.hypot(e[0],e[1],e[2],e[3])}function Jr(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]}function Kr(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Ne(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function en(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function tn(e,t){var r=e[0],n=e[1],a=e[2],s=e[3],c=t[0],l=t[1],h=t[2],u=t[3];return Math.abs(r-c)<=se.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-l)<=se.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-h)<=se.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(s-u)<=se.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))}function rn(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function nn(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}var sn=Ve;F.mul=sn;var on=Ne;F.sub=on});var Ze=H(j=>{"use strict";function pe(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?pe=function(r){return typeof r}:pe=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},pe(e)}Object.defineProperty(j,"__esModule",{value:!0});j.create=cn;j.clone=ln;j.copy=fn;j.identity=hn;j.fromValues=dn;j.set=un;j.invert=pn;j.determinant=vn;j.multiply=Ge;j.rotate=_n;j.scale=mn;j.translate=yn;j.fromRotation=gn;j.fromScaling=Mn;j.fromTranslation=bn;j.str=xn;j.frob=wn;j.add=An;j.subtract=Qe;j.multiplyScalar=Tn;j.multiplyScalarAndAdd=Sn;j.exactEquals=On;j.equals=Ln;j.sub=j.mul=void 0;var K=Rn(Z());function Ue(){if(typeof WeakMap!="function")return null;var e=new WeakMap;return Ue=function(){return e},e}function Rn(e){if(e&&e.__esModule)return e;if(e===null||pe(e)!=="object"&&typeof e!="function")return{default:e};var t=Ue();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=n?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function cn(){var e=new K.ARRAY_TYPE(6);return K.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function ln(e){var t=new K.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function fn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function hn(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function dn(e,t,r,n,a,s){var c=new K.ARRAY_TYPE(6);return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c[4]=a,c[5]=s,c}function un(e,t,r,n,a,s,c){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=s,e[5]=c,e}function pn(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=t[4],l=t[5],h=r*s-n*a;return h?(h=1/h,e[0]=s*h,e[1]=-n*h,e[2]=-a*h,e[3]=r*h,e[4]=(a*l-s*c)*h,e[5]=(n*c-r*l)*h,e):null}function vn(e){return e[0]*e[3]-e[1]*e[2]}function Ge(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=t[4],h=t[5],u=r[0],i=r[1],o=r[2],f=r[3],d=r[4],v=r[5];return e[0]=n*u+s*i,e[1]=a*u+c*i,e[2]=n*o+s*f,e[3]=a*o+c*f,e[4]=n*d+s*v+l,e[5]=a*d+c*v+h,e}function _n(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=t[4],h=t[5],u=Math.sin(r),i=Math.cos(r);return e[0]=n*i+s*u,e[1]=a*i+c*u,e[2]=n*-u+s*i,e[3]=a*-u+c*i,e[4]=l,e[5]=h,e}function mn(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=t[4],h=t[5],u=r[0],i=r[1];return e[0]=n*u,e[1]=a*u,e[2]=s*i,e[3]=c*i,e[4]=l,e[5]=h,e}function yn(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=t[4],h=t[5],u=r[0],i=r[1];return e[0]=n,e[1]=a,e[2]=s,e[3]=c,e[4]=n*u+s*i+l,e[5]=a*u+c*i+h,e}function gn(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e}function Mn(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function bn(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function xn(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function wn(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function An(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e}function Qe(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}function Tn(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e}function Sn(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e}function On(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function Ln(e,t){var r=e[0],n=e[1],a=e[2],s=e[3],c=e[4],l=e[5],h=t[0],u=t[1],i=t[2],o=t[3],f=t[4],d=t[5];return Math.abs(r-h)<=K.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-u)<=K.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-i)<=K.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))&&Math.abs(s-o)<=K.EPSILON*Math.max(1,Math.abs(s),Math.abs(o))&&Math.abs(c-f)<=K.EPSILON*Math.max(1,Math.abs(c),Math.abs(f))&&Math.abs(l-d)<=K.EPSILON*Math.max(1,Math.abs(l),Math.abs(d))}var Pn=Ge;j.mul=Pn;var In=Qe;j.sub=In});var Re=H(W=>{"use strict";function ve(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ve=function(r){return typeof r}:ve=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ve(e)}Object.defineProperty(W,"__esModule",{value:!0});W.create=Wn;W.fromMat4=En;W.clone=qn;W.copy=Cn;W.fromValues=Dn;W.set=kn;W.identity=Fn;W.transpose=jn;W.invert=zn;W.adjoint=Yn;W.determinant=Hn;W.multiply=$e;W.translate=Vn;W.rotate=Nn;W.scale=Xn;W.fromTranslation=Bn;W.fromRotation=Gn;W.fromScaling=Qn;W.fromMat2d=Un;W.fromQuat=Zn;W.normalFromMat4=$n;W.projection=Jn;W.str=Kn;W.frob=ei;W.add=ti;W.subtract=Je;W.multiplyScalar=ri;W.multiplyScalarAndAdd=ni;W.exactEquals=ii;W.equals=ai;W.sub=W.mul=void 0;var X=si(Z());function Ke(){if(typeof WeakMap!="function")return null;var e=new WeakMap;return Ke=function(){return e},e}function si(e){if(e&&e.__esModule)return e;if(e===null||ve(e)!=="object"&&typeof e!="function")return{default:e};var t=Ke();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=n?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function Wn(){var e=new X.ARRAY_TYPE(9);return X.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function En(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function qn(e){var t=new X.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Cn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Dn(e,t,r,n,a,s,c,l,h){var u=new X.ARRAY_TYPE(9);return u[0]=e,u[1]=t,u[2]=r,u[3]=n,u[4]=a,u[5]=s,u[6]=c,u[7]=l,u[8]=h,u}function kn(e,t,r,n,a,s,c,l,h,u){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=s,e[5]=c,e[6]=l,e[7]=h,e[8]=u,e}function Fn(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function jn(e,t){if(e===t){var r=t[1],n=t[2],a=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=a}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function zn(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=t[4],l=t[5],h=t[6],u=t[7],i=t[8],o=i*c-l*u,f=-i*s+l*h,d=u*s-c*h,v=r*o+n*f+a*d;return v?(v=1/v,e[0]=o*v,e[1]=(-i*n+a*u)*v,e[2]=(l*n-a*c)*v,e[3]=f*v,e[4]=(i*r-a*h)*v,e[5]=(-l*r+a*s)*v,e[6]=d*v,e[7]=(-u*r+n*h)*v,e[8]=(c*r-n*s)*v,e):null}function Yn(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=t[4],l=t[5],h=t[6],u=t[7],i=t[8];return e[0]=c*i-l*u,e[1]=a*u-n*i,e[2]=n*l-a*c,e[3]=l*h-s*i,e[4]=r*i-a*h,e[5]=a*s-r*l,e[6]=s*u-c*h,e[7]=n*h-r*u,e[8]=r*c-n*s,e}function Hn(e){var t=e[0],r=e[1],n=e[2],a=e[3],s=e[4],c=e[5],l=e[6],h=e[7],u=e[8];return t*(u*s-c*h)+r*(-u*a+c*l)+n*(h*a-s*l)}function $e(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=t[4],h=t[5],u=t[6],i=t[7],o=t[8],f=r[0],d=r[1],v=r[2],_=r[3],p=r[4],m=r[5],y=r[6],g=r[7],M=r[8];return e[0]=f*n+d*c+v*u,e[1]=f*a+d*l+v*i,e[2]=f*s+d*h+v*o,e[3]=_*n+p*c+m*u,e[4]=_*a+p*l+m*i,e[5]=_*s+p*h+m*o,e[6]=y*n+g*c+M*u,e[7]=y*a+g*l+M*i,e[8]=y*s+g*h+M*o,e}function Vn(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=t[4],h=t[5],u=t[6],i=t[7],o=t[8],f=r[0],d=r[1];return e[0]=n,e[1]=a,e[2]=s,e[3]=c,e[4]=l,e[5]=h,e[6]=f*n+d*c+u,e[7]=f*a+d*l+i,e[8]=f*s+d*h+o,e}function Nn(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=t[4],h=t[5],u=t[6],i=t[7],o=t[8],f=Math.sin(r),d=Math.cos(r);return e[0]=d*n+f*c,e[1]=d*a+f*l,e[2]=d*s+f*h,e[3]=d*c-f*n,e[4]=d*l-f*a,e[5]=d*h-f*s,e[6]=u,e[7]=i,e[8]=o,e}function Xn(e,t,r){var n=r[0],a=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=a*t[3],e[4]=a*t[4],e[5]=a*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Bn(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Gn(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Qn(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Un(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function Zn(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=r+r,l=n+n,h=a+a,u=r*c,i=n*c,o=n*l,f=a*c,d=a*l,v=a*h,_=s*c,p=s*l,m=s*h;return e[0]=1-o-v,e[3]=i-m,e[6]=f+p,e[1]=i+m,e[4]=1-u-v,e[7]=d-_,e[2]=f-p,e[5]=d+_,e[8]=1-u-o,e}function $n(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=t[4],l=t[5],h=t[6],u=t[7],i=t[8],o=t[9],f=t[10],d=t[11],v=t[12],_=t[13],p=t[14],m=t[15],y=r*l-n*c,g=r*h-a*c,M=r*u-s*c,b=n*h-a*l,x=n*u-s*l,E=a*u-s*h,S=i*_-o*v,D=i*p-f*v,C=i*m-d*v,z=o*p-f*_,k=o*m-d*_,q=f*m-d*p,P=y*q-g*k+M*z+b*C-x*D+E*S;return P?(P=1/P,e[0]=(l*q-h*k+u*z)*P,e[1]=(h*C-c*q-u*D)*P,e[2]=(c*k-l*C+u*S)*P,e[3]=(a*k-n*q-s*z)*P,e[4]=(r*q-a*C+s*D)*P,e[5]=(n*C-r*k-s*S)*P,e[6]=(_*E-p*x+m*b)*P,e[7]=(p*M-v*E-m*g)*P,e[8]=(v*x-_*M+m*y)*P,e):null}function Jn(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Kn(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function ei(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function ti(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function Je(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function ri(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function ni(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e}function ii(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function ai(e,t){var r=e[0],n=e[1],a=e[2],s=e[3],c=e[4],l=e[5],h=e[6],u=e[7],i=e[8],o=t[0],f=t[1],d=t[2],v=t[3],_=t[4],p=t[5],m=t[6],y=t[7],g=t[8];return Math.abs(r-o)<=X.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-f)<=X.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(a-d)<=X.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(s-v)<=X.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-_)<=X.EPSILON*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(l-p)<=X.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(h-m)<=X.EPSILON*Math.max(1,Math.abs(h),Math.abs(m))&&Math.abs(u-y)<=X.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(i-g)<=X.EPSILON*Math.max(1,Math.abs(i),Math.abs(g))}var oi=$e;W.mul=oi;var ci=Je;W.sub=ci});var Pe=H(O=>{"use strict";function _e(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_e=function(r){return typeof r}:_e=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_e(e)}Object.defineProperty(O,"__esModule",{value:!0});O.create=li;O.clone=fi;O.copy=hi;O.fromValues=di;O.set=ui;O.identity=et;O.transpose=pi;O.invert=vi;O.adjoint=_i;O.determinant=mi;O.multiply=tt;O.translate=yi;O.scale=gi;O.rotate=Mi;O.rotateX=bi;O.rotateY=xi;O.rotateZ=wi;O.fromTranslation=Ai;O.fromScaling=Ti;O.fromRotation=Si;O.fromXRotation=Oi;O.fromYRotation=Li;O.fromZRotation=Ri;O.fromRotationTranslation=rt;O.fromQuat2=Pi;O.getTranslation=Ii;O.getScaling=nt;O.getRotation=Wi;O.fromRotationTranslationScale=Ei;O.fromRotationTranslationScaleOrigin=qi;O.fromQuat=Ci;O.frustum=Di;O.perspective=ki;O.perspectiveFromFieldOfView=Fi;O.ortho=ji;O.lookAt=zi;O.targetTo=Yi;O.str=Hi;O.frob=Vi;O.add=Ni;O.subtract=it;O.multiplyScalar=Xi;O.multiplyScalarAndAdd=Bi;O.exactEquals=Gi;O.equals=Qi;O.sub=O.mul=void 0;var Y=Ui(Z());function at(){if(typeof WeakMap!="function")return null;var e=new WeakMap;return at=function(){return e},e}function Ui(e){if(e&&e.__esModule)return e;if(e===null||_e(e)!=="object"&&typeof e!="function")return{default:e};var t=at();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=n?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function li(){var e=new Y.ARRAY_TYPE(16);return Y.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function fi(e){var t=new Y.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function hi(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function di(e,t,r,n,a,s,c,l,h,u,i,o,f,d,v,_){var p=new Y.ARRAY_TYPE(16);return p[0]=e,p[1]=t,p[2]=r,p[3]=n,p[4]=a,p[5]=s,p[6]=c,p[7]=l,p[8]=h,p[9]=u,p[10]=i,p[11]=o,p[12]=f,p[13]=d,p[14]=v,p[15]=_,p}function ui(e,t,r,n,a,s,c,l,h,u,i,o,f,d,v,_,p){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=s,e[5]=c,e[6]=l,e[7]=h,e[8]=u,e[9]=i,e[10]=o,e[11]=f,e[12]=d,e[13]=v,e[14]=_,e[15]=p,e}function et(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pi(e,t){if(e===t){var r=t[1],n=t[2],a=t[3],s=t[6],c=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=s,e[11]=t[14],e[12]=a,e[13]=c,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function vi(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=t[4],l=t[5],h=t[6],u=t[7],i=t[8],o=t[9],f=t[10],d=t[11],v=t[12],_=t[13],p=t[14],m=t[15],y=r*l-n*c,g=r*h-a*c,M=r*u-s*c,b=n*h-a*l,x=n*u-s*l,E=a*u-s*h,S=i*_-o*v,D=i*p-f*v,C=i*m-d*v,z=o*p-f*_,k=o*m-d*_,q=f*m-d*p,P=y*q-g*k+M*z+b*C-x*D+E*S;return P?(P=1/P,e[0]=(l*q-h*k+u*z)*P,e[1]=(a*k-n*q-s*z)*P,e[2]=(_*E-p*x+m*b)*P,e[3]=(f*x-o*E-d*b)*P,e[4]=(h*C-c*q-u*D)*P,e[5]=(r*q-a*C+s*D)*P,e[6]=(p*M-v*E-m*g)*P,e[7]=(i*E-f*M+d*g)*P,e[8]=(c*k-l*C+u*S)*P,e[9]=(n*C-r*k-s*S)*P,e[10]=(v*x-_*M+m*y)*P,e[11]=(o*M-i*x-d*y)*P,e[12]=(l*D-c*z-h*S)*P,e[13]=(r*z-n*D+a*S)*P,e[14]=(_*g-v*b-p*y)*P,e[15]=(i*b-o*g+f*y)*P,e):null}function _i(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=t[4],l=t[5],h=t[6],u=t[7],i=t[8],o=t[9],f=t[10],d=t[11],v=t[12],_=t[13],p=t[14],m=t[15];return e[0]=l*(f*m-d*p)-o*(h*m-u*p)+_*(h*d-u*f),e[1]=-(n*(f*m-d*p)-o*(a*m-s*p)+_*(a*d-s*f)),e[2]=n*(h*m-u*p)-l*(a*m-s*p)+_*(a*u-s*h),e[3]=-(n*(h*d-u*f)-l*(a*d-s*f)+o*(a*u-s*h)),e[4]=-(c*(f*m-d*p)-i*(h*m-u*p)+v*(h*d-u*f)),e[5]=r*(f*m-d*p)-i*(a*m-s*p)+v*(a*d-s*f),e[6]=-(r*(h*m-u*p)-c*(a*m-s*p)+v*(a*u-s*h)),e[7]=r*(h*d-u*f)-c*(a*d-s*f)+i*(a*u-s*h),e[8]=c*(o*m-d*_)-i*(l*m-u*_)+v*(l*d-u*o),e[9]=-(r*(o*m-d*_)-i*(n*m-s*_)+v*(n*d-s*o)),e[10]=r*(l*m-u*_)-c*(n*m-s*_)+v*(n*u-s*l),e[11]=-(r*(l*d-u*o)-c*(n*d-s*o)+i*(n*u-s*l)),e[12]=-(c*(o*p-f*_)-i*(l*p-h*_)+v*(l*f-h*o)),e[13]=r*(o*p-f*_)-i*(n*p-a*_)+v*(n*f-a*o),e[14]=-(r*(l*p-h*_)-c*(n*p-a*_)+v*(n*h-a*l)),e[15]=r*(l*f-h*o)-c*(n*f-a*o)+i*(n*h-a*l),e}function mi(e){var t=e[0],r=e[1],n=e[2],a=e[3],s=e[4],c=e[5],l=e[6],h=e[7],u=e[8],i=e[9],o=e[10],f=e[11],d=e[12],v=e[13],_=e[14],p=e[15],m=t*c-r*s,y=t*l-n*s,g=t*h-a*s,M=r*l-n*c,b=r*h-a*c,x=n*h-a*l,E=u*v-i*d,S=u*_-o*d,D=u*p-f*d,C=i*_-o*v,z=i*p-f*v,k=o*p-f*_;return m*k-y*z+g*C+M*D-b*S+x*E}function tt(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=t[4],h=t[5],u=t[6],i=t[7],o=t[8],f=t[9],d=t[10],v=t[11],_=t[12],p=t[13],m=t[14],y=t[15],g=r[0],M=r[1],b=r[2],x=r[3];return e[0]=g*n+M*l+b*o+x*_,e[1]=g*a+M*h+b*f+x*p,e[2]=g*s+M*u+b*d+x*m,e[3]=g*c+M*i+b*v+x*y,g=r[4],M=r[5],b=r[6],x=r[7],e[4]=g*n+M*l+b*o+x*_,e[5]=g*a+M*h+b*f+x*p,e[6]=g*s+M*u+b*d+x*m,e[7]=g*c+M*i+b*v+x*y,g=r[8],M=r[9],b=r[10],x=r[11],e[8]=g*n+M*l+b*o+x*_,e[9]=g*a+M*h+b*f+x*p,e[10]=g*s+M*u+b*d+x*m,e[11]=g*c+M*i+b*v+x*y,g=r[12],M=r[13],b=r[14],x=r[15],e[12]=g*n+M*l+b*o+x*_,e[13]=g*a+M*h+b*f+x*p,e[14]=g*s+M*u+b*d+x*m,e[15]=g*c+M*i+b*v+x*y,e}function yi(e,t,r){var n=r[0],a=r[1],s=r[2],c,l,h,u,i,o,f,d,v,_,p,m;return t===e?(e[12]=t[0]*n+t[4]*a+t[8]*s+t[12],e[13]=t[1]*n+t[5]*a+t[9]*s+t[13],e[14]=t[2]*n+t[6]*a+t[10]*s+t[14],e[15]=t[3]*n+t[7]*a+t[11]*s+t[15]):(c=t[0],l=t[1],h=t[2],u=t[3],i=t[4],o=t[5],f=t[6],d=t[7],v=t[8],_=t[9],p=t[10],m=t[11],e[0]=c,e[1]=l,e[2]=h,e[3]=u,e[4]=i,e[5]=o,e[6]=f,e[7]=d,e[8]=v,e[9]=_,e[10]=p,e[11]=m,e[12]=c*n+i*a+v*s+t[12],e[13]=l*n+o*a+_*s+t[13],e[14]=h*n+f*a+p*s+t[14],e[15]=u*n+d*a+m*s+t[15]),e}function gi(e,t,r){var n=r[0],a=r[1],s=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Mi(e,t,r,n){var a=n[0],s=n[1],c=n[2],l=Math.hypot(a,s,c),h,u,i,o,f,d,v,_,p,m,y,g,M,b,x,E,S,D,C,z,k,q,P,U;return l<Y.EPSILON?null:(l=1/l,a*=l,s*=l,c*=l,h=Math.sin(r),u=Math.cos(r),i=1-u,o=t[0],f=t[1],d=t[2],v=t[3],_=t[4],p=t[5],m=t[6],y=t[7],g=t[8],M=t[9],b=t[10],x=t[11],E=a*a*i+u,S=s*a*i+c*h,D=c*a*i-s*h,C=a*s*i-c*h,z=s*s*i+u,k=c*s*i+a*h,q=a*c*i+s*h,P=s*c*i-a*h,U=c*c*i+u,e[0]=o*E+_*S+g*D,e[1]=f*E+p*S+M*D,e[2]=d*E+m*S+b*D,e[3]=v*E+y*S+x*D,e[4]=o*C+_*z+g*k,e[5]=f*C+p*z+M*k,e[6]=d*C+m*z+b*k,e[7]=v*C+y*z+x*k,e[8]=o*q+_*P+g*U,e[9]=f*q+p*P+M*U,e[10]=d*q+m*P+b*U,e[11]=v*q+y*P+x*U,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function bi(e,t,r){var n=Math.sin(r),a=Math.cos(r),s=t[4],c=t[5],l=t[6],h=t[7],u=t[8],i=t[9],o=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*a+u*n,e[5]=c*a+i*n,e[6]=l*a+o*n,e[7]=h*a+f*n,e[8]=u*a-s*n,e[9]=i*a-c*n,e[10]=o*a-l*n,e[11]=f*a-h*n,e}function xi(e,t,r){var n=Math.sin(r),a=Math.cos(r),s=t[0],c=t[1],l=t[2],h=t[3],u=t[8],i=t[9],o=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*a-u*n,e[1]=c*a-i*n,e[2]=l*a-o*n,e[3]=h*a-f*n,e[8]=s*n+u*a,e[9]=c*n+i*a,e[10]=l*n+o*a,e[11]=h*n+f*a,e}function wi(e,t,r){var n=Math.sin(r),a=Math.cos(r),s=t[0],c=t[1],l=t[2],h=t[3],u=t[4],i=t[5],o=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*a+u*n,e[1]=c*a+i*n,e[2]=l*a+o*n,e[3]=h*a+f*n,e[4]=u*a-s*n,e[5]=i*a-c*n,e[6]=o*a-l*n,e[7]=f*a-h*n,e}function Ai(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Ti(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Si(e,t,r){var n=r[0],a=r[1],s=r[2],c=Math.hypot(n,a,s),l,h,u;return c<Y.EPSILON?null:(c=1/c,n*=c,a*=c,s*=c,l=Math.sin(t),h=Math.cos(t),u=1-h,e[0]=n*n*u+h,e[1]=a*n*u+s*l,e[2]=s*n*u-a*l,e[3]=0,e[4]=n*a*u-s*l,e[5]=a*a*u+h,e[6]=s*a*u+n*l,e[7]=0,e[8]=n*s*u+a*l,e[9]=a*s*u-n*l,e[10]=s*s*u+h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Oi(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Li(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ri(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function rt(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=n+n,h=a+a,u=s+s,i=n*l,o=n*h,f=n*u,d=a*h,v=a*u,_=s*u,p=c*l,m=c*h,y=c*u;return e[0]=1-(d+_),e[1]=o+y,e[2]=f-m,e[3]=0,e[4]=o-y,e[5]=1-(i+_),e[6]=v+p,e[7]=0,e[8]=f+m,e[9]=v-p,e[10]=1-(i+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Pi(e,t){var r=new Y.ARRAY_TYPE(3),n=-t[0],a=-t[1],s=-t[2],c=t[3],l=t[4],h=t[5],u=t[6],i=t[7],o=n*n+a*a+s*s+c*c;return o>0?(r[0]=(l*c+i*n+h*s-u*a)*2/o,r[1]=(h*c+i*a+u*n-l*s)*2/o,r[2]=(u*c+i*s+l*a-h*n)*2/o):(r[0]=(l*c+i*n+h*s-u*a)*2,r[1]=(h*c+i*a+u*n-l*s)*2,r[2]=(u*c+i*s+l*a-h*n)*2),rt(e,t,r),e}function Ii(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function nt(e,t){var r=t[0],n=t[1],a=t[2],s=t[4],c=t[5],l=t[6],h=t[8],u=t[9],i=t[10];return e[0]=Math.hypot(r,n,a),e[1]=Math.hypot(s,c,l),e[2]=Math.hypot(h,u,i),e}function Wi(e,t){var r=new Y.ARRAY_TYPE(3);nt(r,t);var n=1/r[0],a=1/r[1],s=1/r[2],c=t[0]*n,l=t[1]*a,h=t[2]*s,u=t[4]*n,i=t[5]*a,o=t[6]*s,f=t[8]*n,d=t[9]*a,v=t[10]*s,_=c+i+v,p=0;return _>0?(p=Math.sqrt(_+1)*2,e[3]=.25*p,e[0]=(o-d)/p,e[1]=(f-h)/p,e[2]=(l-u)/p):c>i&&c>v?(p=Math.sqrt(1+c-i-v)*2,e[3]=(o-d)/p,e[0]=.25*p,e[1]=(l+u)/p,e[2]=(f+h)/p):i>v?(p=Math.sqrt(1+i-c-v)*2,e[3]=(f-h)/p,e[0]=(l+u)/p,e[1]=.25*p,e[2]=(o+d)/p):(p=Math.sqrt(1+v-c-i)*2,e[3]=(l-u)/p,e[0]=(f+h)/p,e[1]=(o+d)/p,e[2]=.25*p),e}function Ei(e,t,r,n){var a=t[0],s=t[1],c=t[2],l=t[3],h=a+a,u=s+s,i=c+c,o=a*h,f=a*u,d=a*i,v=s*u,_=s*i,p=c*i,m=l*h,y=l*u,g=l*i,M=n[0],b=n[1],x=n[2];return e[0]=(1-(v+p))*M,e[1]=(f+g)*M,e[2]=(d-y)*M,e[3]=0,e[4]=(f-g)*b,e[5]=(1-(o+p))*b,e[6]=(_+m)*b,e[7]=0,e[8]=(d+y)*x,e[9]=(_-m)*x,e[10]=(1-(o+v))*x,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function qi(e,t,r,n,a){var s=t[0],c=t[1],l=t[2],h=t[3],u=s+s,i=c+c,o=l+l,f=s*u,d=s*i,v=s*o,_=c*i,p=c*o,m=l*o,y=h*u,g=h*i,M=h*o,b=n[0],x=n[1],E=n[2],S=a[0],D=a[1],C=a[2],z=(1-(_+m))*b,k=(d+M)*b,q=(v-g)*b,P=(d-M)*x,U=(1-(f+m))*x,he=(p+y)*x,de=(v+g)*E,je=(p-y)*E,ze=(1-(f+_))*E;return e[0]=z,e[1]=k,e[2]=q,e[3]=0,e[4]=P,e[5]=U,e[6]=he,e[7]=0,e[8]=de,e[9]=je,e[10]=ze,e[11]=0,e[12]=r[0]+S-(z*S+P*D+de*C),e[13]=r[1]+D-(k*S+U*D+je*C),e[14]=r[2]+C-(q*S+he*D+ze*C),e[15]=1,e}function Ci(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=r+r,l=n+n,h=a+a,u=r*c,i=n*c,o=n*l,f=a*c,d=a*l,v=a*h,_=s*c,p=s*l,m=s*h;return e[0]=1-o-v,e[1]=i+m,e[2]=f-p,e[3]=0,e[4]=i-m,e[5]=1-u-v,e[6]=d+_,e[7]=0,e[8]=f+p,e[9]=d-_,e[10]=1-u-o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Di(e,t,r,n,a,s,c){var l=1/(r-t),h=1/(a-n),u=1/(s-c);return e[0]=s*2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*h,e[6]=0,e[7]=0,e[8]=(r+t)*l,e[9]=(a+n)*h,e[10]=(c+s)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=c*s*2*u,e[15]=0,e}function ki(e,t,r,n,a){var s=1/Math.tan(t/2),c;return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==Infinity?(c=1/(n-a),e[10]=(a+n)*c,e[14]=2*a*n*c):(e[10]=-1,e[14]=-2*n),e}function Fi(e,t,r,n){var a=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),c=Math.tan(t.leftDegrees*Math.PI/180),l=Math.tan(t.rightDegrees*Math.PI/180),h=2/(c+l),u=2/(a+s);return e[0]=h,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-((c-l)*h*.5),e[9]=(a-s)*u*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function ji(e,t,r,n,a,s,c){var l=1/(t-r),h=1/(n-a),u=1/(s-c);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*l,e[13]=(a+n)*h,e[14]=(c+s)*u,e[15]=1,e}function zi(e,t,r,n){var a,s,c,l,h,u,i,o,f,d,v=t[0],_=t[1],p=t[2],m=n[0],y=n[1],g=n[2],M=r[0],b=r[1],x=r[2];return Math.abs(v-M)<Y.EPSILON&&Math.abs(_-b)<Y.EPSILON&&Math.abs(p-x)<Y.EPSILON?et(e):(i=v-M,o=_-b,f=p-x,d=1/Math.hypot(i,o,f),i*=d,o*=d,f*=d,a=y*f-g*o,s=g*i-m*f,c=m*o-y*i,d=Math.hypot(a,s,c),d?(d=1/d,a*=d,s*=d,c*=d):(a=0,s=0,c=0),l=o*c-f*s,h=f*a-i*c,u=i*s-o*a,d=Math.hypot(l,h,u),d?(d=1/d,l*=d,h*=d,u*=d):(l=0,h=0,u=0),e[0]=a,e[1]=l,e[2]=i,e[3]=0,e[4]=s,e[5]=h,e[6]=o,e[7]=0,e[8]=c,e[9]=u,e[10]=f,e[11]=0,e[12]=-(a*v+s*_+c*p),e[13]=-(l*v+h*_+u*p),e[14]=-(i*v+o*_+f*p),e[15]=1,e)}function Yi(e,t,r,n){var a=t[0],s=t[1],c=t[2],l=n[0],h=n[1],u=n[2],i=a-r[0],o=s-r[1],f=c-r[2],d=i*i+o*o+f*f;d>0&&(d=1/Math.sqrt(d),i*=d,o*=d,f*=d);var v=h*f-u*o,_=u*i-l*f,p=l*o-h*i;return d=v*v+_*_+p*p,d>0&&(d=1/Math.sqrt(d),v*=d,_*=d,p*=d),e[0]=v,e[1]=_,e[2]=p,e[3]=0,e[4]=o*p-f*_,e[5]=f*v-i*p,e[6]=i*_-o*v,e[7]=0,e[8]=i,e[9]=o,e[10]=f,e[11]=0,e[12]=a,e[13]=s,e[14]=c,e[15]=1,e}function Hi(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Vi(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Ni(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function it(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function Xi(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function Bi(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function Gi(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Qi(e,t){var r=e[0],n=e[1],a=e[2],s=e[3],c=e[4],l=e[5],h=e[6],u=e[7],i=e[8],o=e[9],f=e[10],d=e[11],v=e[12],_=e[13],p=e[14],m=e[15],y=t[0],g=t[1],M=t[2],b=t[3],x=t[4],E=t[5],S=t[6],D=t[7],C=t[8],z=t[9],k=t[10],q=t[11],P=t[12],U=t[13],he=t[14],de=t[15];return Math.abs(r-y)<=Y.EPSILON*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(n-g)<=Y.EPSILON*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(a-M)<=Y.EPSILON*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(s-b)<=Y.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(c-x)<=Y.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(l-E)<=Y.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(h-S)<=Y.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(u-D)<=Y.EPSILON*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(i-C)<=Y.EPSILON*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(o-z)<=Y.EPSILON*Math.max(1,Math.abs(o),Math.abs(z))&&Math.abs(f-k)<=Y.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(d-q)<=Y.EPSILON*Math.max(1,Math.abs(d),Math.abs(q))&&Math.abs(v-P)<=Y.EPSILON*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(_-U)<=Y.EPSILON*Math.max(1,Math.abs(_),Math.abs(U))&&Math.abs(p-he)<=Y.EPSILON*Math.max(1,Math.abs(p),Math.abs(he))&&Math.abs(m-de)<=Y.EPSILON*Math.max(1,Math.abs(m),Math.abs(de))}var Zi=tt;O.mul=Zi;var $i=it;O.sub=$i});var Ie=H(A=>{"use strict";function me(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?me=function(r){return typeof r}:me=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},me(e)}Object.defineProperty(A,"__esModule",{value:!0});A.create=st;A.clone=Ji;A.length=ot;A.fromValues=Ki;A.copy=ea;A.set=ta;A.add=ra;A.subtract=ct;A.multiply=lt;A.divide=ft;A.ceil=na;A.floor=ia;A.min=aa;A.max=sa;A.round=oa;A.scale=ca;A.scaleAndAdd=la;A.distance=ht;A.squaredDistance=dt;A.squaredLength=ut;A.negate=fa;A.inverse=ha;A.normalize=da;A.dot=pt;A.cross=ua;A.lerp=pa;A.hermite=va;A.bezier=_a;A.random=ma;A.transformMat4=ya;A.transformMat3=ga;A.transformQuat=Ma;A.rotateX=ba;A.rotateY=xa;A.rotateZ=wa;A.angle=Aa;A.zero=Ta;A.str=Sa;A.exactEquals=Oa;A.equals=La;A.forEach=A.sqrLen=A.len=A.sqrDist=A.dist=A.div=A.mul=A.sub=void 0;var re=Ra(Z());function vt(){if(typeof WeakMap!="function")return null;var e=new WeakMap;return vt=function(){return e},e}function Ra(e){if(e&&e.__esModule)return e;if(e===null||me(e)!=="object"&&typeof e!="function")return{default:e};var t=vt();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=n?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function st(){var e=new re.ARRAY_TYPE(3);return re.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ji(e){var t=new re.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ot(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)}function Ki(e,t,r){var n=new re.ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=r,n}function ea(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function ta(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function ra(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function ct(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function lt(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function ft(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function na(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function ia(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function aa(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function sa(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function oa(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function ca(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function la(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function ht(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return Math.hypot(r,n,a)}function dt(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return r*r+n*n+a*a}function ut(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function fa(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function ha(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function da(e,t){var r=t[0],n=t[1],a=t[2],s=r*r+n*n+a*a;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function pt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ua(e,t,r){var n=t[0],a=t[1],s=t[2],c=r[0],l=r[1],h=r[2];return e[0]=a*h-s*l,e[1]=s*c-n*h,e[2]=n*l-a*c,e}function pa(e,t,r,n){var a=t[0],s=t[1],c=t[2];return e[0]=a+n*(r[0]-a),e[1]=s+n*(r[1]-s),e[2]=c+n*(r[2]-c),e}function va(e,t,r,n,a,s){var c=s*s,l=c*(2*s-3)+1,h=c*(s-2)+s,u=c*(s-1),i=c*(3-2*s);return e[0]=t[0]*l+r[0]*h+n[0]*u+a[0]*i,e[1]=t[1]*l+r[1]*h+n[1]*u+a[1]*i,e[2]=t[2]*l+r[2]*h+n[2]*u+a[2]*i,e}function _a(e,t,r,n,a,s){var c=1-s,l=c*c,h=s*s,u=l*c,i=3*s*l,o=3*h*c,f=h*s;return e[0]=t[0]*u+r[0]*i+n[0]*o+a[0]*f,e[1]=t[1]*u+r[1]*i+n[1]*o+a[1]*f,e[2]=t[2]*u+r[2]*i+n[2]*o+a[2]*f,e}function ma(e,t){t=t||1;var r=re.RANDOM()*2*Math.PI,n=re.RANDOM()*2-1,a=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*a,e[1]=Math.sin(r)*a,e[2]=n*t,e}function ya(e,t,r){var n=t[0],a=t[1],s=t[2],c=r[3]*n+r[7]*a+r[11]*s+r[15];return c=c||1,e[0]=(r[0]*n+r[4]*a+r[8]*s+r[12])/c,e[1]=(r[1]*n+r[5]*a+r[9]*s+r[13])/c,e[2]=(r[2]*n+r[6]*a+r[10]*s+r[14])/c,e}function ga(e,t,r){var n=t[0],a=t[1],s=t[2];return e[0]=n*r[0]+a*r[3]+s*r[6],e[1]=n*r[1]+a*r[4]+s*r[7],e[2]=n*r[2]+a*r[5]+s*r[8],e}function Ma(e,t,r){var n=r[0],a=r[1],s=r[2],c=r[3],l=t[0],h=t[1],u=t[2],i=a*u-s*h,o=s*l-n*u,f=n*h-a*l,d=a*f-s*o,v=s*i-n*f,_=n*o-a*i,p=c*2;return i*=p,o*=p,f*=p,d*=2,v*=2,_*=2,e[0]=l+i+d,e[1]=h+o+v,e[2]=u+f+_,e}function ba(e,t,r,n){var a=[],s=[];return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],s[0]=a[0],s[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),s[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function xa(e,t,r,n){var a=[],s=[];return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],s[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),s[1]=a[1],s[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function wa(e,t,r,n){var a=[],s=[];return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],s[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),s[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),s[2]=a[2],e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function Aa(e,t){var r=e[0],n=e[1],a=e[2],s=t[0],c=t[1],l=t[2],h=Math.sqrt(r*r+n*n+a*a),u=Math.sqrt(s*s+c*c+l*l),i=h*u,o=i&&pt(e,t)/i;return Math.acos(Math.min(Math.max(o,-1),1))}function Ta(e){return e[0]=0,e[1]=0,e[2]=0,e}function Sa(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Oa(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function La(e,t){var r=e[0],n=e[1],a=e[2],s=t[0],c=t[1],l=t[2];return Math.abs(r-s)<=re.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-c)<=re.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-l)<=re.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))}var Pa=ct;A.sub=Pa;var Ia=lt;A.mul=Ia;var Wa=ft;A.div=Wa;var Ea=ht;A.dist=Ea;var qa=dt;A.sqrDist=qa;var Ca=ot;A.len=Ca;var Da=ut;A.sqrLen=Da;var ka=function(){var e=st();return function(t,r,n,a,s,c){var l,h;for(r||(r=3),n||(n=0),a?h=Math.min(a*r+n,t.length):h=t.length,l=n;l<h;l+=r)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],s(e,e,c),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}}();A.forEach=ka});var We=H(L=>{"use strict";function ye(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ye=function(r){return typeof r}:ye=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ye(e)}Object.defineProperty(L,"__esModule",{value:!0});L.create=_t;L.clone=Fa;L.fromValues=ja;L.copy=za;L.set=Ya;L.add=Ha;L.subtract=mt;L.multiply=yt;L.divide=gt;L.ceil=Va;L.floor=Na;L.min=Xa;L.max=Ba;L.round=Ga;L.scale=Qa;L.scaleAndAdd=Ua;L.distance=Mt;L.squaredDistance=bt;L.length=xt;L.squaredLength=wt;L.negate=Za;L.inverse=$a;L.normalize=Ja;L.dot=Ka;L.cross=es;L.lerp=ts;L.random=rs;L.transformMat4=ns;L.transformQuat=is;L.zero=as;L.str=ss;L.exactEquals=os;L.equals=cs;L.forEach=L.sqrLen=L.len=L.sqrDist=L.dist=L.div=L.mul=L.sub=void 0;var Q=ls(Z());function At(){if(typeof WeakMap!="function")return null;var e=new WeakMap;return At=function(){return e},e}function ls(e){if(e&&e.__esModule)return e;if(e===null||ye(e)!=="object"&&typeof e!="function")return{default:e};var t=At();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=n?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function _t(){var e=new Q.ARRAY_TYPE(4);return Q.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Fa(e){var t=new Q.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function ja(e,t,r,n){var a=new Q.ARRAY_TYPE(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a}function za(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Ya(e,t,r,n,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e}function Ha(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function mt(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function yt(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function gt(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Va(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Na(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Xa(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function Ba(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Ga(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Qa(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Ua(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function Mt(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],s=t[3]-e[3];return Math.hypot(r,n,a,s)}function bt(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],s=t[3]-e[3];return r*r+n*n+a*a+s*s}function xt(e){var t=e[0],r=e[1],n=e[2],a=e[3];return Math.hypot(t,r,n,a)}function wt(e){var t=e[0],r=e[1],n=e[2],a=e[3];return t*t+r*r+n*n+a*a}function Za(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function $a(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Ja(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=r*r+n*n+a*a+s*s;return c>0&&(c=1/Math.sqrt(c)),e[0]=r*c,e[1]=n*c,e[2]=a*c,e[3]=s*c,e}function Ka(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function es(e,t,r,n){var a=r[0]*n[1]-r[1]*n[0],s=r[0]*n[2]-r[2]*n[0],c=r[0]*n[3]-r[3]*n[0],l=r[1]*n[2]-r[2]*n[1],h=r[1]*n[3]-r[3]*n[1],u=r[2]*n[3]-r[3]*n[2],i=t[0],o=t[1],f=t[2],d=t[3];return e[0]=o*u-f*h+d*l,e[1]=-(i*u)+f*c-d*s,e[2]=i*h-o*c+d*a,e[3]=-(i*l)+o*s-f*a,e}function ts(e,t,r,n){var a=t[0],s=t[1],c=t[2],l=t[3];return e[0]=a+n*(r[0]-a),e[1]=s+n*(r[1]-s),e[2]=c+n*(r[2]-c),e[3]=l+n*(r[3]-l),e}function rs(e,t){t=t||1;var r,n,a,s,c,l;do r=Q.RANDOM()*2-1,n=Q.RANDOM()*2-1,c=r*r+n*n;while(c>=1);do a=Q.RANDOM()*2-1,s=Q.RANDOM()*2-1,l=a*a+s*s;while(l>=1);var h=Math.sqrt((1-c)/l);return e[0]=t*r,e[1]=t*n,e[2]=t*a*h,e[3]=t*s*h,e}function ns(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3];return e[0]=r[0]*n+r[4]*a+r[8]*s+r[12]*c,e[1]=r[1]*n+r[5]*a+r[9]*s+r[13]*c,e[2]=r[2]*n+r[6]*a+r[10]*s+r[14]*c,e[3]=r[3]*n+r[7]*a+r[11]*s+r[15]*c,e}function is(e,t,r){var n=t[0],a=t[1],s=t[2],c=r[0],l=r[1],h=r[2],u=r[3],i=u*n+l*s-h*a,o=u*a+h*n-c*s,f=u*s+c*a-l*n,d=-c*n-l*a-h*s;return e[0]=i*u+d*-c+o*-h-f*-l,e[1]=o*u+d*-l+f*-c-i*-h,e[2]=f*u+d*-h+i*-l-o*-c,e[3]=t[3],e}function as(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function ss(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function os(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function cs(e,t){var r=e[0],n=e[1],a=e[2],s=e[3],c=t[0],l=t[1],h=t[2],u=t[3];return Math.abs(r-c)<=Q.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-l)<=Q.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-h)<=Q.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(s-u)<=Q.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))}var fs=mt;L.sub=fs;var hs=yt;L.mul=hs;var ds=gt;L.div=ds;var us=Mt;L.dist=us;var ps=bt;L.sqrDist=ps;var vs=xt;L.len=vs;var _s=wt;L.sqrLen=_s;var ms=function(){var e=_t();return function(t,r,n,a,s,c){var l,h;for(r||(r=4),n||(n=0),a?h=Math.min(a*r+n,t.length):h=t.length,l=n;l<h;l+=r)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],s(e,e,c),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}}();L.forEach=ms});var Ce=H(w=>{"use strict";function ge(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ge=function(r){return typeof r}:ge=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ge(e)}Object.defineProperty(w,"__esModule",{value:!0});w.create=Ee;w.identity=ys;w.setAxisAngle=Tt;w.getAxisAngle=gs;w.getAngle=Ms;w.multiply=St;w.rotateX=bs;w.rotateY=xs;w.rotateZ=ws;w.calculateW=As;w.exp=Ot;w.ln=Lt;w.pow=Ts;w.slerp=Me;w.random=Ss;w.invert=Os;w.conjugate=Ls;w.fromMat3=Rt;w.fromEuler=Rs;w.str=Ps;w.setAxes=w.sqlerp=w.rotationTo=w.equals=w.exactEquals=w.normalize=w.sqrLen=w.squaredLength=w.len=w.length=w.lerp=w.dot=w.scale=w.mul=w.add=w.set=w.copy=w.fromValues=w.clone=void 0;var ce=be(Z()),Is=be(Re()),ne=be(Ie()),B=be(We());function Pt(){if(typeof WeakMap!="function")return null;var e=new WeakMap;return Pt=function(){return e},e}function be(e){if(e&&e.__esModule)return e;if(e===null||ge(e)!=="object"&&typeof e!="function")return{default:e};var t=Pt();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=n?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function Ee(){var e=new ce.ARRAY_TYPE(4);return ce.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function ys(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Tt(e,t,r){r=r*.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function gs(e,t){var r=Math.acos(t[3])*2,n=Math.sin(r/2);return n>ce.EPSILON?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function Ms(e,t){var r=It(e,t);return Math.acos(2*r*r-1)}function St(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=r[0],h=r[1],u=r[2],i=r[3];return e[0]=n*i+c*l+a*u-s*h,e[1]=a*i+c*h+s*l-n*u,e[2]=s*i+c*u+n*h-a*l,e[3]=c*i-n*l-a*h-s*u,e}function bs(e,t,r){r*=.5;var n=t[0],a=t[1],s=t[2],c=t[3],l=Math.sin(r),h=Math.cos(r);return e[0]=n*h+c*l,e[1]=a*h+s*l,e[2]=s*h-a*l,e[3]=c*h-n*l,e}function xs(e,t,r){r*=.5;var n=t[0],a=t[1],s=t[2],c=t[3],l=Math.sin(r),h=Math.cos(r);return e[0]=n*h-s*l,e[1]=a*h+c*l,e[2]=s*h+n*l,e[3]=c*h-a*l,e}function ws(e,t,r){r*=.5;var n=t[0],a=t[1],s=t[2],c=t[3],l=Math.sin(r),h=Math.cos(r);return e[0]=n*h+a*l,e[1]=a*h-n*l,e[2]=s*h+c*l,e[3]=c*h-s*l,e}function As(e,t){var r=t[0],n=t[1],a=t[2];return e[0]=r,e[1]=n,e[2]=a,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),e}function Ot(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=Math.sqrt(r*r+n*n+a*a),l=Math.exp(s),h=c>0?l*Math.sin(c)/c:0;return e[0]=r*h,e[1]=n*h,e[2]=a*h,e[3]=l*Math.cos(c),e}function Lt(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=Math.sqrt(r*r+n*n+a*a),l=c>0?Math.atan2(c,s)/c:0;return e[0]=r*l,e[1]=n*l,e[2]=a*l,e[3]=.5*Math.log(r*r+n*n+a*a+s*s),e}function Ts(e,t,r){return Lt(e,t),Wt(e,e,r),Ot(e,e),e}function Me(e,t,r,n){var a=t[0],s=t[1],c=t[2],l=t[3],h=r[0],u=r[1],i=r[2],o=r[3],f,d,v,_,p;return d=a*h+s*u+c*i+l*o,d<0&&(d=-d,h=-h,u=-u,i=-i,o=-o),1-d>ce.EPSILON?(f=Math.acos(d),v=Math.sin(f),_=Math.sin((1-n)*f)/v,p=Math.sin(n*f)/v):(_=1-n,p=n),e[0]=_*a+p*h,e[1]=_*s+p*u,e[2]=_*c+p*i,e[3]=_*l+p*o,e}function Ss(e){var t=ce.RANDOM(),r=ce.RANDOM(),n=ce.RANDOM(),a=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=a*Math.sin(2*Math.PI*r),e[1]=a*Math.cos(2*Math.PI*r),e[2]=s*Math.sin(2*Math.PI*n),e[3]=s*Math.cos(2*Math.PI*n),e}function Os(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],c=r*r+n*n+a*a+s*s,l=c?1/c:0;return e[0]=-r*l,e[1]=-n*l,e[2]=-a*l,e[3]=s*l,e}function Ls(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Rt(e,t){var r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[a*3+a]&&(a=2);var s=(a+1)%3,c=(a+2)%3;n=Math.sqrt(t[a*3+a]-t[s*3+s]-t[c*3+c]+1),e[a]=.5*n,n=.5/n,e[3]=(t[s*3+c]-t[c*3+s])*n,e[s]=(t[s*3+a]+t[a*3+s])*n,e[c]=(t[c*3+a]+t[a*3+c])*n}return e}function Rs(e,t,r,n){var a=.5*Math.PI/180;t*=a,r*=a,n*=a;var s=Math.sin(t),c=Math.cos(t),l=Math.sin(r),h=Math.cos(r),u=Math.sin(n),i=Math.cos(n);return e[0]=s*h*i-c*l*u,e[1]=c*l*i+s*h*u,e[2]=c*h*u-s*l*i,e[3]=c*h*i+s*l*u,e}function Ps(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Ws=B.clone;w.clone=Ws;var Es=B.fromValues;w.fromValues=Es;var qs=B.copy;w.copy=qs;var Cs=B.set;w.set=Cs;var Ds=B.add;w.add=Ds;var ks=St;w.mul=ks;var Wt=B.scale;w.scale=Wt;var It=B.dot;w.dot=It;var Fs=B.lerp;w.lerp=Fs;var Et=B.length;w.length=Et;var js=Et;w.len=js;var qt=B.squaredLength;w.squaredLength=qt;var zs=qt;w.sqrLen=zs;var qe=B.normalize;w.normalize=qe;var Ys=B.exactEquals;w.exactEquals=Ys;var Hs=B.equals;w.equals=Hs;var Vs=function(){var e=ne.create(),t=ne.fromValues(1,0,0),r=ne.fromValues(0,1,0);return function(n,a,s){var c=ne.dot(a,s);return c<-.999999?(ne.cross(e,t,a),ne.len(e)<1e-6&&ne.cross(e,r,a),ne.normalize(e,e),Tt(n,e,Math.PI),n):c>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(ne.cross(e,a,s),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+c,qe(n,n))}}();w.rotationTo=Vs;var Ns=function(){var e=Ee(),t=Ee();return function(r,n,a,s,c,l){return Me(e,n,c,l),Me(t,a,s,l),Me(r,e,t,2*l*(1-l)),r}}();w.sqlerp=Ns;var Xs=function(){var e=Is.create();return function(t,r,n,a){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],qe(t,Rt(t,e))}}();w.setAxes=Xs});var Ht=H(R=>{"use strict";function xe(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?xe=function(r){return typeof r}:xe=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},xe(e)}Object.defineProperty(R,"__esModule",{value:!0});R.create=Bs;R.clone=Gs;R.fromValues=Qs;R.fromRotationTranslationValues=Us;R.fromRotationTranslation=Ct;R.fromTranslation=Zs;R.fromRotation=$s;R.fromMat4=Js;R.copy=Dt;R.identity=Ks;R.set=eo;R.getDual=to;R.setDual=ro;R.getTranslation=no;R.translate=io;R.rotateX=ao;R.rotateY=so;R.rotateZ=oo;R.rotateByQuatAppend=co;R.rotateByQuatPrepend=lo;R.rotateAroundAxis=fo;R.add=ho;R.multiply=kt;R.scale=uo;R.lerp=po;R.invert=vo;R.conjugate=_o;R.normalize=mo;R.str=yo;R.exactEquals=go;R.equals=Mo;R.sqrLen=R.squaredLength=R.len=R.length=R.dot=R.mul=R.setReal=R.getReal=void 0;var N=De(Z()),ie=De(Ce()),Ft=De(Pe());function jt(){if(typeof WeakMap!="function")return null;var e=new WeakMap;return jt=function(){return e},e}function De(e){if(e&&e.__esModule)return e;if(e===null||xe(e)!=="object"&&typeof e!="function")return{default:e};var t=jt();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=n?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function Bs(){var e=new N.ARRAY_TYPE(8);return N.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function Gs(e){var t=new N.ARRAY_TYPE(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Qs(e,t,r,n,a,s,c,l){var h=new N.ARRAY_TYPE(8);return h[0]=e,h[1]=t,h[2]=r,h[3]=n,h[4]=a,h[5]=s,h[6]=c,h[7]=l,h}function Us(e,t,r,n,a,s,c){var l=new N.ARRAY_TYPE(8);l[0]=e,l[1]=t,l[2]=r,l[3]=n;var h=a*.5,u=s*.5,i=c*.5;return l[4]=h*n+u*r-i*t,l[5]=u*n+i*e-h*r,l[6]=i*n+h*t-u*e,l[7]=-h*e-u*t-i*r,l}function Ct(e,t,r){var n=r[0]*.5,a=r[1]*.5,s=r[2]*.5,c=t[0],l=t[1],h=t[2],u=t[3];return e[0]=c,e[1]=l,e[2]=h,e[3]=u,e[4]=n*u+a*h-s*l,e[5]=a*u+s*c-n*h,e[6]=s*u+n*l-a*c,e[7]=-n*c-a*l-s*h,e}function Zs(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0]*.5,e[5]=t[1]*.5,e[6]=t[2]*.5,e[7]=0,e}function $s(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Js(e,t){var r=ie.create();Ft.getRotation(r,t);var n=new N.ARRAY_TYPE(3);return Ft.getTranslation(n,t),Ct(e,r,n),e}function Dt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Ks(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function eo(e,t,r,n,a,s,c,l,h){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e[4]=s,e[5]=c,e[6]=l,e[7]=h,e}var bo=ie.copy;R.getReal=bo;function to(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e}var xo=ie.copy;R.setReal=xo;function ro(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e}function no(e,t){var r=t[4],n=t[5],a=t[6],s=t[7],c=-t[0],l=-t[1],h=-t[2],u=t[3];return e[0]=(r*u+s*c+n*h-a*l)*2,e[1]=(n*u+s*l+a*c-r*h)*2,e[2]=(a*u+s*h+r*l-n*c)*2,e}function io(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=r[0]*.5,h=r[1]*.5,u=r[2]*.5,i=t[4],o=t[5],f=t[6],d=t[7];return e[0]=n,e[1]=a,e[2]=s,e[3]=c,e[4]=c*l+a*u-s*h+i,e[5]=c*h+s*l-n*u+o,e[6]=c*u+n*h-a*l+f,e[7]=-n*l-a*h-s*u+d,e}function ao(e,t,r){var n=-t[0],a=-t[1],s=-t[2],c=t[3],l=t[4],h=t[5],u=t[6],i=t[7],o=l*c+i*n+h*s-u*a,f=h*c+i*a+u*n-l*s,d=u*c+i*s+l*a-h*n,v=i*c-l*n-h*a-u*s;return ie.rotateX(e,t,r),n=e[0],a=e[1],s=e[2],c=e[3],e[4]=o*c+v*n+f*s-d*a,e[5]=f*c+v*a+d*n-o*s,e[6]=d*c+v*s+o*a-f*n,e[7]=v*c-o*n-f*a-d*s,e}function so(e,t,r){var n=-t[0],a=-t[1],s=-t[2],c=t[3],l=t[4],h=t[5],u=t[6],i=t[7],o=l*c+i*n+h*s-u*a,f=h*c+i*a+u*n-l*s,d=u*c+i*s+l*a-h*n,v=i*c-l*n-h*a-u*s;return ie.rotateY(e,t,r),n=e[0],a=e[1],s=e[2],c=e[3],e[4]=o*c+v*n+f*s-d*a,e[5]=f*c+v*a+d*n-o*s,e[6]=d*c+v*s+o*a-f*n,e[7]=v*c-o*n-f*a-d*s,e}function oo(e,t,r){var n=-t[0],a=-t[1],s=-t[2],c=t[3],l=t[4],h=t[5],u=t[6],i=t[7],o=l*c+i*n+h*s-u*a,f=h*c+i*a+u*n-l*s,d=u*c+i*s+l*a-h*n,v=i*c-l*n-h*a-u*s;return ie.rotateZ(e,t,r),n=e[0],a=e[1],s=e[2],c=e[3],e[4]=o*c+v*n+f*s-d*a,e[5]=f*c+v*a+d*n-o*s,e[6]=d*c+v*s+o*a-f*n,e[7]=v*c-o*n-f*a-d*s,e}function co(e,t,r){var n=r[0],a=r[1],s=r[2],c=r[3],l=t[0],h=t[1],u=t[2],i=t[3];return e[0]=l*c+i*n+h*s-u*a,e[1]=h*c+i*a+u*n-l*s,e[2]=u*c+i*s+l*a-h*n,e[3]=i*c-l*n-h*a-u*s,l=t[4],h=t[5],u=t[6],i=t[7],e[4]=l*c+i*n+h*s-u*a,e[5]=h*c+i*a+u*n-l*s,e[6]=u*c+i*s+l*a-h*n,e[7]=i*c-l*n-h*a-u*s,e}function lo(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=r[0],h=r[1],u=r[2],i=r[3];return e[0]=n*i+c*l+a*u-s*h,e[1]=a*i+c*h+s*l-n*u,e[2]=s*i+c*u+n*h-a*l,e[3]=c*i-n*l-a*h-s*u,l=r[4],h=r[5],u=r[6],i=r[7],e[4]=n*i+c*l+a*u-s*h,e[5]=a*i+c*h+s*l-n*u,e[6]=s*i+c*u+n*h-a*l,e[7]=c*i-n*l-a*h-s*u,e}function fo(e,t,r,n){if(Math.abs(n)<N.EPSILON)return Dt(e,t);var a=Math.hypot(r[0],r[1],r[2]);n=n*.5;var s=Math.sin(n),c=s*r[0]/a,l=s*r[1]/a,h=s*r[2]/a,u=Math.cos(n),i=t[0],o=t[1],f=t[2],d=t[3];e[0]=i*u+d*c+o*h-f*l,e[1]=o*u+d*l+f*c-i*h,e[2]=f*u+d*h+i*l-o*c,e[3]=d*u-i*c-o*l-f*h;var v=t[4],_=t[5],p=t[6],m=t[7];return e[4]=v*u+m*c+_*h-p*l,e[5]=_*u+m*l+p*c-v*h,e[6]=p*u+m*h+v*l-_*c,e[7]=m*u-v*c-_*l-p*h,e}function ho(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e}function kt(e,t,r){var n=t[0],a=t[1],s=t[2],c=t[3],l=r[4],h=r[5],u=r[6],i=r[7],o=t[4],f=t[5],d=t[6],v=t[7],_=r[0],p=r[1],m=r[2],y=r[3];return e[0]=n*y+c*_+a*m-s*p,e[1]=a*y+c*p+s*_-n*m,e[2]=s*y+c*m+n*p-a*_,e[3]=c*y-n*_-a*p-s*m,e[4]=n*i+c*l+a*u-s*h+o*y+v*_+f*m-d*p,e[5]=a*i+c*h+s*l-n*u+f*y+v*p+d*_-o*m,e[6]=s*i+c*u+n*h-a*l+d*y+v*m+o*p-f*_,e[7]=c*i-n*l-a*h-s*u+v*y-o*_-f*p-d*m,e}var wo=kt;R.mul=wo;function uo(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e}var zt=ie.dot;R.dot=zt;function po(e,t,r,n){var a=1-n;return zt(t,r)<0&&(n=-n),e[0]=t[0]*a+r[0]*n,e[1]=t[1]*a+r[1]*n,e[2]=t[2]*a+r[2]*n,e[3]=t[3]*a+r[3]*n,e[4]=t[4]*a+r[4]*n,e[5]=t[5]*a+r[5]*n,e[6]=t[6]*a+r[6]*n,e[7]=t[7]*a+r[7]*n,e}function vo(e,t){var r=we(t);return e[0]=-t[0]/r,e[1]=-t[1]/r,e[2]=-t[2]/r,e[3]=t[3]/r,e[4]=-t[4]/r,e[5]=-t[5]/r,e[6]=-t[6]/r,e[7]=t[7]/r,e}function _o(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e}var Yt=ie.length;R.length=Yt;var Ao=Yt;R.len=Ao;var we=ie.squaredLength;R.squaredLength=we;var To=we;R.sqrLen=To;function mo(e,t){var r=we(t);if(r>0){r=Math.sqrt(r);var n=t[0]/r,a=t[1]/r,s=t[2]/r,c=t[3]/r,l=t[4],h=t[5],u=t[6],i=t[7],o=n*l+a*h+s*u+c*i;e[0]=n,e[1]=a,e[2]=s,e[3]=c,e[4]=(l-n*o)/r,e[5]=(h-a*o)/r,e[6]=(u-s*o)/r,e[7]=(i-c*o)/r}return e}function yo(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function go(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function Mo(e,t){var r=e[0],n=e[1],a=e[2],s=e[3],c=e[4],l=e[5],h=e[6],u=e[7],i=t[0],o=t[1],f=t[2],d=t[3],v=t[4],_=t[5],p=t[6],m=t[7];return Math.abs(r-i)<=N.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-o)<=N.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(a-f)<=N.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-d)<=N.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(c-v)<=N.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(l-_)<=N.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(h-p)<=N.EPSILON*Math.max(1,Math.abs(h),Math.abs(p))&&Math.abs(u-m)<=N.EPSILON*Math.max(1,Math.abs(u),Math.abs(m))}});var Jt=H(T=>{"use strict";function Ae(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ae=function(r){return typeof r}:Ae=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ae(e)}Object.defineProperty(T,"__esModule",{value:!0});T.create=Vt;T.clone=So;T.fromValues=Oo;T.copy=Lo;T.set=Ro;T.add=Po;T.subtract=Nt;T.multiply=Xt;T.divide=Bt;T.ceil=Io;T.floor=Wo;T.min=Eo;T.max=qo;T.round=Co;T.scale=Do;T.scaleAndAdd=ko;T.distance=Gt;T.squaredDistance=Qt;T.length=Ut;T.squaredLength=Zt;T.negate=Fo;T.inverse=jo;T.normalize=zo;T.dot=Yo;T.cross=Ho;T.lerp=Vo;T.random=No;T.transformMat2=Xo;T.transformMat2d=Bo;T.transformMat3=Go;T.transformMat4=Qo;T.rotate=Uo;T.angle=Zo;T.zero=$o;T.str=Jo;T.exactEquals=Ko;T.equals=ec;T.forEach=T.sqrLen=T.sqrDist=T.dist=T.div=T.mul=T.sub=T.len=void 0;var le=tc(Z());function $t(){if(typeof WeakMap!="function")return null;var e=new WeakMap;return $t=function(){return e},e}function tc(e){if(e&&e.__esModule)return e;if(e===null||Ae(e)!=="object"&&typeof e!="function")return{default:e};var t=$t();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=n?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function Vt(){var e=new le.ARRAY_TYPE(2);return le.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function So(e){var t=new le.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t}function Oo(e,t){var r=new le.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r}function Lo(e,t){return e[0]=t[0],e[1]=t[1],e}function Ro(e,t,r){return e[0]=t,e[1]=r,e}function Po(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Nt(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Xt(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function Bt(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function Io(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Wo(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Eo(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function qo(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function Co(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function Do(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function ko(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function Gt(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.hypot(r,n)}function Qt(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function Ut(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function Zt(e){var t=e[0],r=e[1];return t*t+r*r}function Fo(e,t){return e[0]=-t[0],e[1]=-t[1],e}function jo(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function zo(e,t){var r=t[0],n=t[1],a=r*r+n*n;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e}function Yo(e,t){return e[0]*t[0]+e[1]*t[1]}function Ho(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function Vo(e,t,r,n){var a=t[0],s=t[1];return e[0]=a+n*(r[0]-a),e[1]=s+n*(r[1]-s),e}function No(e,t){t=t||1;var r=le.RANDOM()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function Xo(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[2]*a,e[1]=r[1]*n+r[3]*a,e}function Bo(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[2]*a+r[4],e[1]=r[1]*n+r[3]*a+r[5],e}function Go(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[3]*a+r[6],e[1]=r[1]*n+r[4]*a+r[7],e}function Qo(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[4]*a+r[12],e[1]=r[1]*n+r[5]*a+r[13],e}function Uo(e,t,r,n){var a=t[0]-r[0],s=t[1]-r[1],c=Math.sin(n),l=Math.cos(n);return e[0]=a*l-s*c+r[0],e[1]=a*c+s*l+r[1],e}function Zo(e,t){var r=e[0],n=e[1],a=t[0],s=t[1],c=Math.sqrt(r*r+n*n)*Math.sqrt(a*a+s*s),l=c&&(r*a+n*s)/c;return Math.acos(Math.min(Math.max(l,-1),1))}function $o(e){return e[0]=0,e[1]=0,e}function Jo(e){return"vec2("+e[0]+", "+e[1]+")"}function Ko(e,t){return e[0]===t[0]&&e[1]===t[1]}function ec(e,t){var r=e[0],n=e[1],a=t[0],s=t[1];return Math.abs(r-a)<=le.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=le.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))}var rc=Ut;T.len=rc;var nc=Nt;T.sub=nc;var ic=Xt;T.mul=ic;var ac=Bt;T.div=ac;var sc=Gt;T.dist=sc;var oc=Qt;T.sqrDist=oc;var cc=Zt;T.sqrLen=cc;var lc=function(){var e=Vt();return function(t,r,n,a,s,c){var l,h;for(r||(r=2),n||(n=0),a?h=Math.min(a*r+n,t.length):h=t.length,l=n;l<h;l+=r)e[0]=t[l],e[1]=t[l+1],s(e,e,c),t[l]=e[0],t[l+1]=e[1];return t}}();T.forEach=lc});var te=H(V=>{"use strict";function Te(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Te=function(r){return typeof r}:Te=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Te(e)}Object.defineProperty(V,"__esModule",{value:!0});V.vec4=V.vec3=V.vec2=V.quat2=V.quat=V.mat4=V.mat3=V.mat2d=V.mat2=V.glMatrix=void 0;var fc=ee(Z());V.glMatrix=fc;var hc=ee(Be());V.mat2=hc;var dc=ee(Ze());V.mat2d=dc;var uc=ee(Re());V.mat3=uc;var pc=ee(Pe());V.mat4=pc;var vc=ee(Ce());V.quat=vc;var _c=ee(Ht());V.quat2=_c;var mc=ee(Jt());V.vec2=mc;var yc=ee(Ie());V.vec3=yc;var gc=ee(We());V.vec4=gc;function Kt(){if(typeof WeakMap!="function")return null;var e=new WeakMap;return Kt=function(){return e},e}function ee(e){if(e&&e.__esModule)return e;if(e===null||Te(e)!=="object"&&typeof e!="function")return{default:e};var t=Kt();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=n?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}});var er=H(()=>{WL.registerComponent("8thwall-camera",{camera:{type:WL.Type.Enum,values:["auto","back","front"],default:"auto"}},{name:"wonderland-engine",init:function(){this.position=[0,0,0,0],this.rotation=[0,0,0,0],this.started=!1;let e=["auto","back","front"];this.camera=e[this.camera],this.camera=="auto"&&(this.camera="back"),this.onStart=this.onStart.bind(this),this.onUpdate=this.onUpdate.bind(this),XR8.addCameraPipelineModules([XR8.GlTextureRenderer.pipelineModule(),XR8.XrController.pipelineModule(),this]),this.camera=="back"?XR8.run({canvas:Module.canvas,ownRunLoop:!1}):this.camera=="back"?(XR8.XrController.configure({disableWorldTracking:!0}),XR8.run({canvas:Module.canvas,ownRunLoop:!1,cameraConfig:{direction:XR8.XrConfig.camera().FRONT}})):console.error("[8thwall-camera] Invalid camera setting:",this.camera)},update:function(){if(this.started){if(WL.scene.onPostRender.length==0&&(WL.scene.onPreRender.push(function(){XR8.runPreRender(Date.now()),_wl_reset_context()}),WL.scene.onPostRender.push(function(){XR8.runPostRender(Date.now())})),this.rotation[0]==0&&this.rotation[1]==0&&this.rotation[2]==0&&this.rotation[3]==0)return;this.object.resetTransform(),this.object.rotate(this.rotation),this.object.translate(this.position)}},onUpdate:function(e){if(!e.processCpuResult.reality)return;let t=e.processCpuResult.reality.rotation;this.rotation[0]=t.x,this.rotation[1]=t.y,this.rotation[2]=t.z,this.rotation[3]=t.w;let r=e.processCpuResult.reality.position;this.position[0]=r.x,this.position[1]=r.y,this.position[2]=r.z},onStart:function(){this.started=!0}})});var tr=H(()=>{WL.registerComponent("cursor-target",{},{init:function(){this.hoverFunctions=[],this.unHoverFunctions=[],this.clickFunctions=[],this.moveFunctions=[],this.downFunctions=[],this.upFunctions=[]},onHover:function(e,t){for(let r of this.hoverFunctions)r(e,t)},onUnhover:function(e,t){for(let r of this.unHoverFunctions)r(e,t)},onClick:function(e,t){for(let r of this.clickFunctions)r(e,t)},onMove:function(e,t){for(let r of this.moveFunctions)r(e,t)},onDown:function(e,t){for(let r of this.downFunctions)r(e,t)},onUp:function(e,t){for(let r of this.upFunctions)r(e,t)},addHoverFunction:function(e){this._validateCallback(e),this.hoverFunctions.push(e)},removeHoverFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.hoverFunctions,e)},addUnHoverFunction:function(e){this._validateCallback(e),this.unHoverFunctions.push(e)},removeUnHoverFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.unHoverFunctions,e)},addClickFunction:function(e){this._validateCallback(e),this.clickFunctions.push(e)},removeClickFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.clickFunctions,e)},addMoveFunction:function(e){this._validateCallback(e),this.moveFunctions.push(e)},removeMoveFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.moveFunctions,e)},addDownFunction:function(e){this._validateCallback(e),this.downFunctions.push(e)},removeDownFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.downFunctions,e)},addUpFunction:function(e){this._validateCallback(e),this.upFunctions.push(e)},removeUpFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.upFunctions,e)},_removeItemOnce:function(e,t){var r=e.indexOf(t);return r>-1&&e.splice(r,1),e},_validateCallback:function(e){if(typeof e!="function")throw new TypeError(this.object.name+".cursor-target: Argument needs to be a function")}})});var Mc={};var oe,rr=$(()=>{oe=J(te());WL.registerComponent("cursor",{collisionGroup:{type:WL.Type.Int,default:1},cursorRayObject:{type:WL.Type.Object},cursorRayScalingAxis:{type:WL.Type.Enum,values:["x","y","z","none"],default:"z"},cursorObject:{type:WL.Type.Object},handedness:{type:WL.Type.Enum,values:["input component","left","right","none"],default:"input component"},rayCastMode:{type:WL.Type.Enum,values:["collision","physx"],default:"collision"},styleCursor:{type:WL.Type.Bool,default:!0}},{init:function(){this.session=null,this.collisionMask=1<<this.collisionGroup,this.maxDistance=100},start:function(){if(this.handedness==0){let e=this.object.getComponent("input");e?(this.handedness=e.handedness,this.input=e):console.warn("cursor component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];this.globalTarget=this.object.addComponent("cursor-target"),this.origin=new Float32Array(3),this.cursorObjScale=new Float32Array(3),this.direction=[0,0,0],this.tempQuat=new Float32Array(4),this.viewComponent=this.object.getComponent("view"),this.viewComponent!=null&&(WL.canvas.addEventListener("click",this.onClick.bind(this)),WL.canvas.addEventListener("pointermove",this.onPointerMove.bind(this)),WL.canvas.addEventListener("pointerdown",this.onPointerDown.bind(this)),WL.canvas.addEventListener("pointerup",this.onPointerUp.bind(this)),this.projectionMatrix=new Float32Array(16),oe.mat4.invert(this.projectionMatrix,this.viewComponent.projectionMatrix),window.addEventListener("resize",this.onViewportResize.bind(this))),this.isHovering=!1,this.visible=!0,this.isDown=!1,this.lastIsDown=!1,this.cursorPos=new Float32Array(3),this.hoveringObject=null,WL.onXRSessionStart.push(this.setupVREvents.bind(this)),this.cursorRayObject&&(this.cursorRayScale=new Float32Array(3),this.cursorRayScale.set(this.cursorRayObject.scalingLocal),this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction),this._setCursorRayTransform([this.origin[0]+this.direction[0],this.origin[1]+this.direction[1],this.origin[2]+this.direction[2]]))},onViewportResize:function(){!this.viewComponent||oe.mat4.invert(this.projectionMatrix,this.viewComponent.projectionMatrix)},_setCursorRayTransform:function(e){if(!this.cursorRayObject)return;let t=oe.vec3.dist(this.origin,e);this.cursorRayObject.setTranslationLocal([0,0,-t/2]),this.cursorRayScalingAxis!=4&&(this.cursorRayObject.resetScaling(),this.cursorRayScale[this.cursorRayScalingAxis]=t/2,this.cursorRayObject.scale(this.cursorRayScale))},_setCursorVisibility:function(e){this.visible!=e&&(this.visible=e,!!this.cursorObject&&(e?(this.cursorObject.resetScaling(),this.cursorObject.scale(this.cursorObjScale)):(this.cursorObjScale.set(this.cursorObject.scalingLocal),this.cursorObject.scale([0,0,0]))))},update:function(){this.doUpdate(!1)},doUpdate:function(e){if(this.session){if(this.arTouchDown&&this.input&&WL.xrSession.inputSources[0].handedness==="none"&&WL.xrSession.inputSources[0].gamepad){let r=WL.xrSession.inputSources[0].gamepad.axes;this.direction=[r[0],-r[1],-1],this.updateDirection()}else this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction);let t=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(this.origin,this.direction,this.collisionMask):WL.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);t.hitCount>0?this.cursorPos.set(t.locations[0]):this.cursorPos.fill(0),this.hoverBehaviour(t,e)}this.cursorObject&&(this.hoveringObject&&(this.cursorPos[0]!=0||this.cursorPos[1]!=0||this.cursorPos[2]!=0)?(this._setCursorVisibility(!0),this.cursorObject.setTranslationWorld(this.cursorPos),this._setCursorRayTransform(this.cursorPos)):this._setCursorVisibility(!1))},hoverBehaviour:function(e,t){if(e.hitCount>0){if(!this.hoveringObject||!this.hoveringObject.equals(e.objects[0])){if(this.hoveringObject){let a=this.hoveringObject.getComponent("cursor-target");a&&a.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this)}this.hoveringObject=e.objects[0],this.styleCursor&&(WL.canvas.style.cursor="pointer");let n=this.hoveringObject.getComponent("cursor-target");n&&(this.hoveringObjectTarget=n,n.onHover(this.hoveringObject,this)),this.globalTarget.onHover(this.hoveringObject,this)}this.hoveringObjectTarget&&this.hoveringObjectTarget.onMove(this.hoveringObject,this);let r=this.hoveringObject.getComponent("cursor-target");this.isDown!==this.lastIsDown&&(this.isDown?(r&&r.onDown(this.hoveringObject,this),this.globalTarget.onDown(this.hoveringObject,this)):(r&&r.onUp(this.hoveringObject,this),this.globalTarget.onUp(this.hoveringObject,this))),t&&(r&&r.onClick(this.hoveringObject,this),this.globalTarget.onClick(this.hoveringObject,this))}else if(this.hoveringObject&&e.hitCount==0){let r=this.hoveringObject.getComponent("cursor-target");r&&r.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this),this.hoveringObject=null,this.hoveringObjectTarget=null,this.styleCursor&&(WL.canvas.style.cursor="default")}this.lastIsDown=this.isDown},setupVREvents:function(e){this.session=e,e.addEventListener("end",function(t){this.session=null}.bind(this)),e.addEventListener("select",this.onSelect.bind(this)),e.addEventListener("selectstart",this.onSelectStart.bind(this)),e.addEventListener("selectend",this.onSelectEnd.bind(this)),this.onViewportResize()},onSelect:function(e){e.inputSource.handedness==this.handedness&&this.doUpdate(!0)},onSelectStart:function(e){this.arTouchDown=!0,e.inputSource.handedness==this.handedness&&(this.isDown=!0)},onSelectEnd:function(e){this.arTouchDown=!1,e.inputSource.handedness==this.handedness&&(this.isDown=!1)},onPointerMove:function(e){if(!e.isPrimary)return;let t=e.target.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.hoverBehaviour(r,!1)},onClick:function(e){let t=e.target.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.hoverBehaviour(r,!0)},onPointerDown:function(e){if(!e.isPrimary||e.button!==0)return;let t=e.target.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.isDown=!0,this.hoverBehaviour(r,!1)},onPointerUp:function(e){if(!e.isPrimary||e.button!==0)return;let t=e.target.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.isDown=!1,this.hoverBehaviour(r,!1)},updateMousePos:function(e,t,r,n){let a=e/r,s=t/n;return this.direction=[a*2-1,-s*2+1,-1],this.updateDirection()},updateDirection:function(){this.object.getTranslationWorld(this.origin),oe.vec3.transformMat4(this.direction,this.direction,this.projectionMatrix),oe.vec3.normalize(this.direction,this.direction),oe.vec3.transformQuat(this.direction,this.direction,this.object.transformWorld);let e=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(this.origin,this.direction,this.collisionMask):WL.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);return e.hitCount>0?this.cursorPos.set(e.locations[0]):this.cursorPos.fill(0),e},onDeactivate:function(){if(this._setCursorVisibility(!1),this.hoveringObject){let e=this.hoveringObject.getComponent("cursor-target");e&&e.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this)}this.cursorRayObject&&this.cursorRayObject.scale([0,0,0])},onActivate:function(){this._setCursorVisibility(!0)}})});var nr=H(()=>{WL.registerComponent("debug-object",{obj:{type:WL.Type.Object}},{start:function(){},init:function(){let e=[0,0,0];glMatrix.quat2.getTranslation(e,this.object.transformWorld),console.log("Debug Object:",this.object.name),console.log("Other object:",this.obj.name),console.log("	translation",e),console.log("	transformWorld",this.object.transformWorld),console.log("	transformLocal",this.object.transformLocal)},update:function(){}})});var ir=H(()=>{function bc(e,t,r,n){let a=Math.cos(t/2),s=Math.cos(r/2),c=Math.cos(n/2),l=Math.sin(t/2),h=Math.sin(r/2),u=Math.sin(n/2);e[0]=l*s*c+a*h*u,e[1]=a*h*c-l*s*u,e[2]=a*s*u-l*h*c,e[3]=a*s*c+l*h*u}WL.registerComponent("device-orientation-look",{},{start:function(){this.rotationX=0,this.rotationY=0,this.lastClientX=-1,this.lastClientY=-1},init:function(){this.deviceOrientation=[0,0,0,1],this.screenOrientation=window.innerHeight>window.innerWidth?0:90,this._origin=[0,0,0],window.addEventListener("deviceorientation",function(e){let t=e.alpha||0,r=e.beta||0,n=e.gamma||0,a=Math.PI/180;bc(this.deviceOrientation,r*a,t*a,-n*a)}.bind(this)),window.addEventListener("orientationchange",function(e){this.screenOrientation=window.orientation||0}.bind(this),!1)},update:function(){Module.webxr_session==null&&(glMatrix.quat2.getTranslation(this._origin,this.object.transformLocal),this.object.resetTransform(),this.screenOrientation!=0&&this.object.rotateAxisAngleDeg([0,0,-1],this.screenOrientation),this.object.rotate([-Math.sqrt(.5),0,0,Math.sqrt(.5)]),this.object.rotate(this.deviceOrientation),this.object.translate(this._origin))}})});var ar=H(()=>{WL.registerComponent("finger-cursor",{},{init:function(){this.lastTarget=null},start:function(){this.tip=this.object.getComponent("collision")},update:function(){let e=this.tip.queryOverlaps(),t=null;for(let r=0;r<e.length;++r){let n=e[r].object,a=n.getComponent("cursor-target");if(a){a.equals(this.lastTarget)||(a.onHover(n,this),a.onClick(n,this)),t=a;break}}if(t)this.lastTarget=t;else{this.lastTarget&&this.lastTarget.onUnhover(this.lastTarget.object,this),this.lastTarget=null;return}}})});var sr=H(()=>{WL.registerComponent("fixed-foveation",{fixedFoveation:{type:WL.Type.Float,default:.5}},{start:function(){WL.xrSession?this.setFixedFoveation():WL.onXRSessionStart.push(this.setFixedFoveation.bind(this))},setFixedFoveation:function(){"webxr_baseLayer"in Module&&(Module.webxr_baseLayer.fixedFoveation=this.fixedFoveation)}})});var xc={};var fe,or=$(()=>{fe=J(te());WL.registerComponent("hand-tracking",{handedness:{type:WL.Type.Enum,default:"left",values:["left","right"]},jointMesh:{type:WL.Type.Mesh,default:null},jointMaterial:{type:WL.Type.Material,default:null},handSkin:{type:WL.Type.Skin,default:null},deactivateChildrenWithoutPose:{type:WL.Type.Bool,default:!0},controllerToDeactivate:{type:WL.Type.Object}},{ORDERED_JOINTS:["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],init:function(){this.handedness=["left","right"][this.handedness]},start:function(){if(this.joints=[],this.session=null,this.hasPose=!1,this._childrenActive=!0,!("XRHand"in window)){console.warn("WebXR Hand Tracking not supported by this browser."),this.active=!1;return}if(this.handSkin){let t=this.handSkin.jointIds;this.joints[this.ORDERED_JOINTS[0]]=new WL.Object(t[0]);for(let r=0;r<t.length;++r){let n=new WL.Object(t[r]);this.joints[n.name]=n}return}for(let e=0;e<=this.ORDERED_JOINTS.length;++e){let t=WL.scene.addObject(this.object.parent),r=t.addComponent("mesh");r.mesh=this.jointMesh,r.material=this.jointMaterial,this.joints[this.ORDERED_JOINTS[e]]=t}},update:function(e){if(this.session||WL.xrSession&&this.setupVREvents(WL.xrSession),!!this.session){if(this.hasPose=!1,this.session&&this.session.inputSources)for(let t=0;t<=this.session.inputSources.length;++t){let r=this.session.inputSources[t];if(!r||!r.hand||r.handedness!=this.handedness)continue;if(this.hasPose=!0,r.hand.get("wrist")!==null){let s=Module.webxr_frame.getJointPose(r.hand.get("wrist"),WebXR.refSpaces[WebXR.refSpace]);s&&(this.object.resetTranslationRotation(),this.object.transformLocal.set([s.transform.orientation.x,s.transform.orientation.y,s.transform.orientation.z,s.transform.orientation.w]),this.object.translate([s.transform.position.x,s.transform.position.y,s.transform.position.z]))}let n=new Float32Array(3),a=new Float32Array(4);fe.quat.invert(a,this.object.transformLocal),this.object.getTranslationLocal(n);for(let s=0;s<this.ORDERED_JOINTS.length;++s){let c=this.ORDERED_JOINTS[s],l=this.joints[c];if(l==null)continue;let h=null;if(r.hand.get(c)!==null&&(h=Module.webxr_frame.getJointPose(r.hand.get(c),WebXR.refSpaces[WebXR.refSpace])),h!==null)if(this.handSkin)l.resetTranslationRotation(),l.translate([h.transform.position.x-n[0],h.transform.position.y-n[1],h.transform.position.z-n[2]]),l.rotate(a),l.rotateObject([h.transform.orientation.x,h.transform.orientation.y,h.transform.orientation.z,h.transform.orientation.w]);else{l.resetTransform(),l.transformLocal.set([h.transform.orientation.x,h.transform.orientation.y,h.transform.orientation.z,h.transform.orientation.w]),l.translate([h.transform.position.x,h.transform.position.y,h.transform.position.z]);let u=h.radius||.007;l.scale([u,u,u])}else this.handSkin||l.scale([0,0,0])}}!this.hasPose&&this._childrenActive?(this._childrenActive=!1,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!1),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!0,this.setChildrenActive(!0,this.controllerToDeactivate))):this.hasPose&&!this._childrenActive&&(this._childrenActive=!0,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!0),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!1,this.setChildrenActive(!1,this.controllerToDeactivate)))}},setChildrenActive:function(e,t){t=t||this.object;let r=t.children;for(let n of r)n.active=e,this.setChildrenActive(e,n)},isGrabbing:function(){let e=[0,0,0];fe.quat2.getTranslation(e,this.joints["index-finger-tip"].transformLocal);let t=[0,0,0];return fe.quat2.getTranslation(t,this.joints["thumb-tip"].transformLocal),fe.vec3.sqrDist(t,e)<.001},setupVREvents:function(e){this.session=e}})});var wc={};var cr,lr=$(()=>{cr=J(te());WL.registerComponent("hit-test-location",{},{init:function(){WL.onXRSessionStart.push(this.xrSessionStart.bind(this)),WL.onXRSessionStart.push(this.xrSessionEnd.bind(this)),this.tempScaling=new Float32Array(3),this.tempScaling.set(this.object.scalingLocal),this.visible=!1,this.object.scale([0,0,0])},update:function(e){let t=this.visible;if(this.xrHitTestSource){let r=Module.webxr_frame;if(!r)return;let n=r.getHitTestResults(this.xrHitTestSource);if(n.length>0){let a=n[0].getPose(this.xrViewerSpace);this.visible=!0,cr.quat2.fromMat4(this.object.transformLocal,a.transform.matrix),this.object.setDirty()}else this.visible=!1}this.visible!=t&&(this.visible?(this.object.scalingLocal.set(this.tempScaling),this.object.setDirty()):(this.tempScaling.set(this.object.scalingLocal),this.object.scale([0,0,0])))},xrSessionStart:function(e){e.requestReferenceSpace("viewer").then(function(t){this.xrViewerSpace=t,e.requestHitTestSource({space:this.xrViewerSpace}).then(function(r){this.xrHitTestSource=r}.bind(this)).catch(console.error)}.bind(this)).catch(console.error)},xrSessionEnd:function(){!this.xrHitTestSource||(this.xrHitTestSource.cancel(),this.xrHitTestSource=null)}})});var ke=H(Se=>{(function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var i=this||t;return i._counter=1e3,i._html5AudioPool=[],i.html5PoolSize=10,i._codecs={},i._howls=[],i._muted=!1,i._volume=1,i._canPlayEvent="canplaythrough",i._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,i.masterGain=null,i.noAudio=!1,i.usingWebAudio=!0,i.autoSuspend=!0,i.ctx=null,i.autoUnlock=!0,i._setup(),i},volume:function(i){var o=this||t;if(i=parseFloat(i),o.ctx||u(),typeof i!="undefined"&&i>=0&&i<=1){if(o._volume=i,o._muted)return o;o.usingWebAudio&&o.masterGain.gain.setValueAtTime(i,t.ctx.currentTime);for(var f=0;f<o._howls.length;f++)if(!o._howls[f]._webAudio)for(var d=o._howls[f]._getSoundIds(),v=0;v<d.length;v++){var _=o._howls[f]._soundById(d[v]);_&&_._node&&(_._node.volume=_._volume*i)}return o}return o._volume},mute:function(i){var o=this||t;o.ctx||u(),o._muted=i,o.usingWebAudio&&o.masterGain.gain.setValueAtTime(i?0:o._volume,t.ctx.currentTime);for(var f=0;f<o._howls.length;f++)if(!o._howls[f]._webAudio)for(var d=o._howls[f]._getSoundIds(),v=0;v<d.length;v++){var _=o._howls[f]._soundById(d[v]);_&&_._node&&(_._node.muted=i?!0:_._muted)}return o},stop:function(){for(var i=this||t,o=0;o<i._howls.length;o++)i._howls[o].stop();return i},unload:function(){for(var i=this||t,o=i._howls.length-1;o>=0;o--)i._howls[o].unload();return i.usingWebAudio&&i.ctx&&typeof i.ctx.close!="undefined"&&(i.ctx.close(),i.ctx=null,u()),i},codecs:function(i){return(this||t)._codecs[i.replace(/^x-/,"")]},_setup:function(){var i=this||t;if(i.state=i.ctx&&i.ctx.state||"suspended",i._autoSuspend(),!i.usingWebAudio)if(typeof Audio!="undefined")try{var o=new Audio;typeof o.oncanplaythrough=="undefined"&&(i._canPlayEvent="canplay")}catch(f){i.noAudio=!0}else i.noAudio=!0;try{var o=new Audio;o.muted&&(i.noAudio=!0)}catch(f){}return i.noAudio||i._setupCodecs(),i},_setupCodecs:function(){var i=this||t,o=null;try{o=typeof Audio!="undefined"?new Audio:null}catch(_){return i}if(!o||typeof o.canPlayType!="function")return i;var f=o.canPlayType("audio/mpeg;").replace(/^no$/,""),d=i._navigator&&i._navigator.userAgent.match(/OPR\/([0-6].)/g),v=d&&parseInt(d[0].split("/")[1],10)<33;return i._codecs={mp3:!!(!v&&(f||o.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var i=this||t;if(!(i._audioUnlocked||!i.ctx)){i._audioUnlocked=!1,i.autoUnlock=!1,!i._mobileUnloaded&&i.ctx.sampleRate!==44100&&(i._mobileUnloaded=!0,i.unload()),i._scratchBuffer=i.ctx.createBuffer(1,1,22050);var o=function(f){for(;i._html5AudioPool.length<i.html5PoolSize;)try{var d=new Audio;d._unlocked=!0,i._releaseHtml5Audio(d)}catch(g){i.noAudio=!0;break}for(var v=0;v<i._howls.length;v++)if(!i._howls[v]._webAudio)for(var _=i._howls[v]._getSoundIds(),p=0;p<_.length;p++){var m=i._howls[v]._soundById(_[p]);m&&m._node&&!m._node._unlocked&&(m._node._unlocked=!0,m._node.load())}i._autoResume();var y=i.ctx.createBufferSource();y.buffer=i._scratchBuffer,y.connect(i.ctx.destination),typeof y.start=="undefined"?y.noteOn(0):y.start(0),typeof i.ctx.resume=="function"&&i.ctx.resume(),y.onended=function(){y.disconnect(0),i._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0);for(var g=0;g<i._howls.length;g++)i._howls[g]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),i}},_obtainHtml5Audio:function(){var i=this||t;if(i._html5AudioPool.length)return i._html5AudioPool.pop();var o=new Audio().play();return o&&typeof Promise!="undefined"&&(o instanceof Promise||typeof o.then=="function")&&o.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(i){var o=this||t;return i._unlocked&&o._html5AudioPool.push(i),o},_autoSuspend:function(){var i=this;if(!(!i.autoSuspend||!i.ctx||typeof i.ctx.suspend=="undefined"||!t.usingWebAudio)){for(var o=0;o<i._howls.length;o++)if(i._howls[o]._webAudio){for(var f=0;f<i._howls[o]._sounds.length;f++)if(!i._howls[o]._sounds[f]._paused)return i}return i._suspendTimer&&clearTimeout(i._suspendTimer),i._suspendTimer=setTimeout(function(){if(!!i.autoSuspend){i._suspendTimer=null,i.state="suspending";var d=function(){i.state="suspended",i._resumeAfterSuspend&&(delete i._resumeAfterSuspend,i._autoResume())};i.ctx.suspend().then(d,d)}},3e4),i}},_autoResume:function(){var i=this;if(!(!i.ctx||typeof i.ctx.resume=="undefined"||!t.usingWebAudio))return i.state==="running"&&i.ctx.state!=="interrupted"&&i._suspendTimer?(clearTimeout(i._suspendTimer),i._suspendTimer=null):i.state==="suspended"||i.state==="running"&&i.ctx.state==="interrupted"?(i.ctx.resume().then(function(){i.state="running";for(var o=0;o<i._howls.length;o++)i._howls[o]._emit("resume")}),i._suspendTimer&&(clearTimeout(i._suspendTimer),i._suspendTimer=null)):i.state==="suspending"&&(i._resumeAfterSuspend=!0),i}};var t=new e,r=function(i){var o=this;if(!i.src||i.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}o.init(i)};r.prototype={init:function(i){var o=this;return t.ctx||u(),o._autoplay=i.autoplay||!1,o._format=typeof i.format!="string"?i.format:[i.format],o._html5=i.html5||!1,o._muted=i.mute||!1,o._loop=i.loop||!1,o._pool=i.pool||5,o._preload=typeof i.preload=="boolean"||i.preload==="metadata"?i.preload:!0,o._rate=i.rate||1,o._sprite=i.sprite||{},o._src=typeof i.src!="string"?i.src:[i.src],o._volume=i.volume!==void 0?i.volume:1,o._xhr={method:i.xhr&&i.xhr.method?i.xhr.method:"GET",headers:i.xhr&&i.xhr.headers?i.xhr.headers:null,withCredentials:i.xhr&&i.xhr.withCredentials?i.xhr.withCredentials:!1},o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._playLock=!1,o._onend=i.onend?[{fn:i.onend}]:[],o._onfade=i.onfade?[{fn:i.onfade}]:[],o._onload=i.onload?[{fn:i.onload}]:[],o._onloaderror=i.onloaderror?[{fn:i.onloaderror}]:[],o._onplayerror=i.onplayerror?[{fn:i.onplayerror}]:[],o._onpause=i.onpause?[{fn:i.onpause}]:[],o._onplay=i.onplay?[{fn:i.onplay}]:[],o._onstop=i.onstop?[{fn:i.onstop}]:[],o._onmute=i.onmute?[{fn:i.onmute}]:[],o._onvolume=i.onvolume?[{fn:i.onvolume}]:[],o._onrate=i.onrate?[{fn:i.onrate}]:[],o._onseek=i.onseek?[{fn:i.onseek}]:[],o._onunlock=i.onunlock?[{fn:i.onunlock}]:[],o._onresume=[],o._webAudio=t.usingWebAudio&&!o._html5,typeof t.ctx!="undefined"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&o._preload!=="none"&&o.load(),o},load:function(){var i=this,o=null;if(t.noAudio){i._emit("loaderror",null,"No audio support.");return}typeof i._src=="string"&&(i._src=[i._src]);for(var f=0;f<i._src.length;f++){var d,v;if(i._format&&i._format[f])d=i._format[f];else{if(v=i._src[f],typeof v!="string"){i._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}d=/^data:audio\/([^;,]+);/i.exec(v),d||(d=/\.([^.]+)$/.exec(v.split("?",1)[0])),d&&(d=d[1].toLowerCase())}if(d||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),d&&t.codecs(d)){o=i._src[f];break}}if(!o){i._emit("loaderror",null,"No codec support for selected audio sources.");return}return i._src=o,i._state="loading",window.location.protocol==="https:"&&o.slice(0,5)==="http:"&&(i._html5=!0,i._webAudio=!1),new n(i),i._webAudio&&s(i),i},play:function(i,o){var f=this,d=null;if(typeof i=="number")d=i,i=null;else{if(typeof i=="string"&&f._state==="loaded"&&!f._sprite[i])return null;if(typeof i=="undefined"&&(i="__default",!f._playLock)){for(var v=0,_=0;_<f._sounds.length;_++)f._sounds[_]._paused&&!f._sounds[_]._ended&&(v++,d=f._sounds[_]._id);v===1?i=null:d=null}}var p=d?f._soundById(d):f._inactiveSound();if(!p)return null;if(d&&!i&&(i=p._sprite||"__default"),f._state!=="loaded"){p._sprite=i,p._ended=!1;var m=p._id;return f._queue.push({event:"play",action:function(){f.play(m)}}),m}if(d&&!p._paused)return o||f._loadQueue("play"),p._id;f._webAudio&&t._autoResume();var y=Math.max(0,p._seek>0?p._seek:f._sprite[i][0]/1e3),g=Math.max(0,(f._sprite[i][0]+f._sprite[i][1])/1e3-y),M=g*1e3/Math.abs(p._rate),b=f._sprite[i][0]/1e3,x=(f._sprite[i][0]+f._sprite[i][1])/1e3;p._sprite=i,p._ended=!1;var E=function(){p._paused=!1,p._seek=y,p._start=b,p._stop=x,p._loop=!!(p._loop||f._sprite[i][2])};if(y>=x){f._ended(p);return}var S=p._node;if(f._webAudio){var D=function(){f._playLock=!1,E(),f._refreshBuffer(p);var q=p._muted||f._muted?0:p._volume;S.gain.setValueAtTime(q,t.ctx.currentTime),p._playStart=t.ctx.currentTime,typeof S.bufferSource.start=="undefined"?p._loop?S.bufferSource.noteGrainOn(0,y,86400):S.bufferSource.noteGrainOn(0,y,g):p._loop?S.bufferSource.start(0,y,86400):S.bufferSource.start(0,y,g),M!==Infinity&&(f._endTimers[p._id]=setTimeout(f._ended.bind(f,p),M)),o||setTimeout(function(){f._emit("play",p._id),f._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?D():(f._playLock=!0,f.once("resume",D),f._clearTimer(p._id))}else{var C=function(){S.currentTime=y,S.muted=p._muted||f._muted||t._muted||S.muted,S.volume=p._volume*t.volume(),S.playbackRate=p._rate;try{var q=S.play();if(q&&typeof Promise!="undefined"&&(q instanceof Promise||typeof q.then=="function")?(f._playLock=!0,E(),q.then(function(){f._playLock=!1,S._unlocked=!0,o||(f._emit("play",p._id),f._loadQueue())}).catch(function(){f._playLock=!1,f._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),p._ended=!0,p._paused=!0})):o||(f._playLock=!1,E(),f._emit("play",p._id),f._loadQueue()),S.playbackRate=p._rate,S.paused){f._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}i!=="__default"||p._loop?f._endTimers[p._id]=setTimeout(f._ended.bind(f,p),M):(f._endTimers[p._id]=function(){f._ended(p),S.removeEventListener("ended",f._endTimers[p._id],!1)},S.addEventListener("ended",f._endTimers[p._id],!1))}catch(P){f._emit("playerror",p._id,P)}};S.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(S.src=f._src,S.load());var z=window&&window.ejecta||!S.readyState&&t._navigator.isCocoonJS;if(S.readyState>=3||z)C();else{f._playLock=!0;var k=function(){C(),S.removeEventListener(t._canPlayEvent,k,!1)};S.addEventListener(t._canPlayEvent,k,!1),f._clearTimer(p._id)}}return p._id},pause:function(i){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"pause",action:function(){o.pause(i)}}),o;for(var f=o._getSoundIds(i),d=0;d<f.length;d++){o._clearTimer(f[d]);var v=o._soundById(f[d]);if(v&&!v._paused&&(v._seek=o.seek(f[d]),v._rateSeek=0,v._paused=!0,o._stopFade(f[d]),v._node))if(o._webAudio){if(!v._node.bufferSource)continue;typeof v._node.bufferSource.stop=="undefined"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),o._cleanBuffer(v._node)}else(!isNaN(v._node.duration)||v._node.duration===Infinity)&&v._node.pause();arguments[1]||o._emit("pause",v?v._id:null)}return o},stop:function(i,o){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(i)}}),f;for(var d=f._getSoundIds(i),v=0;v<d.length;v++){f._clearTimer(d[v]);var _=f._soundById(d[v]);_&&(_._seek=_._start||0,_._rateSeek=0,_._paused=!0,_._ended=!0,f._stopFade(d[v]),_._node&&(f._webAudio?_._node.bufferSource&&(typeof _._node.bufferSource.stop=="undefined"?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),f._cleanBuffer(_._node)):(!isNaN(_._node.duration)||_._node.duration===Infinity)&&(_._node.currentTime=_._start||0,_._node.pause(),_._node.duration===Infinity&&f._clearSound(_._node))),o||f._emit("stop",_._id))}return f},mute:function(i,o){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(i,o)}}),f;if(typeof o=="undefined")if(typeof i=="boolean")f._muted=i;else return f._muted;for(var d=f._getSoundIds(o),v=0;v<d.length;v++){var _=f._soundById(d[v]);_&&(_._muted=i,_._interval&&f._stopFade(_._id),f._webAudio&&_._node?_._node.gain.setValueAtTime(i?0:_._volume,t.ctx.currentTime):_._node&&(_._node.muted=t._muted?!0:i),f._emit("mute",_._id))}return f},volume:function(){var i=this,o=arguments,f,d;if(o.length===0)return i._volume;if(o.length===1||o.length===2&&typeof o[1]=="undefined"){var v=i._getSoundIds(),_=v.indexOf(o[0]);_>=0?d=parseInt(o[0],10):f=parseFloat(o[0])}else o.length>=2&&(f=parseFloat(o[0]),d=parseInt(o[1],10));var p;if(typeof f!="undefined"&&f>=0&&f<=1){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,o)}}),i;typeof d=="undefined"&&(i._volume=f),d=i._getSoundIds(d);for(var m=0;m<d.length;m++)p=i._soundById(d[m]),p&&(p._volume=f,o[2]||i._stopFade(d[m]),i._webAudio&&p._node&&!p._muted?p._node.gain.setValueAtTime(f,t.ctx.currentTime):p._node&&!p._muted&&(p._node.volume=f*t.volume()),i._emit("volume",p._id))}else return p=d?i._soundById(d):i._sounds[0],p?p._volume:0;return i},fade:function(i,o,f,d){var v=this;if(v._state!=="loaded"||v._playLock)return v._queue.push({event:"fade",action:function(){v.fade(i,o,f,d)}}),v;i=Math.min(Math.max(0,parseFloat(i)),1),o=Math.min(Math.max(0,parseFloat(o)),1),f=parseFloat(f),v.volume(i,d);for(var _=v._getSoundIds(d),p=0;p<_.length;p++){var m=v._soundById(_[p]);if(m){if(d||v._stopFade(_[p]),v._webAudio&&!m._muted){var y=t.ctx.currentTime,g=y+f/1e3;m._volume=i,m._node.gain.setValueAtTime(i,y),m._node.gain.linearRampToValueAtTime(o,g)}v._startFadeInterval(m,i,o,f,_[p],typeof d=="undefined")}}return v},_startFadeInterval:function(i,o,f,d,v,_){var p=this,m=o,y=f-o,g=Math.abs(y/.01),M=Math.max(4,g>0?d/g:d),b=Date.now();i._fadeTo=f,i._interval=setInterval(function(){var x=(Date.now()-b)/d;b=Date.now(),m+=y*x,m=Math.round(m*100)/100,y<0?m=Math.max(f,m):m=Math.min(f,m),p._webAudio?i._volume=m:p.volume(m,i._id,!0),_&&(p._volume=m),(f<o&&m<=f||f>o&&m>=f)&&(clearInterval(i._interval),i._interval=null,i._fadeTo=null,p.volume(f,i._id),p._emit("fade",i._id))},M)},_stopFade:function(i){var o=this,f=o._soundById(i);return f&&f._interval&&(o._webAudio&&f._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(f._interval),f._interval=null,o.volume(f._fadeTo,i),f._fadeTo=null,o._emit("fade",i)),o},loop:function(){var i=this,o=arguments,f,d,v;if(o.length===0)return i._loop;if(o.length===1)if(typeof o[0]=="boolean")f=o[0],i._loop=f;else return v=i._soundById(parseInt(o[0],10)),v?v._loop:!1;else o.length===2&&(f=o[0],d=parseInt(o[1],10));for(var _=i._getSoundIds(d),p=0;p<_.length;p++)v=i._soundById(_[p]),v&&(v._loop=f,i._webAudio&&v._node&&v._node.bufferSource&&(v._node.bufferSource.loop=f,f&&(v._node.bufferSource.loopStart=v._start||0,v._node.bufferSource.loopEnd=v._stop)));return i},rate:function(){var i=this,o=arguments,f,d;if(o.length===0)d=i._sounds[0]._id;else if(o.length===1){var v=i._getSoundIds(),_=v.indexOf(o[0]);_>=0?d=parseInt(o[0],10):f=parseFloat(o[0])}else o.length===2&&(f=parseFloat(o[0]),d=parseInt(o[1],10));var p;if(typeof f=="number"){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,o)}}),i;typeof d=="undefined"&&(i._rate=f),d=i._getSoundIds(d);for(var m=0;m<d.length;m++)if(p=i._soundById(d[m]),p){i.playing(d[m])&&(p._rateSeek=i.seek(d[m]),p._playStart=i._webAudio?t.ctx.currentTime:p._playStart),p._rate=f,i._webAudio&&p._node&&p._node.bufferSource?p._node.bufferSource.playbackRate.setValueAtTime(f,t.ctx.currentTime):p._node&&(p._node.playbackRate=f);var y=i.seek(d[m]),g=(i._sprite[p._sprite][0]+i._sprite[p._sprite][1])/1e3-y,M=g*1e3/Math.abs(p._rate);(i._endTimers[d[m]]||!p._paused)&&(i._clearTimer(d[m]),i._endTimers[d[m]]=setTimeout(i._ended.bind(i,p),M)),i._emit("rate",p._id)}}else return p=i._soundById(d),p?p._rate:i._rate;return i},seek:function(){var i=this,o=arguments,f,d;if(o.length===0)d=i._sounds[0]._id;else if(o.length===1){var v=i._getSoundIds(),_=v.indexOf(o[0]);_>=0?d=parseInt(o[0],10):i._sounds.length&&(d=i._sounds[0]._id,f=parseFloat(o[0]))}else o.length===2&&(f=parseFloat(o[0]),d=parseInt(o[1],10));if(typeof d=="undefined")return i;if(typeof f=="number"&&(i._state!=="loaded"||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,o)}}),i;var p=i._soundById(d);if(p)if(typeof f=="number"&&f>=0){var m=i.playing(d);m&&i.pause(d,!0),p._seek=f,p._ended=!1,i._clearTimer(d),!i._webAudio&&p._node&&!isNaN(p._node.duration)&&(p._node.currentTime=f);var y=function(){i._emit("seek",d),m&&i.play(d,!0)};if(m&&!i._webAudio){var g=function(){i._playLock?setTimeout(g,0):y()};setTimeout(g,0)}else y()}else if(i._webAudio){var M=i.playing(d)?t.ctx.currentTime-p._playStart:0,b=p._rateSeek?p._rateSeek-p._seek:0;return p._seek+(b+M*Math.abs(p._rate))}else return p._node.currentTime;return i},playing:function(i){var o=this;if(typeof i=="number"){var f=o._soundById(i);return f?!f._paused:!1}for(var d=0;d<o._sounds.length;d++)if(!o._sounds[d]._paused)return!0;return!1},duration:function(i){var o=this,f=o._duration,d=o._soundById(i);return d&&(f=o._sprite[d._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var i=this,o=i._sounds,f=0;f<o.length;f++)o[f]._paused||i.stop(o[f]._id),i._webAudio||(i._clearSound(o[f]._node),o[f]._node.removeEventListener("error",o[f]._errorFn,!1),o[f]._node.removeEventListener(t._canPlayEvent,o[f]._loadFn,!1),o[f]._node.removeEventListener("ended",o[f]._endFn,!1),t._releaseHtml5Audio(o[f]._node)),delete o[f]._node,i._clearTimer(o[f]._id);var d=t._howls.indexOf(i);d>=0&&t._howls.splice(d,1);var v=!0;for(f=0;f<t._howls.length;f++)if(t._howls[f]._src===i._src||i._src.indexOf(t._howls[f]._src)>=0){v=!1;break}return a&&v&&delete a[i._src],t.noAudio=!1,i._state="unloaded",i._sounds=[],i=null,null},on:function(i,o,f,d){var v=this,_=v["_on"+i];return typeof o=="function"&&_.push(d?{id:f,fn:o,once:d}:{id:f,fn:o}),v},off:function(i,o,f){var d=this,v=d["_on"+i],_=0;if(typeof o=="number"&&(f=o,o=null),o||f)for(_=0;_<v.length;_++){var p=f===v[_].id;if(o===v[_].fn&&p||!o&&p){v.splice(_,1);break}}else if(i)d["_on"+i]=[];else{var m=Object.keys(d);for(_=0;_<m.length;_++)m[_].indexOf("_on")===0&&Array.isArray(d[m[_]])&&(d[m[_]]=[])}return d},once:function(i,o,f){var d=this;return d.on(i,o,f,1),d},_emit:function(i,o,f){for(var d=this,v=d["_on"+i],_=v.length-1;_>=0;_--)(!v[_].id||v[_].id===o||i==="load")&&(setTimeout(function(p){p.call(this,o,f)}.bind(d,v[_].fn),0),v[_].once&&d.off(i,v[_].fn,v[_].id));return d._loadQueue(i),d},_loadQueue:function(i){var o=this;if(o._queue.length>0){var f=o._queue[0];f.event===i&&(o._queue.shift(),o._loadQueue()),i||f.action()}return o},_ended:function(i){var o=this,f=i._sprite;if(!o._webAudio&&i._node&&!i._node.paused&&!i._node.ended&&i._node.currentTime<i._stop)return setTimeout(o._ended.bind(o,i),100),o;var d=!!(i._loop||o._sprite[f][2]);if(o._emit("end",i._id),!o._webAudio&&d&&o.stop(i._id,!0).play(i._id),o._webAudio&&d){o._emit("play",i._id),i._seek=i._start||0,i._rateSeek=0,i._playStart=t.ctx.currentTime;var v=(i._stop-i._start)*1e3/Math.abs(i._rate);o._endTimers[i._id]=setTimeout(o._ended.bind(o,i),v)}return o._webAudio&&!d&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,i._rateSeek=0,o._clearTimer(i._id),o._cleanBuffer(i._node),t._autoSuspend()),!o._webAudio&&!d&&o.stop(i._id,!0),o},_clearTimer:function(i){var o=this;if(o._endTimers[i]){if(typeof o._endTimers[i]!="function")clearTimeout(o._endTimers[i]);else{var f=o._soundById(i);f&&f._node&&f._node.removeEventListener("ended",o._endTimers[i],!1)}delete o._endTimers[i]}return o},_soundById:function(i){for(var o=this,f=0;f<o._sounds.length;f++)if(i===o._sounds[f]._id)return o._sounds[f];return null},_inactiveSound:function(){var i=this;i._drain();for(var o=0;o<i._sounds.length;o++)if(i._sounds[o]._ended)return i._sounds[o].reset();return new n(i)},_drain:function(){var i=this,o=i._pool,f=0,d=0;if(!(i._sounds.length<o)){for(d=0;d<i._sounds.length;d++)i._sounds[d]._ended&&f++;for(d=i._sounds.length-1;d>=0;d--){if(f<=o)return;i._sounds[d]._ended&&(i._webAudio&&i._sounds[d]._node&&i._sounds[d]._node.disconnect(0),i._sounds.splice(d,1),f--)}}},_getSoundIds:function(i){var o=this;if(typeof i=="undefined"){for(var f=[],d=0;d<o._sounds.length;d++)f.push(o._sounds[d]._id);return f}else return[i]},_refreshBuffer:function(i){var o=this;return i._node.bufferSource=t.ctx.createBufferSource(),i._node.bufferSource.buffer=a[o._src],i._panner?i._node.bufferSource.connect(i._panner):i._node.bufferSource.connect(i._node),i._node.bufferSource.loop=i._loop,i._loop&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop||0),i._node.bufferSource.playbackRate.setValueAtTime(i._rate,t.ctx.currentTime),o},_cleanBuffer:function(i){var o=this,f=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(t._scratchBuffer&&i.bufferSource&&(i.bufferSource.onended=null,i.bufferSource.disconnect(0),f))try{i.bufferSource.buffer=t._scratchBuffer}catch(d){}return i.bufferSource=null,o},_clearSound:function(i){var o=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);o||(i.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var n=function(i){this._parent=i,this.init()};n.prototype={init:function(){var i=this,o=i._parent;return i._muted=o._muted,i._loop=o._loop,i._volume=o._volume,i._rate=o._rate,i._seek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++t._counter,o._sounds.push(i),i.create(),i},create:function(){var i=this,o=i._parent,f=t._muted||i._muted||i._parent._muted?0:i._volume;return o._webAudio?(i._node=typeof t.ctx.createGain=="undefined"?t.ctx.createGainNode():t.ctx.createGain(),i._node.gain.setValueAtTime(f,t.ctx.currentTime),i._node.paused=!0,i._node.connect(t.masterGain)):t.noAudio||(i._node=t._obtainHtml5Audio(),i._errorFn=i._errorListener.bind(i),i._node.addEventListener("error",i._errorFn,!1),i._loadFn=i._loadListener.bind(i),i._node.addEventListener(t._canPlayEvent,i._loadFn,!1),i._endFn=i._endListener.bind(i),i._node.addEventListener("ended",i._endFn,!1),i._node.src=o._src,i._node.preload=o._preload===!0?"auto":o._preload,i._node.volume=f*t.volume(),i._node.load()),i},reset:function(){var i=this,o=i._parent;return i._muted=o._muted,i._loop=o._loop,i._volume=o._volume,i._rate=o._rate,i._seek=0,i._rateSeek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++t._counter,i},_errorListener:function(){var i=this;i._parent._emit("loaderror",i._id,i._node.error?i._node.error.code:0),i._node.removeEventListener("error",i._errorFn,!1)},_loadListener:function(){var i=this,o=i._parent;o._duration=Math.ceil(i._node.duration*10)/10,Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue()),i._node.removeEventListener(t._canPlayEvent,i._loadFn,!1)},_endListener:function(){var i=this,o=i._parent;o._duration===Infinity&&(o._duration=Math.ceil(i._node.duration*10)/10,o._sprite.__default[1]===Infinity&&(o._sprite.__default[1]=o._duration*1e3),o._ended(i)),i._node.removeEventListener("ended",i._endFn,!1)}};var a={},s=function(i){var o=i._src;if(a[o]){i._duration=a[o].duration,h(i);return}if(/^data:[^;]+;base64,/.test(o)){for(var f=atob(o.split(",")[1]),d=new Uint8Array(f.length),v=0;v<f.length;++v)d[v]=f.charCodeAt(v);l(d.buffer,i)}else{var _=new XMLHttpRequest;_.open(i._xhr.method,o,!0),_.withCredentials=i._xhr.withCredentials,_.responseType="arraybuffer",i._xhr.headers&&Object.keys(i._xhr.headers).forEach(function(p){_.setRequestHeader(p,i._xhr.headers[p])}),_.onload=function(){var p=(_.status+"")[0];if(p!=="0"&&p!=="2"&&p!=="3"){i._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".");return}l(_.response,i)},_.onerror=function(){i._webAudio&&(i._html5=!0,i._webAudio=!1,i._sounds=[],delete a[o],i.load())},c(_)}},c=function(i){try{i.send()}catch(o){i.onerror()}},l=function(i,o){var f=function(){o._emit("loaderror",null,"Decoding audio data failed.")},d=function(v){v&&o._sounds.length>0?(a[o._src]=v,h(o,v)):f()};typeof Promise!="undefined"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(i).then(d).catch(f):t.ctx.decodeAudioData(i,d,f)},h=function(i,o){o&&!i._duration&&(i._duration=o.duration),Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue())},u=function(){if(!!t.usingWebAudio){try{typeof AudioContext!="undefined"?t.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch(v){t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var i=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),o=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=o?parseInt(o[1],10):null;if(i&&f&&f<9){var d=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!d&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain=="undefined"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:t,Howl:r}}),typeof Se!="undefined"&&(Se.Howler=t,Se.Howl=r),typeof global!="undefined"?(global.HowlerGlobal=e,global.Howler=t,global.Howl=r,global.Sound=n):typeof window!="undefined"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=r,window.Sound=n)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var n=r._howls.length-1;n>=0;n--)r._howls[n].stereo(t);return r},HowlerGlobal.prototype.pos=function(t,r,n){var a=this;if(!a.ctx||!a.ctx.listener)return a;if(r=typeof r!="number"?a._pos[1]:r,n=typeof n!="number"?a._pos[2]:n,typeof t=="number")a._pos=[t,r,n],typeof a.ctx.listener.positionX!="undefined"?(a.ctx.listener.positionX.setTargetAtTime(a._pos[0],Howler.ctx.currentTime,.1),a.ctx.listener.positionY.setTargetAtTime(a._pos[1],Howler.ctx.currentTime,.1),a.ctx.listener.positionZ.setTargetAtTime(a._pos[2],Howler.ctx.currentTime,.1)):a.ctx.listener.setPosition(a._pos[0],a._pos[1],a._pos[2]);else return a._pos;return a},HowlerGlobal.prototype.orientation=function(t,r,n,a,s,c){var l=this;if(!l.ctx||!l.ctx.listener)return l;var h=l._orientation;if(r=typeof r!="number"?h[1]:r,n=typeof n!="number"?h[2]:n,a=typeof a!="number"?h[3]:a,s=typeof s!="number"?h[4]:s,c=typeof c!="number"?h[5]:c,typeof t=="number")l._orientation=[t,r,n,a,s,c],typeof l.ctx.listener.forwardX!="undefined"?(l.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(a,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(c,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(t,r,n,a,s,c);else return h;return l},Howl.prototype.init=function(t){return function(r){var n=this;return n._orientation=r.orientation||[1,0,0],n._stereo=r.stereo||null,n._pos=r.pos||null,n._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle!="undefined"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle!="undefined"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain!="undefined"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel!="undefined"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance!="undefined"?r.maxDistance:1e4,panningModel:typeof r.panningModel!="undefined"?r.panningModel:"HRTF",refDistance:typeof r.refDistance!="undefined"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor!="undefined"?r.rolloffFactor:1},n._onstereo=r.onstereo?[{fn:r.onstereo}]:[],n._onpos=r.onpos?[{fn:r.onpos}]:[],n._onorientation=r.onorientation?[{fn:r.onorientation}]:[],t.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,r){var n=this;if(!n._webAudio)return n;if(n._state!=="loaded")return n._queue.push({event:"stereo",action:function(){n.stereo(t,r)}}),n;var a=typeof Howler.ctx.createStereoPanner=="undefined"?"spatial":"stereo";if(typeof r=="undefined")if(typeof t=="number")n._stereo=t,n._pos=[t,0,0];else return n._stereo;for(var s=n._getSoundIds(r),c=0;c<s.length;c++){var l=n._soundById(s[c]);if(l)if(typeof t=="number")l._stereo=t,l._pos=[t,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&e(l,a),a==="spatial"?typeof l._panner.positionX!="undefined"?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(t,0,0):l._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),n._emit("stereo",l._id);else return l._stereo}return n},Howl.prototype.pos=function(t,r,n,a){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"pos",action:function(){s.pos(t,r,n,a)}}),s;if(r=typeof r!="number"?0:r,n=typeof n!="number"?-.5:n,typeof a=="undefined")if(typeof t=="number")s._pos=[t,r,n];else return s._pos;for(var c=s._getSoundIds(a),l=0;l<c.length;l++){var h=s._soundById(c[l]);if(h)if(typeof t=="number")h._pos=[t,r,n],h._node&&((!h._panner||h._panner.pan)&&e(h,"spatial"),typeof h._panner.positionX!="undefined"?(h._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setPosition(t,r,n)),s._emit("pos",h._id);else return h._pos}return s},Howl.prototype.orientation=function(t,r,n,a){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"orientation",action:function(){s.orientation(t,r,n,a)}}),s;if(r=typeof r!="number"?s._orientation[1]:r,n=typeof n!="number"?s._orientation[2]:n,typeof a=="undefined")if(typeof t=="number")s._orientation=[t,r,n];else return s._orientation;for(var c=s._getSoundIds(a),l=0;l<c.length;l++){var h=s._soundById(c[l]);if(h)if(typeof t=="number")h._orientation=[t,r,n],h._node&&(h._panner||(h._pos||(h._pos=s._pos||[0,0,-.5]),e(h,"spatial")),typeof h._panner.orientationX!="undefined"?(h._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setOrientation(t,r,n)),s._emit("orientation",h._id);else return h._orientation}return s},Howl.prototype.pannerAttr=function(){var t=this,r=arguments,n,a,s;if(!t._webAudio)return t;if(r.length===0)return t._pannerAttr;if(r.length===1)if(typeof r[0]=="object")n=r[0],typeof a=="undefined"&&(n.pannerAttr||(n.pannerAttr={coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,panningModel:n.panningModel}),t._pannerAttr={coneInnerAngle:typeof n.pannerAttr.coneInnerAngle!="undefined"?n.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof n.pannerAttr.coneOuterAngle!="undefined"?n.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof n.pannerAttr.coneOuterGain!="undefined"?n.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof n.pannerAttr.distanceModel!="undefined"?n.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof n.pannerAttr.maxDistance!="undefined"?n.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof n.pannerAttr.refDistance!="undefined"?n.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof n.pannerAttr.rolloffFactor!="undefined"?n.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof n.pannerAttr.panningModel!="undefined"?n.pannerAttr.panningModel:t._panningModel});else return s=t._soundById(parseInt(r[0],10)),s?s._pannerAttr:t._pannerAttr;else r.length===2&&(n=r[0],a=parseInt(r[1],10));for(var c=t._getSoundIds(a),l=0;l<c.length;l++)if(s=t._soundById(c[l]),s){var h=s._pannerAttr;h={coneInnerAngle:typeof n.coneInnerAngle!="undefined"?n.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof n.coneOuterAngle!="undefined"?n.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof n.coneOuterGain!="undefined"?n.coneOuterGain:h.coneOuterGain,distanceModel:typeof n.distanceModel!="undefined"?n.distanceModel:h.distanceModel,maxDistance:typeof n.maxDistance!="undefined"?n.maxDistance:h.maxDistance,refDistance:typeof n.refDistance!="undefined"?n.refDistance:h.refDistance,rolloffFactor:typeof n.rolloffFactor!="undefined"?n.rolloffFactor:h.rolloffFactor,panningModel:typeof n.panningModel!="undefined"?n.panningModel:h.panningModel};var u=s._panner;u?(u.coneInnerAngle=h.coneInnerAngle,u.coneOuterAngle=h.coneOuterAngle,u.coneOuterGain=h.coneOuterGain,u.distanceModel=h.distanceModel,u.maxDistance=h.maxDistance,u.refDistance=h.refDistance,u.rolloffFactor=h.rolloffFactor,u.panningModel=h.panningModel):(s._pos||(s._pos=t._pos||[0,0,-.5]),e(s,"spatial"))}return t},Sound.prototype.init=function(t){return function(){var r=this,n=r._parent;r._orientation=n._orientation,r._stereo=n._stereo,r._pos=n._pos,r._pannerAttr=n._pannerAttr,t.call(this),r._stereo?n.stereo(r._stereo):r._pos&&n.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var r=this,n=r._parent;return r._orientation=n._orientation,r._stereo=n._stereo,r._pos=n._pos,r._pannerAttr=n._pannerAttr,r._stereo?n.stereo(r._stereo):r._pos?n.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,n._refreshBuffer(r)),t.call(this)}}(Sound.prototype.reset);var e=function(t,r){r=r||"spatial",r==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX!="undefined"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX!="undefined"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()});var Ac={};var nl,fr=$(()=>{nl=J(ke());WL.registerComponent("howler-audio-listener",{spatial:{type:WL.Type.Bool,default:!0}},{init:function(){this.origin=new Float32Array(3),this.fwd=new Float32Array(3),this.up=new Float32Array(3)},update:function(){!this.spatial||(this.object.getTranslationWorld(this.origin),this.object.getForward(this.fwd),this.object.getUp(this.up),Howler.pos(this.origin[0],this.origin[1],this.origin[2]),Howler.orientation(this.fwd[0],this.fwd[1],this.fwd[2],this.up[0],this.up[1],this.up[2]))}})});var Tc={};var hr,dr=$(()=>{hr=J(ke());WL.registerComponent("howler-audio-source",{volume:{type:WL.Type.Float,default:1},spatial:{type:WL.Type.Bool,default:!0},loop:{type:WL.Type.Bool,default:!1},autoplay:{type:WL.Type.Bool,default:!1},src:{type:WL.Type.String,default:""}},{start:function(){this.audio=new hr.Howl({src:[this.src],loop:this.loop,volume:this.volume,autoplay:this.autoplay}),this.lastPlayedAudioId=null,this.origin=new Float32Array(3),this.lastOrigin=new Float32Array(3),this.spatial&&this.autoplay&&(this.updatePosition(),this.play());let e=()=>{this.stop();let t=WL.onSceneLoaded.indexOf(e);t>=0&&WL.onSceneLoaded.splice(t,1)};WL.onSceneLoaded.push(e)},update:function(){!this.spatial||!this.lastPlayedAudioId||(this.object.getTranslationWorld(this.origin),(Math.abs(this.lastOrigin[0]-this.origin[0])>.005||Math.abs(this.lastOrigin[1]-this.origin[1])>.005||Math.abs(this.lastOrigin[2]-this.origin[2])>.005)&&this.updatePosition())},updatePosition:function(){this.audio.pos(this.origin[0],this.origin[1],this.origin[2],this.lastPlayedAudioId),this.lastOrigin.set(this.origin)},play:function(){this.lastPlayedAudioId&&this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=this.audio.play(),this.spatial&&this.updatePosition()},stop:function(){!this.lastPlayedAudioId||(this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=null)}})});var ur=H(()=>{WL.registerComponent("image-texture",{url:{type:WL.Type.String,default:""},meshIndex:{type:WL.Type.Int,default:0},material:{type:WL.Type.Material}},{init:function(){this.material||(console.warn("image-texture: material property not set, please set 'material' instead of deprecated 'meshIndex'."),this.material=this.object.getComponent("mesh",this.meshIndex).material)},start:function(){WL.textures.load(this.url,"anonymous").then(e=>{this.material.shader=="Flat Opaque Textured"?this.material.flatTexture=e:mat.shader=="Phong Opaque Textured"?this.material.diffuseTexture=e:console.error("Shader",this.material.shader,"not supported by image-texture")}).catch(console.err)}})});var Sc={};var pr,vr=$(()=>{pr=J(te());WL.registerComponent("mouse-look",{sensitity:{type:WL.Type.Float,default:.25},requireMouseDown:{type:WL.Type.Bool,default:!0},mouseButtonIndex:{type:WL.Type.Int,default:0}},{init:function(){this.currentRotationY=0,this.currentRotationX=0,this.origin=new Float32Array(3),this.parentOrigin=new Float32Array(3),document.addEventListener("mousemove",function(e){this.active&&(this.mouseDown||!this.requireMouseDown)&&(this.rotationY=-this.sensitity*e.movementX/100,this.rotationX=-this.sensitity*e.movementY/100,this.currentRotationX+=this.rotationX,this.currentRotationY+=this.rotationY,this.currentRotationX=Math.min(1.507,this.currentRotationX),this.currentRotationX=Math.max(-1.507,this.currentRotationX),this.object.getTranslationWorld(this.origin),this.object.parent.getTranslationWorld(this.parentOrigin),pr.vec3.sub(this.origin,this.origin,this.parentOrigin),this.object.resetTranslationRotation(),this.object.rotateAxisAngleRad([1,0,0],this.currentRotationX),this.object.rotateAxisAngleRad([0,1,0],this.currentRotationY),this.object.translate(this.origin))}.bind(this)),this.requireMouseDown&&(this.mouseButtonIndex==2&&WL.canvas.addEventListener("contextmenu",function(e){e.preventDefault()},!1),WL.canvas.addEventListener("mousedown",function(e){if(e.button==this.mouseButtonIndex&&(this.mouseDown=!0,document.body.style.cursor="grabbing",e.button==1))return e.preventDefault(),!1}.bind(this)),WL.canvas.addEventListener("mouseup",function(e){e.button==this.mouseButtonIndex&&(this.mouseDown=!1,document.body.style.cursor="initial")}.bind(this)))},start:function(){this.rotationX=0,this.rotationY=0}})});var _r=H(()=>{WL.registerComponent("player-height",{height:{type:WL.Type.Float,default:1.75}},{init:function(){WL.onXRSessionStart.push(this.onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this.onXRSessionEnd.bind(this))},start:function(){this.object.resetTranslationRotation(),this.object.translate([0,this.height,0])},onXRSessionStart:function(){["local","viewer"].includes(WebXR.refSpace)||this.object.resetTranslationRotation()},onXRSessionEnd:function(){["local","viewer"].includes(WebXR.refSpace)||(this.object.resetTranslationRotation(),this.object.translate([0,this.height,0]))}})});var mr=H(()=>{WL.registerComponent("target-framerate",{framerate:{type:WL.Type.Float,default:90}},{start:function(){WL.xrSession?this.setTargetFramerate(WL.xrSession):WL.onXRSessionStart.push(this.setTargetFramerate.bind(this))},setTargetFramerate:function(e){if(e.supportedFrameRates&&e.updateTargetFrameRate){let t=WL.xrSession.supportedFrameRates;t.sort((r,n)=>Math.abs(r-this.framerate)-Math.abs(n-this.framerate)),WL.xrSession.updateTargetFrameRate(t[0])}}})});var Oc={};var ae,yr=$(()=>{ae=J(te());WL.registerComponent("teleport",{teleportIndicatorMeshObject:{type:WL.Type.Object},camRoot:{type:WL.Type.Object},cam:{type:WL.Type.Object},eyeLeft:{type:WL.Type.Object},eyeRight:{type:WL.Type.Object},handedness:{type:WL.Type.Enum,values:["input component","left","right","none"],default:"input component"},floorGroup:{type:WL.Type.Int,default:1},thumbstickActivationThreshhold:{type:WL.Type.Float,default:-.7},thumbstickDeactivationThreshhold:{type:WL.Type.Float,default:.3},indicatorYOffset:{type:WL.Type.Float,default:.01},rayCastMode:{type:WL.Type.Enum,values:["collision","physx"],default:"collision"},maxDistance:{type:WL.Type.Float,default:100}},{init:function(){if(this._prevThumbstickAxis=new Float32Array(2),this._tempVec=new Float32Array(3),this._tempVec0=new Float32Array(3),this._currentIndicatorRotation=0,this.input=this.object.getComponent("input"),!this.input){console.error(this.object.name,"generic-teleport-component.js: input component is required on the object");return}if(!this.teleportIndicatorMeshObject){console.error(this.object.name,"generic-teleport-component.js: Teleport indicator mesh is missing");return}if(!this.camRoot){console.error(this.object.name,"generic-teleport-component.js: camRoot not set");return}this.isIndicating=!1,this.cam&&(this.isMouseIndicating=!1,WL.canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),WL.canvas.addEventListener("mouseup",this.onMouseUp.bind(this))),this.indicatorHidden=!0,this.hitSpot=new Float32Array(3),this._hasHit=!1,this._extraRotation=0,this._currentStickAxes=new Float32Array(2)},start:function(){if(this.handedness==0){let e=this.object.getComponent("input");e?(this.handedness=e.handedness,this.input=e):console.warn("teleport component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];WL.onXRSessionStart.push(this.setupVREvents.bind(this)),this.teleportIndicatorMeshObject.active=!1},_getCamRotation:function(){return this.eyeLeft.getForward(this._tempVec),this._tempVec[1]=0,ae.vec3.normalize(this._tempVec,this._tempVec),Math.atan2(this._tempVec[0],this._tempVec[2])},update:function(){let e=0;if(this.gamepad&&this.gamepad.axes&&(this._currentStickAxes[0]=this.gamepad.axes[2],this._currentStickAxes[1]=this.gamepad.axes[3],e=Math.abs(this._currentStickAxes[0])+Math.abs(this._currentStickAxes[1])),!this.isIndicating&&this._prevThumbstickAxis[1]>=this.thumbstickActivationThreshhold&&this._currentStickAxes[1]<this.thumbstickActivationThreshhold?this.isIndicating=!0:this.isIndicating&&e<this.thumbstickDeactivationThreshhold&&(this.isIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,this._extraRotation)),this.isIndicating&&this.teleportIndicatorMeshObject&&this.input){let t=this._tempVec0;ae.quat2.getTranslation(t,this.object.transformWorld);let r=this.object.getForward(this._tempVec),n=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(t,r,1<<this.floorGroup):WL.physics.rayCast(t,r,1<<this.floorGroup,this.maxDistance);n.hitCount>0?(this.indicatorHidden=!1,this._extraRotation=Math.PI+Math.atan2(this._currentStickAxes[0],this._currentStickAxes[1]),this._currentIndicatorRotation=this._getCamRotation()+(this._extraRotation-Math.PI),this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(n.locations[0]),this.teleportIndicatorMeshObject.translate([0,this.indicatorYOffset,0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot.set(n.locations[0]),this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}else this.teleportIndicatorMeshObject&&this.isMouseIndicating&&this.onMousePressed();this._prevThumbstickAxis.set(this._currentStickAxes)},setupVREvents:function(e){if(this.session=e,e.addEventListener("end",function(){this.gamepad=null,this.session=null}.bind(this)),e.inputSources&&e.inputSources.length)for(let t=0;t<e.inputSources.length;t++){let r=e.inputSources[t];r.handedness==this.handedness&&(this.gamepad=r.gamepad)}e.addEventListener("inputsourceschange",function(t){if(t.added&&t.added.length)for(let r=0;r<t.added.length;r++){let n=t.added[r];n.handedness==this.handedness&&(this.gamepad=n.gamepad)}}.bind(this))},onMouseDown:function(){this.isMouseIndicating=!0},onMouseUp:function(){this.isMouseIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,0)},onMousePressed:function(){let e=[0,0,0];ae.quat2.getTranslation(e,this.cam.transformWorld);let t=this.cam.getForward(this._tempVec),r=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(e,t,1<<this.floorGroup):WL.physics.rayCast(e,t,1<<this.floorGroup,this.maxDistance);r.hitCount>0?(this.indicatorHidden=!1,t[1]=0,ae.vec3.normalize(t,t),this._currentIndicatorRotation=-Math.sign(t[2])*Math.acos(t[0])-Math.PI*.5,this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(r.locations[0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot=r.locations[0],this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)},_teleportPlayer:function(e,t){this.camRoot.rotateAxisAngleRad([0,1,0],t);let r=this._tempVec,n=this._tempVec0;this.session?(this.eyeLeft.getTranslationWorld(r),this.eyeRight.getTranslationWorld(n),ae.vec3.add(r,r,n),ae.vec3.scale(r,r,.5)):this.cam.getTranslationWorld(r),this.camRoot.getTranslationWorld(n),ae.vec3.sub(r,n,r),r[0]+=e[0],r[1]=e[1],r[2]+=e[2],this.camRoot.setTranslationWorld(r)}})});var Rc={};var I,Lc,gr=$(()=>{I=J(te());Math.clamp=function(e,t,r){return Math.max(t,Math.min(e,r))};Lc=function(){let e=new Float32Array(3),t=new Float32Array(3),r=new Float32Array(3),n=new Float32Array(3),a=new Float32Array(3),s=new Float32Array(3),c=new Float32Array(3),l=new Float32Array(4),h=new Float32Array(4),u=new Float32Array(4),i=new Float32Array(4);return function(o,f,d,v,_,p,m,y,g,M){I.vec3.sub(r,v,d);let b=I.vec3.length(r);I.vec3.sub(e,v,_);let x=I.vec3.length(e);I.vec3.sub(e,p,d);let E=Math.clamp(I.vec3.length(e),m,b+x-m);I.vec3.sub(t,_,d),I.vec3.sub(n,d,v),I.vec3.sub(a,_,v),I.vec3.normalize(t,t),I.vec3.normalize(r,r),I.vec3.normalize(n,n),I.vec3.normalize(a,a),I.vec3.normalize(e,e);let S=Math.acos(Math.clamp(I.vec3.dot(t,r),-1,1)),D=Math.acos(Math.clamp(I.vec3.dot(n,a),-1,1)),C=Math.acos(Math.clamp(I.vec3.dot(t,e),-1,1)),z=Math.acos(Math.clamp((x*x-b*b-E*E)/(-2*b*E),-1,1)),k=Math.acos(Math.clamp((E*E-b*b-x*x)/(-2*b*x),-1,1));I.vec3.sub(t,_,d),I.vec3.sub(r,v,d),I.vec3.sub(e,p,d),I.vec3.cross(s,t,r),I.vec3.cross(c,t,e),M?(I.vec3.sub(r,M,v),I.vec3.transformQuat(r,[0,0,-1],g)):I.vec3.sub(r,v,d);let q=I.vec3.length(s);q==0?s.set([1,0,0]):I.vec3.scale(s,s,1/q),I.vec3.normalize(c,c),I.quat.conjugate(y,y),I.quat.setAxisAngle(h,I.vec3.transformQuat(l,s,y),z-S),I.quat.setAxisAngle(i,I.vec3.transformQuat(l,c,y),C),I.quat.mul(o,o,I.quat.mul(l,h,i)),I.quat.normalize(o,o),I.quat.conjugate(g,g),I.quat.setAxisAngle(u,I.vec3.transformQuat(l,s,g),k-D),I.quat.mul(f,f,u),I.quat.normalize(f,f)}}();WL.registerComponent("two-joint-ik-solver",{root:{type:WL.Type.Object},middle:{type:WL.Type.Object},end:{type:WL.Type.Object},target:{type:WL.Type.Object},helper:{type:WL.Type.Object}},{init:function(){this.pos=new Float32Array(3*7),this.p=[this.pos.subarray(0,3),this.pos.subarray(3,6),this.pos.subarray(6,9),this.pos.subarray(9,12),this.pos.subarray(12,15),this.pos.subarray(15,18),this.pos.subarray(18,21)]},update:function(){let e=this.p;this.root.getTranslationWorld(e[0]),this.middle.getTranslationWorld(e[1]),this.end.getTranslationWorld(e[2]),this.target.getTranslationWorld(e[3]);let t=e[4],r=e[5];this.root.getTranslationLocal(t),this.middle.getTranslationLocal(r),this.helper&&this.helper.getTranslationWorld(e[6]),Lc(this.root.transformLocal,this.middle.transformLocal,e[0],e[1],e[2],e[3],.01,this.root.transformWorld.subarray(0,4),this.middle.transformWorld.subarray(0,4),this.helper?e[6]:null),this.root.setTranslationLocal(t),this.middle.setTranslationLocal(r),this.root.setDirty(),this.middle.setDirty()}})});var Mr=H(()=>{WL.registerComponent("video-texture",{url:{type:WL.Type.String,default:""},material:{type:WL.Type.Material},loop:{type:WL.Type.Bool,default:!0},autoplay:{type:WL.Type.Bool,default:!0},muted:{type:WL.Type.Bool,default:!0}},{init:function(){if(!this.material){console.error("video-texture: material property not set");return}this.loaded=!1,this.frameUpdateRequested=!0},start:function(){if(this.video=document.createElement("video"),this.video.src=this.url,this.video.crossOrigin="anonymous",this.video.loop=this.loop,this.video.muted=this.muted,this.video.addEventListener("playing",function(){this.loaded=!0}.bind(this)),this.autoplay){let e=()=>{this.video.play(),window.removeEventListener("click",e),window.removeEventListener("touchstart",e)};window.addEventListener("click",e),window.addEventListener("touchstart",e)}},click:function(){},applyTexture:function(){let e=this.material;this.texture=new WL.Texture(this.video),e.shader=="Flat Opaque Textured"?e.flatTexture=this.texture:e.shader=="Phong Opaque Textured"?e.diffuseTexture=this.texture:console.error("Shader",e.shader,"not supported by video-texture"),"requestVideoFrameCallback"in this.video?this.video.requestVideoFrameCallback(this.updateVideo.bind(this)):this.video.addEventListener("timeupdate",function(){this.frameUpdateRequested=!0}.bind(this))},update:function(e){this.loaded&&this.frameUpdateRequested&&(this.texture?this.texture.update():this.applyTexture(),this.frameUpdateRequested=!1)},updateVideo:function(){this.frameUpdateRequested=!0,this.video.requestVideoFrameCallback(this.updateVideo.bind(this))}})});var br=H(()=>{WL.registerComponent("vr-mode-active-switch",{activateComponents:{type:WL.Type.Enum,values:["in VR","in non-VR"],default:"in VR"},affectChildren:{type:WL.Type.Bool,default:!0}},{start:function(){this.components=[],this.getComponents(this.object),this.onXRSessionEnd(),WL.onXRSessionStart.push(this.onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this.onXRSessionEnd.bind(this))},getComponents:function(e){let t=e.getComponents().filter(r=>r.type!="vr-mode-active-switch");if(this.components=this.components.concat(t),this.affectChildren){let r=e.children;for(let n=0;n<r.length;++n)this.getComponents(r[n])}},setComponentsActive:function(e){let t=this.components;for(let r=0;r<t.length;++r)t[r].active=e},onXRSessionStart:function(){!this.active||this.setComponentsActive(this.activateComponents==0)},onXRSessionEnd:function(){!this.active||this.setComponentsActive(this.activateComponents!=0)}})});var Pc={};var Fe,xr=$(()=>{Fe=J(te());WL.registerComponent("wasd-controls",{speed:{type:WL.Type.Float,default:.1},headObject:{type:WL.Type.Object}},{init:function(){this.up=!1,this.right=!1,this.down=!1,this.left=!1,window.addEventListener("keydown",this.press.bind(this)),window.addEventListener("keyup",this.release.bind(this))},start:function(){this.headObject=this.headObject||this.object},update:function(){let e=[0,0,0];this.up&&(e[2]-=1),this.down&&(e[2]+=1),this.left&&(e[0]-=1),this.right&&(e[0]+=1),Fe.vec3.normalize(e,e),e[0]*=this.speed,e[2]*=this.speed,Fe.vec3.transformQuat(e,e,this.headObject.transformWorld),this.object.translate(e)},press:function(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!0:e.keyCode===39||e.keyCode===68?this.right=!0:e.keyCode===40||e.keyCode===83?this.down=!0:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!0)},release:function(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!1:e.keyCode===39||e.keyCode===68?this.right=!1:e.keyCode===40||e.keyCode===83?this.down=!1:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!1)}})});var Ic={};var Oe,wr=$(()=>{Oe=J(te());WL.registerComponent("wonderleap-ad",{auId:{type:WL.Type.String,default:"ce6f68fc-4809-4409-8f57-c631283ce5a3"},adId:{type:WL.Type.String}},{init:function(){this.mesh=this.object.getComponent("mesh",0),this.collision=this.object.addComponent("collision"),this.collision.collider=WL.Collider.Box,this.collision.group=2,this.cursorTarget=this.object.addComponent("cursor-target"),this.timeSinceLastVizCheck=0,this.visibleDuration=0,this.durationThreshold=10},start:function(){Wonderleap.fetchAd(this.auId).then(function(e){this.ad=e,WL.textures.load(e.asset,"").then(function(t){let r=WL._images[t._imageIndex];this.collision.extents=[r.width/r.height,1,.1],this.object.scale([r.width/r.height,1,1]),this.mesh.material.shader=="Phong Textured"?this.mesh.material.diffuseTexture=t:this.mesh.material.flatTexture=t}.bind(this)).catch(console.err)}.bind(this)),this.cursorTarget.addClickFunction(this.click.bind(this))},update:function(e){if(this.timeSinceLastVizCheck+=e,this.timeSinceLastVizCheck>.5){let t=this.isVisible();t&&(this.visibleDuration+=this.timeSinceLastVizCheck),this.timeSinceLastVizCheck=0,(!t&&this.visibleDuration>0||this.visibleDuration>this.durationThreshold)&&(Wonderleap.sendMetric("gaze",this.visibleDuration,this.ad.adId,this.ad.auId),this.visibleDuration=0)}},isVisible:function(){let e=WL.scene.activeViews[0];if(!e||!e.active)return console.warn("wonderleap-ad: camera object does not have an active view"),!1;let t=e.object.transformWorld,r=[0,0,0];Oe.quat2.getTranslation(r,t);let n=[0,0,-1];Oe.vec3.transformQuat(n,n,t);let a=WL.scene.rayCast(r,n,2);for(let s=0;s<a.hitCount;++s)if(a.objects[s].objectId==this.object.objectId)return!0;return!1},click:function(){let e=Module.webxr_session;if(e){e.end().then(this.click.bind(this));return}Wonderleap.sendMetric("click",0,this.ad.adId,this.ad.auId),this.ad.url&&window.open(this.ad.url,"_blank")}})});window.glMatrix=te();er();tr();rr();nr();ir();ar();sr();or();lr();fr();dr();ur();vr();_r();mr();yr();gr();Mr();br();xr();wr();})();
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.1
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
/*!
 *  howler.js v2.2.1
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
//# sourceMappingURL=editor-components-bundle.js.map

WL.registerComponent('changeColor', {
    buttonMeshObject: {type: WL.Type.Object},
    hoverMaterial: {type: WL.Type.Material},
    peerComponent: {type: WL.Type.Object},

}, {
    start: function () {
        this.mesh = this.buttonMeshObject.getComponent('mesh');
        this.peerManager = this.peerComponent.getComponent('peer-manager');
        this.defaultMaterial = this.mesh.material;

        this.target = this.object.getComponent('cursor-target') || this.object.addComponent('cursor-target');
        this.target.addClickFunction(this.onClick.bind(this));

        this.peerManager.addNetworkDataRecievedCallback("change-color"+this.object.name, (d) => {
            console.log("change color received", d);
            this.setColor(d.color);
            //emoSpawner.spawn();
        });

        this.target.addDownFunction(this.onDown.bind(this));

        this.target.addHoverFunction(this.onHover.bind(this));
        this.target.addUnHoverFunction(this.onUnHover.bind(this));
        this.target.addUpFunction(this.onUp.bind(this));

        /*  this.soundClick = this.object.addComponent('howler-audio-source', {src: 'sfx/click.wav', spatial: true});
          this.soundUnClick = this.object.addComponent('howler-audio-source', {src: 'sfx/unclick.wav', spatial: true});
  */
    },

    setColor: function (color) {
        let mat = this.defaultMaterial.clone();
        mat.ambientColor = color;
        this.mesh.material = mat;

    },

    onClick: function (_, cursor) {
        const c = Math.random() * 1;
        const d = c * Math.random();
        let color = [c, d, c / d, 1];
        console.log("set color before ", color);
        this.setColor(color);


        console.log("set color ", color);
        this.peerManager.sendPackageImmediately("change-color"+this.object.name, {color: color});
        if (cursor.type == 'finger-cursor') {
            this.onDown(_, cursor);
        }
    },
    onDown: function (_, cursor) {
        //  this.soundClick.play();
        this.buttonMeshObject.translate([0.0, 0.0, 0.02]);
        this.hapticFeedback(cursor.object, 1.0, 20);
    },

    hapticFeedback: function (object, strength, duration) {
        const input = object.getComponent('input');
        if (input && input.xrInputSource) {
            const gamepad = input.xrInputSource.gamepad;
            if (gamepad && gamepad.hapticActuators) gamepad.hapticActuators[0].pulse(strength, duration);

        }
    },

    onUnHover: function (_, cursor) {
        if (this.mesh.material.diffuseColor == this.hoverMaterial.diffuseColor) {
            this.mesh.material = this.defaultMaterial;
        }
        if (cursor.type == 'finger-cursor') {
            this.onUp(_, cursor);
        }

        this.hapticFeedback(cursor.object, 0.3, 50);
    },

    onHover: function (_, cursor) {
        if (this.mesh.material.diffuseColor == this.hoverMaterial.diffuseColor) {
            this.hoverMaterial = this.mesh.material;
        }

        if (cursor.type == 'finger-cursor') {
            this.onDown(_, cursor);
        }

        this.hapticFeedback(cursor.object, 0.5, 50);
    },

    onUp: function (_, cursor) {
        //  this.soundUnClick.play();
        this.buttonMeshObject.translate([0.0, 0.0, -0.02]);
        this.hapticFeedback(cursor.object, 0.7, 20);

    }


});

WL.registerComponent('collide', {
  spawner: {type: WL.Type.Object, default: null},
}, {
    init: function() {
      this.collider = this.object.getComponent('collision');
      this.objects = [];
      this.check = false;
      this.timeStart=0.0;
      this.time = 0.0;
      
    },
    start: function() {
      this.spawner.active = false;
    },
    update: function(dt) {
      //Sphere Movement
      this.object.translate([0, 0, -2*dt]);
      this.time+=dt;
      //Collision Detection & Destruction
      const collidingComps = this.collider.queryOverlaps();
      if(collidingComps.length == 0) {
        this.check = false;
      }
      for(let i = 0; i < collidingComps.length; ++i) {
        if(!this.check) {
          const collidingMesh = collidingComps[i].object.getComponent('mesh');
          this.spawner.translate([this.object.getTranslationWorld([])]);
          collidingMesh.active=false;
          this.object.getComponent('mesh').active=false;
          this.check = true;
          this.spawner.active = true;
          this.timeStart=this.time;
        }
      }
      if(this.timeStart>0.0){
        if(this.time-this.timeStart>1){
          this.spawner.getComponent("mesh-particles").active=false;
        }
        
      }
    },
});

let defaultMat;
WL.registerComponent("controller-teleport-component", {
    peerComponent: {type:WL.Type.Object},
    muteUI: {type:WL.Type.Object},
    mutedColor: {type:WL.Type.Material},
    /** Object that will be placed as indiciation for where the player will teleport to. */
    teleportIndicatorMeshObject: {type: WL.Type.Object, default: null},
    /** Root of the player, the object that will be positioned on teleportation. */
    camRoot: {type: WL.Type.Object, default: null},
    cam: {type: WL.Type.Object, default: null},
    /** Collision group of valid "floor" objects that can be teleported on */
    floorGroup: {type: WL.Type.Int, default: 1},
    thumbstickActivationThreshhold: {type: WL.Type.Float, default: -0.7},
    thumbstickDeactivationThreshhold: {type: WL.Type.Float, default: 0.3},
    indicatorYOffset: {type: WL.Type.Float, default: 0.0},
    snapTurnAmount: {type: WL.Type.Float, default: 0.6},
}, {
    init: function() {
        this.thumbstickActivationThreshhold = -0.7
        this.prevThumbstickYAxisInput = 0;
        this.prevThumbstickXAxisInput = 0;
        this.input = this.object.getComponent('input');
        this._tempVec = [0,0,0];
        this._camRotation = 0;
        this._currentIndicatorRotation = 0;
        if(!this.input) {
            console.error(this.object.name, "controller-teleport-component.js: input component is required on the object.")
            return;
        }
        if(this.teleportIndicatorMeshObject) {
            this.isIndicating = false;

            this.indicatorHidden = true;
            this.hitSpot = undefined;
        } else {
            console.error(this.object.name, 'controller-teleport-component.js: Teleport indicator mesh is missing.');
        }
    },
    start: function() {
        WL.onXRSessionStart.push(this.setupVREvents.bind(this));
        this.mesh = this.muteUI.getComponent('mesh');
        this.defaultMaterial = this.mesh.material;
        defaultMat =   this.defaultMaterial; 
    },
    update: function() {
        let thumbstickXAxisInput = 0;
        let thumbstickYAxisInput = 0;
        let inputLength = 0;
        if(this.gamepadLeft && this.gamepadLeft.axes) {
          thumbstickXAxisInput = this.gamepadLeft.axes[2];
          thumbstickYAxisInput = this.gamepadLeft.axes[3];
          inputLength = Math.abs(thumbstickXAxisInput) + Math.abs(thumbstickYAxisInput);
        }
        if(this.gamepadRight && this.gamepadRight.axes) {
            thumbstickXAxisInput = this.gamepadRight.axes[2];
            thumbstickYAxisInput = this.gamepadRight.axes[3];
            inputLength = Math.abs(thumbstickXAxisInput) + Math.abs(thumbstickYAxisInput);
        }
        if(!this.isIndicating && this.prevThumbstickYAxisInput >= this.thumbstickActivationThreshhold && thumbstickYAxisInput < this.thumbstickActivationThreshhold) {
          this.isIndicating = true;
          this.cam.getForward(this._tempVec);
          this._tempVec[1] = 0;
          glMatrix.vec3.normalize(this._tempVec, this._tempVec);
          this._camRotation = Math.atan2(this._tempVec[0], this._tempVec[2]);
        } else if(this.isIndicating && inputLength < this.thumbstickDeactivationThreshhold) {
          this.isIndicating = false;
          this.teleportIndicatorMeshObject.translate([1000, 1000, 1000]);

          if(this.hitSpot && this.camRoot) {
              this.camRoot.resetTransform();

              // this.session.requestReferenceSpace("local").then(function(xrReferenceSpace) {
              //    this.session.requestAnimationFrame(function(time, xrFrame) {
              //      console.log(xrFrame.getViewerPose(xrReferenceSpace).transform)
              //    })
              // }.bind(this))
              this.hitSpot[1] = 0;
              this.cam.getForward(this._tempVec);
              this._tempVec[1] = 0;
              glMatrix.vec3.normalize(this._tempVec, this._tempVec);
              this._camRotation = Math.atan2(this._tempVec[0], this._tempVec[2]);
              this._camRotation = this._currentIndicatorRotation - this._camRotation;
              this.camRoot.rotateAxisAngleRad([0, 1, 0], this._camRotation);
              this.camRoot.translate(this.hitSpot);
          } else if(!this.camRoot) {
              console.error(this.object.name, 'controller-teleport-component.js: Cam Root reference is missing.');
          }
        }

        if(this.isIndicating && this.teleportIndicatorMeshObject && this.input)
        {
            let origin = [0, 0, 0];
            glMatrix.quat2.getTranslation(origin, this.object.transformWorld);

            let quat = this.object.transformWorld;

            let forwardDirection = [0, 0, 0];
            glMatrix.vec3.transformQuat(forwardDirection, [0, 0, -1], quat);
            let rayHit = WL.scene.rayCast(origin, forwardDirection, 1 << this.floorGroup);
            if(rayHit.hitCount > 0) {
                if(this.indicatorHidden) {
                    this.indicatorHidden = false;
                }

                this._currentIndicatorRotation = this._camRotation + (Math.PI + Math.atan2(thumbstickXAxisInput, thumbstickYAxisInput));
                this.teleportIndicatorMeshObject.resetTranslationRotation();
                this.teleportIndicatorMeshObject.rotateAxisAngleRad([0, 1, 0], this._currentIndicatorRotation);

                this.teleportIndicatorMeshObject.translate(rayHit.locations[0]);


                this.hitSpot = rayHit.locations[0];
                if(this.indicatorYOffset) {
                  this.hitSpot[2] += this.indicatorYOffset;
                }
            } else {
                if(!this.indicatorHidden) {
                    this.teleportIndicatorMeshObject.translate([1000, 1000, 1000]);
                    this.indicatorHidden = true;
                }
                this.hitSpot = undefined;
            }
        } else {
          if(Math.abs(this.prevThumbstickXAxisInput) <= Math.abs(this.thumbstickActivationThreshhold) && Math.abs(thumbstickXAxisInput) > Math.abs(this.thumbstickActivationThreshhold)) {
            this.camRoot.getTranslationWorld(this._tempVec);
            this._camRotation -= Math.sign(thumbstickXAxisInput) * this.snapTurnAmount;
            this.camRoot.resetTranslationRotation();
            this.camRoot.rotateAxisAngleRad([0, 1, 0], this._camRotation);
            this.camRoot.translate(this._tempVec);
          }
        }

        this.prevThumbstickXAxisInput = thumbstickXAxisInput;
        this.prevThumbstickYAxisInput = thumbstickYAxisInput;
    },
    setupVREvents: function(s) {
        /* If in VR, one-time bind the listener */
        this.session = s;
        s.addEventListener('end', function(e) {
            /* Reset cache once the session ends to rebind select etc, in case
             * it starts again */
            this.gamepad = null;
            this.session = null;
        }.bind(this));

        if(s.inputSources && s.inputSources.length) {
          for (var i = 0; i < s.inputSources.length; i++) {
            let inputSource = s.inputSources[i];

            if(inputSource.handedness == "right") {
              this.gamepadRight = inputSource.gamepad;
            } else {
              this.gamepadLeft = inputSource.gamepad;
            }
          }
        }

        s.addEventListener('inputsourceschange' ,function(e) {
            console.log("input source changed");
          if(e.added && e.added.length) {
            for (var i = 0; i < e.added.length; i++) {
              let inputSource = e.added[i];
              if(inputSource.handedness == "right") {
                this.gamepadRight = inputSource.gamepad;
              } else {
                this.gamepadLeft = inputSource.gamepad;
              }
            }
          }
        }.bind(this));

        s.addEventListener('squeeze' ,function(e) {
          let peerManager=  this.peerComponent.getComponent('peer-manager');
           peerManager.toggleMute();
            console.log("toggle mute on squeeze");
            let mat = this.defaultMaterial.clone();


            if(peerManager.getMute()){
                this.mesh.material =this.mutedColor;

            }else{
                this.mesh.material = mat;

            }

        }.bind(this));
    
    }
});

WL.registerComponent('emojiReceiver', {
    peerComponent: {type: WL.Type.Object},
    emojiSpawner: {type:WL.Type.Object},
}, {
    init: function() {
        console.log('init() with param', this.param);
    },
    start: function() {
        let peerManager=  this.peerComponent.getComponent('peer-manager');
        let emoSpawner=  this.emojiSpawner.getComponent('emoji_particle_shooter');
        
        // send message when you are interacting in XR 
        //peerManager.sendPackage("emoji","heart");
        
        peerManager.addNetworkDataRecievedCallback("emoji-start",(d)=>{
            console.log("emoji start received",d);
            emoSpawner.spawn();
        });
        peerManager.addNetworkDataRecievedCallback("emoji-stop",(d)=>{
            console.log("emoji stop received",d);
            //emoSpawner.spawn();
        });
       

        console.log('start() with param', this.param);
    },
    update: function(dt) {
    },
});

WL.registerComponent('emojiSender', {
    message: {type: WL.Type.String},
    peerComponent: {type: WL.Type.Object},
    emojiSpawner: {type:WL.Type.Object},
}, {
    init: function() {
        console.log('init() with param', this.param);
    },
    start: function() {
        let peerManager=  this.peerComponent.getComponent('peer-manager');
        let emoSpawner=  this.peerComponent.emojiSpawner('emoji_particle_shooter');
        
        
      /*  peerManager.addNetworkDataRecievedCallback("emoji",()=>{
            console.log("data received, needs to spawn");
            emoSpawner.spawn();
        })*/
        
        console.log('start() with param', this.param);
    },
    update: function(dt) {
        console.log('update() with delta time', dt);
    },
});

/**
Very simple mesh particles system

Demostrates spawning of new objects with components
and a simple pooling pattern.

Use it and customize it for your own game.
*/
WL.registerComponent('emoji_particle_shooter', {
    /* Mesh for spawned particles */
    devil: {type: WL.Type.Mesh, default: null},
    /* Material for spawned particles */
    devilmat: {type: WL.Type.Material, default: null},
    /* Mesh for spawned particles */
    love: {type: WL.Type.Mesh, default: null},
    /* Material for spawned particles */
    lovemat: {type: WL.Type.Material, default: null},
    /* Mesh for spawned particles */
    think: {type: WL.Type.Mesh, default: null},
    /* Material for spawned particles */
    thinkmat: {type: WL.Type.Material, default: null},
    /* Delay between particle spawns. If below time of a frame, will spawn multiple particles in update. */
    delay: {type: WL.Type.Float, default: 0.04},
    /* Maximum number of particles, once limit is reached, particles are recycled first-in-first-out. */
    maxParticles: {type: WL.Type.Int, default: 10},
    /* Initial speed of emitted particles. */
    initialSpeed: {type: WL.Type.Float, default: 30},
    /* Size of a particle */
    particleScale: {type: WL.Type.Float, default: 0.1},
    //Parent Object
    gun:{type:WL.Type.Object, default: null},

    changeEmojiButton:{type:WL.Type.Object, default: null},
}, {
    init: function() {
        this.time = 0.0;
        this.count = 0;
    },
    start: function() {
        this.objects = [];
        this.velocities = [];

        this.objects = WL.scene.addObjects(this.maxParticles, null, this.maxParticles);

        

        for(let i = 0; i < this.maxParticles; ++i) {
            this.velocities.push([0, 0, 0]);
            let obj = this.objects[i];
            obj.name = "particle" + this.count.toString();
            let mesh = obj.addComponent('mesh');

            mesh.mesh = this.devil;
            mesh.material = this.devilmat;
            /* Most efficient way to hide the mesh */
            obj.scale([0, 0, 0]);
        }

        //this.changeEmojiButton.addClickFunction(function(){if(this.changeEmojiButton.currentEmoji=='devil'){console.log('woohoo')}else{console.log('nope')}});
    },
    update: function(dt) {
        this.time += dt;
        if(this.time > this.delay) {
            /* Time to spawn particles */
            const spawnCount = Math.floor(this.time / this.delay)
            for(let i = 0; i < spawnCount; ++i) this.spawn();
            this.time -= this.delay*spawnCount;
        }

        this.object.translate([dt*4, 0, 0]);
        this.object.rotateAxisAngleDeg([0, 1, 0], dt*90);

        /* Target for retrieving particles world locations */
        let origin = [0, 0, 0];
        let distance = [0, 0, 0];
        for(let i = 0; i < Math.min(this.count, this.objects.length); ++i) {
            /* Get translation first, as object.translate() will mark
             * the object as dirty, which will cause it to recalculate
             * obj.transformWorld on access. We want to avoid this and
             * have it be recalculated in batch at the end of frame
             * instead */
            glMatrix.quat2.getTranslation(origin, this.objects[i].transformWorld);

            /* Apply gravity */
            const vel = this.velocities[i];
            vel[1] -= 9.81*dt;

            /* Check if particle would collide */
            if((origin[1] + vel[1]*dt) <= this.particleScale && vel[1] <= 0) {
                /* Pseudo friction */
                const frict = 1/(1 - vel[1]);
                vel[0] = frict*vel[0];
                vel[2] = frict*vel[2];

                /* Reflect */
                vel[1] = -0.6*vel[1];
                if(vel[1] < 0.6) vel[1] = 0;
            }
        }

        for(let i = 0; i < Math.min(this.count, this.objects.length); ++i) {
            /* Apply velocity */
            glMatrix.vec3.scale(distance, this.velocities[i], dt);
            this.objects[i].translate(distance);
        }
    },

    /** Spawn a particle */
    spawn: function() {
        let index = this.count % this.maxParticles;
        let gun = this.gun;
        let obj = this.objects[index];
        obj.resetTransform();
        obj.scale([this.particleScale, this.particleScale, this.particleScale]);

        /* Activate component, otherwise it will not show up! */
        obj.getComponent('mesh').active = true;

        const origin = this.gun.getTranslationWorld([])
        
        obj.translate(origin);
        console.log("spawning, translate to origin "+origin );

        this.velocities[index][0] = 0;
        this.velocities[index][1] = 0;
        this.velocities[index][2] = .1;

        glMatrix.vec3.normalize(this.velocities[index], this.velocities[index]);
        glMatrix.vec3.scale(this.velocities[index], this.velocities[index], this.initialSpeed);

        this.count += 1;
    }
});

WL.registerComponent('gun_trigger_manager', {
    trigger: {type: WL.Type.Object, default: null},
    particleShooter: {type: WL.Type.Object, default: null},
    peerComponent: {type: WL.Type.Object},

}, {
    init: function () {

    },
    start: function () {
        const particleShooterFunction = this.particleShooter.getComponent("emoji_particle_shooter")
        let peerManager = this.peerComponent.getComponent('peer-manager');

        console.log(particleShooterFunction.active)
        this.trigger.getComponent('cursor-target').addDownFunction(function () {
            particleShooterFunction.active = true;
            // send message when you are interacting in XR 
            peerManager.sendPackageImmediately("emoji-start", {type: "heart"});
            console.log("sending emoji-start");

        });
        this.trigger.getComponent('cursor-target').addUpFunction(function () {
            particleShooterFunction.objects.forEach(object => {
                object.active = false;
            });
            particleShooterFunction.active = false

            peerManager.sendPackage("emoji-stop", {type: "heart"});
            console.log("sending emoji-stop");

        });
    },

});

/**
Very simple mesh particles system

Demostrates spawning of new objects with components
and a simple pooling pattern.

Use it and customize it for your own game.
*/
WL.registerComponent('mesh-particles', {
    /* Mesh for spawned particles */
    mesh: {type: WL.Type.Mesh, default: null},
    /* Material for spawned particles */
    material: {type: WL.Type.Material, default: null},
    /* Delay between particle spawns. If below time of a frame, will spawn multiple particles in update. */
    delay: {type: WL.Type.Float, default: 0.04},
    /* Maximum number of particles, once limit is reached, particles are recycled first-in-first-out. */
    maxParticles: {type: WL.Type.Int, default: 10},
    /* Initial speed of emitted particles. */
    initialSpeed: {type: WL.Type.Float, default: 30},
    /* Size of a particle */
    particleScale: {type: WL.Type.Float, default: 0.1},
}, {
    init: function() {
        this.time = 0.0;
        this.count = 0;
    },
    start: function() {
        this.objects = [];
        this.velocities = [];

        this.objects = WL.scene.addObjects(this.maxParticles, null, this.maxParticles);

        for(let i = 0; i < this.maxParticles; ++i) {
            this.velocities.push([0, 0, 0]);
            let obj = this.objects[i];
            obj.name = "particle" + this.count.toString();
            let mesh = obj.addComponent('mesh');

            mesh.mesh = this.mesh;
            mesh.material = this.material;
            /* Most efficient way to hide the mesh */
            obj.scale([0, 0, 0]);
        }

        const spawnCount = 10
            for(let i = 0; i < spawnCount; ++i) this.spawn();
            this.time -= this.delay*spawnCount;
    },
    update: function(dt) {
        this.time += dt;

        this.object.translate([dt*4, 0, 0]);
        this.object.rotateAxisAngleDeg([0, 1, 0], dt*90);

        /* Target for retrieving particles world locations */
        let origin = [0, 0, 0];
        let distance = [0, 0, 0];
        for(let i = 0; i < Math.min(this.count, this.objects.length); ++i) {
            /* Get translation first, as object.translate() will mark
             * the object as dirty, which will cause it to recalculate
             * obj.transformWorld on access. We want to avoid this and
             * have it be recalculated in batch at the end of frame
             * instead */
            glMatrix.quat2.getTranslation(origin, this.objects[i].transformWorld);

            /* Apply gravity */
            const vel = this.velocities[i];
            vel[1] -= 9.81*dt;

            /* Check if particle would collide */
            if((origin[1] + vel[1]*dt) <= this.particleScale && vel[1] <= 0) {
                /* Pseudo friction */
                const frict = 1/(1 - vel[1]);
                vel[0] = frict*vel[0];
                vel[2] = frict*vel[2];

                /* Reflect */
                vel[1] = -0.6*vel[1];
                if(vel[1] < 0.6) vel[1] = 0;
            }
        }

        for(let i = 0; i < Math.min(this.count, this.objects.length); ++i) {
            /* Apply velocity */
            glMatrix.vec3.scale(distance, this.velocities[i], dt);
            this.objects[i].translate(distance);
            
        }
    },

    /** Spawn a particle */
    spawn: function() {
        let index = this.count % this.maxParticles;

        let obj = this.objects[index];
        obj.resetTransform();
        obj.scale([this.particleScale, this.particleScale, this.particleScale]);

        /* Activate component, otherwise it will not show up! */
        obj.getComponent('mesh').active = true;

        const origin = [0, 0, 0];


        this.velocities[index][0] = Math.random() - 0.5;
        this.velocities[index][1] = Math.random();
        this.velocities[index][2] = Math.random() - 0.5;

        glMatrix.vec3.normalize(this.velocities[index], this.velocities[index]);
        glMatrix.vec3.scale(this.velocities[index], this.velocities[index], this.initialSpeed);

        this.count += 1;
    }
});

WL.registerComponent("muteVoice", {
    peerComponent: {type: WL.Type.Object},
    muteUI: {type: WL.Type.Object},
    mutedColor: {type: WL.Type.Material},
}, {
    init: function () {
        //  this.input = this.Object.getComponent('input');

    },
    start: function () {
        WL.onXRSessionStart.push(this.setupVREvents.bind(this));
        this.mesh = this.muteUI.getComponent('mesh');
        this.defaultMaterial = this.mesh.material;
    },
    update: function () {

    },
    setupVREvents: function (s) {
        /* If in VR, one-time bind the listener */
        this.session = s;
        s.addEventListener('end', function (e) {
            /* Reset cache once the session ends to rebind select etc, in case
             * it starts again */
            this.gamepad = null;
            this.session = null;
        }.bind(this));  
        
        if (s.inputSources && s.inputSources.length) {
            for (var i = 0; i < s.inputSources.length; i++) {
                let inputSource = s.inputSources[i];

                if (inputSource.handedness == "right") {
                    this.gamepadRight = inputSource.gamepad;
                } else {
                    this.gamepadLeft = inputSource.gamepad;
                }
            }
        }
/*

     

        s.addEventListener('inputsourceschange', function (e) {
            console.log("input source changed");
            if (e.added && e.added.length) {
                for (var i = 0; i < e.added.length; i++) {
                    let inputSource = e.added[i];
                    if (inputSource.handedness == "right") {
                        this.gamepadRight = inputSource.gamepad;
                    } else {
                        this.gamepadLeft = inputSource.gamepad;
                    }
                }
            }
        }.bind(this));
*/

        s.addEventListener('squeeze', function (e) {
            let peerManager = this.peerComponent.getComponent('peer-manager');
            peerManager.toggleMute();
            console.log("toggle mute on squeeze");
            let mat = this.defaultMaterial.clone();
            if (peerManager.getMute()) {
                this.mesh.material = this.mutedColor;

            } else {
                this.mesh.material = mat;

            }

        }.bind(this));

    }
});

WL.registerComponent('network-buttons', {
    peerManagerObject: {type: WL.Type.Object},
    cursor: {type: WL.Type.Object},
    hostButton: {type: WL.Type.Object},
    joinButton: {type: WL.Type.Object},
}, {
    start: function () {
        this.pm = this.peerManagerObject.getComponent('peer-manager');
        this.pm.host();
        console.log("trying to host");

        this.pm.peer.on('error', (e) => {
            console.error(e);
            setTimeout(()=>{
                this.pm.join();
                console.log("trying to connect as guest");

                this.pm.peer.on('error', (e) => {
                    console.error(e);
                    setTimeout(()=> {
                        this.pm.host();
                        console.log("trying to host again");
                    },100);
                });
                
            },100);
            
            
        });

    }
    
});

WL.registerComponent("peer-manager", {
    serverId: { type: WL.Type.String, default: "THISISAWONDERLANDENGINEPLACEHOLDER" },
    networkSendFrequencyInS: { type: WL.Type.Float, default: 0.01 },
    playerHead: { type: WL.Type.Object },
    playerRightHand: { type: WL.Type.Object },
    playerLeftHand: { type: WL.Type.Object },
    networkPlayerPool: { type: WL.Type.Object },
    voiceEnabled: { type: WL.Type.Bool, default: true },
}, {
    init: function() {
        this.streams = {};

        this.activePlayers = {};
        this.currentDataPackage = {};
        this.calls = {};
        this.connections = [];
        this.currentTime = 0.0;

        // Dual quaternions for sending head, left and right hand transforms
        this.headDualQuat = new Float32Array(8);
        this.rightHandDualQuat = new Float32Array(8);
        this.leftHandDualQuat = new Float32Array(8);

        // Records user audio
        this.audio = document.createElement("AUDIO");
        this.audio.id = "localAudio";
        document.body.appendChild(this.audio);

        navigator.mediaDevices
            .getUserMedia({ audio: true, video: false })
            .then((stream) => { this.localStream = stream; })
            .catch((err) => console.error("User denied audio access.", err));

        this.connectionEstablishedCallbacks = this.connectionEstablishedCallbacks || [];
        this.clientJoinedCallbacks = this.clientJoinedCallbacks || [];
        this.disconnectCallbacks = this.disconnectCallbacks || [];
        this.registeredNetworkCallbacks = this.registeredNetworkCallbacks || {};
    },

    start: function() {
        /* Try to get one of the two types of spawner component */
        this.networkPlayerSpawner =
            this.networkPlayerPool.getComponent("peer-networked-player-pool") ||
            this.networkPlayerPool.getComponent("peer-networked-player-spawner");
    },

    //
    // Host functions
    //
    host: function() {
        this.peer = new Peer(this.serverId, {debug: 0});
        this.peer.on("open", this._onHostOpen.bind(this));
        this.peer.on("connection", this._onHostConnected.bind(this));
        this.peer.on("disconnected", this._onDisconnected.bind(this));

        this.peer.on("call", (call) => {
            this.calls[call.peer] = call;
            call.answer(this.localStream);
            call.on("stream", (stream) => {
                const audio = document.createElement("AUDIO");
                audio.id = "remoteAudio" + call.peer;
                document.body.appendChild(audio);
                audio.srcObject = stream;
                audio.autoplay = true;
                this.streams[call.peer] = stream;
            });
        });
    },

    kick: function(id) {
        this.currentDataPackage["disconnect"] = this.currentDataPackage["disconnect"] || [];
        this.currentDataPackage["disconnect"].push(id);
        this._removePlayer(id);
    },

    _onHostOpen: function(id) {
        this.isHost = true;
        this.serverId = id;
        this.activePlayers[this.serverId] = {};
        for (const cb of this.connectionEstablishedCallbacks) cb();
    },

    _onHostConnected: function(connection) {
        this._hostPlayerJoined(connection.peer, connection.metadata.username);
        this.connections.push(connection);
        connection.on("open", () => {
            // Additional data too be sent on joining can be added here
            connection.send({ joinedPlayers: Object.keys(this.activePlayers), joined: true});
        });
        connection.on("close", () => this._onHostConnectionClose(connection));
        connection.on("data", (data) => this._onHostDataReceived(data, connection));
        this.object.setTranslationWorld([0, 0, 0]);
    },

    _onHostDataReceived: function(data, connection) {
        if (data.transforms && this.activePlayers[connection.peer]) {
            this.activePlayers[connection.peer].setTransforms(data.transforms);
        }

        for (const key of Object.keys(data)) {
            if (key == "transforms") continue;
            if (key in this.registeredNetworkCallbacks) {
                this.registeredNetworkCallbacks[key].forEach(f => f(data[key]));
            }
        }
        this.currentDataPackage[connection.peer] = data;
    },

    _onHostConnectionClose: function(connection) {
        this._removePlayer(connection.peer);
        this.object.setTranslationWorld([0, -1, 0]);
        this.disconnect();

        this.currentDataPackage["disconnect"] = this.currentDataPackage["disconnect"] || [];
        this.currentDataPackage["disconnect"].push(connection.peer);
    },

    _hostPlayerJoined: function(id) {
        let newPlayer = this.networkPlayerSpawner.getEntity();
        this.activePlayers[id] = newPlayer;
        this.currentDataPackage.joinedPlayers = this.currentDataPackage.joinedPlayers || [];
        this.currentDataPackage.joinedPlayers.push(id);

        for (const cb of this.clientJoinedCallbacks) cb(id, newPlayer);
    },

    //
    // Client functions
    //
    join: function() {
        this.connect(this.serverId);
    },

    connect: function(id) {
        if (!id) return console.error("peer-manager: Connection id parameter missing");
        // Already initialized?
        if (this.peer) return;

        this.peer = new Peer();
        this.peer.on("open", this._clientOnOpen.bind(this));
        this.peer.on("disconnected", this._onDisconnected.bind(this));

        this.connectionId = id;

        this.peer.on("call", (call) => {
            if (!this.voiceEnabled) return;

            this.calls[call.peer] = call;
            call.answer(this.localStream);
            call.on("stream", (stream) => {
                const audio = document.createElement("AUDIO");
                audio.id = "remoteAudio" + id;
                document.body.appendChild(audio);
                audio.srcObject = stream;
                audio.autoplay = true;
                this.streams[id] = stream;
            });
        });
    },

    disconnect: function() {
        if (!this.peer) return;

        this.peer.destroy();
        this.peer = null;
        this.connections = [];
        delete this.connection;
    },

    _onClientConnected: function() {
        this.call(this.serverId);
        this.isHost = false;
        for (const cb of this.connectionEstablishedCallbacks) cb();
    },

    _onClientDataReceived: function(data) {
        const registeredCallbacksKeys = Object.keys(this.registeredNetworkCallbacks);
        const joined = "joined" in data;

        for (const key of Object.keys(data)) {
            const value = data[key];
            if (key == "joinedPlayers") {
                for (let j = 0; j < data.joinedPlayers.length; j++) {
                    const p = data.joinedPlayers[j];
                    // if the join id is the same, ignore
                    if (p == this.peer.id || this.activePlayers[p]) continue;
                    if (!joined && p != this.serverId) {
                        setTimeout(() => { this.call(p); }, Math.floor(500 * j));
                    }

                    const newPlayer = this.networkPlayerSpawner.getEntity();
                    this.activePlayers[p] = newPlayer;
                    for (const cb of this.clientJoinedCallbacks) cb(p, newPlayer);
                }
                continue;
            }

            if (key == "call") continue;
            if (key == "disconnect") {
                for (const v of value) this._removePlayer(v);
            }

            if (this.activePlayers[key]) {
                const values = Object.keys(value);
                for (const v of values) {
                    if (v == "transforms") {
                        this.activePlayers[key].setTransforms(value.transforms);
                        continue;
                    }

                    let includes = registeredCallbacksKeys.includes(v);
                    if (includes) this.registeredNetworkCallbacks[v].forEach(f => f(value[v]));
                }
                continue;
            }

            let includes = registeredCallbacksKeys.includes(key);
            if (includes) this.registeredNetworkCallbacks[key].forEach(f => f((value)));
        }
    },

    _removeAllPlayers: function() {
        const players = Object.keys(this.activePlayers);
        for (const player of players) this._removePlayer(player);
    },

    _removePlayer: function(peerId) {
        if (!this.activePlayers[peerId]) return;

        if (this.calls[peerId]) {
            this.calls[peerId].close();
            delete this.calls[peerId];
        }

        if (this.connections.length) {
            const con = this.connections.find((element) => { return element.peer === peerId; });
            if (con) {
                con.close();
                let index = this.connections.indexOf(con);
                if (index > -1) this.connections.splice(index, 1);
            }
        }

        if (!this.activePlayers[peerId]) return;

        if (Object.keys(this.activePlayers[peerId]).length !== 0) {
            this.activePlayers[peerId].reset();
            this.networkPlayerSpawner.returnEntity(this.activePlayers[peerId]);
        }
        delete this.activePlayers[peerId];
    },

    // All functions
    _onDisconnected: function(connection) {
        this._removeAllPlayers();
        this.disconnect();
        for (let cb of this.disconnectCallbacks) cb(connection.peer);
    },

    call: function(id) {
        if (!this.voiceEnabled) return;

        if(!this.localStream) {
            /* If the page doesn't have permission to access
             * audio stream, creation of the call would fail */
            console.error("Cannot call: no audio stream");
            return;
        }
        const call = this.peer.call(id, this.localStream);
        this.calls[id] = call;
        call.on("stream", (stream) => {
            const audio = document.createElement("AUDIO");
            audio.id = id;
            document.body.appendChild(audio);
            audio.srcObject = stream;
            audio.autoplay = true;
            this.streams[id] = stream;
        });
    },

    _clientOnOpen: function() {
        this.connection = this.peer.connect(this.connectionId, {
            // reliable: true,
            metadata: { username: "TestName" },
        });
        this.connection.on("open", this._onClientConnected.bind(this));
        this.connection.on("data", this._onClientDataReceived.bind(this));
        this.connection.on("close", this._onClientClose.bind(this));
    },

    _onClientClose: function() {
        if (this.peer) this.peer.destroy();
    },

    addConnectionEstablishedCallback: function(f) {
        this.connectionEstablishedCallbacks = this.connectionEstablishedCallbacks || [];
        this.connectionEstablishedCallbacks.push(f);
    },

    removeConnectionEstablishedCallback: function(f) {
        const index = this.connectionEstablishedCallbacks.indexOf(f);
        if (index <= -1) return;

        this.connectionEstablishedCallbacks.splice(index, 1);
    },
    addClientJoinedCallback: function(f) {
        this.clientJoinedCallbacks = this.clientJoinedCallbacks || [];
        this.clientJoinedCallbacks.push(f);
    },
    removeClientJoinedCallback: function(f) {
        const index = this.clientJoinedCallbacks.indexOf(f);
        if (index <= -1) return

        this.clientJoinedCallbacks.splice(index, 1);
    },
    addDisconnectCallback: function(f) {
        this.disconnectCallbacks = this.disconnectCallbacks || [];
        this.disconnectCallbacks.push(f);
    },
    removeDisconnectCallback: function(f) {
        const index = this.disconnectCallbacks.indexOf(f);
        if (index <= -1) return;

        this.disconnectCallbacks.splice(index, 1);
    },

    /* @deprecated Function was renamed to correct spelling */
    addNetworkDataRecievedCallback: function(...args) {
        return this.addNetworkDataReceivedCallback(...args);
    },

    addNetworkDataReceivedCallback: function(key, f) {
        this.registeredNetworkCallbacks = this.registeredNetworkCallbacks || {};
        const cbs = this.registeredNetworkCallbacks[key] || [];
        this.registeredNetworkCallbacks[key] = cbs;
        cbs.push(f);
    },

    /* @deprecated Function was renamed to correct spelling */
    removeNetworkDataRecievedCallback: function(...args) {
        return this.removeNetworkDataReceivedCallback(...args);
    },

    removeNetworkDataReceivedCallback: function(key) {
        delete this.registeredNetworkCallbacks[key];
    },

    sendPackage: function(key, data) {
        this.currentDataPackage[key] = data;
    },

    sendPackageImmediately: function(key, data) {
        let package = {};
        package[key] = data;

        if (this.connection) {
            this.connection.send(package);
            return;
        }

        for (let con of this.connections) con.send(package);
    },
    getMute: function() {
        return this.localStream.getTracks()[0].enabled;
    },
    toggleMute: function() {
        this.localStream.getTracks()[0].enabled =
            !this.localStream.getTracks()[0].enabled;
    },

    setOwnMute: function(mute) {
        this.localStream.getTracks()[0].enabled = !mute;
    },

    setOtherMute: function(id, mute) {
        if (this.streams[id]) this.streams[id].getTracks()[0].enabled = !mute;
    },

    update: function(dt) {
        if(!this.connection && this.connections.length == 0) return;

        this.currentTime += dt;
        if (this.currentTime < this.networkSendFrequencyInS) return;

        this.currentTime = 0.0;

        this.headDualQuat.set(this.playerHead.transformWorld);
        this.rightHandDualQuat.set(this.playerRightHand.transformWorld);
        this.leftHandDualQuat.set(this.playerLeftHand.transformWorld);

        if (this.connections.length) {
            this.currentDataPackage[this.serverId] = {
                transforms: {
                    head: this.headDualQuat,
                    rightHand: this.rightHandDualQuat,
                    leftHand: this.leftHandDualQuat,
                },
            };

            if (Object.keys(this.currentDataPackage).length == 0) return

            for (let con of this.connections) {
                const currentConnectionId = con.peer;
                const package = Object.fromEntries(
                    Object.entries(this.currentDataPackage).filter((e) => { return e[0] != currentConnectionId; })
                );
                if (Object.keys(package).length) con.send(package);
            }
        } else {
            this.currentDataPackage.transforms = {
                head: this.headDualQuat,
                rightHand: this.rightHandDualQuat,
                leftHand: this.leftHandDualQuat,
            };

            this.connection.send(this.currentDataPackage);
        }

        this.currentDataPackage = {};
    },
});

WL.registerComponent("peer-networked-player-pool", {

}, {
    init: function() {
        this.inactivePool = [];
        for (let c of this.object.children) {
            this.inactivePool.push(c.getComponent("peer-networked-player"));
        }
    },
    getEntity: function() {
        if (this.inactivePool.length) return this.inactivePool.shift();
        console.error("peer-networked-player-pool: No more inactive entities");
    },
    returnEntity: function(entity) {
        this.inactivePool.push(entity);
    },
}
);

WL.registerComponent("peer-networked-player", {
    nameTextObject: { type: WL.Type.Object }
}, {
    init: function() {
        for (let c of this.object.children) {
            if(c.name == "Head") this.head = c;
            if(c.name == "LeftHand") this.leftHand = c;
            if(c.name == "RightHand") this.rightHand = c;
        }
    },

    setName: function(name) {
        if (this.nameTextObject) this.nameTextObject.getComponent("text").text = name;
    },

    reset: function() {
        this.head.resetTranslationRotation();
        this.rightHand.resetTranslationRotation();
        this.leftHand.resetTranslationRotation();
    },

    setTransforms: function(transforms) {
        this.head.transformLocal.set(new Float32Array(transforms.head));
        this.head.setDirty();

        this.rightHand.transformLocal.set(new Float32Array(transforms.rightHand));
        this.rightHand.setDirty();

        this.leftHand.transformLocal.set(new Float32Array(transforms.leftHand));
        this.leftHand.setDirty();
    },
}
);

WL.registerComponent("peer-networked-player-spawner", {
    headMesh: { type: WL.Type.Mesh },
    headMaterial: { type: WL.Type.Material },
    leftHandMesh: { type: WL.Type.Mesh },
    leftHandMaterial: { type: WL.Type.Material },
    rightHandMesh: { type: WL.Type.Mesh },
    rightHandMaterial: { type: WL.Type.Material },
}, {
    init: function() {
        this.count = 0;
    },

    getEntity: function() {
        const player = WL.scene.addObject(1);
        const children = WL.scene.addObjects(3, player);

        children[0].name = "Head";
        children[0].addComponent("mesh", {
            mesh: this.headMesh,
            material: this.headMaterial,
        });

        children[1].name = "LeftHand";
        children[1].addComponent("mesh", {
            mesh: this.leftHandMesh,
            material: this.leftHandMaterial,
        });

        children[2].name = "RightHand";
        children[2].addComponent("mesh", {
            mesh: this.rightHandMesh,
            material: this.rightHandMaterial,
        });

        player.name = `Player ${this.count++}`;
        return player.addComponent("peer-networked-player");
    },

    returnEntity: function(player) {
        console.log("returning:", player);
        player.children.forEach((c) => { c.active = false; });
        player.active = false;
    },
});

parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"EgBh":[function(require,module,exports) {
var e={};e.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),e.useArrayBufferView=!e.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),module.exports.binaryFeatures=e;var r=module.exports.BlobBuilder;function t(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(r=module.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),t.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},t.prototype.flush=function(){if(this._pieces.length>0){var r=new Uint8Array(this._pieces);e.useArrayBufferView||(r=r.buffer),this._parts.push(r),this._pieces=[]}},t.prototype.getBuffer=function(){if(this.flush(),e.useBlobBuilder){for(var t=new r,i=0,u=this._parts.length;i<u;i++)t.append(this._parts[i]);return t.getBlob()}return new Blob(this._parts)},module.exports.BufferBuilder=t;
},{}],"kdPp":[function(require,module,exports) {
var t=require("./bufferbuilder").BufferBuilder,e=require("./bufferbuilder").binaryFeatures,i={unpack:function(t){return new r(t).unpack()},pack:function(t){var e=new n;return e.pack(t),e.getBuffer()}};function r(t){this.index=0,this.dataBuffer=t,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function n(){this.bufferBuilder=new t}function u(t){var e=t.charCodeAt(0);return e<=2047?"00":e<=65535?"000":e<=2097151?"0000":e<=67108863?"00000":"000000"}function a(t){return t.length>600?new Blob([t]).size:t.replace(/[^\u0000-\u007F]/g,u).length}module.exports=i,r.prototype.unpack=function(){var t,e=this.unpack_uint8();if(e<128)return e;if((224^e)<32)return(224^e)-32;if((t=160^e)<=15)return this.unpack_raw(t);if((t=176^e)<=15)return this.unpack_string(t);if((t=144^e)<=15)return this.unpack_array(t);if((t=128^e)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}},r.prototype.unpack_uint8=function(){var t=255&this.dataView[this.index];return this.index++,t},r.prototype.unpack_uint16=function(){var t=this.read(2),e=256*(255&t[0])+(255&t[1]);return this.index+=2,e},r.prototype.unpack_uint32=function(){var t=this.read(4),e=256*(256*(256*t[0]+t[1])+t[2])+t[3];return this.index+=4,e},r.prototype.unpack_uint64=function(){var t=this.read(8),e=256*(256*(256*(256*(256*(256*(256*t[0]+t[1])+t[2])+t[3])+t[4])+t[5])+t[6])+t[7];return this.index+=8,e},r.prototype.unpack_int8=function(){var t=this.unpack_uint8();return t<128?t:t-256},r.prototype.unpack_int16=function(){var t=this.unpack_uint16();return t<32768?t:t-65536},r.prototype.unpack_int32=function(){var t=this.unpack_uint32();return t<Math.pow(2,31)?t:t-Math.pow(2,32)},r.prototype.unpack_int64=function(){var t=this.unpack_uint64();return t<Math.pow(2,63)?t:t-Math.pow(2,64)},r.prototype.unpack_raw=function(t){if(this.length<this.index+t)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+t+" "+this.length);var e=this.dataBuffer.slice(this.index,this.index+t);return this.index+=t,e},r.prototype.unpack_string=function(t){for(var e,i,r=this.read(t),n=0,u="";n<t;)(e=r[n])<128?(u+=String.fromCharCode(e),n++):(192^e)<32?(i=(192^e)<<6|63&r[n+1],u+=String.fromCharCode(i),n+=2):(i=(15&e)<<12|(63&r[n+1])<<6|63&r[n+2],u+=String.fromCharCode(i),n+=3);return this.index+=t,u},r.prototype.unpack_array=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=this.unpack();return e},r.prototype.unpack_map=function(t){for(var e={},i=0;i<t;i++){var r=this.unpack(),n=this.unpack();e[r]=n}return e},r.prototype.unpack_float=function(){var t=this.unpack_uint32(),e=(t>>23&255)-127;return(0===t>>31?1:-1)*(8388607&t|8388608)*Math.pow(2,e-23)},r.prototype.unpack_double=function(){var t=this.unpack_uint32(),e=this.unpack_uint32(),i=(t>>20&2047)-1023;return(0===t>>31?1:-1)*((1048575&t|1048576)*Math.pow(2,i-20)+e*Math.pow(2,i-52))},r.prototype.read=function(t){var e=this.index;if(e+t<=this.length)return this.dataView.subarray(e,e+t);throw new Error("BinaryPackFailure: read index out of range")},n.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},n.prototype.pack=function(t){var i=typeof t;if("string"===i)this.pack_string(t);else if("number"===i)Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if("boolean"===i)!0===t?this.bufferBuilder.append(195):!1===t&&this.bufferBuilder.append(194);else if("undefined"===i)this.bufferBuilder.append(192);else{if("object"!==i)throw new Error('Type "'+i+'" not yet supported');if(null===t)this.bufferBuilder.append(192);else{var r=t.constructor;if(r==Array)this.pack_array(t);else if(r==Blob||r==File||t instanceof Blob||t instanceof File)this.pack_bin(t);else if(r==ArrayBuffer)e.useArrayBufferView?this.pack_bin(new Uint8Array(t)):this.pack_bin(t);else if("BYTES_PER_ELEMENT"in t)e.useArrayBufferView?this.pack_bin(new Uint8Array(t.buffer)):this.pack_bin(t.buffer);else if(r==Object||r.toString().startsWith("class"))this.pack_object(t);else if(r==Date)this.pack_string(t.toString());else{if("function"!=typeof t.toBinaryPack)throw new Error('Type "'+r.toString()+'" not yet supported');this.bufferBuilder.append(t.toBinaryPack())}}}this.bufferBuilder.flush()},n.prototype.pack_bin=function(t){var e=t.length||t.byteLength||t.size;if(e<=15)this.pack_uint8(160+e);else if(e<=65535)this.bufferBuilder.append(218),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(e)}this.bufferBuilder.append(t)},n.prototype.pack_string=function(t){var e=a(t);if(e<=15)this.pack_uint8(176+e);else if(e<=65535)this.bufferBuilder.append(216),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(e)}this.bufferBuilder.append(t)},n.prototype.pack_array=function(t){var e=t.length;if(e<=15)this.pack_uint8(144+e);else if(e<=65535)this.bufferBuilder.append(220),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(e)}for(var i=0;i<e;i++)this.pack(t[i])},n.prototype.pack_integer=function(t){if(t>=-32&&t<=127)this.bufferBuilder.append(255&t);else if(t>=0&&t<=255)this.bufferBuilder.append(204),this.pack_uint8(t);else if(t>=-128&&t<=127)this.bufferBuilder.append(208),this.pack_int8(t);else if(t>=0&&t<=65535)this.bufferBuilder.append(205),this.pack_uint16(t);else if(t>=-32768&&t<=32767)this.bufferBuilder.append(209),this.pack_int16(t);else if(t>=0&&t<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(t);else if(t>=-2147483648&&t<=2147483647)this.bufferBuilder.append(210),this.pack_int32(t);else if(t>=-0x8000000000000000&&t<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(t);else{if(!(t>=0&&t<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(t)}},n.prototype.pack_double=function(t){var e=0;t<0&&(e=1,t=-t);var i=Math.floor(Math.log(t)/Math.LN2),r=t/Math.pow(2,i)-1,n=Math.floor(r*Math.pow(2,52)),u=Math.pow(2,32),a=e<<31|i+1023<<20|n/u&1048575,p=n%u;this.bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(p)},n.prototype.pack_object=function(t){var e=Object.keys(t).length;if(e<=15)this.pack_uint8(128+e);else if(e<=65535)this.bufferBuilder.append(222),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(e)}for(var i in t)t.hasOwnProperty(i)&&(this.pack(i),this.pack(t[i]))},n.prototype.pack_uint8=function(t){this.bufferBuilder.append(t)},n.prototype.pack_uint16=function(t){this.bufferBuilder.append(t>>8),this.bufferBuilder.append(255&t)},n.prototype.pack_uint32=function(t){var e=4294967295&t;this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},n.prototype.pack_uint64=function(t){var e=t/Math.pow(2,32),i=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&i)>>>24),this.bufferBuilder.append((16711680&i)>>>16),this.bufferBuilder.append((65280&i)>>>8),this.bufferBuilder.append(255&i)},n.prototype.pack_int8=function(t){this.bufferBuilder.append(255&t)},n.prototype.pack_int16=function(t){this.bufferBuilder.append((65280&t)>>8),this.bufferBuilder.append(255&t)},n.prototype.pack_int32=function(t){this.bufferBuilder.append(t>>>24&255),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},n.prototype.pack_int64=function(t){var e=Math.floor(t/Math.pow(2,32)),i=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&i)>>>24),this.bufferBuilder.append((16711680&i)>>>16),this.bufferBuilder.append((65280&i)>>>8),this.bufferBuilder.append(255&i)};
},{"./bufferbuilder":"EgBh"}],"iSxC":[function(require,module,exports) {
"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.extractVersion=o,exports.wrapPeerConnectionEvent=i,exports.disableLog=s,exports.disableWarnings=a,exports.log=u,exports.deprecated=c,exports.detectBrowser=p,exports.compactObject=d,exports.walkStats=l,exports.filterStats=b;var n=!0,r=!0;function o(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function i(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,o=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return o.apply(this,arguments);var i=function(e){var t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=i,o.apply(this,[e,i])};var i=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return i.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],i.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function s(e){return"boolean"!=typeof e?new Error("Argument type: "+t(e)+". Please use a boolean."):(n=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function a(e){return"boolean"!=typeof e?new Error("Argument type: "+t(e)+". Please use a boolean."):(r=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function u(){if("object"===("undefined"==typeof window?"undefined":t(window))){if(n)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function c(e,t){r&&console.warn(e+" is deprecated, please use "+t+" instead.")}function p(e){var{navigator:t}=e,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=o(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=o(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=o(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=o(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n}function f(e){return"[object Object]"===Object.prototype.toString.call(e)}function d(t){return f(t)?Object.keys(t).reduce(function(n,r){var o=f(t[r]),i=o?d(t[r]):t[r],s=o&&!Object.keys(i).length;return void 0===i||s?n:Object.assign(n,e({},r,i))},{}):t}function l(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(function(r){r.endsWith("Id")?l(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(function(t){l(e,e.get(t),n)})}))}function b(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;var i=[];return e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&i.push(e)}),i.forEach(function(t){e.forEach(function(n){n.type===r&&n.trackId===t.id&&l(e,n,o)})}),o}
},{}],"s6SN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetUserMedia=i;var e=t(require("../utils.js"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function t(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var o={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(o,i,a):o[i]=e[i]}return o.default=e,t&&t.set(e,o),o}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=e.log;function i(r){var t=r&&r.navigator;if(t.mediaDevices){var i=e.detectBrowser(r),a=function(e){if("object"!==o(e)||e.mandatory||e.optional)return e;var r={};return Object.keys(e).forEach(function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var n="object"===o(e[t])?e[t]:{ideal:e[t]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var i=function(e,r){return e?e+r.charAt(0).toUpperCase()+r.slice(1):"deviceId"===r?"sourceId":r};if(void 0!==n.ideal){r.optional=r.optional||[];var a={};"number"==typeof n.ideal?(a[i("min",t)]=n.ideal,r.optional.push(a),(a={})[i("max",t)]=n.ideal,r.optional.push(a)):(a[i("",t)]=n.ideal,r.optional.push(a))}void 0!==n.exact&&"number"!=typeof n.exact?(r.mandatory=r.mandatory||{},r.mandatory[i("",t)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(r.mandatory=r.mandatory||{},r.mandatory[i(e,t)]=n[e])})}}),e.advanced&&(r.optional=(r.optional||[]).concat(e.advanced)),r},c=function(e,r){if(i.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===o(e.audio)){var c=function(e,r,t){r in e&&!(t in e)&&(e[t]=e[r],delete e[r])};c((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),c(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=a(e.audio)}if(e&&"object"===o(e.video)){var d=e.video.facingMode;d=d&&("object"===o(d)?d:{ideal:d});var u,s=i.version<66;if(d&&("user"===d.exact||"environment"===d.exact||"user"===d.ideal||"environment"===d.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||s))if(delete e.video.facingMode,"environment"===d.exact||"environment"===d.ideal?u=["back","rear"]:"user"!==d.exact&&"user"!==d.ideal||(u=["front"]),u)return t.mediaDevices.enumerateDevices().then(function(t){var o=(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return u.some(function(r){return e.label.toLowerCase().includes(r)})});return!o&&t.length&&u.includes("back")&&(o=t[t.length-1]),o&&(e.video.deviceId=d.exact?{exact:o.deviceId}:{ideal:o.deviceId}),e.video=a(e.video),n("chrome: "+JSON.stringify(e)),r(e)});e.video=a(e.video)}return n("chrome: "+JSON.stringify(e)),r(e)},d=function(e){return i.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,r,o){c(e,function(e){t.webkitGetUserMedia(e,r,function(e){o&&o(d(e))})})}.bind(t),t.mediaDevices.getUserMedia){var u=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return c(e,function(e){return u(e).then(function(r){if(e.audio&&!r.getAudioTracks().length||e.video&&!r.getVideoTracks().length)throw r.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return r},function(e){return Promise.reject(d(e))})})}}}}
},{"../utils.js":"iSxC"}],"VHa8":[function(require,module,exports) {
"use strict";function e(e,i){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof i?e.navigator.mediaDevices.getDisplayMedia=function(a){return i(a).then(function(i){var t=a.video&&a.video.width,o=a.video&&a.video.height,d=a.video&&a.video.frameRate;return a.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:d||3}},t&&(a.video.mandatory.maxWidth=t),o&&(a.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(a)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetDisplayMedia=e;
},{}],"uI5X":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimMediaStream=a,exports.shimOnTrack=c,exports.shimGetSendersWithDtmf=p,exports.shimGetStats=d,exports.shimSenderReceiverGetStats=h,exports.shimAddTrackRemoveTrackWithNative=f,exports.shimAddTrackRemoveTrack=m,exports.shimPeerConnection=u,exports.fixNegotiationNeeded=l,Object.defineProperty(exports,"shimGetUserMedia",{enumerable:!0,get:function(){return t.shimGetUserMedia}}),Object.defineProperty(exports,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r.shimGetDisplayMedia}});var e=i(require("../utils.js")),t=require("./getusermedia"),r=require("./getdisplaymedia");function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function i(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function c(t){if("object"!==s(t)||!t.RTCPeerConnection||"ontrack"in t.RTCPeerConnection.prototype)e.wrapPeerConnectionEvent(t,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._ontrackpoly||(this._ontrackpoly=function(r){r.stream.addEventListener("addtrack",function(n){var i;i=t.RTCPeerConnection.prototype.getReceivers?e.getReceivers().find(function(e){return e.track&&e.track.id===n.track.id}):{track:n.track};var o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],e.dispatchEvent(o)}),r.stream.getTracks().forEach(function(n){var i;i=t.RTCPeerConnection.prototype.getReceivers?e.getReceivers().find(function(e){return e.track&&e.track.id===n.id}):{track:n};var o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],e.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}}function p(e){if("object"===s(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(function(e){r._senders.push(t(r,e))})};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach(function(e){var r=t._senders.find(function(t){return t.track===e});r&&t._senders.splice(t._senders.indexOf(r),1)})}}else if("object"===s(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function d(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,[r,n,i]=arguments;if(arguments.length>0&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var o=function(e){var t={};return e.result().forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){r[t]=e.stat(t)}),t[r.id]=r}),t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){return t.apply(this,[function(e){n(s(o(e)))},r])}return new Promise(function(r,n){t.apply(e,[function(e){r(s(o(e)))},n])}).then(n,i)}}}function h(t){if("object"===s(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver){if(!("getStats"in t.RTCRtpSender.prototype)){var r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=r.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t});var n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),t.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(r){return e.filterStats(r,t.track,!0)})}}if(!("getStats"in t.RTCRtpReceiver.prototype)){var i=t.RTCPeerConnection.prototype.getReceivers;i&&(t.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t}),e.wrapPeerConnectionEvent(t,"track",function(e){return e.receiver._pc=e.srcElement,e}),t.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(r){return e.filterStats(r,t.track,!1)})}}if("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype){var o=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){var e,r,n,i=arguments[0];return this.getSenders().forEach(function(t){t.track===i&&(e?n=!0:e=t)}),this.getReceivers().forEach(function(e){return e.track===i&&(r?n=!0:r=e),e.track===i}),n||e&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):e?e.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}}function f(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(e){if(t.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var n=this.getSenders();r.apply(this,arguments);var i=this.getSenders().filter(function(e){return-1===n.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(i)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]}),i.apply(this,arguments)}}function m(t){if(t.RTCPeerConnection){var r=e.detectBrowser(t);if(t.RTCPeerConnection.prototype.addTrack&&r.version>=65)return f(t);var n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(e){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach(function(e){if(r.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[e.id]){var n=new t.MediaStream(e.getTracks());this._streams[e.id]=n,this._reverseStreams[n.id]=e,e=n}i.apply(this,[e])};var s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},t.RTCPeerConnection.prototype.addTrack=function(e,r){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(t){return t===e}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[r.id];if(o)o.addTrack(e),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))});else{var s=new t.MediaStream([e]);this._streams[r.id]=s,this._reverseStreams[s.id]=r,this.addStream(s)}return this.getSenders().find(function(t){return t.track===e})},["createOffer","createAnswer"].forEach(function(e){var r=t.RTCPeerConnection.prototype[e],n=o({},e,function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(r){var n=p(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then(function(t){return p(e,t)})});t.RTCPeerConnection.prototype[e]=n[e]});var a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,t=arguments[0],r=t.sdp,Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:r})),a.apply(this,arguments)):a.apply(this,arguments);var e,t,r};var c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=c.get.apply(this);return""===e.type?e:p(this,e)}}),t.RTCPeerConnection.prototype.removeTrack=function(e){var t,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach(function(n){r._streams[n].getTracks().find(function(t){return e.track===t})&&(t=r._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function p(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)}),new RTCSessionDescription({type:t.type,sdp:r})}}function u(t){var r=e.detectBrowser(t);if(!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection){r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var r=t.RTCPeerConnection.prototype[e],n=o({},e,function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)});t.RTCPeerConnection.prototype[e]=n[e]});var n=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?r.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}}function l(t){e.wrapPeerConnectionEvent(t,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})}
},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],"NZ1C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.filterIceServers=n;var r=t(require("../utils"));function e(){if("function"!=typeof WeakMap)return null;var r=new WeakMap;return e=function(){return r},r}function t(r){if(r&&r.__esModule)return r;if(null===r||"object"!=typeof r&&"function"!=typeof r)return{default:r};var t=e();if(t&&t.has(r))return t.get(r);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){var f=u?Object.getOwnPropertyDescriptor(r,i):null;f&&(f.get||f.set)?Object.defineProperty(n,i,f):n[i]=r[i]}return n.default=r,t&&t.set(r,n),n}function n(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var u="string"==typeof t;return u&&(t=[t]),t=t.filter(function(r){if(0===r.indexOf("stun:"))return!1;var e=r.startsWith("turn")&&!r.startsWith("turn:[")&&r.includes("transport=udp");return e&&!n?(n=!0,!0):e&&!n}),delete e.url,e.urls=u?t[0]:t,!!t.length}})}
},{"../utils":"iSxC"}],"YHvh":[function(require,module,exports) {
"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(r){return r.trim().split("\n").map(function(r){return r.trim()})},r.splitSections=function(r){return r.split("\nm=").map(function(r,e){return(e>0?"m="+r:r).trim()+"\r\n"})},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(r){return 0===r.indexOf(t)})},r.parseCandidate=function(r){for(var e,t={foundation:(e=0===r.indexOf("a=candidate:")?r.substring(12).split(" "):r.substring(10).split(" "))[0],component:parseInt(e[1],10),protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],address:e[4],port:parseInt(e[5],10),type:e[7]},n=8;n<e.length;n+=2)switch(e[n]){case"raddr":t.relatedAddress=e[n+1];break;case"rport":t.relatedPort=parseInt(e[n+1],10);break;case"tcptype":t.tcpType=e[n+1];break;case"ufrag":t.ufrag=e[n+1],t.usernameFragment=e[n+1];break;default:t[e[n]]=e[n+1]}return t},r.writeCandidate=function(r){var e=[];e.push(r.foundation),e.push(r.component),e.push(r.protocol.toUpperCase()),e.push(r.priority),e.push(r.address||r.ip),e.push(r.port);var t=r.type;return e.push("typ"),e.push(t),"host"!==t&&r.relatedAddress&&r.relatedPort&&(e.push("raddr"),e.push(r.relatedAddress),e.push("rport"),e.push(r.relatedPort)),r.tcpType&&"tcp"===r.protocol.toLowerCase()&&(e.push("tcptype"),e.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(e.push("ufrag"),e.push(r.usernameFragment||r.ufrag)),"candidate:"+e.join(" ")},r.parseIceOptions=function(r){return r.substr(14).split(" ")},r.parseRtpMap=function(r){var e=r.substr(9).split(" "),t={payloadType:parseInt(e.shift(),10)};return e=e[0].split("/"),t.name=e[0],t.clockRate=parseInt(e[1],10),t.channels=3===e.length?parseInt(e[2],10):1,t.numChannels=t.channels,t},r.writeRtpMap=function(r){var e=r.payloadType;void 0!==r.preferredPayloadType&&(e=r.preferredPayloadType);var t=r.channels||r.numChannels||1;return"a=rtpmap:"+e+" "+r.name+"/"+r.clockRate+(1!==t?"/"+t:"")+"\r\n"},r.parseExtmap=function(r){var e=r.substr(9).split(" ");return{id:parseInt(e[0],10),direction:e[0].indexOf("/")>0?e[0].split("/")[1]:"sendrecv",uri:e[1]}},r.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&"sendrecv"!==r.direction?"/"+r.direction:"")+" "+r.uri+"\r\n"},r.parseFmtp=function(r){for(var e,t={},n=r.substr(r.indexOf(" ")+1).split(";"),a=0;a<n.length;a++)t[(e=n[a].trim().split("="))[0].trim()]=e[1];return t},r.writeFmtp=function(r){var e="",t=r.payloadType;if(void 0!==r.preferredPayloadType&&(t=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){var n=[];Object.keys(r.parameters).forEach(function(e){r.parameters[e]?n.push(e+"="+r.parameters[e]):n.push(e)}),e+="a=fmtp:"+t+" "+n.join(";")+"\r\n"}return e},r.parseRtcpFb=function(r){var e=r.substr(r.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},r.writeRtcpFb=function(r){var e="",t=r.payloadType;return void 0!==r.preferredPayloadType&&(t=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(function(r){e+="a=rtcp-fb:"+t+" "+r.type+(r.parameter&&r.parameter.length?" "+r.parameter:"")+"\r\n"}),e},r.parseSsrcMedia=function(r){var e=r.indexOf(" "),t={ssrc:parseInt(r.substr(7,e-7),10)},n=r.indexOf(":",e);return n>-1?(t.attribute=r.substr(e+1,n-e-1),t.value=r.substr(n+1)):t.attribute=r.substr(e+1),t},r.parseSsrcGroup=function(r){var e=r.substr(13).split(" ");return{semantics:e.shift(),ssrcs:e.map(function(r){return parseInt(r,10)})}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(r){var e=r.substr(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(r,e){var t="a=setup:"+e+"\r\n";return r.fingerprints.forEach(function(r){t+="a=fingerprint:"+r.algorithm+" "+r.value+"\r\n"}),t},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter(function(r){return 0===r.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(r){return 0===r.indexOf("a=ice-pwd:")})[0].substr(10)}},r.writeIceParameters=function(r){return"a=ice-ufrag:"+r.usernameFragment+"\r\na=ice-pwd:"+r.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),a=3;a<n.length;a++){var s=n[a],i=r.matchPrefix(e,"a=rtpmap:"+s+" ")[0];if(i){var p=r.parseRtpMap(i),c=r.matchPrefix(e,"a=fmtp:"+s+" ");switch(p.parameters=c.length?r.parseFmtp(c[0]):{},p.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+s+" ").map(r.parseRtcpFb),t.codecs.push(p),p.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(p.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(r){return void 0!==r.preferredPayloadType?r.preferredPayloadType:r.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});var a=0;return t.codecs.forEach(function(r){r.maxptime>a&&(a=r.maxptime)}),a>0&&(n+="a=maxptime:"+a+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){var t,n=[],a=r.parseRtpParameters(e),s=-1!==a.fecMechanisms.indexOf("RED"),i=-1!==a.fecMechanisms.indexOf("ULPFEC"),p=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(r){return"cname"===r.attribute}),c=p.length>0&&p[0].ssrc,o=r.matchPrefix(e,"a=ssrc-group:FID").map(function(r){return r.substr(17).split(" ").map(function(r){return parseInt(r,10)})});o.length>0&&o[0].length>1&&o[0][0]===c&&(t=o[0][1]),a.codecs.forEach(function(r){if("RTX"===r.name.toUpperCase()&&r.parameters.apt){var e={ssrc:c,codecPayloadType:parseInt(r.parameters.apt,10)};c&&t&&(e.rtx={ssrc:t}),n.push(e),s&&((e=JSON.parse(JSON.stringify(e))).fec={ssrc:c,mechanism:i?"red+ulpfec":"red"},n.push(e))}}),0===n.length&&c&&n.push({ssrc:c});var u=r.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(r){r.maxBitrate=u})),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(r){return"cname"===r.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var a=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=a.length>0,t.compound=0===a.length;var s=r.matchPrefix(e,"a=rtcp-mux");return t.mux=s.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var a=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(r){return"msid"===r.attribute});return a.length>0?{stream:(t=a[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),a=r.matchPrefix(e,"a=max-message-size:");a.length>0&&(t=parseInt(a[0].substr(19),10)),isNaN(t)&&(t=65536);var s=r.matchPrefix(e,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var i=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(i[0],10),protocol:i[1],maxMessageSize:t}}},r.writeSctpDescription=function(r,e){var t=[];return t="DTLS/SCTP"!==r.protocol?["m="+r.kind+" 9 "+r.protocol+" "+e.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+e.port+"\r\n"]:["m="+r.kind+" 9 "+r.protocol+" "+e.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+e.port+" "+e.protocol+" 65535\r\n"],void 0!==e.maxMessageSize&&t.push("a=max-message-size:"+e.maxMessageSize+"\r\n"),t.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var a=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+a+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,a){var s=r.writeRtpDescription(e.kind,t);if(s+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),s+="a=mid:"+e.mid+"\r\n",e.direction?s+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?s+="a=sendrecv\r\n":e.rtpSender?s+="a=sendonly\r\n":e.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",e.rtpSender){var i="msid:"+a.id+" "+e.rtpSender.track.id+"\r\n";s+="a="+i,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+i,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+i,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),s},r.getDirection=function(e,t){for(var n=r.splitLines(e),a=0;a<n.length;a++)switch(n[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[a].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(r){return"0"===r.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof module&&(module.exports=r);
},{}],"NJ2u":[function(require,module,exports) {
"use strict";var e=require("sdp");function t(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function r(t,r,n,a,i){var s=e.writeRtpDescription(t.kind,r);if(s+=e.writeIceParameters(t.iceGatherer.getLocalParameters()),s+=e.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":i||"active"),s+="a=mid:"+t.mid+"\r\n",t.rtpSender&&t.rtpReceiver?s+="a=sendrecv\r\n":t.rtpSender?s+="a=sendonly\r\n":t.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",t.rtpSender){var o=t.rtpSender._initialTrackId||t.rtpSender.track.id;t.rtpSender._initialTrackId=o;var c="msid:"+(a?a.id:"-")+" "+o+"\r\n";s+="a="+c,s+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+c,t.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+"\r\n",t.rtpSender&&t.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+e.localCName+"\r\n"),s}function n(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var a="string"==typeof n;return a&&(n=[n]),n=n.filter(function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!r?(r=!0,!0):0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp")}),delete e.url,e.urls=a?n[0]:n,!!n.length}})}function a(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},a=function(e,t,r,a){var i=n(e.parameters.apt,r),s=n(t.parameters.apt,a);return i&&s&&i.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach(function(n){for(var i=0;i<t.codecs.length;i++){var s=t.codecs[i];if(n.name.toLowerCase()===s.name.toLowerCase()&&n.clockRate===s.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&s.parameters.apt&&!a(n,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(n.numChannels,s.numChannels),r.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter(function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var n=0;n<t.headerExtensions.length;n++){var a=t.headerExtensions[n];if(e.uri===a.uri){r.headerExtensions.push(a);break}}}),r}function i(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function s(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return r||e.addRemoteCandidate(t),!r}function o(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}module.exports=function(c,d){function p(e,t){t.addTrack(e),t.dispatchEvent(new c.MediaStreamTrackEvent("addtrack",{track:e}))}function l(e,t,r,n){var a=new Event("track");a.track=t,a.receiver=r,a.transceiver={receiver:r},a.streams=n,c.setTimeout(function(){e._dispatchEvent("track",a)})}var f=function(t){var r=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){r[e]=a[e].bind(a)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",t=JSON.parse(JSON.stringify(t||{})),this.usingBundle="max-bundle"===t.bundlePolicy,"negotiate"===t.rtcpMuxPolicy)throw o("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(t.rtcpMuxPolicy||(t.rtcpMuxPolicy="require"),t.iceTransportPolicy){case"all":case"relay":break;default:t.iceTransportPolicy="all"}switch(t.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:t.bundlePolicy="balanced"}if(t.iceServers=n(t.iceServers||[],d),this._iceGatherers=[],t.iceCandidatePoolSize)for(var i=t.iceCandidatePoolSize;i>0;i--)this._iceGatherers.push(new c.RTCIceGatherer({iceServers:t.iceServers,gatherPolicy:t.iceTransportPolicy}));else t.iceCandidatePoolSize=0;this._config=t,this.transceivers=[],this._sdpSessionId=e.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(f.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(f.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),f.prototype.onicecandidate=null,f.prototype.onaddstream=null,f.prototype.ontrack=null,f.prototype.onremovestream=null,f.prototype.onsignalingstatechange=null,f.prototype.oniceconnectionstatechange=null,f.prototype.onconnectionstatechange=null,f.prototype.onicegatheringstatechange=null,f.prototype.onnegotiationneeded=null,f.prototype.ondatachannel=null,f.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},f.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},f.prototype.getConfiguration=function(){return this._config},f.prototype.getLocalStreams=function(){return this.localStreams},f.prototype.getRemoteStreams=function(){return this.remoteStreams},f.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var a=this._createIceAndDtlsTransports();n.iceTransport=a.iceTransport,n.dtlsTransport=a.dtlsTransport}return t||this.transceivers.push(n),n},f.prototype.addTrack=function(e,t){if(this._isClosed)throw o("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find(function(t){return t.track===e}))throw o("InvalidAccessError","Track already exists.");for(var n=0;n<this.transceivers.length;n++)this.transceivers[n].track||this.transceivers[n].kind!==e.kind||(r=this.transceivers[n]);return r||(r=this._createTransceiver(e.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(t)&&this.localStreams.push(t),r.track=e,r.stream=t,r.rtpSender=new c.RTCRtpSender(e,r.dtlsTransport),r.rtpSender},f.prototype.addStream=function(e){var t=this;if(d>=15025)e.getTracks().forEach(function(r){t.addTrack(r,e)});else{var r=e.clone();e.getTracks().forEach(function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),r.getTracks().forEach(function(e){t.addTrack(e,r)})}},f.prototype.removeTrack=function(e){if(this._isClosed)throw o("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(e instanceof c.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var t=this.transceivers.find(function(t){return t.rtpSender===e});if(!t)throw o("InvalidAccessError","Sender was not created by this connection.");var r=t.stream;t.rtpSender.stop(),t.rtpSender=null,t.track=null,t.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},f.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var r=t.getSenders().find(function(t){return t.track===e});r&&t.removeTrack(r)})},f.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},f.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},f.prototype._createIceGatherer=function(e,t){var r=this;if(t&&e>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var n=new c.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(n,"state",{value:"new",writable:!0}),this.transceivers[e].bufferedCandidateEvents=[],this.transceivers[e].bufferCandidates=function(t){var a=!t.candidate||0===Object.keys(t.candidate).length;n.state=a?"completed":"gathering",null!==r.transceivers[e].bufferedCandidateEvents&&r.transceivers[e].bufferedCandidateEvents.push(t)},n.addEventListener("localcandidate",this.transceivers[e].bufferCandidates),n},f.prototype._gather=function(t,r){var n=this,a=this.transceivers[r].iceGatherer;if(!a.onlocalcandidate){var i=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),a.onlocalcandidate=function(i){if(!(n.usingBundle&&r>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:r};var o=i.candidate,c=!o||0===Object.keys(o).length;if(c)"new"!==a.state&&"gathering"!==a.state||(a.state="completed");else{"new"===a.state&&(a.state="gathering"),o.component=1,o.ufrag=a.getLocalParameters().usernameFragment;var d=e.writeCandidate(o);s.candidate=Object.assign(s.candidate,e.parseCandidate(d)),s.candidate.candidate=d,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var p=e.getMediaSections(n._localDescription.sdp);p[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",n._localDescription.sdp=e.getDescription(n._localDescription.sdp)+p.join("");var l=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==n.iceGatheringState&&(n.iceGatheringState="gathering",n._emitGatheringStateChange()),c||n._dispatchEvent("icecandidate",s),l&&(n._dispatchEvent("icecandidate",new Event("icecandidate")),n.iceGatheringState="complete",n._emitGatheringStateChange())}},c.setTimeout(function(){i.forEach(function(e){a.onlocalcandidate(e)})},0)}},f.prototype._createIceAndDtlsTransports=function(){var e=this,t=new c.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var r=new c.RTCDtlsTransport(t);return r.ondtlsstatechange=function(){e._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:r}},f.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},f.prototype._transceive=function(t,r,n){var i=a(t.localCapabilities,t.remoteCapabilities);r&&t.rtpSender&&(i.encodings=t.sendEncodingParameters,i.rtcp={cname:e.localCName,compound:t.rtcpParameters.compound},t.recvEncodingParameters.length&&(i.rtcp.ssrc=t.recvEncodingParameters[0].ssrc),t.rtpSender.send(i)),n&&t.rtpReceiver&&i.codecs.length>0&&("video"===t.kind&&t.recvEncodingParameters&&d<15019&&t.recvEncodingParameters.forEach(function(e){delete e.rtx}),t.recvEncodingParameters.length?i.encodings=t.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:t.rtcpParameters.compound},t.rtcpParameters.cname&&(i.rtcp.cname=t.rtcpParameters.cname),t.sendEncodingParameters.length&&(i.rtcp.ssrc=t.sendEncodingParameters[0].ssrc),t.rtpReceiver.receive(i))},f.prototype.setLocalDescription=function(t){var r,n,s=this;if(-1===["offer","answer"].indexOf(t.type))return Promise.reject(o("TypeError",'Unsupported type "'+t.type+'"'));if(!i("setLocalDescription",t.type,s.signalingState)||s._isClosed)return Promise.reject(o("InvalidStateError","Can not set local "+t.type+" in state "+s.signalingState));if("offer"===t.type)r=e.splitSections(t.sdp),n=r.shift(),r.forEach(function(t,r){var n=e.parseRtpParameters(t);s.transceivers[r].localCapabilities=n}),s.transceivers.forEach(function(e,t){s._gather(e.mid,t)});else if("answer"===t.type){r=e.splitSections(s._remoteDescription.sdp),n=r.shift();var c=e.matchPrefix(n,"a=ice-lite").length>0;r.forEach(function(t,r){var i=s.transceivers[r],o=i.iceGatherer,d=i.iceTransport,p=i.dtlsTransport,l=i.localCapabilities,f=i.remoteCapabilities;if(!(e.isRejected(t)&&0===e.matchPrefix(t,"a=bundle-only").length)&&!i.rejected){var u=e.getIceParameters(t,n),v=e.getDtlsParameters(t,n);c&&(v.role="server"),s.usingBundle&&0!==r||(s._gather(i.mid,r),"new"===d.state&&d.start(o,u,c?"controlling":"controlled"),"new"===p.state&&p.start(v));var h=a(l,f);s._transceive(i,h.codecs.length>0,!1)}})}return s._localDescription={type:t.type,sdp:t.sdp},"offer"===t.type?s._updateSignalingState("have-local-offer"):s._updateSignalingState("stable"),Promise.resolve()},f.prototype.setRemoteDescription=function(t){var r=this;if(-1===["offer","answer"].indexOf(t.type))return Promise.reject(o("TypeError",'Unsupported type "'+t.type+'"'));if(!i("setRemoteDescription",t.type,r.signalingState)||r._isClosed)return Promise.reject(o("InvalidStateError","Can not set remote "+t.type+" in state "+r.signalingState));var n={};r.remoteStreams.forEach(function(e){n[e.id]=e});var f=[],u=e.splitSections(t.sdp),v=u.shift(),h=e.matchPrefix(v,"a=ice-lite").length>0,m=e.matchPrefix(v,"a=group:BUNDLE ").length>0;r.usingBundle=m;var g=e.matchPrefix(v,"a=ice-options:")[0];return r.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,u.forEach(function(i,o){var l=e.splitLines(i),u=e.getKind(i),g=e.isRejected(i)&&0===e.matchPrefix(i,"a=bundle-only").length,y=l[0].substr(2).split(" ")[2],S=e.getDirection(i,v),T=e.parseMsid(i),E=e.getMid(i)||e.generateIdentifier();if(g||"application"===u&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))r.transceivers[o]={mid:E,kind:u,protocol:y,rejected:!0};else{var C,P,w,R,_,k,b,x,D;!g&&r.transceivers[o]&&r.transceivers[o].rejected&&(r.transceivers[o]=r._createTransceiver(u,!0));var I,L,M=e.parseRtpParameters(i);g||(I=e.getIceParameters(i,v),(L=e.getDtlsParameters(i,v)).role="client"),b=e.parseRtpEncodingParameters(i);var O=e.parseRtcpParameters(i),G=e.matchPrefix(i,"a=end-of-candidates",v).length>0,j=e.matchPrefix(i,"a=candidate:").map(function(t){return e.parseCandidate(t)}).filter(function(e){return 1===e.component});if(("offer"===t.type||"answer"===t.type)&&!g&&m&&o>0&&r.transceivers[o]&&(r._disposeIceAndDtlsTransports(o),r.transceivers[o].iceGatherer=r.transceivers[0].iceGatherer,r.transceivers[o].iceTransport=r.transceivers[0].iceTransport,r.transceivers[o].dtlsTransport=r.transceivers[0].dtlsTransport,r.transceivers[o].rtpSender&&r.transceivers[o].rtpSender.setTransport(r.transceivers[0].dtlsTransport),r.transceivers[o].rtpReceiver&&r.transceivers[o].rtpReceiver.setTransport(r.transceivers[0].dtlsTransport)),"offer"!==t.type||g){if("answer"===t.type&&!g){P=(C=r.transceivers[o]).iceGatherer,w=C.iceTransport,R=C.dtlsTransport,_=C.rtpReceiver,k=C.sendEncodingParameters,x=C.localCapabilities,r.transceivers[o].recvEncodingParameters=b,r.transceivers[o].remoteCapabilities=M,r.transceivers[o].rtcpParameters=O,j.length&&"new"===w.state&&(!h&&!G||m&&0!==o?j.forEach(function(e){s(C.iceTransport,e)}):w.setRemoteCandidates(j)),m&&0!==o||("new"===w.state&&w.start(P,I,"controlling"),"new"===R.state&&R.start(L)),!a(C.localCapabilities,C.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&C.sendEncodingParameters[0].rtx&&delete C.sendEncodingParameters[0].rtx,r._transceive(C,"sendrecv"===S||"recvonly"===S,"sendrecv"===S||"sendonly"===S),!_||"sendrecv"!==S&&"sendonly"!==S?delete C.rtpReceiver:(D=_.track,T?(n[T.stream]||(n[T.stream]=new c.MediaStream),p(D,n[T.stream]),f.push([D,_,n[T.stream]])):(n.default||(n.default=new c.MediaStream),p(D,n.default),f.push([D,_,n.default])))}}else{(C=r.transceivers[o]||r._createTransceiver(u)).mid=E,C.iceGatherer||(C.iceGatherer=r._createIceGatherer(o,m)),j.length&&"new"===C.iceTransport.state&&(!G||m&&0!==o?j.forEach(function(e){s(C.iceTransport,e)}):C.iceTransport.setRemoteCandidates(j)),x=c.RTCRtpReceiver.getCapabilities(u),d<15019&&(x.codecs=x.codecs.filter(function(e){return"rtx"!==e.name})),k=C.sendEncodingParameters||[{ssrc:1001*(2*o+2)}];var N,A=!1;if("sendrecv"===S||"sendonly"===S){if(A=!C.rtpReceiver,_=C.rtpReceiver||new c.RTCRtpReceiver(C.dtlsTransport,u),A)D=_.track,T&&"-"===T.stream||(T?(n[T.stream]||(n[T.stream]=new c.MediaStream,Object.defineProperty(n[T.stream],"id",{get:function(){return T.stream}})),Object.defineProperty(D,"id",{get:function(){return T.track}}),N=n[T.stream]):(n.default||(n.default=new c.MediaStream),N=n.default)),N&&(p(D,N),C.associatedRemoteMediaStreams.push(N)),f.push([D,_,N])}else C.rtpReceiver&&C.rtpReceiver.track&&(C.associatedRemoteMediaStreams.forEach(function(e){var t,r,n=e.getTracks().find(function(e){return e.id===C.rtpReceiver.track.id});n&&(t=n,(r=e).removeTrack(t),r.dispatchEvent(new c.MediaStreamTrackEvent("removetrack",{track:t})))}),C.associatedRemoteMediaStreams=[]);C.localCapabilities=x,C.remoteCapabilities=M,C.rtpReceiver=_,C.rtcpParameters=O,C.sendEncodingParameters=k,C.recvEncodingParameters=b,r._transceive(r.transceivers[o],!1,A)}}}),void 0===r._dtlsRole&&(r._dtlsRole="offer"===t.type?"active":"passive"),r._remoteDescription={type:t.type,sdp:t.sdp},"offer"===t.type?r._updateSignalingState("have-remote-offer"):r._updateSignalingState("stable"),Object.keys(n).forEach(function(e){var t=n[e];if(t.getTracks().length){if(-1===r.remoteStreams.indexOf(t)){r.remoteStreams.push(t);var a=new Event("addstream");a.stream=t,c.setTimeout(function(){r._dispatchEvent("addstream",a)})}f.forEach(function(e){var n=e[0],a=e[1];t.id===e[2].id&&l(r,n,a,[t])})}}),f.forEach(function(e){e[2]||l(r,e[0],e[1],[])}),c.setTimeout(function(){r&&r.transceivers&&r.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},f.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},f.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},f.prototype._maybeFireNegotiationNeeded=function(){var e=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,c.setTimeout(function(){if(e.needNegotiation){e.needNegotiation=!1;var t=new Event("negotiationneeded");e._dispatchEvent("negotiationneeded",t)}},0))},f.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},f.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},f.prototype.createOffer=function(){var t=this;if(t._isClosed)return Promise.reject(o("InvalidStateError","Can not call createOffer after close"));var n=t.transceivers.filter(function(e){return"audio"===e.kind}).length,a=t.transceivers.filter(function(e){return"video"===e.kind}).length,i=arguments[0];if(i){if(i.mandatory||i.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==i.offerToReceiveAudio&&(n=!0===i.offerToReceiveAudio?1:!1===i.offerToReceiveAudio?0:i.offerToReceiveAudio),void 0!==i.offerToReceiveVideo&&(a=!0===i.offerToReceiveVideo?1:!1===i.offerToReceiveVideo?0:i.offerToReceiveVideo)}for(t.transceivers.forEach(function(e){"audio"===e.kind?--n<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)});n>0||a>0;)n>0&&(t._createTransceiver("audio"),n--),a>0&&(t._createTransceiver("video"),a--);var s=e.writeSessionBoilerplate(t._sdpSessionId,t._sdpSessionVersion++);t.transceivers.forEach(function(r,n){var a=r.track,i=r.kind,s=r.mid||e.generateIdentifier();r.mid=s,r.iceGatherer||(r.iceGatherer=t._createIceGatherer(n,t.usingBundle));var o=c.RTCRtpSender.getCapabilities(i);d<15019&&(o.codecs=o.codecs.filter(function(e){return"rtx"!==e.name})),o.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),o.headerExtensions.forEach(function(e){(r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var p=r.sendEncodingParameters||[{ssrc:1001*(2*n+1)}];a&&d>=15019&&"video"===i&&!p[0].rtx&&(p[0].rtx={ssrc:p[0].ssrc+1}),r.wantReceive&&(r.rtpReceiver=new c.RTCRtpReceiver(r.dtlsTransport,i)),r.localCapabilities=o,r.sendEncodingParameters=p}),"max-compat"!==t._config.bundlePolicy&&(s+="a=group:BUNDLE "+t.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n",t.transceivers.forEach(function(n,a){s+=r(n,n.localCapabilities,"offer",n.stream,t._dtlsRole),s+="a=rtcp-rsize\r\n",!n.iceGatherer||"new"===t.iceGatheringState||0!==a&&t.usingBundle||(n.iceGatherer.getLocalCandidates().forEach(function(t){t.component=1,s+="a="+e.writeCandidate(t)+"\r\n"}),"completed"===n.iceGatherer.state&&(s+="a=end-of-candidates\r\n"))});var p=new c.RTCSessionDescription({type:"offer",sdp:s});return Promise.resolve(p)},f.prototype.createAnswer=function(){var t=this;if(t._isClosed)return Promise.reject(o("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==t.signalingState&&"have-local-pranswer"!==t.signalingState)return Promise.reject(o("InvalidStateError","Can not call createAnswer in signalingState "+t.signalingState));var n=e.writeSessionBoilerplate(t._sdpSessionId,t._sdpSessionVersion++);t.usingBundle&&(n+="a=group:BUNDLE "+t.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),n+="a=ice-options:trickle\r\n";var i=e.getMediaSections(t._remoteDescription.sdp).length;t.transceivers.forEach(function(e,s){if(!(s+1>i)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?n+="m=application 0 DTLS/SCTP 5000\r\n":n+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?n+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(n+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(n+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var o;if(e.stream)"audio"===e.kind?o=e.stream.getAudioTracks()[0]:"video"===e.kind&&(o=e.stream.getVideoTracks()[0]),o&&d>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var c=a(e.localCapabilities,e.remoteCapabilities);!c.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,n+=r(e,c,"answer",e.stream,t._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(n+="a=rtcp-rsize\r\n")}});var s=new c.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(s)},f.prototype.addIceCandidate=function(t){var r,n=this;return t&&void 0===t.sdpMLineIndex&&!t.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(a,i){if(!n._remoteDescription)return i(o("InvalidStateError","Can not add ICE candidate without a remote description"));if(t&&""!==t.candidate){var c=t.sdpMLineIndex;if(t.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===t.sdpMid){c=d;break}var p=n.transceivers[c];if(!p)return i(o("OperationError","Can not add ICE candidate"));if(p.rejected)return a();var l=Object.keys(t.candidate).length>0?e.parseCandidate(t.candidate):{};if("tcp"===l.protocol&&(0===l.port||9===l.port))return a();if(l.component&&1!==l.component)return a();if((0===c||c>0&&p.iceTransport!==n.transceivers[0].iceTransport)&&!s(p.iceTransport,l))return i(o("OperationError","Can not add ICE candidate"));var f=t.candidate.trim();0===f.indexOf("a=")&&(f=f.substr(2)),(r=e.getMediaSections(n._remoteDescription.sdp))[c]+="a="+(l.type?f:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=e.getDescription(n._remoteDescription.sdp)+r.join("")}else for(var u=0;u<n.transceivers.length&&(n.transceivers[u].rejected||(n.transceivers[u].iceTransport.addRemoteCandidate({}),(r=e.getMediaSections(n._remoteDescription.sdp))[u]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=e.getDescription(n._remoteDescription.sdp)+r.join(""),!n.usingBundle));u++);a()})},f.prototype.getStats=function(e){if(e&&e instanceof c.MediaStreamTrack){var t=null;if(this.transceivers.forEach(function(r){r.rtpSender&&r.rtpSender.track===e?t=r.rtpSender:r.rtpReceiver&&r.rtpReceiver.track===e&&(t=r.rtpReceiver)}),!t)throw o("InvalidAccessError","Invalid selector.");return t.getStats()}var r=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&r.push(e[t].getStats())})}),Promise.all(r).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(e){var r=c[e];if(r&&r.prototype&&r.prototype.getStats){var n=r.prototype.getStats;r.prototype.getStats=function(){return n.apply(this).then(function(e){var r=new Map;return Object.keys(e).forEach(function(n){e[n].type=t(e[n]),r.set(n,e[n])}),r})}}});var u=["createOffer","createAnswer"];return u.forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(u=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),f};
},{"sdp":"YHvh"}],"YdKx":[function(require,module,exports) {
"use strict";function e(e){var r=e&&e.navigator,t=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return t(e).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetUserMedia=e;
},{}],"P3bV":[function(require,module,exports) {
"use strict";function e(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetDisplayMedia=e;
},{}],"XRic":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimPeerConnection=a,exports.shimReplaceTrack=p,Object.defineProperty(exports,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}}),Object.defineProperty(exports,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}});var e=s(require("../utils")),t=require("./filtericeservers"),r=o(require("rtcpeerconnection-shim")),n=require("./getusermedia"),i=require("./getdisplaymedia");function o(e){return e&&e.__esModule?e:{default:e}}function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function s(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}function a(n){var i=e.detectBrowser(n);if(n.RTCIceGatherer&&(n.RTCIceCandidate||(n.RTCIceCandidate=function(e){return e}),n.RTCSessionDescription||(n.RTCSessionDescription=function(e){return e}),i.version<15025)){var o=Object.getOwnPropertyDescriptor(n.MediaStreamTrack.prototype,"enabled");Object.defineProperty(n.MediaStreamTrack.prototype,"enabled",{set:function(e){o.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!n.RTCRtpSender||"dtmf"in n.RTCRtpSender.prototype||Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new n.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),n.RTCDtmfSender&&!n.RTCDTMFSender&&(n.RTCDTMFSender=n.RTCDtmfSender);var c=(0,r.default)(n,i.version);n.RTCPeerConnection=function(r){return r&&r.iceServers&&(r.iceServers=(0,t.filterIceServers)(r.iceServers,i.version),e.log("ICE servers after filtering:",r.iceServers)),new c(r)},n.RTCPeerConnection.prototype=c.prototype}function p(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}
},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],"GzSv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetUserMedia=n;var e=o(require("../utils"));function t(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return t=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var o=t();if(o&&o.has(e))return o.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,o&&o.set(e,r),r}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(t){var o=e.detectBrowser(t),n=t&&t.navigator,i=t&&t.MediaStreamTrack;if(n.getUserMedia=function(t,o,r){e.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(t).then(o,r)},!(o.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,o){t in e&&!(o in e)&&(e[o]=e[t],delete e[t])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===r(e)&&"object"===r(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},i&&i.prototype.getSettings){var p=i.prototype.getSettings;i.prototype.getSettings=function(){var e=p.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(i&&i.prototype.applyConstraints){var u=i.prototype.applyConstraints;i.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===r(e)&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[e])}}}}
},{"../utils":"iSxC"}],"UuGU":[function(require,module,exports) {
"use strict";function e(e,i){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(a){if(!a||!a.video){var t=new DOMException("getDisplayMedia without video constraints is undefined");return t.name="NotFoundError",t.code=8,Promise.reject(t)}return!0===a.video?a.video={mediaSource:i}:a.video.mediaSource=i,e.navigator.mediaDevices.getUserMedia(a)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimGetDisplayMedia=e;
},{}],"Fzdr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimOnTrack=c,exports.shimPeerConnection=s,exports.shimSenderGetStats=p,exports.shimReceiverGetStats=u,exports.shimRemoveStream=f,exports.shimRTCDataChannel=C,exports.shimAddTransceiver=d,exports.shimCreateOffer=y,exports.shimCreateAnswer=l,Object.defineProperty(exports,"shimGetUserMedia",{enumerable:!0,get:function(){return t.shimGetUserMedia}}),Object.defineProperty(exports,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r.shimGetDisplayMedia}});var e=o(require("../utils")),t=require("./getusermedia"),r=require("./getdisplaymedia");function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){"object"===a(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function s(t){var r=e.detectBrowser(t);if("object"===a(t)&&(t.RTCPeerConnection||t.mozRTCPeerConnection)){if(!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var r=t.RTCPeerConnection.prototype[e],n=i({},e,function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)});t.RTCPeerConnection.prototype[e]=n[e]}),r.version<68){var n=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},c=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){var[e,t,n]=arguments;return c.apply(this,[e||null]).then(function(e){if(r.version<53&&!t)try{e.forEach(function(e){e.type=o[e.type]||e.type})}catch(n){if("TypeError"!==n.name)throw n;e.forEach(function(t,r){e.set(r,Object.assign({},t,{type:o[t.type]||t.type}))})}return e}).then(t,n)}}}function p(e){if("object"===a(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach(function(t){return t._pc=e}),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function u(t){if("object"===a(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&!(t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)){var r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=r.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t}),e.wrapPeerConnectionEvent(t,"track",function(e){return e.receiver._pc=e.srcElement,e}),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function f(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){var r=this;e.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&r.removeTrack(e)})})}function C(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function d(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],r=e&&"sendEncodings"in e;r&&e.sendEncodings.forEach(function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});var n=t.apply(this,arguments);if(r){var{sender:o}=n,i=o.getParameters();"encodings"in i||(i.encodings=e.sendEncodings,this.setParametersPromises.push(o.setParameters(i).catch(function(){})))}return n})}}function y(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,r=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return t.apply(r,e)}).finally(function(){r.setParametersPromises=[]}):t.apply(this,arguments)}}}function l(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,r=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return t.apply(r,e)}).finally(function(){r.setParametersPromises=[]}):t.apply(this,arguments)}}}
},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],"t1lL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimLocalStreamsAPI=n,exports.shimRemoteStreamsAPI=i,exports.shimCallbacksAPI=a,exports.shimGetUserMedia=s,exports.shimConstraints=c,exports.shimRTCIceServerUrls=d,exports.shimTrackEventTransceiver=f,exports.shimCreateOfferLegacy=p;var e=r(require("../utils"));function t(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return t=function(){return e},e}function r(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=t();if(r&&r.has(e))return r.get(e);var o={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(o,i,a):o[i]=e[i]}return o.default=e,r&&r.set(e,o),o}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){if("object"===o(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(function(o){return t.call(r,o,e)}),e.getVideoTracks().forEach(function(o){return t.call(r,o,e)})},e.RTCPeerConnection.prototype.addTrack=function(e){var r=arguments[1];return r&&(this._localStreams?this._localStreams.includes(r)||this._localStreams.push(r):this._localStreams=[r]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var o=e.getTracks();this.getSenders().forEach(function(e){o.includes(e.track)&&t.removeTrack(e)})}})}}function i(e){if("object"===o(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}})}),t.apply(e,arguments)}}}function a(e){if("object"===o(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var o=arguments.length>=2?arguments[2]:arguments[0],n=r.apply(this,[o]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[r]);return t?(o.then(e,t),Promise.resolve()):o};var c=function(e,t,r){var o=i.apply(this,[e]);return r?(o.then(t,r),Promise.resolve()):o};t.setLocalDescription=c,c=function(e,t,r){var o=a.apply(this,[e]);return r?(o.then(t,r),Promise.resolve()):o},t.setRemoteDescription=c,c=function(e,t,r){var o=s.apply(this,[e]);return r?(o.then(t,r),Promise.resolve()):o},t.addIceCandidate=c}}function s(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,o=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return o(c(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,o){t.mediaDevices.getUserMedia(e).then(r,o)}.bind(t))}function c(t){return t&&void 0!==t.video?Object.assign({},t,{video:e.compactObject(t.video)}):t}function d(t){var r=t.RTCPeerConnection;t.RTCPeerConnection=function(t,o){if(t&&t.iceServers){for(var n=[],i=0;i<t.iceServers.length;i++){var a=t.iceServers[i];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(e.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,n.push(a)):n.push(t.iceServers[i])}t.iceServers=n}return new r(t,o)},t.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in t.RTCPeerConnection&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return r.generateCertificate}})}function f(e){"object"===o(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function p(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var o=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});!1===e.offerToReceiveVideo&&o?"sendrecv"===o.direction?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":"recvonly"===o.direction&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):!0!==e.offerToReceiveVideo||o||this.addTransceiver("video")}return t.apply(this,arguments)}}
},{"../utils":"iSxC"}],"GOQK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shimRTCIceCandidate=a,exports.shimMaxMessageSize=c,exports.shimSendThrowTypeError=s,exports.shimConnectionState=p,exports.removeAllowExtmapMixed=u;var e=r(require("sdp")),t=o(require("./utils"));function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(o,i,a):o[i]=e[i]}return o.default=e,t&&t.set(e,o),o}function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(n){if(n.RTCIceCandidate&&!(n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)){var o=n.RTCIceCandidate;n.RTCIceCandidate=function(t){if("object"===i(t)&&t.candidate&&0===t.candidate.indexOf("a=")&&((t=JSON.parse(JSON.stringify(t))).candidate=t.candidate.substr(2)),t.candidate&&t.candidate.length){var n=new o(t),r=e.default.parseCandidate(t.candidate),a=Object.assign(n,r);return a.toJSON=function(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new o(t)},n.RTCIceCandidate.prototype=o.prototype,t.wrapPeerConnectionEvent(n,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new n.RTCIceCandidate(e.candidate),writable:"false"}),e})}}function c(n){if(n.RTCPeerConnection){var o=t.detectBrowser(n);"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===o.browser&&o.version>=76){var{sdpSemantics:t}=this.getConfiguration();"plan-b"===t&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(t){if(!t||!t.sdp)return!1;var n=e.default.splitSections(t.sdp);return n.shift(),n.some(function(t){var n=e.default.parseMLine(t);return n&&"application"===n.kind&&-1!==n.protocol.indexOf("SCTP")})}(arguments[0])){var n,i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),a=(p=i,u=65536,"firefox"===o.browser&&(u=o.version<57?-1===p?16384:2147483637:o.version<60?57===o.version?65535:65536:2147483637),u),c=function(t,n){var r=65536;"firefox"===o.browser&&57===o.version&&(r=65535);var i=e.default.matchPrefix(t.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===o.browser&&-1!==n&&(r=2147483637),r}(arguments[0],i);n=0===a&&0===c?Number.POSITIVE_INFINITY:0===a||0===c?Math.max(a,c):Math.min(a,c);var s={};Object.defineProperty(s,"maxMessageSize",{get:function(){return n}}),this._sctp=s}var p,u;return r.apply(this,arguments)}}}function s(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=n.apply(this,arguments);return o(e,this),e},t.wrapPeerConnectionEvent(e,"datachannel",function(e){return o(e.channel,e.target),e})}function o(e,t){var n=e.send;e.send=function(){var o=arguments[0],r=o.length||o.size||o.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}}function p(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}}function u(e){if(e.RTCPeerConnection){var n=t.detectBrowser(e);if(!("chrome"===n.browser&&n.version>=71)){var o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n")),o.apply(this,arguments)}}}}
},{"sdp":"YHvh","./utils":"iSxC"}],"KtlG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.adapterFactory=m;var e=o(require("./utils")),r=o(require("./chrome/chrome_shim")),i=o(require("./edge/edge_shim")),s=o(require("./firefox/firefox_shim")),t=o(require("./safari/safari_shim")),a=o(require("./common_shim"));function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n();if(r&&r.has(e))return r.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=s?Object.getOwnPropertyDescriptor(e,t):null;a&&(a.get||a.set)?Object.defineProperty(i,t,a):i[t]=e[t]}return i.default=e,r&&r.set(e,i),i}function m(){var{window:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},m=e.log,h=e.detectBrowser(n),d={browserDetails:h,commonShim:a,extractVersion:e.extractVersion,disableLog:e.disableLog,disableWarnings:e.disableWarnings};switch(h.browser){case"chrome":if(!r||!r.shimPeerConnection||!o.shimChrome)return m("Chrome shim is not included in this adapter release."),d;m("adapter.js shimming chrome."),d.browserShim=r,r.shimGetUserMedia(n),r.shimMediaStream(n),r.shimPeerConnection(n),r.shimOnTrack(n),r.shimAddTrackRemoveTrack(n),r.shimGetSendersWithDtmf(n),r.shimGetStats(n),r.shimSenderReceiverGetStats(n),r.fixNegotiationNeeded(n),a.shimRTCIceCandidate(n),a.shimConnectionState(n),a.shimMaxMessageSize(n),a.shimSendThrowTypeError(n),a.removeAllowExtmapMixed(n);break;case"firefox":if(!s||!s.shimPeerConnection||!o.shimFirefox)return m("Firefox shim is not included in this adapter release."),d;m("adapter.js shimming firefox."),d.browserShim=s,s.shimGetUserMedia(n),s.shimPeerConnection(n),s.shimOnTrack(n),s.shimRemoveStream(n),s.shimSenderGetStats(n),s.shimReceiverGetStats(n),s.shimRTCDataChannel(n),s.shimAddTransceiver(n),s.shimCreateOffer(n),s.shimCreateAnswer(n),a.shimRTCIceCandidate(n),a.shimConnectionState(n),a.shimMaxMessageSize(n),a.shimSendThrowTypeError(n);break;case"edge":if(!i||!i.shimPeerConnection||!o.shimEdge)return m("MS edge shim is not included in this adapter release."),d;m("adapter.js shimming edge."),d.browserShim=i,i.shimGetUserMedia(n),i.shimGetDisplayMedia(n),i.shimPeerConnection(n),i.shimReplaceTrack(n),a.shimMaxMessageSize(n),a.shimSendThrowTypeError(n);break;case"safari":if(!t||!o.shimSafari)return m("Safari shim is not included in this adapter release."),d;m("adapter.js shimming safari."),d.browserShim=t,t.shimRTCIceServerUrls(n),t.shimCreateOfferLegacy(n),t.shimCallbacksAPI(n),t.shimLocalStreamsAPI(n),t.shimRemoteStreamsAPI(n),t.shimTrackEventTransceiver(n),t.shimGetUserMedia(n),a.shimRTCIceCandidate(n),a.shimMaxMessageSize(n),a.shimSendThrowTypeError(n),a.removeAllowExtmapMixed(n);break;default:m("Unsupported browser!")}return d}
},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],"tI1X":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("./adapter_factory.js"),r=(0,e.adapterFactory)({window:window}),t=r;exports.default=t;
},{"./adapter_factory.js":"KtlG"}],"sXtV":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("webrtc-adapter"));exports.webRTCAdapter=t.default;
},{"webrtc-adapter":"tI1X"}],"I31f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("./adapter");exports.Supports=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e.prototype.isBrowserSupported=function(){var r=this.getBrowser(),e=this.getVersion();return!!this.supportedBrowsers.includes(r)&&("chrome"===r?e>=this.minChromeVersion:"firefox"===r?e>=this.minFirefoxVersion:"safari"===r&&(!this.isIOS&&e>=this.minSafariVersion))},e.prototype.getBrowser=function(){return r.webRTCAdapter.browserDetails.browser},e.prototype.getVersion=function(){return r.webRTCAdapter.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var e,i=this.getBrowser(),t=r.webRTCAdapter.browserDetails.version||0;if("chrome"===i&&t<72)return!1;if("firefox"===i&&t>=59)return!0;if(!(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype))return!1;var o=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),o=!0}catch(n){}finally{e&&e.close()}return o},e.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},e}());
},{"./adapter":"sXtV"}],"BHXf":[function(require,module,exports) {
"use strict";var r=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)Object.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,t};Object.defineProperty(exports,"__esModule",{value:!0});var t=r(require("peerjs-js-binarypack")),e=require("./supports"),o={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};exports.util=new(function(){function r(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=o,this.browser=e.Supports.getBrowser(),this.browserVersion=e.Supports.getVersion(),this.supports=function(){var r,t={browser:e.Supports.isBrowserSupported(),webRTC:e.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{r=new RTCPeerConnection(o),t.audioVideo=!0;var n=void 0;try{n=r.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!e.Supports.isIOS}catch(a){}}catch(a){}finally{n&&n.close()}}catch(a){}finally{r&&r.close()}return t}(),this.pack=t.pack,this.unpack=t.unpack,this._dataCount=1}return r.prototype.noop=function(){},r.prototype.validateId=function(r){return!r||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(r)},r.prototype.chunk=function(r){for(var t=[],e=r.size,o=Math.ceil(e/exports.util.chunkedMTU),n=0,a=0;a<e;){var i=Math.min(e,a+exports.util.chunkedMTU),s=r.slice(a,i),u={__peerData:this._dataCount,n:n,data:s,total:o};t.push(u),a=i,n++}return this._dataCount++,t},r.prototype.blobToArrayBuffer=function(r,t){var e=new FileReader;return e.onload=function(r){r.target&&t(r.target.result)},e.readAsArrayBuffer(r),e},r.prototype.binaryStringToArrayBuffer=function(r){for(var t=new Uint8Array(r.length),e=0;e<r.length;e++)t[e]=255&r.charCodeAt(e);return t.buffer},r.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},r.prototype.isSecure=function(){return"https:"===location.protocol},r}());
},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],"JJlS":[function(require,module,exports) {
"use strict";var e=Object.prototype.hasOwnProperty,t="~";function n(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,n,o,s,i){if("function"!=typeof o)throw new TypeError("The listener must be a function");var c=new r(o,s||e,i),f=t?t+n:n;return e._events[f]?e._events[f].fn?e._events[f]=[e._events[f],c]:e._events[f].push(c):(e._events[f]=c,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function i(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(t=!1)),i.prototype.eventNames=function(){var n,r,o=[];if(0===this._eventsCount)return o;for(r in n=this._events)e.call(n,r)&&o.push(t?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(n)):o},i.prototype.listeners=function(e){var n=t?t+e:e,r=this._events[n];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,s=r.length,i=new Array(s);o<s;o++)i[o]=r[o].fn;return i},i.prototype.listenerCount=function(e){var n=t?t+e:e,r=this._events[n];return r?r.fn?1:r.length:0},i.prototype.emit=function(e,n,r,o,s,i){var c=t?t+e:e;if(!this._events[c])return!1;var f,u,a=this._events[c],l=arguments.length;if(a.fn){switch(a.once&&this.removeListener(e,a.fn,void 0,!0),l){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,n),!0;case 3:return a.fn.call(a.context,n,r),!0;case 4:return a.fn.call(a.context,n,r,o),!0;case 5:return a.fn.call(a.context,n,r,o,s),!0;case 6:return a.fn.call(a.context,n,r,o,s,i),!0}for(u=1,f=new Array(l-1);u<l;u++)f[u-1]=arguments[u];a.fn.apply(a.context,f)}else{var v,h=a.length;for(u=0;u<h;u++)switch(a[u].once&&this.removeListener(e,a[u].fn,void 0,!0),l){case 1:a[u].fn.call(a[u].context);break;case 2:a[u].fn.call(a[u].context,n);break;case 3:a[u].fn.call(a[u].context,n,r);break;case 4:a[u].fn.call(a[u].context,n,r,o);break;default:if(!f)for(v=1,f=new Array(l-1);v<l;v++)f[v-1]=arguments[v];a[u].fn.apply(a[u].context,f)}}return!0},i.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},i.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},i.prototype.removeListener=function(e,n,r,o){var i=t?t+e:e;if(!this._events[i])return this;if(!n)return s(this,i),this;var c=this._events[i];if(c.fn)c.fn!==n||o&&!c.once||r&&c.context!==r||s(this,i);else{for(var f=0,u=[],a=c.length;f<a;f++)(c[f].fn!==n||o&&!c[f].once||r&&c[f].context!==r)&&u.push(c[f]);u.length?this._events[i]=1===u.length?u[0]:u:s(this,i)}return this},i.prototype.removeAllListeners=function(e){var r;return e?(r=t?t+e:e,this._events[r]&&s(this,r)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=t,i.EventEmitter=i,"undefined"!=typeof module&&(module.exports=i);
},{}],"WOs9":[function(require,module,exports) {
"use strict";var r=this&&this.__read||function(r,e){var o="function"==typeof Symbol&&r[Symbol.iterator];if(!o)return r;var t,n,l=o.call(r),i=[];try{for(;(void 0===e||e-- >0)&&!(t=l.next()).done;)i.push(t.value)}catch(s){n={error:s}}finally{try{t&&!t.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}return i},e=this&&this.__spread||function(){for(var e=[],o=0;o<arguments.length;o++)e=e.concat(r(arguments[o]));return e};Object.defineProperty(exports,"__esModule",{value:!0});var o,t="PeerJS: ";!function(r){r[r.Disabled=0]="Disabled",r[r.Errors=1]="Errors",r[r.Warnings=2]="Warnings",r[r.All=3]="All"}(o=exports.LogLevel||(exports.LogLevel={}));var n=function(){function r(){this._logLevel=o.Disabled}return Object.defineProperty(r.prototype,"logLevel",{get:function(){return this._logLevel},set:function(r){this._logLevel=r},enumerable:!0,configurable:!0}),r.prototype.log=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this._logLevel>=o.All&&this._print.apply(this,e([o.All],r))},r.prototype.warn=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this._logLevel>=o.Warnings&&this._print.apply(this,e([o.Warnings],r))},r.prototype.error=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this._logLevel>=o.Errors&&this._print.apply(this,e([o.Errors],r))},r.prototype.setLogFunction=function(r){this._print=r},r.prototype._print=function(r){for(var n=[],l=1;l<arguments.length;l++)n[l-1]=arguments[l];var i=e([t],n);for(var s in i)i[s]instanceof Error&&(i[s]="("+i[s].name+") "+i[s].message);r>=o.All?console.log.apply(console,e(i)):r>=o.Warnings?console.warn.apply(console,e(["WARNING"],i)):r>=o.Errors&&console.error.apply(console,e(["ERROR"],i))},r}();exports.default=new n;
},{}],"ZRYf":[function(require,module,exports) {
"use strict";var e,r,n,o,t,a,i;Object.defineProperty(exports,"__esModule",{value:!0}),function(e){e.Open="open",e.Stream="stream",e.Data="data",e.Close="close",e.Error="error",e.IceStateChanged="iceStateChanged"}(e=exports.ConnectionEventType||(exports.ConnectionEventType={})),function(e){e.Data="data",e.Media="media"}(r=exports.ConnectionType||(exports.ConnectionType={})),function(e){e.Open="open",e.Close="close",e.Connection="connection",e.Call="call",e.Disconnected="disconnected",e.Error="error"}(n=exports.PeerEventType||(exports.PeerEventType={})),function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"}(o=exports.PeerErrorType||(exports.PeerErrorType={})),function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"}(t=exports.SerializationType||(exports.SerializationType={})),function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"}(a=exports.SocketEventType||(exports.SocketEventType={})),function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"}(i=exports.ServerMessageType||(exports.ServerMessageType={}));
},{}],"wJlv":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function s(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),t=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var s,o,r=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(c){o={error:c}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i},n=this&&this.__spread||function(){for(var e=[],n=0;n<arguments.length;n++)e=e.concat(t(arguments[n]));return e},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("eventemitter3"),i=o(require("./logger")),c=require("./enums"),a=function(t){function o(e,n,s,o,r,i){void 0===i&&(i=5e3);var c=t.call(this)||this;c.pingInterval=i,c._disconnected=!0,c._messagesQueue=[];var a=e?"wss://":"ws://";return c._baseUrl=a+n+":"+s+o+"peerjs?key="+r,c}return e(o,t),o.prototype.start=function(e,t){var n=this;this._id=e;var s=this._baseUrl+"&id="+e+"&token="+t;!this._socket&&this._disconnected&&(this._socket=new WebSocket(s),this._disconnected=!1,this._socket.onmessage=function(e){var t;try{t=JSON.parse(e.data),i.default.log("Server message received:",t)}catch(s){return void i.default.log("Invalid server message",e.data)}n.emit(c.SocketEventType.Message,t)},this._socket.onclose=function(e){n._disconnected||(i.default.log("Socket closed.",e),n._cleanup(),n._disconnected=!0,n.emit(c.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),i.default.log("Socket open"),n._scheduleHeartbeat())})},o.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout(function(){e._sendHeartbeat()},this.pingInterval)},o.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:c.ServerMessageType.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}else i.default.log("Cannot send heartbeat, because socket closed")},o.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},o.prototype._sendQueuedMessages=function(){var e,t,o=n(this._messagesQueue);this._messagesQueue=[];try{for(var r=s(o),i=r.next();!i.done;i=r.next()){var c=i.value;this.send(c)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},o.prototype.send=function(e){if(!this._disconnected)if(this._id)if(e.type){if(this._wsOpen()){var t=JSON.stringify(e);this._socket.send(t)}}else this.emit(c.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(e)},o.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},o.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},o}(r.EventEmitter);exports.Socket=a;
},{"eventemitter3":"JJlS","./logger":"WOs9","./enums":"ZRYf"}],"HCdX":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))(function(i,r){function c(e){try{s(o.next(e))}catch(n){r(n)}}function a(e){try{s(o.throw(e))}catch(n){r(n)}}function s(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(c,a)}s((o=o.apply(e,n||[])).next())})},t=this&&this.__generator||function(e,n){var t,o,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=n.call(e,c)}catch(a){r=[6,a],o=0}finally{t=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var i=require("./util"),r=o(require("./logger")),c=require("./enums"),a=function(){function o(e){this.connection=e}return o.prototype.startConnection=function(e){var n=this._startPeerConnection();if(this.connection.peerConnection=n,this.connection.type===c.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,n),e.originator){if(this.connection.type===c.ConnectionType.Data){var t=this.connection,o={ordered:!!e.reliable},i=n.createDataChannel(t.label,o);t.initialize(i)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},o.prototype._startPeerConnection=function(){r.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},o.prototype._setupListeners=function(e){var n=this,t=this.connection.peer,o=this.connection.connectionId,a=this.connection.type,s=this.connection.provider;r.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(r.default.log("Received ICE candidates for "+t+":",e.candidate),s.socket.send({type:c.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:a,connectionId:o},dst:t}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":r.default.log("iceConnectionState is failed, closing connections to "+t),n.connection.emit(c.ConnectionEventType.Error,new Error("Negotiation of connection to "+t+" failed.")),n.connection.close();break;case"closed":r.default.log("iceConnectionState is closed, closing connections to "+t),n.connection.emit(c.ConnectionEventType.Error,new Error("Connection to "+t+" closed.")),n.connection.close();break;case"disconnected":r.default.log("iceConnectionState changed to disconnected on the connection with "+t);break;case"completed":e.onicecandidate=i.util.noop}n.connection.emit(c.ConnectionEventType.IceStateChanged,e.iceConnectionState)},r.default.log("Listening for data channel"),e.ondatachannel=function(e){r.default.log("Received data channel");var n=e.channel;s.getConnection(t,o).initialize(n)},r.default.log("Listening for remote stream"),e.ontrack=function(e){r.default.log("Received remote stream");var i=e.streams[0],a=s.getConnection(t,o);if(a.type===c.ConnectionType.Media){var d=a;n._addStreamToMediaConnection(i,d)}}},o.prototype.cleanup=function(){r.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var n="closed"!==e.signalingState,t=!1;if(this.connection.type===c.ConnectionType.Data){var o=this.connection.dataChannel;o&&(t=!!o.readyState&&"closed"!==o.readyState)}(n||t)&&e.close()}},o.prototype._makeOffer=function(){return n(this,void 0,Promise,function(){var n,o,a,s,d,l,u;return t(this,function(t){switch(t.label){case 0:n=this.connection.peerConnection,o=this.connection.provider,t.label=1;case 1:return t.trys.push([1,7,,8]),[4,n.createOffer(this.connection.options.constraints)];case 2:a=t.sent(),r.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(a.sdp=this.connection.options.sdpTransform(a.sdp)||a.sdp),t.label=3;case 3:return t.trys.push([3,5,,6]),[4,n.setLocalDescription(a)];case 4:return t.sent(),r.default.log("Set localDescription:",a,"for:"+this.connection.peer),s={sdp:a,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:i.util.browser},this.connection.type===c.ConnectionType.Data&&(d=this.connection,s=e(e({},s),{label:d.label,reliable:d.reliable,serialization:d.serialization})),o.socket.send({type:c.ServerMessageType.Offer,payload:s,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(l=t.sent())&&(o.emitError(c.PeerErrorType.WebRTC,l),r.default.log("Failed to setLocalDescription, ",l)),[3,6];case 6:return[3,8];case 7:return u=t.sent(),o.emitError(c.PeerErrorType.WebRTC,u),r.default.log("Failed to createOffer, ",u),[3,8];case 8:return[2]}})})},o.prototype._makeAnswer=function(){return n(this,void 0,Promise,function(){var e,n,o,a,s;return t(this,function(t){switch(t.label){case 0:e=this.connection.peerConnection,n=this.connection.provider,t.label=1;case 1:return t.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:o=t.sent(),r.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(o.sdp=this.connection.options.sdpTransform(o.sdp)||o.sdp),t.label=3;case 3:return t.trys.push([3,5,,6]),[4,e.setLocalDescription(o)];case 4:return t.sent(),r.default.log("Set localDescription:",o,"for:"+this.connection.peer),n.socket.send({type:c.ServerMessageType.Answer,payload:{sdp:o,type:this.connection.type,connectionId:this.connection.connectionId,browser:i.util.browser},dst:this.connection.peer}),[3,6];case 5:return a=t.sent(),n.emitError(c.PeerErrorType.WebRTC,a),r.default.log("Failed to setLocalDescription, ",a),[3,6];case 6:return[3,8];case 7:return s=t.sent(),n.emitError(c.PeerErrorType.WebRTC,s),r.default.log("Failed to create answer, ",s),[3,8];case 8:return[2]}})})},o.prototype.handleSDP=function(e,o){return n(this,void 0,Promise,function(){var n,i,a,s;return t(this,function(t){switch(t.label){case 0:o=new RTCSessionDescription(o),n=this.connection.peerConnection,i=this.connection.provider,r.default.log("Setting remote description",o),a=this,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,n.setRemoteDescription(o)];case 2:return t.sent(),r.default.log("Set remoteDescription:"+e+" for:"+this.connection.peer),"OFFER"!==e?[3,4]:[4,a._makeAnswer()];case 3:t.sent(),t.label=4;case 4:return[3,6];case 5:return s=t.sent(),i.emitError(c.PeerErrorType.WebRTC,s),r.default.log("Failed to setRemoteDescription, ",s),[3,6];case 6:return[2]}})})},o.prototype.handleCandidate=function(e){return n(this,void 0,Promise,function(){var n,o,i,a,s,d;return t(this,function(t){switch(t.label){case 0:r.default.log("handleCandidate:",e),n=e.candidate,o=e.sdpMLineIndex,i=e.sdpMid,a=this.connection.peerConnection,s=this.connection.provider,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,a.addIceCandidate(new RTCIceCandidate({sdpMid:i,sdpMLineIndex:o,candidate:n}))];case 2:return t.sent(),r.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return d=t.sent(),s.emitError(c.PeerErrorType.WebRTC,d),r.default.log("Failed to handleCandidate, ",d),[3,4];case 4:return[2]}})})},o.prototype._addTracksToConnection=function(e,n){if(r.default.log("add tracks from stream "+e.id+" to peer connection"),!n.addTrack)return r.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(function(t){n.addTrack(t,e)})},o.prototype._addStreamToMediaConnection=function(e,n){r.default.log("add stream "+e.id+" to media connection "+n.connectionId),n.addStream(e)},o}();exports.Negotiator=a;
},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],"tQFK":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var e=require("eventemitter3"),r=function(e){function r(t,r,n){var o=e.call(this)||this;return o.peer=t,o.provider=r,o.options=n,o._open=!1,o.metadata=n.metadata,o}return t(r,e),Object.defineProperty(r.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),r}(e.EventEmitter);exports.BaseConnection=r;
},{"eventemitter3":"JJlS"}],"dbHP":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),t=this&&this.__assign||function(){return(t=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],r=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var n=require("./util"),i=r(require("./logger")),a=require("./negotiator"),s=require("./enums"),l=require("./baseconnection"),c=function(r){function l(e,t,o){var i=r.call(this,e,t,o)||this;return i._localStream=i.options._stream,i.connectionId=i.options.connectionId||l.ID_PREFIX+n.util.randomToken(),i._negotiator=new a.Negotiator(i),i._localStream&&i._negotiator.startConnection({_stream:i._localStream,originator:!0}),i}return e(l,r),Object.defineProperty(l.prototype,"type",{get:function(){return s.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),l.prototype.addStream=function(e){i.default.log("Receiving stream",e),this._remoteStream=e,r.prototype.emit.call(this,s.ConnectionEventType.Stream,e)},l.prototype.handleMessage=function(e){var t=e.type,o=e.payload;switch(e.type){case s.ServerMessageType.Answer:this._negotiator.handleSDP(t,o.sdp),this._open=!0;break;case s.ServerMessageType.Candidate:this._negotiator.handleCandidate(o.candidate);break;default:i.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},l.prototype.answer=function(e,r){var n,a;if(void 0===r&&(r={}),this._localStream)i.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,r&&r.sdpTransform&&(this.options.sdpTransform=r.sdpTransform),this._negotiator.startConnection(t(t({},this.options._payload),{_stream:e}));var s=this.provider._getMessages(this.connectionId);try{for(var l=o(s),c=l.next();!c.done;c=l.next()){var p=c.value;this.handleMessage(p)}}catch(u){n={error:u}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}this._open=!0}},l.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,r.prototype.emit.call(this,s.ConnectionEventType.Close))},l.ID_PREFIX="mc_",l}(l.BaseConnection);exports.MediaConnection=c;
},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],"GGp6":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("eventemitter3"),o=t(require("./logger")),n=function(t){function r(){var e=t.call(this)||this;return e.fileReader=new FileReader,e._queue=[],e._processing=!1,e.fileReader.onload=function(t){e._processing=!1,t.target&&e.emit("done",t.target.result),e.doNextTask()},e.fileReader.onerror=function(t){o.default.error("EncodingQueue error:",t),e._processing=!1,e.destroy(),e.emit("error",t)},e}return e(r,t),Object.defineProperty(r.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),r.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},r.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},r.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},r}(r.EventEmitter);exports.EncodingQueue=n;
},{"eventemitter3":"JJlS","./logger":"WOs9"}],"GBTQ":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),t=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var i=require("./util"),o=n(require("./logger")),r=require("./negotiator"),a=require("./enums"),s=require("./baseconnection"),u=require("./encodingQueue"),l=function(n){function s(e,t,l){var f=n.call(this,e,t,l)||this;return f.stringify=JSON.stringify,f.parse=JSON.parse,f._buffer=[],f._bufferSize=0,f._buffering=!1,f._chunkedData={},f._encodingQueue=new u.EncodingQueue,f.connectionId=f.options.connectionId||s.ID_PREFIX+i.util.randomToken(),f.label=f.options.label||f.connectionId,f.serialization=f.options.serialization||a.SerializationType.Binary,f.reliable=!!f.options.reliable,f._encodingQueue.on("done",function(e){f._bufferedSend(e)}),f._encodingQueue.on("error",function(){o.default.error("DC#"+f.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),f.close()}),f._negotiator=new r.Negotiator(f),f._negotiator.startConnection(f.options._payload||{originator:!0}),f}return e(s,n),Object.defineProperty(s.prototype,"type",{get:function(){return a.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),s.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},s.prototype._configureDataChannel=function(){var e=this;i.util.supports.binaryBlob&&!i.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){o.default.log("DC#"+e.connectionId+" dc connection success"),e._open=!0,e.emit(a.ConnectionEventType.Open)},this.dataChannel.onmessage=function(t){o.default.log("DC#"+e.connectionId+" dc onmessage:",t.data),e._handleDataMessage(t)},this.dataChannel.onclose=function(){o.default.log("DC#"+e.connectionId+" dc closed for:",e.peer),e.close()}},s.prototype._handleDataMessage=function(e){var t=this,o=e.data,r=o.constructor,s=o;if(this.serialization===a.SerializationType.Binary||this.serialization===a.SerializationType.BinaryUTF8){if(r===Blob)return void i.util.blobToArrayBuffer(o,function(e){var n=i.util.unpack(e);t.emit(a.ConnectionEventType.Data,n)});if(r===ArrayBuffer)s=i.util.unpack(o);else if(r===String){var u=i.util.binaryStringToArrayBuffer(o);s=i.util.unpack(u)}}else this.serialization===a.SerializationType.JSON&&(s=this.parse(o));s.__peerData?this._handleChunk(s):n.prototype.emit.call(this,a.ConnectionEventType.Data,s)},s.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=e.data,n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];var i=new Blob(n.data);this._handleDataMessage({data:i})}},s.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,n.prototype.emit.call(this,a.ConnectionEventType.Close))},s.prototype.send=function(e,t){if(this.open)if(this.serialization===a.SerializationType.JSON)this._bufferedSend(this.stringify(e));else if(this.serialization===a.SerializationType.Binary||this.serialization===a.SerializationType.BinaryUTF8){var o=i.util.pack(e);if(!t&&o.size>i.util.chunkedMTU)return void this._sendChunks(o);i.util.supports.binaryBlob?this._bufferedSend(o):this._encodingQueue.enque(o)}else this._bufferedSend(e);else n.prototype.emit.call(this,a.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},s.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},s.prototype._trySend=function(e){var t=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>s.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(function(){t._buffering=!1,t._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(n){return o.default.error("DC#:"+this.connectionId+" Error when sending:",n),this._buffering=!0,this.close(),!1}return!0},s.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},s.prototype._sendChunks=function(e){var n,r,a=i.util.chunk(e);o.default.log("DC#"+this.connectionId+" Try to send "+a.length+" chunks...");try{for(var s=t(a),u=s.next();!u.done;u=s.next()){var l=u.value;this.send(l,!0)}}catch(f){n={error:f}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},s.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case a.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case a.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:o.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},s.ID_PREFIX="dc_",s.MAX_BUFFERED_AMOUNT=8388608,s}(s.BaseConnection);exports.DataConnection=l;
},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],"in7L":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,s){function i(t){try{a(o.next(t))}catch(e){s(e)}}function u(t){try{a(o.throw(t))}catch(e){s(e)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,u)}a((o=o.apply(t,e||[])).next())})},e=this&&this.__generator||function(t,e){var r,o,n,s,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){i.label=s[1];break}if(6===s[0]&&i.label<n[1]){i.label=n[1],n=s;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(s);break}n[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(u){s=[6,u],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var o=require("./util"),n=r(require("./logger")),s=function(){function r(t){this._options=t}return r.prototype._buildUrl=function(t){var e=(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+t;return e+="?ts="+(new Date).getTime()+Math.random()},r.prototype.retrieveId=function(){return t(this,void 0,Promise,function(){var t,r,s,i;return e(this,function(e){switch(e.label){case 0:t=this._buildUrl("id"),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200!==(r=e.sent()).status)throw new Error("Error. Status:"+r.status);return[2,r.text()];case 3:throw s=e.sent(),n.default.error("Error retrieving ID",s),i="","/"===this._options.path&&this._options.host!==o.util.CLOUD_HOST&&(i=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+i);case 4:return[2]}})})},r.prototype.listAllPeers=function(){return t(this,void 0,Promise,function(){var t,r,s,i;return e(this,function(e){switch(e.label){case 0:t=this._buildUrl("peers"),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200!==(r=e.sent()).status){if(401===r.status)throw s="",s=this._options.host===o.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+s);throw new Error("Error. Status:"+r.status)}return[2,r.json()];case 3:throw i=e.sent(),n.default.error("Error retrieving list peers",i),new Error("Could not get list peers from the server."+i);case 4:return[2]}})})},r}();exports.API=s;
},{"./util":"BHXf","./logger":"WOs9"}],"Hxpd":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),t=this&&this.__assign||function(){return(t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var i=require("eventemitter3"),s=require("./util"),a=o(require("./logger")),c=require("./socket"),l=require("./mediaconnection"),d=require("./dataconnection"),u=require("./enums"),p=require("./api"),h=function(){return function(){}}(),f=function(o){function i(e,n){var r,c=o.call(this)||this;return c._id=null,c._lastServerId=null,c._destroyed=!1,c._disconnected=!1,c._open=!1,c._connections=new Map,c._lostMessages=new Map,e&&e.constructor==Object?n=e:e&&(r=e.toString()),n=t({debug:0,host:s.util.CLOUD_HOST,port:s.util.CLOUD_PORT,path:"/",key:i.DEFAULT_KEY,token:s.util.randomToken(),config:s.util.defaultConfig},n),c._options=n,"/"===c._options.host&&(c._options.host=window.location.hostname),c._options.path&&("/"!==c._options.path[0]&&(c._options.path="/"+c._options.path),"/"!==c._options.path[c._options.path.length-1]&&(c._options.path+="/")),void 0===c._options.secure&&c._options.host!==s.util.CLOUD_HOST?c._options.secure=s.util.isSecure():c._options.host==s.util.CLOUD_HOST&&(c._options.secure=!0),c._options.logFunction&&a.default.setLogFunction(c._options.logFunction),a.default.logLevel=c._options.debug||0,c._api=new p.API(n),c._socket=c._createServerConnection(),s.util.supports.audioVideo||s.util.supports.data?r&&!s.util.validateId(r)?(c._delayedAbort(u.PeerErrorType.InvalidID,'ID "'+r+'" is invalid'),c):(r?c._initialize(r):c._api.retrieveId().then(function(e){return c._initialize(e)}).catch(function(e){return c._abort(u.PeerErrorType.ServerError,e)}),c):(c._delayedAbort(u.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),c)}return e(i,o),Object.defineProperty(i.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"connections",{get:function(){var e,t,o=Object.create(null);try{for(var i=n(this._connections),s=i.next();!s.done;s=i.next()){var a=r(s.value,2),c=a[0],l=a[1];o[c]=l}}catch(d){e={error:d}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return o},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),i.prototype._createServerConnection=function(){var e=this,t=new c.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(u.SocketEventType.Message,function(t){e._handleMessage(t)}),t.on(u.SocketEventType.Error,function(t){e._abort(u.PeerErrorType.SocketError,t)}),t.on(u.SocketEventType.Disconnected,function(){e.disconnected||(e.emitError(u.PeerErrorType.Network,"Lost connection to server."),e.disconnect())}),t.on(u.SocketEventType.Close,function(){e.disconnected||e._abort(u.PeerErrorType.SocketClosed,"Underlying socket is already closed.")}),t},i.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},i.prototype._handleMessage=function(e){var t,r,o=e.type,i=e.payload,s=e.src;switch(o){case u.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(u.PeerEventType.Open,this.id);break;case u.ServerMessageType.Error:this._abort(u.PeerErrorType.ServerError,i.msg);break;case u.ServerMessageType.IdTaken:this._abort(u.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case u.ServerMessageType.InvalidKey:this._abort(u.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case u.ServerMessageType.Leave:a.default.log("Received leave message from "+s),this._cleanupPeer(s),this._connections.delete(s);break;case u.ServerMessageType.Expire:this.emitError(u.PeerErrorType.PeerUnavailable,"Could not connect to peer "+s);break;case u.ServerMessageType.Offer:var c=i.connectionId;if((_=this.getConnection(s,c))&&(_.close(),a.default.warn("Offer received for existing Connection ID:"+c)),i.type===u.ConnectionType.Media)_=new l.MediaConnection(s,this,{connectionId:c,_payload:i,metadata:i.metadata}),this._addConnection(s,_),this.emit(u.PeerEventType.Call,_);else{if(i.type!==u.ConnectionType.Data)return void a.default.warn("Received malformed connection type:"+i.type);_=new d.DataConnection(s,this,{connectionId:c,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(s,_),this.emit(u.PeerEventType.Connection,_)}var p=this._getMessages(c);try{for(var h=n(p),f=h.next();!f.done;f=h.next()){var y=f.value;_.handleMessage(y)}}catch(v){t={error:v}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(t)throw t.error}}break;default:if(!i)return void a.default.warn("You received a malformed message from "+s+" of type "+o);var _;c=i.connectionId;(_=this.getConnection(s,c))&&_.peerConnection?_.handleMessage(e):c?this._storeMessage(c,e):a.default.warn("You received an unrecognized message:",e)}},i.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},i.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},i.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return a.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(u.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var n=new d.DataConnection(e,this,t);return this._addConnection(e,n),n},i.prototype.call=function(e,t,n){if(void 0===n&&(n={}),this.disconnected)return a.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(u.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){n._stream=t;var r=new l.MediaConnection(e,this,n);return this._addConnection(e,r),r}a.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},i.prototype._addConnection=function(e,t){a.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},i.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)},i.prototype.getConnection=function(e,t){var r,o,i=this._connections.get(e);if(!i)return null;try{for(var s=n(i),a=s.next();!a.done;a=s.next()){var c=a.value;if(c.connectionId===t)return c}}catch(l){r={error:l}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return null},i.prototype._delayedAbort=function(e,t){var n=this;setTimeout(function(){n._abort(e,t)},0)},i.prototype._abort=function(e,t){a.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},i.prototype.emitError=function(e,t){var n;a.default.error("Error:",t),(n="string"==typeof t?new Error(t):t).type=e,this.emit(u.PeerEventType.Error,n)},i.prototype.destroy=function(){this.destroyed||(a.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(u.PeerEventType.Close))},i.prototype._cleanup=function(){var e,t;try{for(var r=n(this._connections.keys()),o=r.next();!o.done;o=r.next()){var i=o.value;this._cleanupPeer(i),this._connections.delete(i)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}this.socket.removeAllListeners()},i.prototype._cleanupPeer=function(e){var t,r,o=this._connections.get(e);if(o)try{for(var i=n(o),s=i.next();!s.done;s=i.next()){s.value.close()}}catch(a){t={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},i.prototype.disconnect=function(){if(!this.disconnected){var e=this.id;a.default.log("Disconnect peer with ID:"+e),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit(u.PeerEventType.Disconnected,e)}},i.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)a.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");a.default.error("In a hurry? We're still trying to make the initial connection!")}},i.prototype.listAllPeers=function(e){var t=this;void 0===e&&(e=function(e){}),this._api.listAllPeers().then(function(t){return e(t)}).catch(function(e){return t._abort(u.PeerErrorType.ServerError,e)})},i.DEFAULT_KEY="peerjs",i}(i.EventEmitter);exports.Peer=f;
},{"eventemitter3":"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],"iTK6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./util"),r=require("./peer");exports.peerjs={Peer:r.Peer,util:e.util},exports.default=r.Peer,window.peerjs=exports.peerjs,window.Peer=r.Peer;
},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"], null)
//# sourceMappingURL=/peerjs.min.js.map
WL.registerComponent('playScene', {
    message: {type: WL.Type.String, default: "It was clicked!"},
    buttonMeshObject: {type: WL.Type.Object},
}, {
    start: function(dt) {
        /* Get a reference to the "cursor-target" component */
        const target = this.object.getComponent('cursor-target');
        this.buttonMeshObject.active = false;

        target.addClickFunction(this.onClick.bind(this));
    },

    onClick: function() {
        /* Print the message that was configured in the editor) */
        this.buttonMeshObject.children
        console.log(this.message);
    }
});
WL.registerComponent('playbook-toggle', {
    grey: {type: WL.Type.Material},
}, {
    init() {
        this.toggled = false;
    },
    start() {
        this.target = this.object.getComponent('cursor-target') || this.object.addComponent('cursor-target');
        this.collision = this.object.getComponent('collision') || this.object.addComponent('collision');
        this.collision.extents = [ 0.07, 0.04, 0.02 ];
        this.collision.collider = WL.Collider.AxisAlignedBox;
        this.collision.group = 0xF;
        this.collision.active = true;
        this.target.addClickFunction(this.onClick.bind(this));
        console.log(this.collision);

        const children = this.object.children;
        for(const c of children) {
            if(c.name == 'knob') this.knob = c;
        }
    },

    onClick() {
        // mute and unmute 
        
        this.toggled = !this.toggled;
        const moveAmount = 0.030;
        if(this.toggled) {
            //mute the audio 
            // grey the background 
            this.knob.translate([-moveAmount, 0, 0]);
        } else {
            // unmute the audio 
            // ungrey the background 
            this.knob.translate([moveAmount, 0, 0]);
        }
    }
});

WL.registerComponent('SceneOnSwitchComponent', {
    scenefile: {type: WL.Type.String, default: "Scene-Switch.bin"},
    
}, {
    start: function(dt) {
        this.object.getComponent("cursor-target").addClickFunction(() => {
            WL.scene.load(this.scenefile);
            console.log("Switching Scenes...");
        })
        
        
    },
});

WL.registerComponent('setEmoji', {
    param: {type: WL.Type.Float, default: 1.0},
},{
    init: function() {
        console.log('init() with param', this.param);
        var currentEmoji = 'devil'
    },
    start: function() {
        console.log('start() with param', this.param);
    },
    update: function(dt) {

    },
});

WL.registerComponent('skybox', {
    skyMat: {type: WL.Type.Material},
    light1: {type: WL.Type.Object},
    light2: {type: WL.Type.Object}


}, {
    init: function() {
       // console.log('init() with param', this.param);
    },
    start: function() {
       this.lightComponent  = this.light1.getComponent('light');
       this.lightComponent2  = this.light2.getComponent('light');

       // console.log('start() with param', this.param);
        this.target = this.object.getComponent('cursor-target') || this.object.addComponent('cursor-target');
        this.target.addClickFunction(this.onClick.bind(this));
    },
    update: function(dt) {
       // console.log('update() with delta time', dt);
 
    },
    onClick: function(){

        const c = Math.random()*1;
        const d = Math.random()*c;
        const e = Math.random()*d;
        this.skyMat.colorStop3=[0,0,0,1];
        this.skyMat.colorStop2=[e,d,c,1];
        this.skyMat.colorStop1=[e,d,c,1];
        this.skyMat.colorStop0=[1,1,1,1];

        this.lightComponent.color.set([e,d,c]);
        this.lightComponent2.color.set([d,e,c]);


    }
});

WL.registerComponent('spawn-cup', {
    cupMesh: {type: WL.Type.Mesh, default: null},
    cupMaterial:{type:WL.Type.Material, default:null},
    cupSpawnButton:{type: WL.Type.Object, default:null},
}, {
    init: function() {
        
    },
    start: function() {
        const cup = WL.scene.addObject(this.object);

        cup.addComponent('mesh', {
            mesh: this.cupMesh,
            material: this.cupMaterial,
          });
          
          cup.addComponent("physx",{
            shape:WL.Shape.Box,
            extents:[.1,.1,.1],
            kinematic:false,
            gravity: true,
            simulate:true,
          });

          cup.getComponent('mesh').active = true;

          this.cupSpawnButton.getComponent('cursor-target').addClickFunction(function(){if(cup.getComponent('mesh').active==true){
            cup.getComponent('mesh').active = false;
          } else{
            cup.getComponent("mesh").active = true;
          }})

          cup.rotateAxisAngleDegObject([1,0,0], -90) 
    },
    update: function(dt) {
        
    },
});

(()=>{var fn=Object.create;var $=Object.defineProperty;var Tn=Object.getOwnPropertyDescriptor;var bn=Object.getOwnPropertyNames;var Cn=Object.getPrototypeOf,Sn=Object.prototype.hasOwnProperty;var H=(e,t)=>()=>(e&&(t=e(e=0)),t);var T=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),q=(e,t)=>{for(var i in t)$(e,i,{get:t[i],enumerable:!0})},Ut=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of bn(t))!Sn.call(e,n)&&n!==i&&$(e,n,{get:()=>t[n],enumerable:!(s=Tn(t,n))||s.enumerable});return e};var pt=(e,t,i)=>(i=e!=null?fn(Cn(e)):{},Ut(t||!e||!e.__esModule?$(i,"default",{value:e,enumerable:!0}):i,e)),Q=e=>Ut($({},"__esModule",{value:!0}),e);var qt=T(()=>{PP={}});var F={};q(F,{ARRAY_TYPE:()=>D,EPSILON:()=>M,RANDOM:()=>w,equals:()=>Mn,setMatrixArrayType:()=>xn,toRadian:()=>Bn});function xn(e){D=e}function Bn(e){return e*vn}function Mn(e,t){return Math.abs(e-t)<=M*Math.max(1,Math.abs(e),Math.abs(t))}var M,D,w,vn,U=H(()=>{M=1e-6,D=typeof Float32Array<"u"?Float32Array:Array,w=Math.random;vn=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)})});var V={};q(V,{add:()=>Jn,adjoint:()=>Wn,clone:()=>Ln,copy:()=>Vn,create:()=>dt,determinant:()=>kn,equals:()=>ta,exactEquals:()=>$n,frob:()=>Kn,fromMat2d:()=>Un,fromMat4:()=>In,fromQuat:()=>qn,fromRotation:()=>Nn,fromScaling:()=>Gn,fromTranslation:()=>wn,fromValues:()=>An,identity:()=>Rn,invert:()=>On,mul:()=>ea,multiply:()=>zt,multiplyScalar:()=>Yn,multiplyScalarAndAdd:()=>Zn,normalFromMat4:()=>zn,projection:()=>Qn,rotate:()=>Fn,scale:()=>Hn,set:()=>Dn,str:()=>Xn,sub:()=>ia,subtract:()=>Qt,translate:()=>jn,transpose:()=>En});function dt(){var e=new D(9);return D!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function In(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function Ln(e){var t=new D(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Vn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function An(e,t,i,s,n,a,r,l,y){var c=new D(9);return c[0]=e,c[1]=t,c[2]=i,c[3]=s,c[4]=n,c[5]=a,c[6]=r,c[7]=l,c[8]=y,c}function Dn(e,t,i,s,n,a,r,l,y,c){return e[0]=t,e[1]=i,e[2]=s,e[3]=n,e[4]=a,e[5]=r,e[6]=l,e[7]=y,e[8]=c,e}function Rn(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function En(e,t){if(e===t){var i=t[1],s=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=s,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function On(e,t){var i=t[0],s=t[1],n=t[2],a=t[3],r=t[4],l=t[5],y=t[6],c=t[7],o=t[8],m=o*r-l*c,u=-o*a+l*y,h=c*a-r*y,_=i*m+s*u+n*h;return _?(_=1/_,e[0]=m*_,e[1]=(-o*s+n*c)*_,e[2]=(l*s-n*r)*_,e[3]=u*_,e[4]=(o*i-n*y)*_,e[5]=(-l*i+n*a)*_,e[6]=h*_,e[7]=(-c*i+s*y)*_,e[8]=(r*i-s*a)*_,e):null}function Wn(e,t){var i=t[0],s=t[1],n=t[2],a=t[3],r=t[4],l=t[5],y=t[6],c=t[7],o=t[8];return e[0]=r*o-l*c,e[1]=n*c-s*o,e[2]=s*l-n*r,e[3]=l*y-a*o,e[4]=i*o-n*y,e[5]=n*a-i*l,e[6]=a*c-r*y,e[7]=s*y-i*c,e[8]=i*r-s*a,e}function kn(e){var t=e[0],i=e[1],s=e[2],n=e[3],a=e[4],r=e[5],l=e[6],y=e[7],c=e[8];return t*(c*a-r*y)+i*(-c*n+r*l)+s*(y*n-a*l)}function zt(e,t,i){var s=t[0],n=t[1],a=t[2],r=t[3],l=t[4],y=t[5],c=t[6],o=t[7],m=t[8],u=i[0],h=i[1],_=i[2],P=i[3],p=i[4],g=i[5],b=i[6],C=i[7],x=i[8];return e[0]=u*s+h*r+_*c,e[1]=u*n+h*l+_*o,e[2]=u*a+h*y+_*m,e[3]=P*s+p*r+g*c,e[4]=P*n+p*l+g*o,e[5]=P*a+p*y+g*m,e[6]=b*s+C*r+x*c,e[7]=b*n+C*l+x*o,e[8]=b*a+C*y+x*m,e}function jn(e,t,i){var s=t[0],n=t[1],a=t[2],r=t[3],l=t[4],y=t[5],c=t[6],o=t[7],m=t[8],u=i[0],h=i[1];return e[0]=s,e[1]=n,e[2]=a,e[3]=r,e[4]=l,e[5]=y,e[6]=u*s+h*r+c,e[7]=u*n+h*l+o,e[8]=u*a+h*y+m,e}function Fn(e,t,i){var s=t[0],n=t[1],a=t[2],r=t[3],l=t[4],y=t[5],c=t[6],o=t[7],m=t[8],u=Math.sin(i),h=Math.cos(i);return e[0]=h*s+u*r,e[1]=h*n+u*l,e[2]=h*a+u*y,e[3]=h*r-u*s,e[4]=h*l-u*n,e[5]=h*y-u*a,e[6]=c,e[7]=o,e[8]=m,e}function Hn(e,t,i){var s=i[0],n=i[1];return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function wn(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Nn(e,t){var i=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=i,e[2]=0,e[3]=-i,e[4]=s,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Gn(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Un(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function qn(e,t){var i=t[0],s=t[1],n=t[2],a=t[3],r=i+i,l=s+s,y=n+n,c=i*r,o=s*r,m=s*l,u=n*r,h=n*l,_=n*y,P=a*r,p=a*l,g=a*y;return e[0]=1-m-_,e[3]=o-g,e[6]=u+p,e[1]=o+g,e[4]=1-c-_,e[7]=h-P,e[2]=u-p,e[5]=h+P,e[8]=1-c-m,e}function zn(e,t){var i=t[0],s=t[1],n=t[2],a=t[3],r=t[4],l=t[5],y=t[6],c=t[7],o=t[8],m=t[9],u=t[10],h=t[11],_=t[12],P=t[13],p=t[14],g=t[15],b=i*l-s*r,C=i*y-n*r,x=i*c-a*r,v=s*y-n*l,B=s*c-a*l,O=n*c-a*y,L=o*P-m*_,W=o*p-u*_,R=o*g-h*_,j=m*p-u*P,k=m*g-h*P,E=u*g-h*p,A=b*E-C*k+x*j+v*R-B*W+O*L;return A?(A=1/A,e[0]=(l*E-y*k+c*j)*A,e[1]=(y*R-r*E-c*W)*A,e[2]=(r*k-l*R+c*L)*A,e[3]=(n*k-s*E-a*j)*A,e[4]=(i*E-n*R+a*W)*A,e[5]=(s*R-i*k-a*L)*A,e[6]=(P*O-p*B+g*v)*A,e[7]=(p*x-_*O-g*C)*A,e[8]=(_*B-P*x+g*b)*A,e):null}function Qn(e,t,i){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/i,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Xn(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Kn(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function Jn(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e}function Qt(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e}function Yn(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e}function Zn(e,t,i,s){return e[0]=t[0]+i[0]*s,e[1]=t[1]+i[1]*s,e[2]=t[2]+i[2]*s,e[3]=t[3]+i[3]*s,e[4]=t[4]+i[4]*s,e[5]=t[5]+i[5]*s,e[6]=t[6]+i[6]*s,e[7]=t[7]+i[7]*s,e[8]=t[8]+i[8]*s,e}function $n(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function ta(e,t){var i=e[0],s=e[1],n=e[2],a=e[3],r=e[4],l=e[5],y=e[6],c=e[7],o=e[8],m=t[0],u=t[1],h=t[2],_=t[3],P=t[4],p=t[5],g=t[6],b=t[7],C=t[8];return Math.abs(i-m)<=M*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-u)<=M*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(n-h)<=M*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(a-_)<=M*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(r-P)<=M*Math.max(1,Math.abs(r),Math.abs(P))&&Math.abs(l-p)<=M*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(y-g)<=M*Math.max(1,Math.abs(y),Math.abs(g))&&Math.abs(c-b)<=M*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(o-C)<=M*Math.max(1,Math.abs(o),Math.abs(C))}var ea,ia,_t=H(()=>{U();ea=zt,ia=Qt});var S={};q(S,{add:()=>ja,adjoint:()=>ya,clone:()=>na,copy:()=>aa,create:()=>sa,determinant:()=>ua,equals:()=>Na,exactEquals:()=>wa,frob:()=>ka,fromQuat:()=>Ma,fromQuat2:()=>xa,fromRotation:()=>Ta,fromRotationTranslation:()=>Jt,fromRotationTranslationScale:()=>va,fromRotationTranslationScaleOrigin:()=>Ba,fromScaling:()=>fa,fromTranslation:()=>ga,fromValues:()=>oa,fromXRotation:()=>ba,fromYRotation:()=>Ca,fromZRotation:()=>Sa,frustum:()=>Ia,getRotation:()=>gt,getScaling:()=>Yt,getTranslation:()=>Pt,identity:()=>Xt,invert:()=>ma,lookAt:()=>Ea,mul:()=>Ga,multiply:()=>Kt,multiplyScalar:()=>Fa,multiplyScalarAndAdd:()=>Ha,ortho:()=>Da,orthoNO:()=>$t,orthoZO:()=>Ra,perspective:()=>La,perspectiveFromFieldOfView:()=>Aa,perspectiveNO:()=>Zt,perspectiveZO:()=>Va,rotate:()=>pa,rotateX:()=>da,rotateY:()=>_a,rotateZ:()=>Pa,scale:()=>ha,set:()=>ra,str:()=>Wa,sub:()=>Ua,subtract:()=>te,targetTo:()=>Oa,translate:()=>ca,transpose:()=>la});function sa(){var e=new D(16);return D!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function na(e){var t=new D(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function aa(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function oa(e,t,i,s,n,a,r,l,y,c,o,m,u,h,_,P){var p=new D(16);return p[0]=e,p[1]=t,p[2]=i,p[3]=s,p[4]=n,p[5]=a,p[6]=r,p[7]=l,p[8]=y,p[9]=c,p[10]=o,p[11]=m,p[12]=u,p[13]=h,p[14]=_,p[15]=P,p}function ra(e,t,i,s,n,a,r,l,y,c,o,m,u,h,_,P,p){return e[0]=t,e[1]=i,e[2]=s,e[3]=n,e[4]=a,e[5]=r,e[6]=l,e[7]=y,e[8]=c,e[9]=o,e[10]=m,e[11]=u,e[12]=h,e[13]=_,e[14]=P,e[15]=p,e}function Xt(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function la(e,t){if(e===t){var i=t[1],s=t[2],n=t[3],a=t[6],r=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=s,e[9]=a,e[11]=t[14],e[12]=n,e[13]=r,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function ma(e,t){var i=t[0],s=t[1],n=t[2],a=t[3],r=t[4],l=t[5],y=t[6],c=t[7],o=t[8],m=t[9],u=t[10],h=t[11],_=t[12],P=t[13],p=t[14],g=t[15],b=i*l-s*r,C=i*y-n*r,x=i*c-a*r,v=s*y-n*l,B=s*c-a*l,O=n*c-a*y,L=o*P-m*_,W=o*p-u*_,R=o*g-h*_,j=m*p-u*P,k=m*g-h*P,E=u*g-h*p,A=b*E-C*k+x*j+v*R-B*W+O*L;return A?(A=1/A,e[0]=(l*E-y*k+c*j)*A,e[1]=(n*k-s*E-a*j)*A,e[2]=(P*O-p*B+g*v)*A,e[3]=(u*B-m*O-h*v)*A,e[4]=(y*R-r*E-c*W)*A,e[5]=(i*E-n*R+a*W)*A,e[6]=(p*x-_*O-g*C)*A,e[7]=(o*O-u*x+h*C)*A,e[8]=(r*k-l*R+c*L)*A,e[9]=(s*R-i*k-a*L)*A,e[10]=(_*B-P*x+g*b)*A,e[11]=(m*x-o*B-h*b)*A,e[12]=(l*W-r*j-y*L)*A,e[13]=(i*j-s*W+n*L)*A,e[14]=(P*C-_*v-p*b)*A,e[15]=(o*v-m*C+u*b)*A,e):null}function ya(e,t){var i=t[0],s=t[1],n=t[2],a=t[3],r=t[4],l=t[5],y=t[6],c=t[7],o=t[8],m=t[9],u=t[10],h=t[11],_=t[12],P=t[13],p=t[14],g=t[15];return e[0]=l*(u*g-h*p)-m*(y*g-c*p)+P*(y*h-c*u),e[1]=-(s*(u*g-h*p)-m*(n*g-a*p)+P*(n*h-a*u)),e[2]=s*(y*g-c*p)-l*(n*g-a*p)+P*(n*c-a*y),e[3]=-(s*(y*h-c*u)-l*(n*h-a*u)+m*(n*c-a*y)),e[4]=-(r*(u*g-h*p)-o*(y*g-c*p)+_*(y*h-c*u)),e[5]=i*(u*g-h*p)-o*(n*g-a*p)+_*(n*h-a*u),e[6]=-(i*(y*g-c*p)-r*(n*g-a*p)+_*(n*c-a*y)),e[7]=i*(y*h-c*u)-r*(n*h-a*u)+o*(n*c-a*y),e[8]=r*(m*g-h*P)-o*(l*g-c*P)+_*(l*h-c*m),e[9]=-(i*(m*g-h*P)-o*(s*g-a*P)+_*(s*h-a*m)),e[10]=i*(l*g-c*P)-r*(s*g-a*P)+_*(s*c-a*l),e[11]=-(i*(l*h-c*m)-r*(s*h-a*m)+o*(s*c-a*l)),e[12]=-(r*(m*p-u*P)-o*(l*p-y*P)+_*(l*u-y*m)),e[13]=i*(m*p-u*P)-o*(s*p-n*P)+_*(s*u-n*m),e[14]=-(i*(l*p-y*P)-r*(s*p-n*P)+_*(s*y-n*l)),e[15]=i*(l*u-y*m)-r*(s*u-n*m)+o*(s*y-n*l),e}function ua(e){var t=e[0],i=e[1],s=e[2],n=e[3],a=e[4],r=e[5],l=e[6],y=e[7],c=e[8],o=e[9],m=e[10],u=e[11],h=e[12],_=e[13],P=e[14],p=e[15],g=t*r-i*a,b=t*l-s*a,C=t*y-n*a,x=i*l-s*r,v=i*y-n*r,B=s*y-n*l,O=c*_-o*h,L=c*P-m*h,W=c*p-u*h,R=o*P-m*_,j=o*p-u*_,k=m*p-u*P;return g*k-b*j+C*R+x*W-v*L+B*O}function Kt(e,t,i){var s=t[0],n=t[1],a=t[2],r=t[3],l=t[4],y=t[5],c=t[6],o=t[7],m=t[8],u=t[9],h=t[10],_=t[11],P=t[12],p=t[13],g=t[14],b=t[15],C=i[0],x=i[1],v=i[2],B=i[3];return e[0]=C*s+x*l+v*m+B*P,e[1]=C*n+x*y+v*u+B*p,e[2]=C*a+x*c+v*h+B*g,e[3]=C*r+x*o+v*_+B*b,C=i[4],x=i[5],v=i[6],B=i[7],e[4]=C*s+x*l+v*m+B*P,e[5]=C*n+x*y+v*u+B*p,e[6]=C*a+x*c+v*h+B*g,e[7]=C*r+x*o+v*_+B*b,C=i[8],x=i[9],v=i[10],B=i[11],e[8]=C*s+x*l+v*m+B*P,e[9]=C*n+x*y+v*u+B*p,e[10]=C*a+x*c+v*h+B*g,e[11]=C*r+x*o+v*_+B*b,C=i[12],x=i[13],v=i[14],B=i[15],e[12]=C*s+x*l+v*m+B*P,e[13]=C*n+x*y+v*u+B*p,e[14]=C*a+x*c+v*h+B*g,e[15]=C*r+x*o+v*_+B*b,e}function ca(e,t,i){var s=i[0],n=i[1],a=i[2],r,l,y,c,o,m,u,h,_,P,p,g;return t===e?(e[12]=t[0]*s+t[4]*n+t[8]*a+t[12],e[13]=t[1]*s+t[5]*n+t[9]*a+t[13],e[14]=t[2]*s+t[6]*n+t[10]*a+t[14],e[15]=t[3]*s+t[7]*n+t[11]*a+t[15]):(r=t[0],l=t[1],y=t[2],c=t[3],o=t[4],m=t[5],u=t[6],h=t[7],_=t[8],P=t[9],p=t[10],g=t[11],e[0]=r,e[1]=l,e[2]=y,e[3]=c,e[4]=o,e[5]=m,e[6]=u,e[7]=h,e[8]=_,e[9]=P,e[10]=p,e[11]=g,e[12]=r*s+o*n+_*a+t[12],e[13]=l*s+m*n+P*a+t[13],e[14]=y*s+u*n+p*a+t[14],e[15]=c*s+h*n+g*a+t[15]),e}function ha(e,t,i){var s=i[0],n=i[1],a=i[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function pa(e,t,i,s){var n=s[0],a=s[1],r=s[2],l=Math.hypot(n,a,r),y,c,o,m,u,h,_,P,p,g,b,C,x,v,B,O,L,W,R,j,k,E,A,G;return l<M?null:(l=1/l,n*=l,a*=l,r*=l,y=Math.sin(i),c=Math.cos(i),o=1-c,m=t[0],u=t[1],h=t[2],_=t[3],P=t[4],p=t[5],g=t[6],b=t[7],C=t[8],x=t[9],v=t[10],B=t[11],O=n*n*o+c,L=a*n*o+r*y,W=r*n*o-a*y,R=n*a*o-r*y,j=a*a*o+c,k=r*a*o+n*y,E=n*r*o+a*y,A=a*r*o-n*y,G=r*r*o+c,e[0]=m*O+P*L+C*W,e[1]=u*O+p*L+x*W,e[2]=h*O+g*L+v*W,e[3]=_*O+b*L+B*W,e[4]=m*R+P*j+C*k,e[5]=u*R+p*j+x*k,e[6]=h*R+g*j+v*k,e[7]=_*R+b*j+B*k,e[8]=m*E+P*A+C*G,e[9]=u*E+p*A+x*G,e[10]=h*E+g*A+v*G,e[11]=_*E+b*A+B*G,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function da(e,t,i){var s=Math.sin(i),n=Math.cos(i),a=t[4],r=t[5],l=t[6],y=t[7],c=t[8],o=t[9],m=t[10],u=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*n+c*s,e[5]=r*n+o*s,e[6]=l*n+m*s,e[7]=y*n+u*s,e[8]=c*n-a*s,e[9]=o*n-r*s,e[10]=m*n-l*s,e[11]=u*n-y*s,e}function _a(e,t,i){var s=Math.sin(i),n=Math.cos(i),a=t[0],r=t[1],l=t[2],y=t[3],c=t[8],o=t[9],m=t[10],u=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n-c*s,e[1]=r*n-o*s,e[2]=l*n-m*s,e[3]=y*n-u*s,e[8]=a*s+c*n,e[9]=r*s+o*n,e[10]=l*s+m*n,e[11]=y*s+u*n,e}function Pa(e,t,i){var s=Math.sin(i),n=Math.cos(i),a=t[0],r=t[1],l=t[2],y=t[3],c=t[4],o=t[5],m=t[6],u=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n+c*s,e[1]=r*n+o*s,e[2]=l*n+m*s,e[3]=y*n+u*s,e[4]=c*n-a*s,e[5]=o*n-r*s,e[6]=m*n-l*s,e[7]=u*n-y*s,e}function ga(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function fa(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ta(e,t,i){var s=i[0],n=i[1],a=i[2],r=Math.hypot(s,n,a),l,y,c;return r<M?null:(r=1/r,s*=r,n*=r,a*=r,l=Math.sin(t),y=Math.cos(t),c=1-y,e[0]=s*s*c+y,e[1]=n*s*c+a*l,e[2]=a*s*c-n*l,e[3]=0,e[4]=s*n*c-a*l,e[5]=n*n*c+y,e[6]=a*n*c+s*l,e[7]=0,e[8]=s*a*c+n*l,e[9]=n*a*c-s*l,e[10]=a*a*c+y,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function ba(e,t){var i=Math.sin(t),s=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ca(e,t){var i=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Sa(e,t){var i=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Jt(e,t,i){var s=t[0],n=t[1],a=t[2],r=t[3],l=s+s,y=n+n,c=a+a,o=s*l,m=s*y,u=s*c,h=n*y,_=n*c,P=a*c,p=r*l,g=r*y,b=r*c;return e[0]=1-(h+P),e[1]=m+b,e[2]=u-g,e[3]=0,e[4]=m-b,e[5]=1-(o+P),e[6]=_+p,e[7]=0,e[8]=u+g,e[9]=_-p,e[10]=1-(o+h),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function xa(e,t){var i=new D(3),s=-t[0],n=-t[1],a=-t[2],r=t[3],l=t[4],y=t[5],c=t[6],o=t[7],m=s*s+n*n+a*a+r*r;return m>0?(i[0]=(l*r+o*s+y*a-c*n)*2/m,i[1]=(y*r+o*n+c*s-l*a)*2/m,i[2]=(c*r+o*a+l*n-y*s)*2/m):(i[0]=(l*r+o*s+y*a-c*n)*2,i[1]=(y*r+o*n+c*s-l*a)*2,i[2]=(c*r+o*a+l*n-y*s)*2),Jt(e,t,i),e}function Pt(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Yt(e,t){var i=t[0],s=t[1],n=t[2],a=t[4],r=t[5],l=t[6],y=t[8],c=t[9],o=t[10];return e[0]=Math.hypot(i,s,n),e[1]=Math.hypot(a,r,l),e[2]=Math.hypot(y,c,o),e}function gt(e,t){var i=new D(3);Yt(i,t);var s=1/i[0],n=1/i[1],a=1/i[2],r=t[0]*s,l=t[1]*n,y=t[2]*a,c=t[4]*s,o=t[5]*n,m=t[6]*a,u=t[8]*s,h=t[9]*n,_=t[10]*a,P=r+o+_,p=0;return P>0?(p=Math.sqrt(P+1)*2,e[3]=.25*p,e[0]=(m-h)/p,e[1]=(u-y)/p,e[2]=(l-c)/p):r>o&&r>_?(p=Math.sqrt(1+r-o-_)*2,e[3]=(m-h)/p,e[0]=.25*p,e[1]=(l+c)/p,e[2]=(u+y)/p):o>_?(p=Math.sqrt(1+o-r-_)*2,e[3]=(u-y)/p,e[0]=(l+c)/p,e[1]=.25*p,e[2]=(m+h)/p):(p=Math.sqrt(1+_-r-o)*2,e[3]=(l-c)/p,e[0]=(u+y)/p,e[1]=(m+h)/p,e[2]=.25*p),e}function va(e,t,i,s){var n=t[0],a=t[1],r=t[2],l=t[3],y=n+n,c=a+a,o=r+r,m=n*y,u=n*c,h=n*o,_=a*c,P=a*o,p=r*o,g=l*y,b=l*c,C=l*o,x=s[0],v=s[1],B=s[2];return e[0]=(1-(_+p))*x,e[1]=(u+C)*x,e[2]=(h-b)*x,e[3]=0,e[4]=(u-C)*v,e[5]=(1-(m+p))*v,e[6]=(P+g)*v,e[7]=0,e[8]=(h+b)*B,e[9]=(P-g)*B,e[10]=(1-(m+_))*B,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function Ba(e,t,i,s,n){var a=t[0],r=t[1],l=t[2],y=t[3],c=a+a,o=r+r,m=l+l,u=a*c,h=a*o,_=a*m,P=r*o,p=r*m,g=l*m,b=y*c,C=y*o,x=y*m,v=s[0],B=s[1],O=s[2],L=n[0],W=n[1],R=n[2],j=(1-(P+g))*v,k=(h+x)*v,E=(_-C)*v,A=(h-x)*B,G=(1-(u+g))*B,X=(p+b)*B,K=(_+C)*O,Nt=(p-b)*O,Gt=(1-(u+P))*O;return e[0]=j,e[1]=k,e[2]=E,e[3]=0,e[4]=A,e[5]=G,e[6]=X,e[7]=0,e[8]=K,e[9]=Nt,e[10]=Gt,e[11]=0,e[12]=i[0]+L-(j*L+A*W+K*R),e[13]=i[1]+W-(k*L+G*W+Nt*R),e[14]=i[2]+R-(E*L+X*W+Gt*R),e[15]=1,e}function Ma(e,t){var i=t[0],s=t[1],n=t[2],a=t[3],r=i+i,l=s+s,y=n+n,c=i*r,o=s*r,m=s*l,u=n*r,h=n*l,_=n*y,P=a*r,p=a*l,g=a*y;return e[0]=1-m-_,e[1]=o+g,e[2]=u-p,e[3]=0,e[4]=o-g,e[5]=1-c-_,e[6]=h+P,e[7]=0,e[8]=u+p,e[9]=h-P,e[10]=1-c-m,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ia(e,t,i,s,n,a,r){var l=1/(i-t),y=1/(n-s),c=1/(a-r);return e[0]=a*2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*y,e[6]=0,e[7]=0,e[8]=(i+t)*l,e[9]=(n+s)*y,e[10]=(r+a)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=r*a*2*c,e[15]=0,e}function Zt(e,t,i,s,n){var a=1/Math.tan(t/2),r;return e[0]=a/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(r=1/(s-n),e[10]=(n+s)*r,e[14]=2*n*s*r):(e[10]=-1,e[14]=-2*s),e}function Va(e,t,i,s,n){var a=1/Math.tan(t/2),r;return e[0]=a/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(r=1/(s-n),e[10]=n*r,e[14]=n*s*r):(e[10]=-1,e[14]=-s),e}function Aa(e,t,i,s){var n=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),r=Math.tan(t.leftDegrees*Math.PI/180),l=Math.tan(t.rightDegrees*Math.PI/180),y=2/(r+l),c=2/(n+a);return e[0]=y,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-((r-l)*y*.5),e[9]=(n-a)*c*.5,e[10]=s/(i-s),e[11]=-1,e[12]=0,e[13]=0,e[14]=s*i/(i-s),e[15]=0,e}function $t(e,t,i,s,n,a,r){var l=1/(t-i),y=1/(s-n),c=1/(a-r);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+i)*l,e[13]=(n+s)*y,e[14]=(r+a)*c,e[15]=1,e}function Ra(e,t,i,s,n,a,r){var l=1/(t-i),y=1/(s-n),c=1/(a-r);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=c,e[11]=0,e[12]=(t+i)*l,e[13]=(n+s)*y,e[14]=a*c,e[15]=1,e}function Ea(e,t,i,s){var n,a,r,l,y,c,o,m,u,h,_=t[0],P=t[1],p=t[2],g=s[0],b=s[1],C=s[2],x=i[0],v=i[1],B=i[2];return Math.abs(_-x)<M&&Math.abs(P-v)<M&&Math.abs(p-B)<M?Xt(e):(o=_-x,m=P-v,u=p-B,h=1/Math.hypot(o,m,u),o*=h,m*=h,u*=h,n=b*u-C*m,a=C*o-g*u,r=g*m-b*o,h=Math.hypot(n,a,r),h?(h=1/h,n*=h,a*=h,r*=h):(n=0,a=0,r=0),l=m*r-u*a,y=u*n-o*r,c=o*a-m*n,h=Math.hypot(l,y,c),h?(h=1/h,l*=h,y*=h,c*=h):(l=0,y=0,c=0),e[0]=n,e[1]=l,e[2]=o,e[3]=0,e[4]=a,e[5]=y,e[6]=m,e[7]=0,e[8]=r,e[9]=c,e[10]=u,e[11]=0,e[12]=-(n*_+a*P+r*p),e[13]=-(l*_+y*P+c*p),e[14]=-(o*_+m*P+u*p),e[15]=1,e)}function Oa(e,t,i,s){var n=t[0],a=t[1],r=t[2],l=s[0],y=s[1],c=s[2],o=n-i[0],m=a-i[1],u=r-i[2],h=o*o+m*m+u*u;h>0&&(h=1/Math.sqrt(h),o*=h,m*=h,u*=h);var _=y*u-c*m,P=c*o-l*u,p=l*m-y*o;return h=_*_+P*P+p*p,h>0&&(h=1/Math.sqrt(h),_*=h,P*=h,p*=h),e[0]=_,e[1]=P,e[2]=p,e[3]=0,e[4]=m*p-u*P,e[5]=u*_-o*p,e[6]=o*P-m*_,e[7]=0,e[8]=o,e[9]=m,e[10]=u,e[11]=0,e[12]=n,e[13]=a,e[14]=r,e[15]=1,e}function Wa(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function ka(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function ja(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e}function te(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e}function Fa(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e}function Ha(e,t,i,s){return e[0]=t[0]+i[0]*s,e[1]=t[1]+i[1]*s,e[2]=t[2]+i[2]*s,e[3]=t[3]+i[3]*s,e[4]=t[4]+i[4]*s,e[5]=t[5]+i[5]*s,e[6]=t[6]+i[6]*s,e[7]=t[7]+i[7]*s,e[8]=t[8]+i[8]*s,e[9]=t[9]+i[9]*s,e[10]=t[10]+i[10]*s,e[11]=t[11]+i[11]*s,e[12]=t[12]+i[12]*s,e[13]=t[13]+i[13]*s,e[14]=t[14]+i[14]*s,e[15]=t[15]+i[15]*s,e}function wa(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Na(e,t){var i=e[0],s=e[1],n=e[2],a=e[3],r=e[4],l=e[5],y=e[6],c=e[7],o=e[8],m=e[9],u=e[10],h=e[11],_=e[12],P=e[13],p=e[14],g=e[15],b=t[0],C=t[1],x=t[2],v=t[3],B=t[4],O=t[5],L=t[6],W=t[7],R=t[8],j=t[9],k=t[10],E=t[11],A=t[12],G=t[13],X=t[14],K=t[15];return Math.abs(i-b)<=M*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(s-C)<=M*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(n-x)<=M*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(a-v)<=M*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(r-B)<=M*Math.max(1,Math.abs(r),Math.abs(B))&&Math.abs(l-O)<=M*Math.max(1,Math.abs(l),Math.abs(O))&&Math.abs(y-L)<=M*Math.max(1,Math.abs(y),Math.abs(L))&&Math.abs(c-W)<=M*Math.max(1,Math.abs(c),Math.abs(W))&&Math.abs(o-R)<=M*Math.max(1,Math.abs(o),Math.abs(R))&&Math.abs(m-j)<=M*Math.max(1,Math.abs(m),Math.abs(j))&&Math.abs(u-k)<=M*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(h-E)<=M*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(_-A)<=M*Math.max(1,Math.abs(_),Math.abs(A))&&Math.abs(P-G)<=M*Math.max(1,Math.abs(P),Math.abs(G))&&Math.abs(p-X)<=M*Math.max(1,Math.abs(p),Math.abs(X))&&Math.abs(g-K)<=M*Math.max(1,Math.abs(g),Math.abs(K))}var La,Da,Ga,Ua,ft=H(()=>{U();La=Zt;Da=$t;Ga=Kt,Ua=te});var d={};q(d,{add:()=>Xa,angle:()=>po,bezier:()=>oo,ceil:()=>Ka,clone:()=>qa,copy:()=>za,create:()=>tt,cross:()=>J,dist:()=>So,distance:()=>ae,div:()=>Co,divide:()=>ne,dot:()=>it,equals:()=>fo,exactEquals:()=>go,floor:()=>Ja,forEach:()=>Bo,fromValues:()=>et,hermite:()=>ao,inverse:()=>so,len:()=>bt,length:()=>ee,lerp:()=>no,max:()=>Za,min:()=>Ya,mul:()=>bo,multiply:()=>se,negate:()=>io,normalize:()=>Tt,random:()=>ro,rotateX:()=>uo,rotateY:()=>co,rotateZ:()=>ho,round:()=>$a,scale:()=>to,scaleAndAdd:()=>eo,set:()=>Qa,sqrDist:()=>xo,sqrLen:()=>vo,squaredDistance:()=>oe,squaredLength:()=>re,str:()=>Po,sub:()=>To,subtract:()=>ie,transformMat3:()=>mo,transformMat4:()=>lo,transformQuat:()=>yo,zero:()=>_o});function tt(){var e=new D(3);return D!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function qa(e){var t=new D(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ee(e){var t=e[0],i=e[1],s=e[2];return Math.hypot(t,i,s)}function et(e,t,i){var s=new D(3);return s[0]=e,s[1]=t,s[2]=i,s}function za(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Qa(e,t,i,s){return e[0]=t,e[1]=i,e[2]=s,e}function Xa(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function ie(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function se(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function ne(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e}function Ka(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function Ja(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function Ya(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e}function Za(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e}function $a(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function to(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function eo(e,t,i,s){return e[0]=t[0]+i[0]*s,e[1]=t[1]+i[1]*s,e[2]=t[2]+i[2]*s,e}function ae(e,t){var i=t[0]-e[0],s=t[1]-e[1],n=t[2]-e[2];return Math.hypot(i,s,n)}function oe(e,t){var i=t[0]-e[0],s=t[1]-e[1],n=t[2]-e[2];return i*i+s*s+n*n}function re(e){var t=e[0],i=e[1],s=e[2];return t*t+i*i+s*s}function io(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function so(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Tt(e,t){var i=t[0],s=t[1],n=t[2],a=i*i+s*s+n*n;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function it(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function J(e,t,i){var s=t[0],n=t[1],a=t[2],r=i[0],l=i[1],y=i[2];return e[0]=n*y-a*l,e[1]=a*r-s*y,e[2]=s*l-n*r,e}function no(e,t,i,s){var n=t[0],a=t[1],r=t[2];return e[0]=n+s*(i[0]-n),e[1]=a+s*(i[1]-a),e[2]=r+s*(i[2]-r),e}function ao(e,t,i,s,n,a){var r=a*a,l=r*(2*a-3)+1,y=r*(a-2)+a,c=r*(a-1),o=r*(3-2*a);return e[0]=t[0]*l+i[0]*y+s[0]*c+n[0]*o,e[1]=t[1]*l+i[1]*y+s[1]*c+n[1]*o,e[2]=t[2]*l+i[2]*y+s[2]*c+n[2]*o,e}function oo(e,t,i,s,n,a){var r=1-a,l=r*r,y=a*a,c=l*r,o=3*a*l,m=3*y*r,u=y*a;return e[0]=t[0]*c+i[0]*o+s[0]*m+n[0]*u,e[1]=t[1]*c+i[1]*o+s[1]*m+n[1]*u,e[2]=t[2]*c+i[2]*o+s[2]*m+n[2]*u,e}function ro(e,t){t=t||1;var i=w()*2*Math.PI,s=w()*2-1,n=Math.sqrt(1-s*s)*t;return e[0]=Math.cos(i)*n,e[1]=Math.sin(i)*n,e[2]=s*t,e}function lo(e,t,i){var s=t[0],n=t[1],a=t[2],r=i[3]*s+i[7]*n+i[11]*a+i[15];return r=r||1,e[0]=(i[0]*s+i[4]*n+i[8]*a+i[12])/r,e[1]=(i[1]*s+i[5]*n+i[9]*a+i[13])/r,e[2]=(i[2]*s+i[6]*n+i[10]*a+i[14])/r,e}function mo(e,t,i){var s=t[0],n=t[1],a=t[2];return e[0]=s*i[0]+n*i[3]+a*i[6],e[1]=s*i[1]+n*i[4]+a*i[7],e[2]=s*i[2]+n*i[5]+a*i[8],e}function yo(e,t,i){var s=i[0],n=i[1],a=i[2],r=i[3],l=t[0],y=t[1],c=t[2],o=n*c-a*y,m=a*l-s*c,u=s*y-n*l,h=n*u-a*m,_=a*o-s*u,P=s*m-n*o,p=r*2;return o*=p,m*=p,u*=p,h*=2,_*=2,P*=2,e[0]=l+o+h,e[1]=y+m+_,e[2]=c+u+P,e}function uo(e,t,i,s){var n=[],a=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],a[0]=n[0],a[1]=n[1]*Math.cos(s)-n[2]*Math.sin(s),a[2]=n[1]*Math.sin(s)+n[2]*Math.cos(s),e[0]=a[0]+i[0],e[1]=a[1]+i[1],e[2]=a[2]+i[2],e}function co(e,t,i,s){var n=[],a=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],a[0]=n[2]*Math.sin(s)+n[0]*Math.cos(s),a[1]=n[1],a[2]=n[2]*Math.cos(s)-n[0]*Math.sin(s),e[0]=a[0]+i[0],e[1]=a[1]+i[1],e[2]=a[2]+i[2],e}function ho(e,t,i,s){var n=[],a=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],a[0]=n[0]*Math.cos(s)-n[1]*Math.sin(s),a[1]=n[0]*Math.sin(s)+n[1]*Math.cos(s),a[2]=n[2],e[0]=a[0]+i[0],e[1]=a[1]+i[1],e[2]=a[2]+i[2],e}function po(e,t){var i=e[0],s=e[1],n=e[2],a=t[0],r=t[1],l=t[2],y=Math.sqrt(i*i+s*s+n*n),c=Math.sqrt(a*a+r*r+l*l),o=y*c,m=o&&it(e,t)/o;return Math.acos(Math.min(Math.max(m,-1),1))}function _o(e){return e[0]=0,e[1]=0,e[2]=0,e}function Po(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function go(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function fo(e,t){var i=e[0],s=e[1],n=e[2],a=t[0],r=t[1],l=t[2];return Math.abs(i-a)<=M*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(s-r)<=M*Math.max(1,Math.abs(s),Math.abs(r))&&Math.abs(n-l)<=M*Math.max(1,Math.abs(n),Math.abs(l))}var To,bo,Co,So,xo,bt,vo,Bo,Ct=H(()=>{U();To=ie,bo=se,Co=ne,So=ae,xo=oe,bt=ee,vo=re,Bo=function(){var e=tt();return function(t,i,s,n,a,r){var l,y;for(i||(i=3),s||(s=0),n?y=Math.min(n*i+s,t.length):y=t.length,l=s;l<y;l+=i)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],a(e,e,r),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}}()});var z={};q(z,{add:()=>Mt,ceil:()=>Mo,clone:()=>St,copy:()=>vt,create:()=>le,cross:()=>Oo,dist:()=>Uo,distance:()=>ce,div:()=>Go,divide:()=>ue,dot:()=>Vt,equals:()=>Rt,exactEquals:()=>Dt,floor:()=>Io,forEach:()=>Xo,fromValues:()=>xt,inverse:()=>Eo,len:()=>zo,length:()=>st,lerp:()=>At,max:()=>Vo,min:()=>Lo,mul:()=>No,multiply:()=>ye,negate:()=>Ro,normalize:()=>Lt,random:()=>Wo,round:()=>Ao,scale:()=>It,scaleAndAdd:()=>Do,set:()=>Bt,sqrDist:()=>qo,sqrLen:()=>Qo,squaredDistance:()=>he,squaredLength:()=>nt,str:()=>Ho,sub:()=>wo,subtract:()=>me,transformMat4:()=>ko,transformQuat:()=>jo,zero:()=>Fo});function le(){var e=new D(4);return D!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function St(e){var t=new D(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function xt(e,t,i,s){var n=new D(4);return n[0]=e,n[1]=t,n[2]=i,n[3]=s,n}function vt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Bt(e,t,i,s,n){return e[0]=t,e[1]=i,e[2]=s,e[3]=n,e}function Mt(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e}function me(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}function ye(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e}function ue(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e}function Mo(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Io(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Lo(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e}function Vo(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e}function Ao(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function It(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e}function Do(e,t,i,s){return e[0]=t[0]+i[0]*s,e[1]=t[1]+i[1]*s,e[2]=t[2]+i[2]*s,e[3]=t[3]+i[3]*s,e}function ce(e,t){var i=t[0]-e[0],s=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return Math.hypot(i,s,n,a)}function he(e,t){var i=t[0]-e[0],s=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return i*i+s*s+n*n+a*a}function st(e){var t=e[0],i=e[1],s=e[2],n=e[3];return Math.hypot(t,i,s,n)}function nt(e){var t=e[0],i=e[1],s=e[2],n=e[3];return t*t+i*i+s*s+n*n}function Ro(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Eo(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Lt(e,t){var i=t[0],s=t[1],n=t[2],a=t[3],r=i*i+s*s+n*n+a*a;return r>0&&(r=1/Math.sqrt(r)),e[0]=i*r,e[1]=s*r,e[2]=n*r,e[3]=a*r,e}function Vt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Oo(e,t,i,s){var n=i[0]*s[1]-i[1]*s[0],a=i[0]*s[2]-i[2]*s[0],r=i[0]*s[3]-i[3]*s[0],l=i[1]*s[2]-i[2]*s[1],y=i[1]*s[3]-i[3]*s[1],c=i[2]*s[3]-i[3]*s[2],o=t[0],m=t[1],u=t[2],h=t[3];return e[0]=m*c-u*y+h*l,e[1]=-(o*c)+u*r-h*a,e[2]=o*y-m*r+h*n,e[3]=-(o*l)+m*a-u*n,e}function At(e,t,i,s){var n=t[0],a=t[1],r=t[2],l=t[3];return e[0]=n+s*(i[0]-n),e[1]=a+s*(i[1]-a),e[2]=r+s*(i[2]-r),e[3]=l+s*(i[3]-l),e}function Wo(e,t){t=t||1;var i,s,n,a,r,l;do i=w()*2-1,s=w()*2-1,r=i*i+s*s;while(r>=1);do n=w()*2-1,a=w()*2-1,l=n*n+a*a;while(l>=1);var y=Math.sqrt((1-r)/l);return e[0]=t*i,e[1]=t*s,e[2]=t*n*y,e[3]=t*a*y,e}function ko(e,t,i){var s=t[0],n=t[1],a=t[2],r=t[3];return e[0]=i[0]*s+i[4]*n+i[8]*a+i[12]*r,e[1]=i[1]*s+i[5]*n+i[9]*a+i[13]*r,e[2]=i[2]*s+i[6]*n+i[10]*a+i[14]*r,e[3]=i[3]*s+i[7]*n+i[11]*a+i[15]*r,e}function jo(e,t,i){var s=t[0],n=t[1],a=t[2],r=i[0],l=i[1],y=i[2],c=i[3],o=c*s+l*a-y*n,m=c*n+y*s-r*a,u=c*a+r*n-l*s,h=-r*s-l*n-y*a;return e[0]=o*c+h*-r+m*-y-u*-l,e[1]=m*c+h*-l+u*-r-o*-y,e[2]=u*c+h*-y+o*-l-m*-r,e[3]=t[3],e}function Fo(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Ho(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Dt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Rt(e,t){var i=e[0],s=e[1],n=e[2],a=e[3],r=t[0],l=t[1],y=t[2],c=t[3];return Math.abs(i-r)<=M*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(s-l)<=M*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(n-y)<=M*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(a-c)<=M*Math.max(1,Math.abs(a),Math.abs(c))}var wo,No,Go,Uo,qo,zo,Qo,Xo,Et=H(()=>{U();wo=me,No=ye,Go=ue,Uo=ce,qo=he,zo=st,Qo=nt,Xo=function(){var e=le();return function(t,i,s,n,a,r){var l,y;for(i||(i=4),s||(s=0),n?y=Math.min(n*i+s,t.length):y=t.length,l=s;l<y;l+=i)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],a(e,e,r),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}}()});var f={};q(f,{add:()=>lr,calculateW:()=>Zo,clone:()=>ar,conjugate:()=>ir,copy:()=>ot,create:()=>Y,dot:()=>rt,equals:()=>pr,exactEquals:()=>hr,exp:()=>_e,fromEuler:()=>sr,fromMat3:()=>ge,fromValues:()=>or,getAngle:()=>Yo,getAxisAngle:()=>Jo,identity:()=>Ko,invert:()=>er,len:()=>ur,length:()=>lt,lerp:()=>yr,ln:()=>Pe,mul:()=>mr,multiply:()=>de,normalize:()=>jt,pow:()=>$o,random:()=>tr,rotateX:()=>Ot,rotateY:()=>Wt,rotateZ:()=>kt,rotationTo:()=>dr,scale:()=>fe,set:()=>rr,setAxes:()=>Pr,setAxisAngle:()=>pe,slerp:()=>at,sqlerp:()=>_r,sqrLen:()=>cr,squaredLength:()=>mt,str:()=>nr});function Y(){var e=new D(4);return D!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Ko(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function pe(e,t,i){i=i*.5;var s=Math.sin(i);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(i),e}function Jo(e,t){var i=Math.acos(t[3])*2,s=Math.sin(i/2);return s>M?(e[0]=t[0]/s,e[1]=t[1]/s,e[2]=t[2]/s):(e[0]=1,e[1]=0,e[2]=0),i}function Yo(e,t){var i=rt(e,t);return Math.acos(2*i*i-1)}function de(e,t,i){var s=t[0],n=t[1],a=t[2],r=t[3],l=i[0],y=i[1],c=i[2],o=i[3];return e[0]=s*o+r*l+n*c-a*y,e[1]=n*o+r*y+a*l-s*c,e[2]=a*o+r*c+s*y-n*l,e[3]=r*o-s*l-n*y-a*c,e}function Ot(e,t,i){i*=.5;var s=t[0],n=t[1],a=t[2],r=t[3],l=Math.sin(i),y=Math.cos(i);return e[0]=s*y+r*l,e[1]=n*y+a*l,e[2]=a*y-n*l,e[3]=r*y-s*l,e}function Wt(e,t,i){i*=.5;var s=t[0],n=t[1],a=t[2],r=t[3],l=Math.sin(i),y=Math.cos(i);return e[0]=s*y-a*l,e[1]=n*y+r*l,e[2]=a*y+s*l,e[3]=r*y-n*l,e}function kt(e,t,i){i*=.5;var s=t[0],n=t[1],a=t[2],r=t[3],l=Math.sin(i),y=Math.cos(i);return e[0]=s*y+n*l,e[1]=n*y-s*l,e[2]=a*y+r*l,e[3]=r*y-a*l,e}function Zo(e,t){var i=t[0],s=t[1],n=t[2];return e[0]=i,e[1]=s,e[2]=n,e[3]=Math.sqrt(Math.abs(1-i*i-s*s-n*n)),e}function _e(e,t){var i=t[0],s=t[1],n=t[2],a=t[3],r=Math.sqrt(i*i+s*s+n*n),l=Math.exp(a),y=r>0?l*Math.sin(r)/r:0;return e[0]=i*y,e[1]=s*y,e[2]=n*y,e[3]=l*Math.cos(r),e}function Pe(e,t){var i=t[0],s=t[1],n=t[2],a=t[3],r=Math.sqrt(i*i+s*s+n*n),l=r>0?Math.atan2(r,a)/r:0;return e[0]=i*l,e[1]=s*l,e[2]=n*l,e[3]=.5*Math.log(i*i+s*s+n*n+a*a),e}function $o(e,t,i){return Pe(e,t),fe(e,e,i),_e(e,e),e}function at(e,t,i,s){var n=t[0],a=t[1],r=t[2],l=t[3],y=i[0],c=i[1],o=i[2],m=i[3],u,h,_,P,p;return h=n*y+a*c+r*o+l*m,h<0&&(h=-h,y=-y,c=-c,o=-o,m=-m),1-h>M?(u=Math.acos(h),_=Math.sin(u),P=Math.sin((1-s)*u)/_,p=Math.sin(s*u)/_):(P=1-s,p=s),e[0]=P*n+p*y,e[1]=P*a+p*c,e[2]=P*r+p*o,e[3]=P*l+p*m,e}function tr(e){var t=w(),i=w(),s=w(),n=Math.sqrt(1-t),a=Math.sqrt(t);return e[0]=n*Math.sin(2*Math.PI*i),e[1]=n*Math.cos(2*Math.PI*i),e[2]=a*Math.sin(2*Math.PI*s),e[3]=a*Math.cos(2*Math.PI*s),e}function er(e,t){var i=t[0],s=t[1],n=t[2],a=t[3],r=i*i+s*s+n*n+a*a,l=r?1/r:0;return e[0]=-i*l,e[1]=-s*l,e[2]=-n*l,e[3]=a*l,e}function ir(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function ge(e,t){var i=t[0]+t[4]+t[8],s;if(i>0)s=Math.sqrt(i+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[n*3+n]&&(n=2);var a=(n+1)%3,r=(n+2)%3;s=Math.sqrt(t[n*3+n]-t[a*3+a]-t[r*3+r]+1),e[n]=.5*s,s=.5/s,e[3]=(t[a*3+r]-t[r*3+a])*s,e[a]=(t[a*3+n]+t[n*3+a])*s,e[r]=(t[r*3+n]+t[n*3+r])*s}return e}function sr(e,t,i,s){var n=.5*Math.PI/180;t*=n,i*=n,s*=n;var a=Math.sin(t),r=Math.cos(t),l=Math.sin(i),y=Math.cos(i),c=Math.sin(s),o=Math.cos(s);return e[0]=a*y*o-r*l*c,e[1]=r*l*o+a*y*c,e[2]=r*y*c-a*l*o,e[3]=r*y*o+a*l*c,e}function nr(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var ar,or,ot,rr,lr,mr,fe,rt,yr,lt,ur,mt,cr,jt,hr,pr,dr,_r,Pr,Ft=H(()=>{U();_t();Ct();Et();ar=St,or=xt,ot=vt,rr=Bt,lr=Mt,mr=de,fe=It,rt=Vt,yr=At,lt=st,ur=lt,mt=nt,cr=mt,jt=Lt,hr=Dt,pr=Rt,dr=function(){var e=tt(),t=et(1,0,0),i=et(0,1,0);return function(s,n,a){var r=it(n,a);return r<-.999999?(J(e,t,n),bt(e)<1e-6&&J(e,i,n),Tt(e,e),pe(s,e,Math.PI),s):r>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(J(e,n,a),s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=1+r,jt(s,s))}}(),_r=function(){var e=Y(),t=Y();return function(i,s,n,a,r,l){return at(e,s,r,l),at(t,n,a,l),at(i,e,t,2*l*(1-l)),i}}(),Pr=function(){var e=dt();return function(t,i,s,n){return e[0]=s[0],e[3]=s[1],e[6]=s[2],e[1]=n[0],e[4]=n[1],e[7]=n[2],e[2]=-i[0],e[5]=-i[1],e[8]=-i[2],jt(t,ge(t,e))}}()});var I={};q(I,{add:()=>Fr,clone:()=>fr,conjugate:()=>Ur,copy:()=>be,create:()=>gr,dot:()=>Se,equals:()=>Jr,exactEquals:()=>Kr,fromMat4:()=>xr,fromRotation:()=>Sr,fromRotationTranslation:()=>Te,fromRotationTranslationValues:()=>br,fromTranslation:()=>Cr,fromValues:()=>Tr,getDual:()=>Ir,getReal:()=>Mr,getTranslation:()=>Ar,identity:()=>vr,invert:()=>Gr,len:()=>qr,length:()=>xe,lerp:()=>Nr,mul:()=>Hr,multiply:()=>Ce,normalize:()=>Qr,rotateAroundAxis:()=>jr,rotateByQuatAppend:()=>Wr,rotateByQuatPrepend:()=>kr,rotateX:()=>Rr,rotateY:()=>Er,rotateZ:()=>Or,scale:()=>wr,set:()=>Br,setDual:()=>Vr,setReal:()=>Lr,sqrLen:()=>zr,squaredLength:()=>yt,str:()=>Xr,translate:()=>Dr});function gr(){var e=new D(8);return D!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function fr(e){var t=new D(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Tr(e,t,i,s,n,a,r,l){var y=new D(8);return y[0]=e,y[1]=t,y[2]=i,y[3]=s,y[4]=n,y[5]=a,y[6]=r,y[7]=l,y}function br(e,t,i,s,n,a,r){var l=new D(8);l[0]=e,l[1]=t,l[2]=i,l[3]=s;var y=n*.5,c=a*.5,o=r*.5;return l[4]=y*s+c*i-o*t,l[5]=c*s+o*e-y*i,l[6]=o*s+y*t-c*e,l[7]=-y*e-c*t-o*i,l}function Te(e,t,i){var s=i[0]*.5,n=i[1]*.5,a=i[2]*.5,r=t[0],l=t[1],y=t[2],c=t[3];return e[0]=r,e[1]=l,e[2]=y,e[3]=c,e[4]=s*c+n*y-a*l,e[5]=n*c+a*r-s*y,e[6]=a*c+s*l-n*r,e[7]=-s*r-n*l-a*y,e}function Cr(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0]*.5,e[5]=t[1]*.5,e[6]=t[2]*.5,e[7]=0,e}function Sr(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function xr(e,t){var i=Y();gt(i,t);var s=new D(3);return Pt(s,t),Te(e,i,s),e}function be(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function vr(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Br(e,t,i,s,n,a,r,l,y){return e[0]=t,e[1]=i,e[2]=s,e[3]=n,e[4]=a,e[5]=r,e[6]=l,e[7]=y,e}function Ir(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e}function Vr(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e}function Ar(e,t){var i=t[4],s=t[5],n=t[6],a=t[7],r=-t[0],l=-t[1],y=-t[2],c=t[3];return e[0]=(i*c+a*r+s*y-n*l)*2,e[1]=(s*c+a*l+n*r-i*y)*2,e[2]=(n*c+a*y+i*l-s*r)*2,e}function Dr(e,t,i){var s=t[0],n=t[1],a=t[2],r=t[3],l=i[0]*.5,y=i[1]*.5,c=i[2]*.5,o=t[4],m=t[5],u=t[6],h=t[7];return e[0]=s,e[1]=n,e[2]=a,e[3]=r,e[4]=r*l+n*c-a*y+o,e[5]=r*y+a*l-s*c+m,e[6]=r*c+s*y-n*l+u,e[7]=-s*l-n*y-a*c+h,e}function Rr(e,t,i){var s=-t[0],n=-t[1],a=-t[2],r=t[3],l=t[4],y=t[5],c=t[6],o=t[7],m=l*r+o*s+y*a-c*n,u=y*r+o*n+c*s-l*a,h=c*r+o*a+l*n-y*s,_=o*r-l*s-y*n-c*a;return Ot(e,t,i),s=e[0],n=e[1],a=e[2],r=e[3],e[4]=m*r+_*s+u*a-h*n,e[5]=u*r+_*n+h*s-m*a,e[6]=h*r+_*a+m*n-u*s,e[7]=_*r-m*s-u*n-h*a,e}function Er(e,t,i){var s=-t[0],n=-t[1],a=-t[2],r=t[3],l=t[4],y=t[5],c=t[6],o=t[7],m=l*r+o*s+y*a-c*n,u=y*r+o*n+c*s-l*a,h=c*r+o*a+l*n-y*s,_=o*r-l*s-y*n-c*a;return Wt(e,t,i),s=e[0],n=e[1],a=e[2],r=e[3],e[4]=m*r+_*s+u*a-h*n,e[5]=u*r+_*n+h*s-m*a,e[6]=h*r+_*a+m*n-u*s,e[7]=_*r-m*s-u*n-h*a,e}function Or(e,t,i){var s=-t[0],n=-t[1],a=-t[2],r=t[3],l=t[4],y=t[5],c=t[6],o=t[7],m=l*r+o*s+y*a-c*n,u=y*r+o*n+c*s-l*a,h=c*r+o*a+l*n-y*s,_=o*r-l*s-y*n-c*a;return kt(e,t,i),s=e[0],n=e[1],a=e[2],r=e[3],e[4]=m*r+_*s+u*a-h*n,e[5]=u*r+_*n+h*s-m*a,e[6]=h*r+_*a+m*n-u*s,e[7]=_*r-m*s-u*n-h*a,e}function Wr(e,t,i){var s=i[0],n=i[1],a=i[2],r=i[3],l=t[0],y=t[1],c=t[2],o=t[3];return e[0]=l*r+o*s+y*a-c*n,e[1]=y*r+o*n+c*s-l*a,e[2]=c*r+o*a+l*n-y*s,e[3]=o*r-l*s-y*n-c*a,l=t[4],y=t[5],c=t[6],o=t[7],e[4]=l*r+o*s+y*a-c*n,e[5]=y*r+o*n+c*s-l*a,e[6]=c*r+o*a+l*n-y*s,e[7]=o*r-l*s-y*n-c*a,e}function kr(e,t,i){var s=t[0],n=t[1],a=t[2],r=t[3],l=i[0],y=i[1],c=i[2],o=i[3];return e[0]=s*o+r*l+n*c-a*y,e[1]=n*o+r*y+a*l-s*c,e[2]=a*o+r*c+s*y-n*l,e[3]=r*o-s*l-n*y-a*c,l=i[4],y=i[5],c=i[6],o=i[7],e[4]=s*o+r*l+n*c-a*y,e[5]=n*o+r*y+a*l-s*c,e[6]=a*o+r*c+s*y-n*l,e[7]=r*o-s*l-n*y-a*c,e}function jr(e,t,i,s){if(Math.abs(s)<M)return be(e,t);var n=Math.hypot(i[0],i[1],i[2]);s=s*.5;var a=Math.sin(s),r=a*i[0]/n,l=a*i[1]/n,y=a*i[2]/n,c=Math.cos(s),o=t[0],m=t[1],u=t[2],h=t[3];e[0]=o*c+h*r+m*y-u*l,e[1]=m*c+h*l+u*r-o*y,e[2]=u*c+h*y+o*l-m*r,e[3]=h*c-o*r-m*l-u*y;var _=t[4],P=t[5],p=t[6],g=t[7];return e[4]=_*c+g*r+P*y-p*l,e[5]=P*c+g*l+p*r-_*y,e[6]=p*c+g*y+_*l-P*r,e[7]=g*c-_*r-P*l-p*y,e}function Fr(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e}function Ce(e,t,i){var s=t[0],n=t[1],a=t[2],r=t[3],l=i[4],y=i[5],c=i[6],o=i[7],m=t[4],u=t[5],h=t[6],_=t[7],P=i[0],p=i[1],g=i[2],b=i[3];return e[0]=s*b+r*P+n*g-a*p,e[1]=n*b+r*p+a*P-s*g,e[2]=a*b+r*g+s*p-n*P,e[3]=r*b-s*P-n*p-a*g,e[4]=s*o+r*l+n*c-a*y+m*b+_*P+u*g-h*p,e[5]=n*o+r*y+a*l-s*c+u*b+_*p+h*P-m*g,e[6]=a*o+r*c+s*y-n*l+h*b+_*g+m*p-u*P,e[7]=r*o-s*l-n*y-a*c+_*b-m*P-u*p-h*g,e}function wr(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e}function Nr(e,t,i,s){var n=1-s;return Se(t,i)<0&&(s=-s),e[0]=t[0]*n+i[0]*s,e[1]=t[1]*n+i[1]*s,e[2]=t[2]*n+i[2]*s,e[3]=t[3]*n+i[3]*s,e[4]=t[4]*n+i[4]*s,e[5]=t[5]*n+i[5]*s,e[6]=t[6]*n+i[6]*s,e[7]=t[7]*n+i[7]*s,e}function Gr(e,t){var i=yt(t);return e[0]=-t[0]/i,e[1]=-t[1]/i,e[2]=-t[2]/i,e[3]=t[3]/i,e[4]=-t[4]/i,e[5]=-t[5]/i,e[6]=-t[6]/i,e[7]=t[7]/i,e}function Ur(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e}function Qr(e,t){var i=yt(t);if(i>0){i=Math.sqrt(i);var s=t[0]/i,n=t[1]/i,a=t[2]/i,r=t[3]/i,l=t[4],y=t[5],c=t[6],o=t[7],m=s*l+n*y+a*c+r*o;e[0]=s,e[1]=n,e[2]=a,e[3]=r,e[4]=(l-s*m)/i,e[5]=(y-n*m)/i,e[6]=(c-a*m)/i,e[7]=(o-r*m)/i}return e}function Xr(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function Kr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function Jr(e,t){var i=e[0],s=e[1],n=e[2],a=e[3],r=e[4],l=e[5],y=e[6],c=e[7],o=t[0],m=t[1],u=t[2],h=t[3],_=t[4],P=t[5],p=t[6],g=t[7];return Math.abs(i-o)<=M*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(s-m)<=M*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(n-u)<=M*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-h)<=M*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(r-_)<=M*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(l-P)<=M*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(y-p)<=M*Math.max(1,Math.abs(y),Math.abs(p))&&Math.abs(c-g)<=M*Math.max(1,Math.abs(c),Math.abs(g))}var Mr,Lr,Hr,Se,xe,qr,yt,zr,ve=H(()=>{U();Ft();ft();Mr=ot;Lr=ot;Hr=Ce;Se=rt;xe=lt,qr=xe,yt=mt,zr=yt});var N={};q(N,{add:()=>el,angle:()=>bl,ceil:()=>il,clone:()=>Yr,copy:()=>$r,create:()=>Be,cross:()=>hl,dist:()=>Vl,distance:()=>Ve,div:()=>Ll,divide:()=>Le,dot:()=>cl,equals:()=>vl,exactEquals:()=>xl,floor:()=>sl,forEach:()=>Rl,fromValues:()=>Zr,inverse:()=>yl,len:()=>Bl,length:()=>De,lerp:()=>pl,max:()=>al,min:()=>nl,mul:()=>Il,multiply:()=>Ie,negate:()=>ml,normalize:()=>ul,random:()=>dl,rotate:()=>Tl,round:()=>ol,scale:()=>rl,scaleAndAdd:()=>ll,set:()=>tl,sqrDist:()=>Al,sqrLen:()=>Dl,squaredDistance:()=>Ae,squaredLength:()=>Re,str:()=>Sl,sub:()=>Ml,subtract:()=>Me,transformMat2:()=>_l,transformMat2d:()=>Pl,transformMat3:()=>gl,transformMat4:()=>fl,zero:()=>Cl});function Be(){var e=new D(2);return D!=Float32Array&&(e[0]=0,e[1]=0),e}function Yr(e){var t=new D(2);return t[0]=e[0],t[1]=e[1],t}function Zr(e,t){var i=new D(2);return i[0]=e,i[1]=t,i}function $r(e,t){return e[0]=t[0],e[1]=t[1],e}function tl(e,t,i){return e[0]=t,e[1]=i,e}function el(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function Me(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}function Ie(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e}function Le(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e}function il(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function sl(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function nl(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e}function al(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e}function ol(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function rl(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}function ll(e,t,i,s){return e[0]=t[0]+i[0]*s,e[1]=t[1]+i[1]*s,e}function Ve(e,t){var i=t[0]-e[0],s=t[1]-e[1];return Math.hypot(i,s)}function Ae(e,t){var i=t[0]-e[0],s=t[1]-e[1];return i*i+s*s}function De(e){var t=e[0],i=e[1];return Math.hypot(t,i)}function Re(e){var t=e[0],i=e[1];return t*t+i*i}function ml(e,t){return e[0]=-t[0],e[1]=-t[1],e}function yl(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function ul(e,t){var i=t[0],s=t[1],n=i*i+s*s;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e}function cl(e,t){return e[0]*t[0]+e[1]*t[1]}function hl(e,t,i){var s=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=s,e}function pl(e,t,i,s){var n=t[0],a=t[1];return e[0]=n+s*(i[0]-n),e[1]=a+s*(i[1]-a),e}function dl(e,t){t=t||1;var i=w()*2*Math.PI;return e[0]=Math.cos(i)*t,e[1]=Math.sin(i)*t,e}function _l(e,t,i){var s=t[0],n=t[1];return e[0]=i[0]*s+i[2]*n,e[1]=i[1]*s+i[3]*n,e}function Pl(e,t,i){var s=t[0],n=t[1];return e[0]=i[0]*s+i[2]*n+i[4],e[1]=i[1]*s+i[3]*n+i[5],e}function gl(e,t,i){var s=t[0],n=t[1];return e[0]=i[0]*s+i[3]*n+i[6],e[1]=i[1]*s+i[4]*n+i[7],e}function fl(e,t,i){var s=t[0],n=t[1];return e[0]=i[0]*s+i[4]*n+i[12],e[1]=i[1]*s+i[5]*n+i[13],e}function Tl(e,t,i,s){var n=t[0]-i[0],a=t[1]-i[1],r=Math.sin(s),l=Math.cos(s);return e[0]=n*l-a*r+i[0],e[1]=n*r+a*l+i[1],e}function bl(e,t){var i=e[0],s=e[1],n=t[0],a=t[1],r=Math.sqrt(i*i+s*s)*Math.sqrt(n*n+a*a),l=r&&(i*n+s*a)/r;return Math.acos(Math.min(Math.max(l,-1),1))}function Cl(e){return e[0]=0,e[1]=0,e}function Sl(e){return"vec2("+e[0]+", "+e[1]+")"}function xl(e,t){return e[0]===t[0]&&e[1]===t[1]}function vl(e,t){var i=e[0],s=e[1],n=t[0],a=t[1];return Math.abs(i-n)<=M*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(s-a)<=M*Math.max(1,Math.abs(s),Math.abs(a))}var Bl,Ml,Il,Ll,Vl,Al,Dl,Rl,Ee=H(()=>{U();Bl=De,Ml=Me,Il=Ie,Ll=Le,Vl=Ve,Al=Ae,Dl=Re,Rl=function(){var e=Be();return function(t,i,s,n,a,r){var l,y;for(i||(i=2),s||(s=0),n?y=Math.min(n*i+s,t.length):y=t.length,l=s;l<y;l+=i)e[0]=t[l],e[1]=t[l+1],a(e,e,r),t[l]=e[0],t[l+1]=e[1];return t}}()});var Z=H(()=>{U();_t();ft();Ft();ve();Ee();Ct();Et()});var El={};var Oe=H(()=>{Z();Array.prototype.pp_first=function(){return this.length>0?this[0]:void 0};Array.prototype.pp_last=function(){return this.length>0?this[this.length-1]:void 0};Array.prototype.pp_has=function(e){return this.pp_find(e)!=null};Array.prototype.pp_hasEqual=function(e,t=null){return this.pp_findEqual(e,t)!=null};Array.prototype.pp_find=function(e){let t,i=this.findIndex(e);return i>=0&&(t=this[i]),t};Array.prototype.pp_findIndex=function(e){return this.findIndex(e)};Array.prototype.pp_findAll=function(e){return this.filter(e)};Array.prototype.pp_findAllIndexes=function(e){let t=[];for(let i=0;i<this.length;i++){let s=this[i];e(s)&&t.push(i)}return t};Array.prototype.pp_findEqual=function(e,t=null){return t==null?this.pp_find(i=>i===e):this.pp_find(i=>t(i,e))};Array.prototype.pp_findAllEqual=function(e,t=null){return t==null?this.pp_findAll(i=>i===e):this.pp_findAll(i=>t(i,e))};Array.prototype.pp_findIndexEqual=function(e,t=null){return t==null?this.findIndex(i=>i===e):this.findIndex(i=>t(i,e))};Array.prototype.pp_findAllIndexesEqual=function(e,t=null){return t==null?this.pp_findAllIndexes(i=>i===e):this.pp_findAllIndexes(i=>t(i,e))};Array.prototype.pp_removeIndex=function(e){let t;if(e>=0&&e<this.length){let i=this.splice(e,1);i.length==1&&(t=i[0])}return t};Array.prototype.pp_remove=function(e){let t,i=this.findIndex(e);return i>=0&&(t=this.pp_removeIndex(i)),t};Array.prototype.pp_removeAll=function(e){let t=[],i;do i=this.pp_remove(e),i!==void 0&&t.push(i);while(i!==void 0);return t};Array.prototype.pp_removeEqual=function(e,t=null){return t==null?this.pp_remove(i=>i===e):this.pp_remove(i=>t(i,e))};Array.prototype.pp_removeAllEqual=function(e,t=null){return t==null?this.pp_removeAll(i=>i===e):this.pp_removeAll(i=>t(i,e))};Array.prototype.pp_pushUnique=function(e,t=null){let i=this.length;return this.pp_hasEqual(e,t)||(i=this.push(e)),i};Array.prototype.pp_unshiftUnique=function(e,t=null){let i=this.length;return this.pp_hasEqual(e,t)||(i=this.unshift(e)),i};Array.prototype.pp_copy=function(e,t=null){for(;this.length>e.length;)this.pop();for(let i=0;i<e.length;i++)t==null?this[i]=e[i]:this[i]=t(this[i],e[i]);return this};Array.prototype.pp_clone=function(e=null){if(e==null)return this.slice(0);let t=null;switch(this.constructor.name){case"Array":t=new Array(this.length);break;case"Uint32Array":t=new Uint32Array(this.length);break;case"Int32Array":t=new Int32Array(this.length);break;case"Float32Array":t=new Float32Array(this.length);break;case"Float64Array":t=new Float64Array(this.length);break;default:t=new Array(this.length),console.error("Cloned array type not supported!");break}for(let i=0;i<this.length;i++)t[i]=e(this[i]);return t};Array.prototype.pp_equals=function(e,t=null){let i=!0;if(e!=null&&this.length==e.length){for(let s=0;s<this.length;s++)if(t!=null&&!t(this[s],e[s])||t==null&&this[s]!=e[s]){i=!1;break}}else i=!1;return i};Array.prototype.pp_clear=function(){return this.length=0,this};Array.prototype.vec_toString=function(e=null){return this._vec_buildConsoleMessage(e)};Array.prototype.vec_log=function(e=4){let t=this._vec_buildConsoleMessage(e);console.log(t)};Array.prototype.vec_error=function(e=4){let t=this._vec_buildConsoleMessage(e);console.error(t)};Array.prototype.vec_warn=function(e=4){let t=this._vec_buildConsoleMessage(e);console.warn(t)};Array.prototype.vec_scale=function(e,t=null){t=this._vec_prepareOut(t);for(let i=0;i<t.length;i++)t[i]=t[i]*e;return t};Array.prototype.vec_round=function(e=null){e=this._vec_prepareOut(e);for(let t=0;t<e.length;t++)e[t]=Math.round(e[t]);return e};Array.prototype.vec_floor=function(e=null){e=this._vec_prepareOut(e);for(let t=0;t<e.length;t++)e[t]=Math.floor(e[t]);return e};Array.prototype.vec_ceil=function(e=null){e=this._vec_prepareOut(e);for(let t=0;t<e.length;t++)e[t]=Math.ceil(e[t]);return e};Array.prototype.vec_clamp=function(e,t,i=null){i=this._vec_prepareOut(i);let s=e??-Number.MAX_VALUE,n=t??Number.MAX_VALUE,a=Math.min(s,n),r=Math.max(s,n);for(let l=0;l<i.length;l++)i[l]=Math.min(Math.max(i[l],a),r);return i};Array.prototype.vec_equals=function(e,t=0){let i=this.length==e.length;for(let s=0;s<this.length&&i;s++)i=i&&Math.abs(this[s]-e[s])<=t;return i};Array.prototype.vec2_set=function(e,t=null){return t==null?N.set(this,e,e):N.set(this,e,t),this};Array.prototype.vec2_length=function(){return N.length(this)};Array.prototype.vec2_normalize=function(e=N.create()){return N.normalize(e,this),e};Array.prototype.vec2_copy=function(e){return N.copy(this,e),this};Array.prototype.vec2_clone=function(e=N.create()){return N.copy(e,this),e};Array.prototype.vec2_zero=function(){return N.zero(this),this};Array.prototype.vec2_isZero=function(){return this.vec2_length()==0};Array.prototype.vec3_normalize=function(e=d.create()){return d.normalize(e,this),e};Array.prototype.vec3_copy=function(e){return d.copy(this,e),this};Array.prototype.vec3_clone=function(e=d.create()){return d.copy(e,this),e};Array.prototype.vec3_set=function(e,t=null,i=null){return t==null?d.set(this,e,e,e):d.set(this,e,t,i),this};Array.prototype.vec3_zero=function(){return d.zero(this),this};Array.prototype.vec3_angle=function(e){return this.vec3_angleDegrees(e)};Array.prototype.vec3_angleDegrees=function(e){return this.vec3_angleRadians(e)*(180/Math.PI)};Array.prototype.vec3_angleRadians=function(e){return this.vec3_isZero()||e.vec3_isZero()?0:d.angle(this,e)};Array.prototype.vec3_length=function(){return d.length(this)};Array.prototype.vec3_distance=function(e){return d.dist(this,e)};Array.prototype.vec3_add=function(e,t=d.create()){return d.add(t,this,e),t};Array.prototype.vec3_sub=function(e,t=d.create()){return d.sub(t,this,e),t};Array.prototype.vec3_mul=function(e,t=d.create()){return d.mul(t,this,e),t};Array.prototype.vec3_div=function(e,t=d.create()){return d.div(t,this,e),t};Array.prototype.vec3_scale=function(e,t=d.create()){return d.scale(t,this,e),t};Array.prototype.vec3_negate=function(e=d.create()){return d.negate(e,this),e};Array.prototype.vec3_cross=function(e,t=d.create()){return d.cross(t,this,e),t};Array.prototype.vec3_transformQuat=function(e,t=d.create()){return d.transformQuat(t,this,e),t};Array.prototype.vec3_transformMat4=function(e,t=d.create()){return d.transformMat4(t,this,e),t};Array.prototype.vec3_lengthSigned=function(e){let t=d.length(this);return this.vec3_isConcordant(e)||(t*=-1),t};Array.prototype.vec3_angleSigned=function(e,t){return this.vec3_angleSignedDegrees(e,t)};Array.prototype.vec3_angleSignedDegrees=function(e,t){return this.vec3_angleSignedRadians(e,t)*(180/Math.PI)};Array.prototype.vec3_angleSignedRadians=function(){let e=d.create();return function(i,s){this.vec3_cross(i,e);let n=this.vec3_angleRadians(i);return e.vec3_isConcordant(s)||(n=-n),n}}();Array.prototype.vec3_toRadians=function(e=d.create()){return d.set(e,F.toRadian(this[0]),F.toRadian(this[1]),F.toRadian(this[2])),e};Array.prototype.vec3_toDegrees=function(e=d.create()){return d.set(e,this[0]*(180/Math.PI),this[1]*(180/Math.PI),this[2]*(180/Math.PI)),e};Array.prototype.vec3_toQuat=function(e){return this.vec3_degreesToQuat(e)};Array.prototype.vec3_radiansToQuat=function(e=f.create()){return e.quat_fromRadians(this),e};Array.prototype.vec3_degreesToQuat=function(e=f.create()){return e.quat_fromDegrees(this),e};Array.prototype.vec3_isNormalized=function(){return Math.abs(d.length(this)-1)<this._pp_epsilon};Array.prototype.vec3_isZero=function(e=0){return this.vec3_length()<=e};Array.prototype.vec3_componentAlongAxis=function(e,t=d.create()){let i=d.angle(this,e),s=Math.cos(i)*d.length(this);return d.copy(t,e),d.scale(t,t,s),t};Array.prototype.vec3_valueAlongAxis=function(){let e=d.create();return function(i){this.vec3_componentAlongAxis(i,e);let s=e.vec3_length();return e.vec3_isConcordant(i)||(s=-s),s}}();Array.prototype.vec3_removeComponentAlongAxis=function(){let e=d.create();return function(i,s=d.create()){return this.vec3_componentAlongAxis(i,e),d.sub(s,this,e),s}}();Array.prototype.vec3_copyComponentAlongAxis=function(){let e=d.create();return function(i,s,n=d.create()){return this.vec3_removeComponentAlongAxis(s,n),i.vec3_componentAlongAxis(s,e),n.vec3_add(e,n),n}}();Array.prototype.vec3_isConcordant=function(e){return d.angle(this,e)<=Math.PI/2};Array.prototype.vec3_isFurtherAlongAxis=function(){let e=d.create();return function(i,s){let n=this.vec3_componentAlongAxis(s,e).vec3_length(),a=this.vec3_isConcordant(s)?n:-n,r=i.vec3_componentAlongAxis(s,e).vec3_length(),l=i.vec3_isConcordant(s)?r:-r;return a>l}}();Array.prototype.vec3_isToTheRight=function(e,t){return this.vec3_signTo(e,t)>=0};Array.prototype.vec3_signTo=function(){let e=d.create(),t=d.create();return function(s,n,a=1){this.vec3_removeComponentAlongAxis(n,e),s.vec3_removeComponentAlongAxis(n,t);let r=this.vec3_angleSigned(s,n);return r>0?1:r==0?a:-1}}();Array.prototype.vec3_projectOnAxis=function(e,t=d.create()){return this.vec3_componentAlongAxis(e,t),t};Array.prototype.vec3_projectOnAxisAlongAxis=function(){let e=d.create(),t=d.create(),i=d.create();return function(n,a,r=d.create()){if(this.vec3_isOnAxis(n)||a.vec3_isOnAxis(n))r.vec3_copy(this);else if(a.vec3_cross(n,e),e.vec3_normalize(e),this.vec3_removeComponentAlongAxis(e,r),!r.vec3_isOnAxis(n)){r.vec3_projectOnAxis(n,t),t.vec3_sub(r,t),t.vec3_isConcordant(a)?i.vec3_copy(a):a.vec3_negate(i);let l=i.vec3_angleRadians(t),y=t.vec3_length()/Math.cos(l);i.vec3_normalize(i),i.vec3_scale(y,i),r.vec3_add(i,r),r.vec3_projectOnAxis(n,r)}return r}}();Array.prototype.vec3_projectOnPlane=function(e,t=d.create()){return this.vec3_removeComponentAlongAxis(e,t),t};Array.prototype.vec3_projectOnPlaneAlongAxis=function(){let e=d.create(),t=d.create();return function(s,n,a=d.create()){if(this.vec3_isOnPlane(s)||n.vec3_isOnPlane(s))a.vec3_copy(this);else{a.vec3_copy(this),a.vec3_projectOnPlane(s,e),e.vec3_sub(a,e),e.vec3_isConcordant(n)?t.vec3_copy(n):n.vec3_negate(t);let r=t.vec3_angleRadians(e),l=e.vec3_length()/Math.cos(r);t.vec3_normalize(t),t.vec3_scale(l,t),a.vec3_add(t,a),a.vec3_projectOnPlane(s,a)}return a}}();Array.prototype.vec3_isOnAxis=function(e){let t=this.vec3_angle(e);return Math.abs(t)<this._pp_degreesEpsilon||Math.abs(t-180)<this._pp_degreesEpsilon};Array.prototype.vec3_isOnPlane=function(e){let t=this.vec3_angle(e);return Math.abs(t-90)<this._pp_degreesEpsilon};Array.prototype.vec3_rotate=function(e,t){return this.vec3_rotateDegrees(e,t)};Array.prototype.vec3_rotateDegrees=function(){let e=d.create();return function(i,s){return this.vec3_rotateAroundDegrees(i,e,s)}}();Array.prototype.vec3_rotateRadians=function(){let e=d.create();return function(i,s){return this.vec3_rotateAroundRadians(i,e,s)}}();Array.prototype.vec3_rotateQuat=function(){let e=d.create();return function(i,s){return this.vec3_rotateAroundQuat(i,e,s)}}();Array.prototype.vec3_rotateAxis=function(e,t,i){return this.vec3_rotateAxisDegrees(e,t,i)};Array.prototype.vec3_rotateAxisDegrees=function(){let e=d.create();return function(i,s,n){return this.vec3_rotateAroundAxisDegrees(i,s,e,n)}}();Array.prototype.vec3_rotateAxisRadians=function(){let e=d.create();return function(i,s,n){return this.vec3_rotateAroundAxisRadians(i,s,e,n)}}();Array.prototype.vec3_rotateAround=function(e,t,i){return this.vec3_rotateAroundDegrees(e,t,i)};Array.prototype.vec3_rotateAroundDegrees=function(){let e=f.create();return function(i,s,n=d.create()){return i.vec3_degreesToQuat(e),this.vec3_rotateAroundQuat(e,s,n)}}();Array.prototype.vec3_rotateAroundRadians=function(){let e=f.create();return function(i,s,n=d.create()){return i.vec3_radiansToQuat(e),this.vec3_rotateAroundQuat(e,s,n)}}();Array.prototype.vec3_rotateAroundQuat=function(e,t,i=d.create()){return d.sub(i,this,t),d.transformQuat(i,i,e),d.add(i,i,t),i};Array.prototype.vec3_rotateAroundAxis=function(e,t,i,s){return this.vec3_rotateAroundAxisDegrees(e,t,i,s)};Array.prototype.vec3_rotateAroundAxisDegrees=function(e,t,i,s){return this.vec3_rotateAroundAxisRadians(F.toRadian(e),t,i,s)};Array.prototype.vec3_rotateAroundAxisRadians=function(){let e=f.create();return function(i,s,n,a=d.create()){return f.setAxisAngle(e,s,i),this.vec3_rotateAroundQuat(e,n,a)}}();Array.prototype.vec3_convertPositionToWorld=function(e,t){return this.vec3_convertPositionToWorldMatrix(e,t)};Array.prototype.vec3_convertPositionToLocal=function(e,t){return this.vec3_convertPositionToLocalMatrix(e,t)};Array.prototype.vec3_convertPositionToWorldMatrix=function(e,t=d.create()){return d.transformMat4(t,this,e),t};Array.prototype.vec3_convertPositionToLocalMatrix=function(){let e=S.create();return function(i,s=d.create()){return S.invert(e,i),d.transformMat4(s,this,e),s}}();Array.prototype.vec3_convertPositionToWorldQuat=function(){let e=S.create(),t=d.create(),i=f.create(),s=d.create();return d.set(s,1,1,1),function(a,r=d.create()){return a.quat2_getPosition(t),a.quat2_getRotationQuat(i),e.mat4_setPositionRotationQuatScale(t,i,s),this.vec3_convertPositionToWorldMatrix(e,r)}}();Array.prototype.vec3_convertPositionToLocalQuat=function(){let e=S.create(),t=d.create(),i=f.create(),s=d.create();return d.set(s,1,1,1),function(a,r=d.create()){return a.quat2_getPosition(t),a.quat2_getRotationQuat(i),e.mat4_setPositionRotationQuatScale(t,i,s),this.vec3_convertPositionToLocalMatrix(e,r)}}();Array.prototype.vec3_convertDirectionToWorld=function(e,t){return this.vec3_convertDirectionToWorldMatrix(e,t)};Array.prototype.vec3_convertDirectionToLocal=function(e,t){return this.vec3_convertDirectionToLocalMatrix(e,t)};Array.prototype.vec3_convertDirectionToWorldMatrix=function(){let e=f.create();return function(i,s=d.create()){return i.mat4_getRotationQuat(e),d.transformQuat(s,this,e),s}}();Array.prototype.vec3_convertDirectionToLocalMatrix=function(){let e=f.create();return function(i,s=d.create()){return i.mat4_getRotationQuat(e),f.conjugate(e,e),d.transformQuat(s,this,e),s}}();Array.prototype.vec3_convertDirectionToWorldQuat=function(){let e=f.create();return function(i,s=d.create()){return i.quat2_getRotationQuat(e),d.transformQuat(s,this,e),s}}();Array.prototype.vec3_convertDirectionToLocalQuat=function(){let e=f.create();return function(i,s=d.create()){return i.quat2_getRotationQuat(e),f.conjugate(e,e),d.transformQuat(s,this,e),s}}();Array.prototype.vec3_log=function(e=4){this.vec_log(e)};Array.prototype.vec3_error=function(e=4){this.vec_error(e)};Array.prototype.vec3_warn=function(e=4){this.vec_warn(e)};Array.prototype.vec3_addRotation=function(e,t){return this.vec3_degreesAddRotation(e,t)};Array.prototype.vec3_addRotationDegrees=function(e,t){return quat.vec3_degreesAddRotationDegrees(e,t)};Array.prototype.vec3_addRotationRadians=function(e,t){return quat.vec3_degreesAddRotationRadians(e,t)};Array.prototype.vec3_addRotationQuat=function(e,t){return quat.vec3_degreesAddRotationQuat(e,t)};Array.prototype.vec3_degreesAddRotation=function(e,t){return this.vec3_degreesAddRotationDegrees(e,t)};Array.prototype.vec3_degreesAddRotationDegrees=function(){let e=f.create();return function(i,s=d.create()){return this.vec3_degreesToQuat(e),e.quat_addRotationDegrees(i,e).quat_toDegrees(s)}}();Array.prototype.vec3_degreesAddRotationRadians=function(){let e=f.create();return function(i,s=d.create()){return this.vec3_degreesToQuat(e),e.quat_addRotationRadians(i,e).quat_toDegrees(s)}}();Array.prototype.vec3_degreesAddRotationQuat=function(){let e=f.create();return function(i,s=d.create()){return this.vec3_degreesToQuat(e),e.quat_addRotationQuat(i,e).quat_toDegrees(s)}}();Array.prototype.vec3_radiansAddRotation=function(e,t){return this.vec3_radiansAddRotationDegrees(e,t)};Array.prototype.vec3_radiansAddRotationDegrees=function(){let e=f.create();return function(i,s=d.create()){return this.vec3_radiansToQuat(e),e.quat_addRotationDegrees(i,e).quat_toRadians(s)}}();Array.prototype.vec3_radiansAddRotationRadians=function(){let e=f.create();return function(i,s=d.create()){return this.vec3_radiansToQuat(e),e.quat_addRotationRadians(i,e).quat_toRadians(s)}}();Array.prototype.vec3_radiansAddRotationQuat=function(){let e=f.create();return function(i,s=d.create()){return this.vec3_radiansToQuat(e),e.quat_addRotationQuat(i,e).quat_toRadians(s)}}();Array.prototype.vec3_toMatrix=function(e=V.create()){return this.vec3_degreesToMatrix(e)};Array.prototype.vec3_degreesToMatrix=function(){let e=f.create();return function(i=V.create()){return this.vec3_degreesToQuat(e),e.quat_toMatrix(i)}}();Array.prototype.vec3_radiansToMatrix=function(){let e=f.create();return function(i=V.create()){return this.vec3_radiansToQuat(e),e.quat_toMatrix(i)}}();Array.prototype.vec3_rotationTo=function(e,t){return this.vec3_rotationToDegrees(e,t)};Array.prototype.vec3_rotationToDegrees=function(){let e=f.create();return function(i,s=d.create()){return this.vec3_rotationToQuat(i,e),e.quat_toDegrees(s),s}}();Array.prototype.vec3_rotationToRadians=function(){let e=f.create();return function(i,s=d.create()){return this.vec3_rotationToQuat(i,e),e.quat_toRadians(s),s}}();Array.prototype.vec3_rotationToQuat=function(){let e=d.create();return function(i,s=f.create()){this.vec3_cross(i,e),e.vec3_normalize(e);let n=this.vec3_angleSigned(i,e);return s.quat_fromAxis(n,e),s.quat_normalize(s),s}}();Array.prototype.vec3_rotationToPivoted=function(e,t,i){return this.vec3_rotationToPivotedDegrees(e,t,i)};Array.prototype.vec3_rotationToPivotedDegrees=function(){let e=f.create();return function(i,s,n=d.create()){return this.vec3_rotationToPivotedQuat(i,s,e),e.quat_toDegrees(n),n}}();Array.prototype.vec3_rotationToPivotedRadians=function(){let e=f.create();return function(i,s,n=d.create()){return this.vec3_rotationToPivotedQuat(i,s,e),e.quat_toRadians(n),n}}();Array.prototype.vec3_rotationToPivotedQuat=function(){let e=d.create(),t=d.create(),i=d.create();return function(n,a,r=f.create()){this.vec3_removeComponentAlongAxis(a,e),n.vec3_removeComponentAlongAxis(a,t),e.vec3_cross(t,i),i.vec3_normalize(i);let l=e.vec3_angleSigned(t,i);return r.quat_fromAxis(l,i),r.quat_normalize(r),r}}();Array.prototype.vec3_lerp=function(e,t,i=d.create()){return t<=0?(i.vec3_copy(this),i):t>=1?(i.vec3_copy(e),i):(d.lerp(i,this,e,t),i)};Array.prototype.vec3_interpolate=function(e,t,i=PP.EasingFunction.linear,s=d.create()){let n=i(t);return this.vec3_lerp(e,n,s)};Array.prototype.vec4_set=function(e,t=null,i=null,s=null){return t==null?z.set(this,e,e,e,e):z.set(this,e,t,i,s),this};Array.prototype.vec4_copy=function(e){return z.copy(this,e),this};Array.prototype.quat_normalize=function(e=f.create()){return f.normalize(e,this),e};Array.prototype.quat_copy=function(e){return f.copy(this,e),this};Array.prototype.quat_clone=function(e=f.create()){return f.copy(e,this),e};Array.prototype.quat_set=function(e,t=null,i=null,s=null){return t==null?f.set(this,e,e,e,e):f.set(this,e,t,i,s),this};Array.prototype.quat_identity=function(){return f.identity(this),this};Array.prototype.quat_length=function(){return f.length(this)};Array.prototype.quat_invert=function(e=f.create()){return f.invert(e,this),e};Array.prototype.quat_mul=function(e,t=f.create()){return f.mul(t,this,e),t};Array.prototype.quat_getAxis=function(e=d.create()){return f.getAxisAngle(e,this),e};Array.prototype.quat_getAngle=function(){return this.quat_getAngleDegrees()};Array.prototype.quat_getAngleDegrees=function(){return this.quat_getAngleRadians()*(180/Math.PI)};Array.prototype.quat_getAngleRadians=function(){let e=d.create();return function(){return f.getAxisAngle(e,this)}}();Array.prototype.quat_getAxes=function(e=[d.create(),d.create(),d.create()]){return this.quat_getLeft(e[0]),this.quat_getUp(e[1]),this.quat_getForward(e[2]),e};Array.prototype.quat_getForward=function(){let e=V.create();return function(i=d.create()){return V.fromQuat(e,this),d.set(i,e[6],e[7],e[8]),d.normalize(i,i),i}}();Array.prototype.quat_getBackward=function(e){return e=this.quat_getForward(e),e.vec3_negate(e),e};Array.prototype.quat_getLeft=function(){let e=V.create();return function(i=d.create()){return V.fromQuat(e,this),d.set(i,e[0],e[1],e[2]),d.normalize(i,i),i}}();Array.prototype.quat_getRight=function(e){return e=this.quat_getLeft(e),e.vec3_negate(e),e};Array.prototype.quat_getUp=function(){let e=V.create();return function(i=d.create()){return V.fromQuat(e,this),d.set(i,e[3],e[4],e[5]),d.normalize(i,i),i}}();Array.prototype.quat_getDown=function(e){return e=this.quat_getUp(e),e.vec3_negate(e),e};Array.prototype.quat_setAxes=function(e,t,i){return i!=null?this.quat_setForward(i,t,e):t!=null?this.quat_setUp(t,i,e):this.quat_setLeft(e,t,i)};Array.prototype.quat_setForward=function(e,t=null,i=null){return this._quat_setAxes([i,t,e],[2,1,0])};Array.prototype.quat_setBackward=function(){let e=d.create();return function(i,s=null,n=null){return i.vec3_negate(e),this._quat_setAxes([n,s,e],[2,1,0])}}();Array.prototype.quat_setUp=function(e,t=null,i=null){return this._quat_setAxes([i,e,t],[1,2,0])};Array.prototype.quat_setDown=function(){let e=d.create();return function(i,s=null,n=null){return i.vec3_negate(e),this._quat_setAxes([n,e,s],[1,2,0])}}();Array.prototype.quat_setLeft=function(e,t=null,i=null){return this._quat_setAxes([e,t,i],[0,1,2])};Array.prototype.quat_setRight=function(){let e=d.create();return function(i,s=null,n=null){return i.vec3_negate(e),this._quat_setAxes([e,s,n],[0,1,2])}}();Array.prototype.quat_toWorld=function(e,t=f.create()){return f.mul(t,e,this),t};Array.prototype.quat_toLocal=function(){let e=f.create();return function(i,s=f.create()){return f.conjugate(e,i),f.mul(s,e,this),s}}();Array.prototype.quat_fromAxis=function(e,t){return this.quat_fromAxisDegrees(e,t)};Array.prototype.quat_fromAxisDegrees=function(e,t){return f.setAxisAngle(this,t,F.toRadian(e)),this};Array.prototype.quat_fromAxisRadians=function(e,t){return f.setAxisAngle(this,t,e),this};Array.prototype.quat_fromAxes=function(){let e=V.create();return function(i,s,n){return e.mat3_fromAxes(i,s,n),e.mat3_toQuat(this)}}();Array.prototype.quat_fromRadians=function(){let e=d.create();return function(i){return i.vec3_toDegrees(e),this.quat_fromDegrees(e)}}();Array.prototype.quat_fromDegrees=function(e){return f.fromEuler(this,e[0],e[1],e[2]),this};Array.prototype.quat_toRadians=function(){let e=V.create();return function(i=d.create()){return V.fromQuat(e,this),i[1]=Math.asin(-this._pp_clamp(e[2],-1,1)),Math.abs(e[2])<1-this._pp_epsilon?(i[0]=Math.atan2(e[5],e[8]),i[2]=Math.atan2(e[1],e[0])):(i[0]=0,i[2]=Math.atan2(-e[3],e[4])),i}}();Array.prototype.quat_toDegrees=function(e=d.create()){return this.quat_toRadians(e),e.vec3_toDegrees(e),e};Array.prototype.quat_isNormalized=function(){return Math.abs(f.length(this)-1)<this._pp_epsilon};Array.prototype.quat_addRotation=function(e,t){return this.quat_addRotationDegrees(e,t)};Array.prototype.quat_addRotationDegrees=function(){let e=f.create();return function(i,s){return i.vec3_degreesToQuat(e),this.quat_addRotationQuat(e,s)}}();Array.prototype.quat_addRotationRadians=function(){let e=f.create();return function(i,s){return i.vec3_radiansToQuat(e),this.quat_addRotationQuat(e,s)}}();Array.prototype.quat_addRotationQuat=function(e,t=f.create()){return e.quat_mul(this,t),t};Array.prototype.quat_subRotation=function(e,t){return this.quat_subRotationDegrees(e,t)};Array.prototype.quat_subRotationDegrees=function(){let e=f.create();return function(i,s){return i.vec3_degreesToQuat(e),this.quat_subRotationQuat(e,s)}}();Array.prototype.quat_subRotationRadians=function(){let e=f.create();return function(i,s){return i.vec3_radiansToQuat(e),this.quat_subRotationQuat(e,s)}}();Array.prototype.quat_subRotationQuat=function(){let e=f.create();return function(i,s=f.create()){return i.quat_invert(e),this.quat_mul(e,s),s.quat_normalize(s),s}}();Array.prototype.quat_rotationTo=function(e,t){return this.quat_rotationToDegrees(e,t)};Array.prototype.quat_rotationToDegrees=function(){let e=f.create();return function(i,s){return this.quat_rotationToQuat(i,e),e.quat_toDegrees(s)}}();Array.prototype.quat_rotationToRadians=function(){let e=f.create();return function(i,s){return this.quat_rotationToQuat(i,e),e.quat_toRadians(s)}}();Array.prototype.quat_rotationToQuat=function(e,t){return e.quat_subRotationQuat(this,t)};Array.prototype.quat_toMatrix=function(e=V.create()){return V.fromQuat(e,this),e};Array.prototype.quat_rotate=function(e,t){return this.quat_rotateDegrees(e,t)};Array.prototype.quat_rotateDegrees=function(e,t){return this.quat_addRotationDegrees(e,t)};Array.prototype.quat_rotateRadians=function(e,t){return this.quat_addRotationRadians(e,t)};Array.prototype.quat_rotateQuat=function(e,t){return this.quat_addRotationQuat(e,t)};Array.prototype.quat_rotateAxis=function(e,t,i){return this.quat_rotateAxisDegrees(e,t,i)};Array.prototype.quat_rotateAxisDegrees=function(){let e=f.create();return function(i,s,n){return e.quat_fromAxisDegrees(i,s),this.quat_rotateQuat(e,n)}}();Array.prototype.quat_rotateAxisRadians=function(){let e=f.create();return function(i,s,n){return e.quat_fromAxisRadians(i,s),this.quat_rotateQuat(e,n)}}();Array.prototype.quat_lerp=function(e,t,i=f.create()){return t<=0?(i.quat_copy(this),i):t>=1?(i.quat_copy(e),i):(f.lerp(i,this,e,t),i.quat_normalize(i),i)};Array.prototype.quat_interpolate=function(e,t,i=PP.EasingFunction.linear,s=f.create()){let n=i(t);return this.quat_lerp(e,n,s)};Array.prototype.quat_slerp=function(e,t,i=f.create()){return t<=0?(i.quat_copy(this),i):t>=1?(i.quat_copy(e),i):(f.slerp(i,this,e,t),i)};Array.prototype.quat_sinterpolate=function(e,t,i=PP.EasingFunction.linear,s=f.create()){let n=i(t);return this.quat_slerp(e,n,s)};Array.prototype.quat2_normalize=function(e=I.create()){return I.normalize(e,this),e};Array.prototype.quat2_copy=function(e){return I.copy(this,e),this};Array.prototype.quat2_identity=function(){return I.identity(this),this};Array.prototype.quat2_getPosition=function(e=d.create()){return I.getTranslation(e,this),e};Array.prototype.quat2_getRotation=function(e){return this.quat2_getRotationDegrees(e)};Array.prototype.quat2_getRotationDegrees=function(){let e=f.create();return function(i=d.create()){return this.quat2_getRotationQuat(e).quat_toDegrees(i),i}}();Array.prototype.quat2_getRotationRadians=function(){let e=f.create();return function(i=d.create()){return this.quat2_getRotationQuat(e).quat_toRadians(i),i}}();Array.prototype.quat2_getRotationQuat=function(e=f.create()){return f.copy(e,this),e};Array.prototype.quat2_setPositionRotation=function(e,t){return this.quat2_setPositionRotationDegrees(e,t)};Array.prototype.quat2_setPositionRotationDegrees=function(){let e=f.create();return function(i,s){return s.vec3_degreesToQuat(e),I.fromRotationTranslation(this,e,i),this}}();Array.prototype.quat2_setPositionRotationRadians=function(){let e=f.create();return function(i,s){return s.vec3_radiansToQuat(e),I.fromRotationTranslation(this,e,i),this}}();Array.prototype.quat2_setPositionRotationQuat=function(e,t){return I.fromRotationTranslation(this,t,e),this};Array.prototype.quat2_getAxes=function(e=[d.create(),d.create(),d.create()]){return this.quat2_getLeft(e[0]),this.quat2_getUp(e[1]),this.quat2_getForward(e[2]),e};Array.prototype.quat2_getForward=function(){let e=V.create();return function(i=d.create()){return V.fromQuat(e,this),d.set(i,e[6],e[7],e[8]),d.normalize(i,i),i}}();Array.prototype.quat2_getBackward=function(e){return e=this.quat2_getForward(e),e.vec3_negate(e),e};Array.prototype.quat2_getLeft=function(){let e=V.create();return function(i=d.create()){return V.fromQuat(e,this),d.set(i,e[0],e[1],e[2]),d.normalize(i,i),i}}();Array.prototype.quat2_getRight=function(e){return e=this.quat2_getLeft(e),e.vec3_negate(e),e};Array.prototype.quat2_getUp=function(){let e=V.create();return function(i=d.create()){return V.fromQuat(e,this),d.set(i,e[3],e[4],e[5]),d.normalize(i,i),i}}();Array.prototype.quat2_getDown=function(e){return e=this.quat2_getUp(e),e.vec3_negate(e),e};Array.prototype.quat2_toWorld=function(e,t=I.create()){return I.mul(t,e,this),t};Array.prototype.quat2_toLocal=function(){let e=I.create();return function(i,s=I.create()){return I.conjugate(e,i),I.mul(s,e,this),s}}();Array.prototype.quat2_toMatrix=function(e=S.create()){return S.fromQuat2(e,this),e};Array.prototype.quat2_fromMatrix=function(e){return e.mat4_toQuat(this),this};Array.prototype.quat2_lerp=function(e,t,i=I.create()){return t<=0?(i.quat2_copy(this),i):t>=1?(i.quat2_copy(e),i):(I.lerp(i,this,e,t),i.quat2_normalize(i),i)};Array.prototype.quat2_interpolate=function(e,t,i=PP.EasingFunction.linear,s=I.create()){let n=i(t);return this.quat2_lerp(e,n,s)};Array.prototype.mat3_toDegrees=function(){let e=f.create();return function(i=d.create()){return this.mat3_toQuat(e),e.quat_toDegrees(i),i}}();Array.prototype.mat3_toRadians=function(){let e=f.create();return function(i=d.create()){return this.mat3_toQuat(e),e.quat_toRadians(i),i}}();Array.prototype.mat3_toQuat=function(e=f.create()){return f.fromMat3(e,this),e.quat_normalize(e),e};Array.prototype.mat3_fromAxes=function(e,t,i){return V.set(this,e[0],e[1],e[2],t[0],t[1],t[2],i[0],i[1],i[2]),this};Array.prototype.mat4_copy=function(e){return S.copy(this,e),this};Array.prototype.mat4_identity=function(){return S.identity(this),this};Array.prototype.mat4_invert=function(e=S.create()){return S.invert(e,this),e};Array.prototype.mat4_clone=function(e=S.create()){return S.copy(e,this),e};Array.prototype.mat4_getPosition=function(e=d.create()){return S.getTranslation(e,this),e};Array.prototype.mat4_getRotation=function(e=d.create()){return this.mat4_getRotationDegrees(e)};Array.prototype.mat4_getRotationDegrees=function(){let e=f.create();return function(i=d.create()){return this.mat4_getRotationQuat(e),e.quat_toDegrees(i),i}}();Array.prototype.mat4_getRotationRadians=function(){let e=f.create();return function(i=d.create()){return this.mat4_getRotationQuat(e),e.quat_toRadians(i),i}}();Array.prototype.mat4_getRotationQuat=function(){let e=d.create(),t=S.create(),i=d.create(),s=d.create();return d.set(s,1,1,1),function(a=f.create()){return S.getScaling(e,this),d.divide(i,s,e),S.scale(t,this,i),S.getRotation(a,t),f.normalize(a,a),a}}();Array.prototype.mat4_getScale=function(e=d.create()){return S.getScaling(e,this),e};Array.prototype.mat4_setPosition=function(e){return this[12]=e[0],this[13]=e[1],this[14]=e[2],this};Array.prototype.mat4_setRotation=function(e){return this.mat4_setRotationDegrees(e),this};Array.prototype.mat4_setRotationDegrees=function(){let e=f.create();return function(i){return this.mat4_setRotationQuat(i.vec3_degreesToQuat(e)),this}}();Array.prototype.mat4_setRotationRadians=function(){let e=d.create();return function(i){return this.mat4_setRotationDegrees(i.vec3_toDegrees(e)),this}}();Array.prototype.mat4_setRotationQuat=function(){let e=d.create(),t=d.create();return function(s){return this.mat4_getPosition(e),this.mat4_getScale(t),this.mat4_setPositionRotationQuatScale(e,s,t),this}}();Array.prototype.mat4_setScale=function(){let e=d.create();return function(i){return S.getScaling(e,this),d.divide(e,i,e),S.scale(this,this,e),this}}();Array.prototype.mat4_setPositionRotationScale=function(e,t,i){return this.mat4_setPositionRotationDegreesScale(e,t,i),this};Array.prototype.mat4_setPositionRotationDegreesScale=function(){let e=f.create();return function(i,s,n){return this.mat4_setPositionRotationQuatScale(i,s.vec3_degreesToQuat(e),n),this}}();Array.prototype.mat4_setPositionRotationRadiansScale=function(){let e=d.create();return function(i,s,n){return this.mat4_setPositionRotationDegreesScale(i,s.vec3_toDegrees(e),n),this}}();Array.prototype.mat4_setPositionRotationQuatScale=function(e,t,i){return S.fromRotationTranslationScale(this,t,e,i),this};Array.prototype.mat4_setPositionRotation=function(e,t){return this.mat4_setPositionRotationDegrees(e,t),this};Array.prototype.mat4_setPositionRotationDegrees=function(){let e=f.create();return function(i,s){return this.mat4_setPositionRotationQuat(i,s.vec3_degreesToQuat(e)),this}}();Array.prototype.mat4_setPositionRotationRadians=function(){let e=d.create();return function(i,s){return this.mat4_setPositionRotationDegrees(i,s.vec3_toDegrees(e)),this}}();Array.prototype.mat4_setPositionRotationQuat=function(e,t){return S.fromRotationTranslation(this,t,e),this};Array.prototype.mat4_getAxes=function(e=[d.create(),d.create(),d.create()]){return this.mat4_getLeft(e[0]),this.mat4_getUp(e[1]),this.mat4_getForward(e[2]),e};Array.prototype.mat4_getForward=function(e=d.create()){return d.set(e,this[8],this[9],this[10]),d.normalize(e,e),e};Array.prototype.mat4_getBackward=function(e){return e=this.mat4_getForward(e),e.vec3_negate(e),e};Array.prototype.mat4_getLeft=function(e=d.create()){return d.set(e,this[0],this[1],this[2]),d.normalize(e,e),e};Array.prototype.mat4_getRight=function(e){return e=this.mat4_getLeft(e),e.vec3_negate(e),e};Array.prototype.mat4_getUp=function(e=d.create()){return d.set(e,this[4],this[5],this[6]),d.normalize(e,e),e};Array.prototype.mat4_getDown=function(e){return e=this.mat4_getUp(e),e.vec3_negate(e),e};Array.prototype.mat4_toWorld=function(){let e=S.create(),t=d.create(),i=d.create(),s=d.create(),n=d.create();return d.set(n,1,1,1),function(r,l=S.create()){return r.mat4_hasUniformScale()?S.mul(l,r,this):(d.set(t,this[12],this[13],this[14]),t.vec3_convertPositionToWorldMatrix(r,t),S.getScaling(i,r),d.divide(s,n,i),S.scale(e,r,s),S.mul(l,e,this),S.scale(l,l,i),l[12]=t[0],l[13]=t[1],l[14]=t[2],l[15]=1),l}}();Array.prototype.mat4_toLocal=function(){let e=S.create(),t=d.create(),i=d.create(),s=d.create(),n=d.create();return d.set(n,1,1,1),function(r,l=S.create()){return r.mat4_hasUniformScale()?(S.invert(e,r),S.mul(l,e,this)):(d.set(t,this[12],this[13],this[14]),t.vec3_convertPositionToLocalMatrix(r,t),S.getScaling(i,r),d.divide(s,n,i),S.scale(e,r,s),S.invert(e,e),S.mul(l,e,this),S.scale(l,l,s),l[12]=t[0],l[13]=t[1],l[14]=t[2],l[15]=1),l}}();Array.prototype.mat4_hasUniformScale=function(){let e=d.create();return function(){return S.getScaling(e,this),Math.abs(e[0]-e[1])<this._pp_epsilon&&Math.abs(e[1]-e[2])<this._pp_epsilon&&Math.abs(e[0]-e[2])<this._pp_epsilon}}();Array.prototype.mat4_toQuat=function(){let e=d.create(),t=f.create();return function(s=I.create()){return S.getTranslation(e,this),this.mat4_getRotationQuat(t),I.fromRotationTranslation(s,t,e),s}}();Array.prototype.mat4_fromQuat=function(e){return e.quat2_toMatrix(this),this};PP.vec2_create=function(e=null,t=null){let i=N.create();return e!=null&&i.vec2_set(e,t),i};PP.vec3_create=function(e=null,t=null,i=null){let s=d.create();return e!=null&&s.vec3_set(e,t,i),s};PP.vec4_create=function(e=null,t=null,i=null,s=null){let n=z.create();return e!=null&&n.vec4_set(e,t,i,s),n};PP.quat_create=function(e=null,t=null,i=null,s=null){let n=f.create();return e!=null&&n.quat_set(e,t,i,s),n};PP.quat2_create=function(){return I.create()};PP.quat2_fromPositionRotation=function(e,t){return quat2_fromPositionRotationDegrees(e,t)};PP.quat2_fromPositionRotationDegrees=function(e,t){let i=S.create();return i.quat2_setPositionRotationDegrees(e,t),i};PP.quat2_fromPositionRotationRadians=function(e,t){let i=S.create();return i.quat2_setPositionRotationRadians(e,t),i};PP.quat2_fromPositionRotationQuat=function(e,t){let i=I.create();return i.quat2_setPositionRotationQuat(e,t),i};PP.mat4_create=function(){return S.create()};PP.mat4_fromPositionRotation=function(e,t){return mat4_fromPositionRotationDegrees(e,t)};PP.mat4_fromPositionRotationDegrees=function(e,t){let i=S.create();return i.mat4_setPositionRotationDegrees(e,t),i};PP.mat4_fromPositionRotationRadians=function(e,t){let i=S.create();return i.mat4_setPositionRotationRadians(e,t),i};PP.mat4_fromPositionRotationQuat=function(e,t){let i=S.create();return i.mat4_setPositionRotationQuat(e,t),i};PP.mat4_fromPositionRotationScale=function(e,t,i){return mat4_fromPositionRotationDegreesScale(e,t,i)};PP.mat4_fromPositionRotationDegreesScale=function(e,t,i){let s=S.create();return s.mat4_setPositionRotationDegreesScale(e,t,i),s};PP.mat4_fromPositionRotationRadiansScale=function(e,t,i){let s=S.create();return s.mat4_setPositionRotationRadiansScale(e,t,i),s};PP.mat4_fromPositionRotationQuatScale=function(e,t,i){let s=S.create();return s.mat4_setPositionRotationQuatScale(e,t,i),s};Array.prototype._pp_epsilon=1e-6;Array.prototype._pp_degreesEpsilon=1e-5;Array.prototype._pp_clamp=function(e,t,i){return Math.min(Math.max(e,t),i)};Array.prototype._vec_buildConsoleMessage=function(e){let t="[";for(let i=0;i<this.length;i++)i!=0&&(t=t.concat(", ")),e!=null?t=t.concat(this[i].toFixed(e)):t=t.concat(this[i].toString());return t=t.concat("]"),t};Array.prototype._vec_prepareOut=function(e){return e==null?e=this.pp_clone():e!=this&&e.pp_copy(this),e};Array.prototype._quat_setAxes=function(){let e=[d.create(),d.create(),d.create()],t=[[1,-1,1],[1,1,-1],[-1,1,-1]],i=d.create(),s=d.create(),n=d.create(),a=d.create(),r=d.create(),l=V.create(),y=f.create();return function(o,m){let u=o[m[0]],h=o[m[1]],_=o[m[2]];if(u==null)return this;let P=!1;h!=null&&d.angle(u,h)>this._pp_epsilon&&(P=!0);let p=!1;if(_!=null&&d.angle(u,_)>this._pp_epsilon&&(p=!0),P||p){let g=null,b=null,C=null;P?(g=h,b=1,C=2):(g=_,b=2,C=1);let x=t[m[0]];d.cross(e[C],u,g),d.scale(e[C],e[C],x[m[C]]),d.cross(e[b],u,e[C]),d.scale(e[b],e[b],x[m[b]]),d.cross(e[0],e[1],e[2]),d.scale(e[0],e[0],x[m[0]]),d.normalize(i,e[m.pp_findIndexEqual(0)]),d.normalize(s,e[m.pp_findIndexEqual(1)]),d.normalize(n,e[m.pp_findIndexEqual(2)]),V.set(l,i[0],i[1],i[2],s[0],s[1],s[2],n[0],n[1],n[2]),f.fromMat3(y,l),f.normalize(y,y),this.quat_copy(y)}else{m[0]==0?this.quat_getLeft(a):m[0]==1?this.quat_getUp(a):this.quat_getForward(a);let g=d.angle(u,a);g!=0&&(d.cross(r,a,u),d.normalize(r,r),f.setAxisAngle(y,r,g),this.quat_rotateQuat(y,this))}return this}}();for(let e in Array.prototype){let t=["pp_","vec_","vec2_","vec3_","vec4_","quat_","quat2_","mat3_","mat4_","_pp_","_vec_","_quat_"],i=!1;for(let s of t)if(e.startsWith(s)){i=!0;break}i&&(Object.defineProperty(Array.prototype,e,{enumerable:!1}),Uint8ClampedArray.prototype[e]=Array.prototype[e],Object.defineProperty(Uint8ClampedArray.prototype,e,{enumerable:!1}),Uint8ClampedArray.prototype[e]=Array.prototype[e],Object.defineProperty(Uint8ClampedArray.prototype,e,{enumerable:!1}),Uint8Array.prototype[e]=Array.prototype[e],Object.defineProperty(Uint8Array.prototype,e,{enumerable:!1}),Uint16Array.prototype[e]=Array.prototype[e],Object.defineProperty(Uint16Array.prototype,e,{enumerable:!1}),Uint32Array.prototype[e]=Array.prototype[e],Object.defineProperty(Uint32Array.prototype,e,{enumerable:!1}),Int8Array.prototype[e]=Array.prototype[e],Object.defineProperty(Int8Array.prototype,e,{enumerable:!1}),Int16Array.prototype[e]=Array.prototype[e],Object.defineProperty(Int16Array.prototype,e,{enumerable:!1}),Int32Array.prototype[e]=Array.prototype[e],Object.defineProperty(Int32Array.prototype,e,{enumerable:!1}),Float32Array.prototype[e]=Array.prototype[e],Object.defineProperty(Float32Array.prototype,e,{enumerable:!1}),Float64Array.prototype[e]=Array.prototype[e],Object.defineProperty(Float64Array.prototype,e,{enumerable:!1}))}});var Ol={};var We=H(()=>{Z();if(WL&&WL.Object){WL.Object.prototype.pp_getPosition=function(e){return this.pp_getPositionWorld(e)},WL.Object.prototype.pp_getPositionWorld=function(e=d.create()){return this.getTranslationWorld(e),e},WL.Object.prototype.pp_getPositionLocal=function(e=d.create()){return this.getTranslationLocal(e),e},WL.Object.prototype.pp_getRotation=function(e){return this.pp_getRotationWorld(e)},WL.Object.prototype.pp_getRotationDegrees=function(e){return this.pp_getRotationWorldDegrees(e)},WL.Object.prototype.pp_getRotationRadians=function(e){return this.pp_getRotationWorldRadians(e)},WL.Object.prototype.pp_getRotationMatrix=function(e){return this.pp_getRotationWorldMatrix(e)},WL.Object.prototype.pp_getRotationQuat=function(e){return this.pp_getRotationWorldQuat(e)},WL.Object.prototype.pp_getRotationWorld=function(e){return this.pp_getRotationWorldDegrees(e)},WL.Object.prototype.pp_getRotationWorldDegrees=function(e){return e=this.pp_getRotationWorldRadians(e),e.forEach(function(t,i,s){s[i]=this._pp_toDegrees(t)}.bind(this)),e},WL.Object.prototype.pp_getRotationWorldRadians=function(){let e=f.create();return function(i=d.create()){return this.pp_getRotationWorldQuat(e),this._pp_quaternionToRadians(e,i),i}}(),WL.Object.prototype.pp_getRotationWorldMatrix=function(){let e=f.create();return function(i=V.create()){return this.pp_getRotationWorldQuat(e),V.fromQuat(i,e),i}}(),WL.Object.prototype.pp_getRotationWorldQuat=function(e=f.create()){return f.copy(e,this.rotationWorld),e},WL.Object.prototype.pp_getRotationLocal=function(e){return this.pp_getRotationLocalDegrees(e)},WL.Object.prototype.pp_getRotationLocalDegrees=function(e){return e=this.pp_getRotationLocalRadians(e),e.forEach(function(t,i,s){s[i]=this._pp_toDegrees(t)}.bind(this)),e},WL.Object.prototype.pp_getRotationLocalRadians=function(){let e=f.create();return function(i=d.create()){return this.pp_getRotationLocalQuat(e),this._pp_quaternionToRadians(e,i),i}}(),WL.Object.prototype.pp_getRotationLocalMatrix=function(){let e=f.create();return function(i=V.create()){return this.pp_getRotationLocalQuat(e),V.fromQuat(i,e),i}}(),WL.Object.prototype.pp_getRotationLocalQuat=function(e=f.create()){return f.copy(e,this.rotationLocal),e},WL.Object.prototype.pp_getScale=function(e){return this.pp_getScaleWorld(e)},WL.Object.prototype.pp_getScaleWorld=function(e=d.create()){return d.copy(e,this.scalingWorld),e},WL.Object.prototype.pp_getScaleLocal=function(e=d.create()){return d.copy(e,this.scalingLocal),e},WL.Object.prototype.pp_getTransform=function(e){return this.pp_getTransformWorld(e)},WL.Object.prototype.pp_getTransformMatrix=function(e){return this.pp_getTransformWorldMatrix(e)},WL.Object.prototype.pp_getTransformQuat=function(e){return this.pp_getTransformWorldQuat(e)},WL.Object.prototype.pp_getTransformWorld=function(e){return this.pp_getTransformWorldMatrix(e)},WL.Object.prototype.pp_getTransformWorldMatrix=function(){let e=I.create(),t=d.create();return function(s=S.create()){return this.pp_getTransformWorldQuat(e),this.pp_getScaleWorld(t),S.fromQuat2(s,e),S.scale(s,s,t),s}}(),WL.Object.prototype.pp_getTransformWorldQuat=function(e=I.create()){return I.copy(e,this.transformWorld),e},WL.Object.prototype.pp_getTransformLocal=function(e){return this.pp_getTransformLocalMatrix(e)},WL.Object.prototype.pp_getTransformLocalMatrix=function(){let e=I.create(),t=d.create();return function(s=S.create()){return this.pp_getTransformLocalQuat(e),this.pp_getScaleLocal(t),S.fromQuat2(s,e),S.scale(s,s,t),s}}(),WL.Object.prototype.pp_getTransformLocalQuat=function(e=I.create()){return I.copy(e,this.transformLocal),e},WL.Object.prototype.pp_getAxes=function(e){return this.pp_getAxesWorld(e)},WL.Object.prototype.pp_getAxesWorld=function(e=[d.create(),d.create(),d.create()]){return this.pp_getLeftWorld(e[0]),this.pp_getUpWorld(e[1]),this.pp_getForwardWorld(e[2]),e},WL.Object.prototype.pp_getAxesLocal=function(e=[d.create(),d.create(),d.create()]){return this.pp_getLeftLocal(e[0]),this.pp_getUpLocal(e[1]),this.pp_getForwardLocal(e[2]),e},WL.Object.prototype.pp_getForward=function(e){return this.pp_getForwardWorld(e)},WL.Object.prototype.pp_getForwardWorld=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationWorldMatrix(e),i[0]=e[6],i[1]=e[7],i[2]=e[8],i}}(),WL.Object.prototype.pp_getForwardLocal=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationLocalMatrix(e),i[0]=e[6],i[1]=e[7],i[2]=e[8],i}}(),WL.Object.prototype.pp_getBackward=function(e){return this.pp_getBackwardWorld(e)},WL.Object.prototype.pp_getBackwardWorld=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationWorldMatrix(e),i[0]=-e[6],i[1]=-e[7],i[2]=-e[8],i}}(),WL.Object.prototype.pp_getBackwardLocal=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationLocalMatrix(e),i[0]=-e[6],i[1]=-e[7],i[2]=-e[8],i}}(),WL.Object.prototype.pp_getUp=function(e){return this.pp_getUpWorld(e)},WL.Object.prototype.pp_getUpWorld=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationWorldMatrix(e),i[0]=e[3],i[1]=e[4],i[2]=e[5],i}}(),WL.Object.prototype.pp_getUpLocal=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationLocalMatrix(e),i[0]=e[3],i[1]=e[4],i[2]=e[5],i}}(),WL.Object.prototype.pp_getDown=function(e){return this.pp_getDownWorld(e)},WL.Object.prototype.pp_getDownWorld=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationWorldMatrix(e),i[0]=-e[3],i[1]=-e[4],i[2]=-e[5],i}}(),WL.Object.prototype.pp_getDownLocal=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationLocalMatrix(e),i[0]=-e[3],i[1]=-e[4],i[2]=-e[5],i}}(),WL.Object.prototype.pp_getLeft=function(e){return this.pp_getLeftWorld(e)},WL.Object.prototype.pp_getLeftWorld=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationWorldMatrix(e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i}}(),WL.Object.prototype.pp_getLeftLocal=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationLocalMatrix(e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i}}(),WL.Object.prototype.pp_getRight=function(e){return this.pp_getRightWorld(e)},WL.Object.prototype.pp_getRightWorld=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationWorldMatrix(e),i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i}}(),WL.Object.prototype.pp_getRightLocal=function(){let e=V.create();return function(i=d.create()){return this.pp_getRotationLocalMatrix(e),i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i}}(),WL.Object.prototype.pp_setPosition=function(e){this.pp_setPositionWorld(e)},WL.Object.prototype.pp_setPositionWorld=function(e){this.setTranslationWorld(e)},WL.Object.prototype.pp_setPositionLocal=function(e){this.setTranslationLocal(e)},WL.Object.prototype.pp_setRotation=function(e){this.pp_setRotationWorld(e)},WL.Object.prototype.pp_setRotationDegrees=function(e){this.pp_setRotationWorldDegrees(e)},WL.Object.prototype.pp_setRotationRadians=function(e){this.pp_setRotationWorldRadians(e)},WL.Object.prototype.pp_setRotationMatrix=function(e){this.pp_setRotationWorldMatrix(e)},WL.Object.prototype.pp_setRotationQuat=function(e){this.pp_setRotationWorldQuat(e)},WL.Object.prototype.pp_setRotationWorld=function(e){this.pp_setRotationWorldDegrees(e)},WL.Object.prototype.pp_setRotationWorldDegrees=function(){let e=f.create();return function(i){this._pp_degreesToQuaternion(i,e),this.pp_setRotationWorldQuat(e)}}(),WL.Object.prototype.pp_setRotationWorldRadians=function(){let e=d.create();return function(i){i.forEach(function(s,n,a){e[n]=this._pp_toDegrees(s)}.bind(this)),this.pp_setRotationWorldDegrees(e)}}(),WL.Object.prototype.pp_setRotationWorldMatrix=function(){let e=f.create();return function(i){f.fromMat3(e,i),this.pp_setRotationWorldQuat(e)}}(),WL.Object.prototype.pp_setRotationWorldQuat=function(e){this.rotationWorld=e},WL.Object.prototype.pp_setRotationLocal=function(e){this.pp_setRotationLocalDegrees(e)},WL.Object.prototype.pp_setRotationLocalDegrees=function(){let e=f.create();return function(i){this._pp_degreesToQuaternion(i,e),this.pp_setRotationLocalQuat(e)}}(),WL.Object.prototype.pp_setRotationLocalRadians=function(){let e=d.create();return function(i){i.forEach(function(s,n,a){e[n]=this._pp_toDegrees(s)}.bind(this)),this.pp_setRotationLocalDegrees(e)}}(),WL.Object.prototype.pp_setRotationLocalMatrix=function(){let e=f.create();return function(i){f.fromMat3(e,i),this.pp_setRotationLocalQuat(e)}}(),WL.Object.prototype.pp_setRotationLocalQuat=function(e){this.rotationLocal=e},WL.Object.prototype.pp_setScale=function(e){this.pp_setScaleWorld(e)},WL.Object.prototype.pp_setScaleWorld=function(){let e=d.create();return function(i){isNaN(i)?this.scalingWorld=i:(d.set(e,i,i,i),this.scalingWorld=e)}}(),WL.Object.prototype.pp_setScaleLocal=function(){let e=d.create();return function(i){isNaN(i)?this.scalingLocal=i:(d.set(e,i,i,i),this.scalingLocal=e)}}(),WL.Object.prototype.pp_setAxes=function(e,t,i){this.pp_setAxesWorld(e,t,i)},WL.Object.prototype.pp_setAxesWorld=function(e,t,i){i!=null?this.pp_setForwardWorld(i,t,e):t!=null?this.pp_setUpWorld(t,i,e):this.pp_setLeftWorld(e,t,i)},WL.Object.prototype.pp_setAxesLocal=function(e,t,i){i!=null?this.pp_setForwardLocal(i,t,e):t!=null?this.pp_setUpLocal(t,i,e):this.pp_setLeftLocal(e,t,i)},WL.Object.prototype.pp_setForward=function(e,t,i){this.pp_setForwardWorld(e,t,i)},WL.Object.prototype.pp_setForwardWorld=function(e,t=null,i=null){this._pp_setAxes([i,t,e],[2,1,0],!1)},WL.Object.prototype.pp_setForwardLocal=function(e,t=null,i=null){this._pp_setAxes([i,t,e],[2,1,0],!0)},WL.Object.prototype.pp_setBackward=function(e,t,i){this.pp_setBackwardWorld(e,t,i)},WL.Object.prototype.pp_setBackwardWorld=function(){let e=d.create();return function(i,s=null,n=null){d.negate(e,i),this._pp_setAxes([n,s,e],[2,1,0],!1)}}(),WL.Object.prototype.pp_setBackwardLocal=function(){let e=d.create();return function(i,s=null,n=null){d.negate(e,i),this._pp_setAxes([n,s,e],[2,1,0],!0)}}(),WL.Object.prototype.pp_setUp=function(e,t,i){this.pp_setUpWorld(e,t,i)},WL.Object.prototype.pp_setUpWorld=function(e,t=null,i=null){this._pp_setAxes([i,e,t],[1,2,0],!1)},WL.Object.prototype.pp_setUpLocal=function(e,t=null,i=null){this._pp_setAxes([i,e,t],[1,2,0],!0)},WL.Object.prototype.pp_setDown=function(e,t,i){this.pp_setDownWorld(e,t,i)},WL.Object.prototype.pp_setDownWorld=function(){let e=d.create();return function(i,s=null,n=null){d.negate(e,i),this._pp_setAxes([n,e,s],[1,2,0],!1)}}(),WL.Object.prototype.pp_setDownLocal=function(){let e=d.create();return function(i,s=null,n=null){d.negate(e,i),this._pp_setAxes([n,e,s],[1,2,0],!0)}}(),WL.Object.prototype.pp_setLeft=function(e,t,i){this.pp_setLeftWorld(e,t,i)},WL.Object.prototype.pp_setLeftWorld=function(e,t=null,i=null){this._pp_setAxes([e,t,i],[0,1,2],!1)},WL.Object.prototype.pp_setLeftLocal=function(e,t=null,i=null){this._pp_setAxes([e,t,i],[0,1,2],!0)},WL.Object.prototype.pp_setRight=function(e,t,i){this.pp_setRightWorld(e,t,i)},WL.Object.prototype.pp_setRightWorld=function(){let e=d.create();return function(i,s=null,n=null){d.negate(e,i),this._pp_setAxes([e,s,n],[0,1,2],!1)}}(),WL.Object.prototype.pp_setRightLocal=function(){let e=d.create();return function(i,s=null,n=null){d.negate(e,i),this._pp_setAxes([e,s,n],[0,1,2],!0)}}(),WL.Object.prototype.pp_setTransform=function(e){this.pp_setTransformWorld(e)},WL.Object.prototype.pp_setTransformMatrix=function(e){this.pp_setTransformWorldMatrix(e)},WL.Object.prototype.pp_setTransformQuat=function(e){this.pp_setTransformWorldQuat(e)},WL.Object.prototype.pp_setTransformWorld=function(e){return this.pp_setTransformWorldMatrix(e)},WL.Object.prototype.pp_setTransformWorldMatrix=function(){let e=d.create(),t=f.create(),i=d.create(),s=S.create(),n=d.create(),a=d.create();return d.set(a,1,1,1),function(l){S.getTranslation(e,l),S.getScaling(i,l),d.divide(n,a,i),S.scale(s,l,n),S.getRotation(t,s),f.normalize(t,t),this.pp_setScaleWorld(i),this.pp_setRotationWorldQuat(t),this.pp_setPositionWorld(e)}}(),WL.Object.prototype.pp_setTransformWorldQuat=function(e){this.transformWorld=e},WL.Object.prototype.pp_setTransformLocal=function(e){return this.pp_setTransformLocalMatrix(e)},WL.Object.prototype.pp_setTransformLocalMatrix=function(){let e=d.create(),t=f.create(),i=d.create(),s=S.create(),n=d.create(),a=d.create();return d.set(a,1,1,1),function(l){S.getTranslation(e,l),S.getScaling(i,l),d.divide(n,a,i),S.scale(s,l,n),S.getRotation(t,s),f.normalize(t,t),this.pp_setScaleLocal(i),this.pp_setRotationLocalQuat(t),this.pp_setPositionLocal(e)}}(),WL.Object.prototype.pp_setTransformLocalQuat=function(e){this.transformLocal=e},WL.Object.prototype.pp_resetPosition=function(){this.pp_resetPositionWorld()},WL.Object.prototype.pp_resetPositionWorld=function(){let e=d.create();return function(){this.pp_setPositionWorld(e)}}(),WL.Object.prototype.pp_resetPositionLocal=function(){let e=d.create();return function(){this.pp_setPositionLocal(e)}}(),WL.Object.prototype.pp_resetRotation=function(){this.pp_resetRotationWorld()},WL.Object.prototype.pp_resetRotationWorld=function(){let e=f.create();return function(){this.pp_setRotationWorldQuat(e)}}(),WL.Object.prototype.pp_resetRotationLocal=function(){let e=f.create();return function(){this.pp_setRotationLocalQuat(e)}}(),WL.Object.prototype.pp_resetScale=function(){this.pp_resetScaleWorld()},WL.Object.prototype.pp_resetScaleWorld=function(){let e=d.create();return d.set(e,1,1,1),function(){this.pp_setScaleWorld(e)}}(),WL.Object.prototype.pp_resetScaleLocal=function(){let e=d.create();return d.set(e,1,1,1),function(){this.pp_setScaleLocal(e)}}(),WL.Object.prototype.pp_resetTransform=function(){this.pp_resetTransformWorld()},WL.Object.prototype.pp_resetTransformWorld=function(){this.pp_resetScaleWorld(),this.pp_resetRotationWorld(),this.pp_resetPositionWorld()},WL.Object.prototype.pp_resetTransformLocal=function(){this.pp_resetScaleLocal(),this.pp_resetRotationLocal(),this.pp_resetPositionLocal()},WL.Object.prototype.pp_translate=function(e){this.pp_translateWorld(e)},WL.Object.prototype.pp_translateWorld=function(e){this.translateWorld(e)},WL.Object.prototype.pp_translateLocal=function(e){this.translate(e)},WL.Object.prototype.pp_translateObject=function(e){this.translateObject(e)},WL.Object.prototype.pp_translateAxis=function(e,t){this.pp_translateAxisWorld(e,t)},WL.Object.prototype.pp_translateAxisWorld=function(){let e=d.create();return function(i,s){d.scale(e,s,i),this.pp_translateWorld(e)}}(),WL.Object.prototype.pp_translateAxisLocal=function(){let e=d.create();return function(i,s){d.scale(e,s,i),this.pp_translateLocal(e)}}(),WL.Object.prototype.pp_translateAxisObject=function(){let e=d.create();return function(i,s){d.scale(e,s,i),this.pp_translateObject(e)}}(),WL.Object.prototype.pp_rotate=function(e){this.pp_rotateWorld(e)},WL.Object.prototype.pp_rotateDegrees=function(e){this.pp_rotateWorldDegrees(e)},WL.Object.prototype.pp_rotateRadians=function(e){this.pp_rotateWorldRadians(e)},WL.Object.prototype.pp_rotateMatrix=function(e){this.pp_rotateWorldMatrix(e)},WL.Object.prototype.pp_rotateQuat=function(e){this.pp_rotateWorldQuat(e)},WL.Object.prototype.pp_rotateWorld=function(e){this.pp_rotateWorldDegrees(e)},WL.Object.prototype.pp_rotateWorldDegrees=function(){let e=f.create();return function(i){this._pp_degreesToQuaternion(i,e),this.pp_rotateWorldQuat(e)}}(),WL.Object.prototype.pp_rotateWorldRadians=function(){let e=d.create();return function(i){i.forEach(function(s,n,a){e[n]=this._pp_toDegrees(s)}.bind(this)),this.pp_rotateWorldDegrees(e)}}(),WL.Object.prototype.pp_rotateWorldMatrix=function(){let e=f.create();return function(i){f.fromMat3(e,i),f.normalize(e,e),this.pp_rotateWorldQuat(e)}}(),WL.Object.prototype.pp_rotateWorldQuat=function(){let e=f.create();return function(i){this.pp_getRotationWorldQuat(e),f.mul(e,i,e),f.normalize(e,e),this.pp_setRotationWorldQuat(e)}}(),WL.Object.prototype.pp_rotateLocal=function(e){this.pp_rotateLocalDegrees(e)},WL.Object.prototype.pp_rotateLocalDegrees=function(){let e=f.create();return function(i){this._pp_degreesToQuaternion(i,e),this.pp_rotateLocalQuat(e)}}(),WL.Object.prototype.pp_rotateLocalRadians=function(){let e=d.create();return function(i){i.forEach(function(s,n,a){e[n]=this._pp_toDegrees(s)}.bind(this)),this.pp_rotateLocalDegrees(e)}}(),WL.Object.prototype.pp_rotateLocalMatrix=function(){let e=f.create();return function(i){f.fromMat3(e,i),f.normalize(e,e),this.pp_rotateLocalQuat(e)}}(),WL.Object.prototype.pp_rotateLocalQuat=function(){let e=f.create();return function(i){this.pp_getRotationLocalQuat(e),f.mul(e,i,e),f.normalize(e,e),this.pp_setRotationLocalQuat(e)}}(),WL.Object.prototype.pp_rotateObject=function(e){this.pp_rotateObjectDegrees(e)},WL.Object.prototype.pp_rotateObjectDegrees=function(){let e=f.create();return function(i){this._pp_degreesToQuaternion(i,e),this.pp_rotateObjectQuat(e)}}(),WL.Object.prototype.pp_rotateObjectRadians=function(){let e=d.create();return function(i){i.forEach(function(s,n,a){e[n]=this._pp_toDegrees(s)}.bind(this)),this.pp_rotateObjectDegrees(e)}}(),WL.Object.prototype.pp_rotateObjectMatrix=function(){let e=f.create();return function(i){f.fromMat3(e,i),f.normalize(e,e),this.pp_rotateObjectQuat(e)}}(),WL.Object.prototype.pp_rotateObjectQuat=function(e){this.rotateObject(e)},WL.Object.prototype.pp_rotateAxis=function(e,t){this.pp_rotateAxisWorld(e,t)},WL.Object.prototype.pp_rotateAxisDegrees=function(e,t){this.pp_rotateAxisWorldDegrees(e,t)},WL.Object.prototype.pp_rotateAxisRadians=function(e,t){this.pp_rotateAxisWorldRadians(e,t)},WL.Object.prototype.pp_rotateAxisWorld=function(e,t){this.pp_rotateAxisWorldDegrees(e,t)},WL.Object.prototype.pp_rotateAxisWorldDegrees=function(e,t){this.pp_rotateAxisWorldRadians(F.toRadian(e),t)},WL.Object.prototype.pp_rotateAxisWorldRadians=function(){let e=f.create();return function(i,s){f.setAxisAngle(e,s,i),this.pp_rotateWorldQuat(e)}}(),WL.Object.prototype.pp_rotateAxisLocal=function(e,t){this.pp_rotateAxisLocalDegrees(e,t)},WL.Object.prototype.pp_rotateAxisLocalDegrees=function(e,t){this.pp_rotateAxisLocalRadians(F.toRadian(e),t)},WL.Object.prototype.pp_rotateAxisLocalRadians=function(){let e=f.create();return function(i,s){f.setAxisAngle(e,s,i),this.pp_rotateLocalQuat(e)}}(),WL.Object.prototype.pp_rotateAxisObject=function(e,t){this.pp_rotateAxisObjectDegrees(e,t)},WL.Object.prototype.pp_rotateAxisObjectDegrees=function(e,t){this.pp_rotateAxisObjectRadians(F.toRadian(e),t)},WL.Object.prototype.pp_rotateAxisObjectRadians=function(){let e=f.create();return function(i,s){f.setAxisAngle(e,s,i),this.pp_rotateObjectQuat(e)}}(),WL.Object.prototype.pp_rotateAround=function(e,t){this.pp_rotateAroundWorld(e,t)},WL.Object.prototype.pp_rotateAroundDegrees=function(e,t){this.pp_rotateAroundWorldDegrees(e,t)},WL.Object.prototype.pp_rotateAroundRadians=function(e,t){this.pp_rotateAroundWorldRadians(e,t)},WL.Object.prototype.pp_rotateAroundMatrix=function(e,t){this.pp_rotateAroundWorldMatrix(e,t)},WL.Object.prototype.pp_rotateAroundQuat=function(e,t){this.pp_rotateAroundWorldQuat(e,t)},WL.Object.prototype.pp_rotateAroundWorld=function(e,t){this.pp_rotateAroundWorldDegrees(e,t)},WL.Object.prototype.pp_rotateAroundWorldDegrees=function(){let e=f.create();return function(i,s){this._pp_degreesToQuaternion(i,e),this.pp_rotateAroundWorldQuat(e,s)}}(),WL.Object.prototype.pp_rotateAroundWorldRadians=function(){let e=d.create();return function(i,s){i.forEach(function(n,a,r){e[a]=this._pp_toDegrees(n)}.bind(this)),this.pp_rotateAroundWorldDegrees(e,s)}}(),WL.Object.prototype.pp_rotateAroundWorldMatrix=function(){let e=f.create();return function(i,s){f.fromMat3(e,i),f.normalize(e,e),this.pp_rotateAroundWorldQuat(e,s)}}(),WL.Object.prototype.pp_rotateAroundWorldQuat=function(){let e=d.create();return function(i,s){let n=f.getAxisAngle(e,i);this.pp_rotateAroundAxisWorldRadians(n,e,s)}}(),WL.Object.prototype.pp_rotateAroundLocal=function(e,t){this.pp_rotateAroundLocalDegrees(e,t)},WL.Object.prototype.pp_rotateAroundLocalDegrees=function(){let e=f.create();return function(i,s){this._pp_degreesToQuaternion(i,e),this.pp_rotateAroundLocalQuat(e,s)}}(),WL.Object.prototype.pp_rotateAroundLocalRadians=function(){let e=d.create();return function(i,s){i.forEach(function(n,a,r){e[a]=this._pp_toDegrees(n)}.bind(this)),this.pp_rotateAroundLocalDegrees(e,s)}}(),WL.Object.prototype.pp_rotateAroundLocalMatrix=function(){let e=f.create();return function(i,s){f.fromMat3(e,i),f.normalize(e,e),this.pp_rotateAroundLocalQuat(e,s)}}(),WL.Object.prototype.pp_rotateAroundLocalQuat=function(){let e=d.create();return function(i,s){let n=f.getAxisAngle(e,i);this.pp_rotateAroundAxisLocalRadians(n,e,s)}}(),WL.Object.prototype.pp_rotateAroundObject=function(e,t){this.pp_rotateAroundObjectDegrees(e,t)},WL.Object.prototype.pp_rotateAroundObjectDegrees=function(){let e=f.create();return function(i,s){this._pp_degreesToQuaternion(i,e),this.pp_rotateAroundObjectQuat(e,s)}}(),WL.Object.prototype.pp_rotateAroundObjectRadians=function(){let e=d.create();return function(i,s){i.forEach(function(n,a,r){e[a]=this._pp_toDegrees(n)}.bind(this)),this.pp_rotateAroundObjectDegrees(e,s)}}(),WL.Object.prototype.pp_rotateAroundObjectMatrix=function(){let e=f.create();return function(i,s){f.fromMat3(e,i),f.normalize(e,e),this.pp_rotateAroundObjectQuat(e,s)}}(),WL.Object.prototype.pp_rotateAroundObjectQuat=function(){let e=d.create();return function(i,s){let n=f.getAxisAngle(e,i);this.pp_rotateAroundAxisObjectRadians(n,e,s)}}(),WL.Object.prototype.pp_rotateAroundAxis=function(e,t,i){this.pp_rotateAroundAxisWorld(e,t,i)},WL.Object.prototype.pp_rotateAroundAxisDegrees=function(e,t,i){this.pp_rotateAroundAxisWorldDegrees(e,t,i)},WL.Object.prototype.pp_rotateAroundAxisRadians=function(e,t,i){this.pp_rotateAroundAxisWorldRadians(e,t,i)},WL.Object.prototype.pp_rotateAroundAxisWorld=function(e,t,i){this.pp_rotateAroundAxisWorldDegrees(e,t,i)},WL.Object.prototype.pp_rotateAroundAxisWorldDegrees=function(e,t,i){this.pp_rotateAroundAxisWorldRadians(F.toRadian(e),t,i)},WL.Object.prototype.pp_rotateAroundAxisWorldRadians=function(){let e=I.create(),t=I.create(),i=I.create(),s=f.create();return function(a,r,l){I.fromRotationTranslation(e,s,l),this.pp_getTransformWorldQuat(i),I.conjugate(t,e),I.mul(i,t,i),I.rotateAroundAxis(e,e,r,a),I.mul(i,e,i),this.pp_setTransformWorldQuat(i)}}(),WL.Object.prototype.pp_rotateAroundAxisLocal=function(e,t,i){this.pp_rotateAroundAxisLocalDegrees(e,t,i)},WL.Object.prototype.pp_rotateAroundAxisLocalDegrees=function(e,t,i){this.pp_rotateAroundAxisLocalRadians(F.toRadian(e),t,i)},WL.Object.prototype.pp_rotateAroundAxisLocalRadians=function(){let e=d.create(),t=d.create();return function(s,n,a){this.pp_convertPositionLocalToWorld(a,e),this.pp_convertDirectionLocalToWorld(n,t),this.pp_rotateAroundAxisWorldRadians(s,t,e)}}(),WL.Object.prototype.pp_rotateAroundAxisObject=function(e,t,i){this.pp_rotateAroundAxisObjectDegrees(e,t,i)},WL.Object.prototype.pp_rotateAroundAxisObjectDegrees=function(e,t,i){this.pp_rotateAroundAxisObjectRadians(F.toRadian(e),t,i)},WL.Object.prototype.pp_rotateAroundAxisObjectRadians=function(){let e=d.create(),t=d.create();return function(s,n,a){this.pp_convertPositionObjectToWorld(a,e),this.pp_convertDirectionObjectToWorld(n,t),this.pp_rotateAroundAxisWorldRadians(s,t,e)}}(),WL.Object.prototype.pp_scaleObject=function(){let e=d.create();return function(i){isNaN(i)?this.scale(i):(d.set(e,i,i,i),this.scale(e))}}(),WL.Object.prototype.pp_lookAt=function(e,t){this.pp_lookAtWorld(e,t)},WL.Object.prototype.pp_lookAtWorld=function(){let e=d.create();return function(i,s){this.pp_getPositionWorld(e),d.sub(e,i,e),this.pp_lookToWorld(e,s)}}(),WL.Object.prototype.pp_lookAtLocal=function(){let e=d.create();return function(i,s){this.pp_getPositionLocal(e),d.sub(e,i,e),this.pp_lookToLocal(e,s)}}(),WL.Object.prototype.pp_lookTo=function(e,t){this.pp_lookToWorld(e,t)},WL.Object.prototype.pp_lookToWorld=function(){let e=d.create();return function(i,s=this.pp_getUpWorld(e)){this.pp_setForwardWorld(i,s)}}(),WL.Object.prototype.pp_lookToLocal=function(){let e=d.create();return function(i,s=this.pp_getUpLocal(e)){this.pp_setForwardLocal(i,s)}}(),WL.Object.prototype.pp_setParent=function(){let e=d.create(),t=f.create(),i=d.create();return function(n,a=!0){a?(this.pp_getPositionWorld(e),this.pp_getRotationWorldQuat(t),this.pp_getScaleWorld(i),this.parent=n,this.pp_setScaleWorld(i),this.pp_setRotationWorldQuat(t),this.pp_setPositionWorld(e)):this.parent=n}}(),WL.Object.prototype.pp_getParent=function(){return this.parent},WL.Object.prototype.pp_convertPositionObjectToWorld=function(){let e=S.create();return function(i,s=d.create()){return this.pp_getTransformWorldMatrix(e),d.transformMat4(s,i,e),s}}(),WL.Object.prototype.pp_convertDirectionObjectToWorld=function(){let e=f.create();return function(i,s=d.create()){return this.pp_getRotationWorldQuat(e),d.transformQuat(s,i,e),s}}(),WL.Object.prototype.pp_convertPositionWorldToObject=function(){let e=S.create();return function(i,s=d.create()){return this.pp_getTransformWorldMatrix(e),S.invert(e,e),d.transformMat4(s,i,e),s}}(),WL.Object.prototype.pp_convertDirectionWorldToObject=function(){let e=f.create();return function(i,s=d.create()){return this.pp_getRotationWorldQuat(e),f.conjugate(e,e),d.transformQuat(s,i,e),s}}(),WL.Object.prototype.pp_convertPositionLocalToWorld=function(e,t=d.create()){return this.pp_getParent()?this.pp_getParent().pp_convertPositionObjectToWorld(e,t):d.copy(t,e),t},WL.Object.prototype.pp_convertDirectionLocalToWorld=function(e,t=d.create()){return this.pp_getParent()?this.pp_getParent().pp_convertDirectionObjectToWorld(e,t):d.copy(t,e),t},WL.Object.prototype.pp_convertPositionWorldToLocal=function(e,t=d.create()){return this.pp_getParent()?this.pp_getParent().pp_convertPositionWorldToObject(e,t):d.copy(t,e),t},WL.Object.prototype.pp_convertDirectionWorldToLocal=function(e,t=d.create()){return this.pp_getParent()?this.pp_getParent().pp_convertDirectionWorldToObject(e,t):d.copy(t,e),t},WL.Object.prototype.pp_convertPositionObjectToLocal=function(e,t=d.create()){return this.pp_convertPositionObjectToWorld(e,t),this.pp_convertPositionWorldToLocal(t,t),t},WL.Object.prototype.pp_convertDirectionObjectToLocal=function(e,t=d.create()){return this.pp_convertDirectionObjectToWorld(e,t),this.pp_convertDirectionWorldToLocal(t,t),t},WL.Object.prototype.pp_convertPositionLocalToObject=function(e,t=d.create()){return this.pp_convertPositionLocalToWorld(e,t),this.pp_convertPositionWorldToObject(t,t),t},WL.Object.prototype.pp_convertDirectionLocalToObject=function(e,t=d.create()){return this.pp_convertDirectionLocalToWorld(e,t),this.pp_convertDirectionWorldToObject(t,t),t},WL.Object.prototype.pp_convertTransformObjectToWorld=function(e,t){return this.pp_convertTransformObjectToWorldMatrix(e,t)},WL.Object.prototype.pp_convertTransformObjectToWorldMatrix=function(){let e=S.create(),t=d.create(),i=d.create(),s=d.create(),n=d.create();return d.set(n,1,1,1),function(r,l=S.create()){return this.pp_getTransformWorldMatrix(e),this.pp_hasUniformScaleWorld()?S.mul(l,e,r):(d.set(t,r[12],r[13],r[14]),this.pp_convertPositionObjectToWorld(t,t),S.getScaling(i,e),d.divide(s,n,i),S.scale(e,e,s),S.mul(l,e,r),S.scale(l,l,i),l[12]=t[0],l[13]=t[1],l[14]=t[2],l[15]=1),l}}(),WL.Object.prototype.pp_convertTransformObjectToWorldQuat=function(){let e=d.create(),t=f.create();return function(s,n=I.create()){return this.pp_getRotationWorldQuat(t),f.mul(t,t,s),I.getTranslation(e,s),this.pp_convertPositionObjectToWorld(e,e),I.fromRotationTranslation(n,t,e),n}}(),WL.Object.prototype.pp_convertTransformWorldToObject=function(e,t){return this.pp_convertTransformWorldToObjectMatrix(e,t)},WL.Object.prototype.pp_convertTransformWorldToObjectMatrix=function(){let e=S.create(),t=d.create(),i=d.create(),s=d.create(),n=d.create();return d.set(n,1,1,1),function(r,l=S.create()){return this.pp_getTransformWorldMatrix(e),this.pp_hasUniformScaleWorld()?(S.invert(e,e),S.mul(l,e,r)):(d.set(t,r[12],r[13],r[14]),this.pp_convertPositionWorldToObject(t,t),S.getScaling(i,e),d.divide(s,n,i),S.scale(e,e,s),S.invert(e,e),S.mul(l,e,r),S.scale(l,l,s),l[12]=t[0],l[13]=t[1],l[14]=t[2],l[15]=1),l}}(),WL.Object.prototype.pp_convertTransformWorldToObjectQuat=function(){let e=d.create(),t=f.create();return function(s,n=I.create()){return this.pp_getRotationWorldQuat(t),f.conjugate(t,t),f.mul(t,t,s),I.getTranslation(e,s),this.pp_convertPositionWorldToObject(e,e),I.fromRotationTranslation(n,t,e),n}}(),WL.Object.prototype.pp_convertTransformLocalToWorld=function(e,t){return this.pp_convertTransformLocalToWorldMatrix(e,t)},WL.Object.prototype.pp_convertTransformLocalToWorldMatrix=function(e,t=S.create()){return this.pp_getParent()?this.pp_getParent().pp_convertTransformObjectToWorldMatrix(e,t):S.copy(t,e),t},WL.Object.prototype.pp_convertTransformLocalToWorldQuat=function(e,t=I.create()){return this.pp_getParent()?this.pp_getParent().pp_convertTransformObjectToWorldQuat(e,t):I.copy(t,e),t},WL.Object.prototype.pp_convertTransformWorldToLocal=function(e,t){return this.pp_convertTransformWorldToLocalMatrix(e,t)},WL.Object.prototype.pp_convertTransformWorldToLocalMatrix=function(e,t=S.create()){return this.pp_getParent()?this.pp_getParent().pp_convertTransformWorldToObjectMatrix(e,t):S.copy(t,e),t},WL.Object.prototype.pp_convertTransformWorldToLocalQuat=function(e,t=I.create()){return this.pp_getParent()?this.pp_getParent().pp_convertTransformWorldToObjectQuat(e,t):I.copy(t,e),t},WL.Object.prototype.pp_convertTransformObjectToLocal=function(e,t){return this.pp_convertTransformObjectToLocalMatrix(e,t)},WL.Object.prototype.pp_convertTransformObjectToLocalMatrix=function(e,t=S.create()){return this.pp_convertTransformObjectToWorldMatrix(e,t),this.pp_convertTransformWorldToLocalMatrix(t,t),t},WL.Object.prototype.pp_convertTransformObjectToLocalQuat=function(e,t=I.create()){return this.pp_convertTransformObjectToWorldQuat(e,t),this.pp_convertTransformWorldToLocalQuat(t,t),t},WL.Object.prototype.pp_convertTransformLocalToObject=function(e,t){return this.pp_convertTransformLocalToObjectMatrix(e,t)},WL.Object.prototype.pp_convertTransformLocalToObjectMatrix=function(e,t=S.create()){return this.pp_convertTransformLocalToWorldMatrix(e,t),this.pp_convertTransformWorldToObjectMatrix(t,t),t},WL.Object.prototype.pp_convertTransformLocalToObjectQuat=function(e,t=I.create()){return this.pp_convertTransformLocalToWorldQuat(e,t),this.pp_convertTransformWorldToObjectQuat(t,t),t},WL.Object.prototype.pp_addComponent=function(e,t,i=null){let s=null;return typeof t=="boolean"?(s={},s.active=t):(s=t,i!=null&&(s==null&&(s={}),s.active=i)),this.addComponent(e,s)},WL.Object.prototype.pp_getComponent=function(e,t=0){return this.getComponent(e,t)},WL.Object.prototype.pp_getComponents=function(e){return this.getComponents(e)},WL.Object.prototype.pp_getComponentHierarchy=function(e,t=0){return this.pp_getComponentHierarchyBreadth(e,t)},WL.Object.prototype.pp_getComponentHierarchyBreadth=function(e,t=0){let i=this.pp_getHierarchyBreadth();return WL.Object.pp_getComponentObjects(i,e,t)},WL.Object.prototype.pp_getComponentHierarchyDepth=function(e,t=0){let i=this.pp_getHierarchyDepth();return WL.Object.pp_getComponentObjects(i,e,t)},WL.Object.prototype.pp_getComponentDescendants=function(e,t=0){return this.pp_getComponentDescendantsBreadth(e,t)},WL.Object.prototype.pp_getComponentDescendantsBreadth=function(e,t=0){let i=this.pp_getDescendantsBreadth();return WL.Object.pp_getComponentObjects(i,e,t)},WL.Object.prototype.pp_getComponentDescendantsDepth=function(e,t=0){let i=this.pp_getDescendantsDepth();return WL.Object.pp_getComponentObjects(i,e,t)},WL.Object.prototype.pp_getComponentChildren=function(e,t=0){let i=this.pp_getChildren();return WL.Object.pp_getComponentObjects(i,e,t)},WL.Object.prototype.pp_getComponentsHierarchy=function(e){return this.pp_getComponentsHierarchyBreadth(e)},WL.Object.prototype.pp_getComponentsHierarchyBreadth=function(e){let t=this.pp_getHierarchyBreadth();return WL.Object.pp_getComponentsObjects(t,e)},WL.Object.prototype.pp_getComponentsHierarchyDepth=function(e){let t=this.pp_getHierarchyDepth();return WL.Object.pp_getComponentsObjects(t,e)},WL.Object.prototype.pp_getComponentsDescendants=function(e){return this.pp_getComponentsDescendantsBreadth(e)},WL.Object.prototype.pp_getComponentsDescendantsBreadth=function(e){let t=this.pp_getDescendantsBreadth();return WL.Object.pp_getComponentsObjects(t,e)},WL.Object.prototype.pp_getComponentsDescendantsDepth=function(e){let t=this.pp_getDescendantsDepth();return WL.Object.pp_getComponentsObjects(t,e)},WL.Object.prototype.pp_getComponentsChildren=function(e){let t=this.pp_getChildren();return WL.Object.pp_getComponentsObjects(t,e)},WL.Object.prototype.pp_setActive=function(e,t=!0){t?this.pp_setActiveHierarchy(e):this.active=e},WL.Object.prototype.pp_setActiveSelf=function(e){this.pp_setActive(e,!1)},WL.Object.prototype.pp_setActiveHierarchy=function(e){this.pp_setActiveHierarchyBreadth(e)},WL.Object.prototype.pp_setActiveHierarchyBreadth=function(e){let t=this.pp_getHierarchyBreadth();return WL.Object.pp_setActiveObjects(t,e)},WL.Object.prototype.pp_setActiveHierarchyDepth=function(e){let t=this.pp_getHierarchyDepth();return WL.Object.pp_setActiveObjects(t,e)},WL.Object.prototype.pp_setActiveDescendants=function(e){this.pp_setActiveDescendantsBreadth(e)},WL.Object.prototype.pp_setActiveDescendantsBreadth=function(e){let t=this.pp_getDescendantsBreadth();return WL.Object.pp_setActiveObjects(t,e)},WL.Object.prototype.pp_setActiveDescendantsDepth=function(e){let t=this.pp_getDescendantsDepth();return WL.Object.pp_setActiveObjects(t,e)},WL.Object.prototype.pp_setActiveChildren=function(e){let t=this.pp_getChildren();return WL.Object.pp_setActiveObjects(t,e)},WL.Object.prototype.pp_hasUniformScale=function(){return this.pp_hasUniformScaleWorld()},WL.Object.prototype.pp_hasUniformScaleWorld=function(){let e=d.create();return function(){return this.pp_getScaleWorld(e),Math.abs(e[0]-e[1])<this._pp_epsilon&&Math.abs(e[1]-e[2])<this._pp_epsilon&&Math.abs(e[0]-e[2])<this._pp_epsilon}}(),WL.Object.prototype.pp_hasUniformScaleLocal=function(){let e=d.create();return function(){return this.pp_getScaleLocal(e),Math.abs(e[0]-e[1])<this._pp_epsilon&&Math.abs(e[1]-e[2])<this._pp_epsilon&&Math.abs(e[0]-e[2])<this._pp_epsilon}}(),PP.CloneParams=class{constructor(){this.myIgnoreNonCloneable=!1,this.myIgnoreComponents=!1,this.myIgnoreChildren=!1,this.myComponentsToIgnore=[],this.myComponentsToInclude=[],this.myIgnoreComponentCallback=null,this.myChildrenToIgnore=[],this.myChildrenToInclude=[],this.myIgnoreChildCallback=null,this.myDeepCloneParams=new PP.DeepCloneParams,this.myExtraData=new Map}},PP.DeepCloneParams=class{constructor(){this._myDeepCloneObject=!1,this._myOverrideDeepCloneComponentMap=new Map,this._myOverrideDeepCloneComponentVariableMap=new Map}setDeepCloneObject(t){this._myDeepCloneObject=t}setDeepCloneComponent(t,i){this._myOverrideDeepCloneComponentMap.set(t,i)}setDeepCloneComponentVariable(t,i,s){let n=null;this._myOverrideDeepCloneComponentVariableMap.has(t)||this._myOverrideDeepCloneComponentVariableMap.set(t,new Map),n=this._myOverrideDeepCloneComponentVariableMap.get(t),n.set(i,s)}isDeepCloneComponent(t){let i=this._myOverrideDeepCloneComponentMap.get(t);return i??this._myDeepCloneObject}isDeepCloneComponentVariable(t,i){let s=this._myOverrideDeepCloneComponentVariableMap.get(t);if(s!=null){let n=s.get(i);if(n!=null)return n}return this.isDeepCloneComponent(t)}},WL.Object.prototype.pp_clone=function(){let e=d.create(),t=I.create();return function(s=new PP.CloneParams){let n=null;if(this.pp_isCloneable(s)){let a=[];a.push([this.parent,this]);let r=[];for(;a.length>0;){let c=a.shift(),o=c[0],m=c[1],u=WL.scene.addObject(o);if(u.name=m.name,u.pp_setScaleLocal(m.pp_getScaleLocal(e)),u.pp_setTransformLocalQuat(m.pp_getTransformLocalQuat(t)),s.myIgnoreComponents||r.push([m,u]),!s.myIgnoreChildren)for(let h of m.children){let _=!1;s.myChildrenToInclude.length>0?_=s.myChildrenToInclude.find(P=>P.pp_equals(h))!=null:_=s.myChildrenToIgnore.find(P=>P.pp_equals(h))==null,_&&s.myIgnoreChildCallback!=null&&(_=!s.myIgnoreChildCallback(h)),_&&a.push([u,h])}n==null&&(n=u)}let l=[];for(;r.length>0;){let c=r.shift(),o=c[0],m=c[1],u=o.pp_getComponents();for(let h of u)if(h.pp_clone!=null){let _=!1;s.myComponentsToInclude.length>0?_=s.myComponentsToInclude.indexOf(h.type)!=-1:_=s.myComponentsToIgnore.indexOf(h.type)==-1,_&&s.myIgnoreComponentCallback!=null&&(_=!s.myIgnoreComponentCallback(h)),_&&l.push([h,m])}}let y=[];for(;l.length>0;){let c=l.shift(),o=c[0],m=c[1],u=o.pp_clone(m,s.myDeepCloneParams,s.myExtraData);o.pp_clonePostProcess!=null&&y.push([o,u])}for(;l.length>0;){let c=l.shift(),o=c[0],m=c[1];o.pp_clonePostProcess(m,s.myDeepCloneParams,s.myExtraData)}}return n}}(),WL.Object.prototype.pp_isCloneable=function(e=new PP.CloneParams){if(e.myIgnoreNonCloneable||e.myIgnoreComponents)return!0;let t=!0,i=[];for(i.push(this);t&&i.length>0;){let s=i.shift(),n=this.pp_getComponents();for(let a of n){let r=!1;if(e.myComponentsToInclude.length>0?r=e.myComponentsToInclude.indexOf(a.type)!=-1:r=e.myComponentsToIgnore.indexOf(a.type)==-1,r&&e.myIgnoreComponentCallback!=null&&(r=!e.myIgnoreComponentCallback(a)),r&&a.pp_clone==null){t=!1;break}}if(t&&!e.myIgnoreChildren)for(let a of s.children){let r=!1;e.myChildrenToInclude.length>0?r=e.myChildrenToInclude.find(l=>l.pp_equals(a))!=null:r=e.myChildrenToIgnore.find(l=>l.pp_equals(a))==null,r&&e.myIgnoreChildCallback!=null&&(r=!e.myIgnoreChildCallback(a)),r&&i.push(a)}}return t},WL.Object.prototype.pp_toString=function(){return this.pp_toStringCompact()},WL.Object.prototype.pp_toStringExtended=function(){let e="    ",t=`
`,i="{",s="}",n="name: ",a="id: ",r="components: ",l="type: ",y="children: ",c="[",o="]",m=c,u=o,h=",",_=t.concat(e,e);return function(){let p="";p=p.concat(i,t);let g=this.pp_getComponents(),b=this.pp_getChildren(),C=this.pp_getName();if(g.length>0||b.length>0||C.length>0?p=p.concat(e,a,this.pp_getID(),h,t):p=p.concat(e,a,this.pp_getID(),t),C.length>0&&(g.length>0||b.length>0?p=p.concat(e,n,this.pp_getName(),h,t):p=p.concat(e,n,this.pp_getName(),t)),g.length>0){p=p.concat(e,r,t,e,c,t);for(let x=0;x<g.length;x++){let v=g[x];p=p.concat(e,e,i,t),p=p.concat(e,e,e,l,v.type,h,t),p=p.concat(e,e,e,a,v._id,h,t),p=p.concat(e,e,s),x!=g.length-1?p=p.concat(h,t):p=p.concat(t)}b.length>0?p=p.concat(e,o,h,t):p=p.concat(e,o,t)}if(b.length>0){p=p.concat(e,y,t,e,m,t);for(let x=0;x<b.length;x++){let B=b[x].pp_toStringExtended();B=B.replaceAll(t,_),B=e.concat(e,B),p=p.concat(B),x!=b.length-1?p=p.concat(h,t):p=p.concat(t)}p=p.concat(e,u,t)}return p=p.concat(s),p}}(),WL.Object.prototype.pp_toStringCompact=function(){let e="    ",t=`
`,i="<none>",s="name: ",n="components: ",a=", ",r=t.concat(e);return function(){let y="",c=this.pp_getName();c.length>0?y=y.concat(s,c):y=y.concat(s,i);let o=this.pp_getComponents();if(o.length>0){y=y.concat(a,n);for(let u=0;u<o.length;u++){let h=o[u];y=y.concat(h.type),u!=o.length-1&&(y=y.concat(a))}}let m=this.pp_getChildren();if(m.length>0){y=y.concat(t);for(let u=0;u<m.length;u++){let _=m[u].pp_toStringCompact();_=_.replaceAll(t,r),_=e.concat(_),y=y.concat(_),u!=m.length-1&&(y=y.concat(t))}}return y}}(),WL.Object.prototype.pp_getObjectByName=function(e){return this.pp_getObjectByNameHierarchy(e)},WL.Object.prototype.pp_getObjectByNameHierarchy=function(e){return this.pp_getObjectByNameHierarchyBreadth(e)},WL.Object.prototype.pp_getObjectByNameHierarchyBreadth=function(e){let t=this.pp_getHierarchyBreadth();return WL.Object.pp_getObjectByNameObjects(t,e)},WL.Object.prototype.pp_getObjectByNameHierarchyDepth=function(e){let t=this.pp_getHierarchyDepth();return WL.Object.pp_getObjectByNameObjects(t,e)},WL.Object.prototype.pp_getObjectByNameDescendants=function(e){return this.pp_getObjectByNameDescendantsBreadth(e)},WL.Object.prototype.pp_getObjectByNameDescendantsBreadth=function(e){let t=this.pp_getDescendantsBreadth();return WL.Object.pp_getObjectByNameObjects(t,e)},WL.Object.prototype.pp_getObjectByNameDescendantsDepth=function(e){let t=this.pp_getDescendantsDepth();return WL.Object.pp_getObjectByNameObjects(t,e)},WL.Object.prototype.pp_getObjectByNameChildren=function(e){let t=this.pp_getChildren();return WL.Object.pp_getObjectByNameObjects(t,e)},WL.Object.prototype.pp_getObjectsByName=function(e){return this.pp_getObjectsByNameHierarchy(e)},WL.Object.prototype.pp_getObjectsByNameHierarchy=function(e){return this.pp_getObjectsByNameHierarchyBreadth(e)},WL.Object.prototype.pp_getObjectsByNameHierarchyBreadth=function(e){let t=this.pp_getHierarchyBreadth();return WL.Object.pp_getObjectsByNameObjects(t,e)},WL.Object.prototype.pp_getObjectsByNameHierarchyDepth=function(e){let t=this.pp_getHierarchyDepth();return WL.Object.pp_getObjectsByNameObjects(t,e)},WL.Object.prototype.pp_getObjectsByNameDescendants=function(e){return this.pp_getObjectsByNameDescendantsBreadth(e)},WL.Object.prototype.pp_getObjectsByNameDescendantsBreadth=function(e){let t=this.pp_getDescendantsBreadth();return WL.Object.pp_getObjectsByNameObjects(t,e)},WL.Object.prototype.pp_getObjectsByNameDescendantsDepth=function(e){let t=this.pp_getDescendantsDepth();return WL.Object.pp_getObjectsByNameObjects(t,e)},WL.Object.prototype.pp_getObjectsByNameChildren=function(e){let t=this.pp_getChildren();return WL.Object.pp_getObjectsByNameObjects(t,e)},WL.Object.prototype.pp_getHierarchy=function(){return this.pp_getHierarchyBreadth()},WL.Object.prototype.pp_getHierarchyBreadth=function(){let e=this.pp_getDescendantsBreadth();return e.unshift(this),e},WL.Object.prototype.pp_getHierarchyDepth=function(){let e=this.pp_getDescendantsDepth();return e.unshift(this),e},WL.Object.prototype.pp_getDescendants=function(){return this.pp_getDescendantsBreadth()},WL.Object.prototype.pp_getDescendantsBreadth=function(){let e=[],t=this.children;for(;t.length>0;){let i=t.shift();e.push(i);for(let s of i.children)t.push(s)}return e},WL.Object.prototype.pp_getDescendantsDepth=function(){let e=[],t=this.pp_getChildren();for(let i of t){e.push(i);let s=i.pp_getDescendantsDepth();s.length>0&&e.push(...s)}return e},WL.Object.prototype.pp_getChildren=function(){return this.children},WL.Object.prototype.pp_addObject=function(){return WL.scene.addObject(this)},WL.Object.prototype.pp_getName=function(){return this.name},WL.Object.prototype.pp_setName=function(e){this.name=e},WL.Object.prototype.pp_getID=function(){return this.objectId},WL.Object.prototype.pp_markDirty=function(){return this.setDirty()},WL.Object.prototype.pp_equals=function(e){return this.equals(e)},WL.Object.prototype.pp_destroy=function(){return this.destroy()},WL.Object.prototype.pp_reserveObjects=function(e){let t=this.pp_getComponentAmountMap();this._pp_reserveObjects(e,t)},WL.Object.prototype.pp_reserveObjectsHierarchy=function(e){let t=this.pp_getComponentAmountMapHierarchy();this._pp_reserveObjects(e,t)},WL.Object.prototype.pp_reserveObjectsDescendants=function(e){let t=this.pp_getComponentAmountMapDescendants();this._pp_reserveObjects(e,t)},WL.Object.prototype.pp_reserveObjectsChildren=function(e){let t=this.pp_getComponentAmountMapChildren();this._pp_reserveObjects(e,t)},WL.Object.prototype.pp_getComponentAmountMap=function(e=new Map){let t=e.get("object");t==null&&(t=0),t+=1,e.set("object",t);let i=this.pp_getComponents();for(let s of i){let n=s.type,a=e.get(n);a==null&&(a=0),a+=1,e.set(n,a)}return e},WL.Object.prototype.pp_getComponentAmountMapHierarchy=function(e=new Map){let t=this.pp_getHierarchy();for(let i of t)i.pp_getComponentAmountMap(e);return e},WL.Object.prototype.pp_getComponentAmountMapDescendants=function(e=new Map){let t=this.pp_getDescendants();for(let i of t)i.pp_getComponentAmountMap(e);return e},WL.Object.prototype.pp_getComponentAmountMapChildren=function(e=new Map){let t=this.pp_getChildren();for(let i of t)i.pp_getComponentAmountMap(e);return e},WL.Object.pp_getComponentObjects=function(e,t,i=0){let s=null;for(let n of e)if(s=n.getComponent(t,i),s!=null)break;return s},WL.Object.pp_getComponentsObjects=function(e,t){let i=[];for(let s of e)i.push(...s.getComponents(t));return i},WL.Object.pp_setActiveObjects=function(e,t){for(let i of e)i.active=t},WL.Object.pp_getObjectByNameObjects=function(e,t){let i=null;for(let s of e)if(s.pp_getName()==t){i=s;break}return i},WL.Object.pp_getObjectsByNameObjects=function(e,t){let i=[];for(let s of e)s.pp_getName()==t&&i.push(s);return i},WL.Object.prototype._pp_epsilon=1e-6,WL.Object.prototype._pp_quaternionToRadians=function(){let e=V.create();return function(i,s=d.create()){return V.fromQuat(e,i),s[1]=Math.asin(-this._pp_clamp(e[2],-1,1)),Math.abs(e[2])<.9999999?(s[0]=Math.atan2(e[5],e[8]),s[2]=Math.atan2(e[1],e[0])):(s[0]=0,s[2]=Math.atan2(-e[3],e[4])),s}}(),WL.Object.prototype._pp_degreesToQuaternion=function(e,t=f.create()){return f.fromEuler(t,e[0],e[1],e[2]),t},WL.Object.prototype._pp_toDegrees=function(e){return e*(180/Math.PI)},WL.Object.prototype._pp_clamp=function(e,t,i){return Math.min(Math.max(e,t),i)},WL.Object.prototype._pp_reserveObjects=function(e,t){let i=t.get("object")*e;t.delete("object");let s={};for(let[n,a]of t.entries())s[n]=a*e;WL.scene.reserveObjects(i,s)},WL.Object.prototype._pp_setAxes=function(){let e=[d.create(),d.create(),d.create()],t=[[1,-1,1],[1,1,-1],[-1,1,-1]],i=d.create(),s=d.create(),n=d.create(),a=d.create(),r=d.create(),l=V.create(),y=f.create();return function(o,m,u){let h=o[m[0]],_=o[m[1]],P=o[m[2]];if(h==null)return;let p=!1;_!=null&&d.angle(h,_)>this._pp_epsilon&&(p=!0);let g=!1;if(P!=null&&d.angle(h,P)>this._pp_epsilon&&(g=!0),p||g){let b=null,C=null,x=null;p?(b=_,C=1,x=2):(b=P,C=2,x=1);let v=t[m[0]];d.cross(e[x],h,b),d.scale(e[x],e[x],v[m[x]]),d.cross(e[C],h,e[x]),d.scale(e[C],e[C],v[m[C]]),d.cross(e[0],e[1],e[2]),d.scale(e[0],e[0],v[m[0]]),d.normalize(i,e[m.pp_findIndexEqual(0)]),d.normalize(s,e[m.pp_findIndexEqual(1)]),d.normalize(n,e[m.pp_findIndexEqual(2)]),V.set(l,i[0],i[1],i[2],s[0],s[1],s[2],n[0],n[1],n[2]),f.fromMat3(y,l),f.normalize(y,y),u?this.pp_setRotationLocalQuat(y):this.pp_setRotationWorldQuat(y)}else{m[0]==0?u?this.pp_getLeftLocal(a):this.pp_getLeftWorld(a):m[0]==1?u?this.pp_getUpLocal(a):this.pp_getUpWorld(a):u?this.pp_getForwardLocal(a):this.pp_getForwardWorld(a);let b=d.angle(h,a);b!=0&&(d.cross(r,a,h),d.normalize(r,r),f.setAxisAngle(y,r,b),u?this.pp_rotateLocalQuat(y):this.pp_rotateWorldQuat(y))}}}();for(let e in WL.Object.prototype){let t=["pp_","_pp_"],i=!1;for(let s of t)if(e.startsWith(s)){i=!0;break}i&&Object.defineProperty(WL.Object.prototype,e,{enumerable:!1})}}});var ke=T(()=>{Math.PP_EPSILON_NUMBER=1e-5;Math.PP_EPSILON_DEGREES=1e-4;Math.pp_clamp=function(e,t,i){let s=t??-Number.MAX_VALUE,n=i??Number.MAX_VALUE,a=Math.min(s,n),r=Math.max(s,n);return Math.min(Math.max(e,a),r)};Math.pp_sign=function(e,t=1){let i=Math.sign(e);return i==0&&(i=Math.sign(t)),i};Math.pp_toDegrees=function(e){return e*(180/Math.PI)};Math.pp_toRadians=function(e){return e*(Math.PI/180)};Math.pp_roundDecimal=function(e,t){let i=Math.pow(10,t);return e=Math.round(e*i)/i,e};Math.pp_mapToRange=function(e,t,i,s,n){if(t==i)return s;let a=Math.pp_clamp(e,t,i);if(a==t)return s;if(a==i)return n;let r=s+(n-s)/(i-t)*(a-t);return Math.pp_clamp(r,s,n)};Math.pp_random=function(e=0,t=1){return Math.random()*(t-e)+e};Math.pp_randomInt=function(e,t){let i=Math.min(e,t),s=Math.max(e,t);return Math.floor(Math.random()*(s-i+1)+i)};Math.pp_randomBool=function(){return Math.pp_randomInt(0,1)==0};Math.pp_randomSign=function(){return Math.random()<.5?1:-1};Math.pp_randomPick=function(...e){let t=null;if(e.length>0)if(e.length==1&&e[0].length!=null){if(e[0].length>0){let i=Math.pp_randomInt(0,e[0].length-1);t=e[0][i]}}else{let i=Math.pp_randomInt(0,e.length-1);t=e[i]}return t};Math.pp_lerp=function(e,t,i){return i<=0?e:i>=1?t:i*(t-e)+e};PP.EasingFunction={linear:e=>e,easeIn:e=>e*e*e,easeOut:e=>(e-1)*(e-1)*(e-1)+1,easeInOut:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1};Math.pp_interpolate=function(e,t,i,s=PP.EasingFunction.linear){let n=s(i);return Math.pp_lerp(e,t,n)};Math.pp_angleDistance=function(e,t){return Math.pp_angleDistanceDegrees(e,t)};Math.pp_angleDistanceDegrees=function(e,t){return Math.abs(Math.pp_angleDistanceSignedDegrees(e,t))};Math.pp_angleDistanceRadians=function(e,t){return Math.abs(Math.pp_angleDistanceSignedRadians(e,t))};Math.pp_angleDistanceSigned=function(e,t){return Math.pp_angleDistanceSignedDegrees(e,t)};Math.pp_angleDistanceSignedDegrees=function(e,t){let i=Math.pp_angleClampDegrees(e,!0),s=Math.pp_angleClampDegrees(t,!0),n=s-i;return s-i>180?n=s-i-360:s-i<-180&&(n=s-i+360),n};Math.pp_angleDistanceSignedRadians=function(e,t){return Math.pp_toRadians(Math.pp_angleDistanceSignedDegrees(Math.pp_toDegrees(e),Math.pp_toDegrees(t)))};Math.pp_angleClamp=function(e,t=!1){return Math.pp_angleClampDegrees(e,t)};Math.pp_angleClampDegrees=function(e,t=!1){let i=e%360;return i<0&&(i+=360),t||i>180&&(i-=360),i};Math.pp_angleClampRadians=function(e,t=!1){return Math.pp_toRadians(Math.pp_angleClampDegrees(Math.pp_toDegrees(e),t))};Math.pp_isInsideAngleRange=function(e,t,i,s=!1){return Math.pp_isInsideAngleRangeDegrees(e,t,i,s)};Math.pp_isInsideAngleRangeDegrees=function(e,t,i,s=!1){let n=!1,a=Math.pp_angleClampDegrees(e,!0),r=Math.pp_angleClampDegrees(t,!0),l=Math.pp_angleClampDegrees(i,!0);if(s&&Math.pp_angleDistanceSignedDegrees(r,l)<0){let y=r;r=l,l=y}return r<l?n=a>=r&&a<=l:n=a>=r||a<=l,n};Math.pp_isInsideAngleRangeRadians=function(e,t,i,s=!1){return Math.pp_isInsideAngleRangeDegrees(Math.pp_toDegrees(e),Math.pp_toDegrees(t),Math.pp_toDegrees(i),s)};for(let e in Math){let t=["pp_","_pp_"],i=!1;for(let s of t)if(e.startsWith(s)){i=!0;break}i&&Object.defineProperty(Math,e,{enumerable:!1})}});var je=T(()=>{if(WL&&WL.Scene){WL.Scene.prototype.pp_getRoot=function(){return new WL.Object(0)},WL.Scene.prototype.pp_getObjects=function(){return this.pp_getObjectsBreadth()},WL.Scene.prototype.pp_getObjectsBreadth=function(){return this.pp_getRoot().pp_getHierarchyBreadth()},WL.Scene.prototype.pp_getObjectsDepth=function(){return this.pp_getRoot().pp_getHierarchyDepth()},WL.Scene.prototype.pp_getComponent=function(e,t=0){return this.pp_getComponentBreadth(e,t)},WL.Scene.prototype.pp_getComponentBreadth=function(e,t=0){return this.pp_getRoot().pp_getComponentHierarchyBreadth(e,t)},WL.Scene.prototype.pp_getComponentDepth=function(e,t=0){return this.pp_getRoot().pp_getComponentHierarchyDepth(e,t)},WL.Scene.prototype.pp_getComponents=function(e){return this.pp_getComponentsBreadth(e)},WL.Scene.prototype.pp_getComponentsBreadth=function(e){return this.pp_getRoot().pp_getComponentsHierarchyBreadth(e)},WL.Scene.prototype.pp_getComponentsDepth=function(e){return this.pp_getRoot().pp_getComponentsHierarchyDepth(e)},WL.Scene.prototype.pp_getObjectByName=function(e){return this.pp_getObjectByNameBreadth(e)},WL.Scene.prototype.pp_getObjectByNameBreadth=function(e){return this.pp_getRoot().pp_getObjectByNameHierarchyBreadth(e)},WL.Scene.prototype.pp_getObjectByNameDepth=function(e){return this.pp_getRoot().pp_getObjectByNameHierarchyDepth(e)},WL.Scene.prototype.pp_getObjectsByName=function(e){return this.pp_getObjectsByNameBreadth(e)},WL.Scene.prototype.pp_getObjectsByNameBreadth=function(e){return this.pp_getRoot().pp_getObjectsByNameHierarchyBreadth(e)},WL.Scene.prototype.pp_getObjectsByNameDepth=function(e){return this.pp_getRoot().pp_getObjectsByNameHierarchyDepth(e)},WL.Scene.prototype.pp_toString=function(){return this.pp_toStringCompact()},WL.Scene.prototype.pp_toStringCompact=function(){return this.pp_getRoot().pp_toStringCompact()},WL.Scene.prototype.pp_toStringExtended=function(){return this.pp_getRoot().pp_toStringExtended()},WL.Scene.prototype.pp_getComponentAmountMap=function(e=new Map){return this.pp_getRoot().pp_getComponentAmountMapHierarchy(e)};for(let e in WL.Scene.prototype){let t=["pp_","_pp_"],i=!1;for(let s of t)if(e.startsWith(s)){i=!0;break}i&&Object.defineProperty(WL.Scene.prototype,e,{enumerable:!1})}}});var Fe=T(()=>{WL&&WL.Object&&(WL.MeshComponent.prototype.pp_clone=function(e,t,i){let s=e.pp_addComponent(this.type);return s.active=this.active,t.isDeepCloneComponentVariable("mesh","material")?s.material=this.material.clone():s.material=this.material,t.isDeepCloneComponentVariable("mesh","mesh")?s.mesh=PP.MeshUtils.cloneMesh(this.mesh):s.mesh=this.mesh,s.skin=this.skin,s},WL.CollisionComponent.prototype.pp_clone=function(e,t,i){let s=e.pp_addComponent(this.type);return s.active=this.active,s.collider=this.collider,s.extents=this.extents.slice(0),s.group=this.group,s},WL.TextComponent.prototype.pp_clone=function(e,t,i){let s=e.pp_addComponent(this.type);return s.active=this.active,t.isDeepCloneComponent("text")?s.text=this.text.slice(0):s.text=this.text,t.isDeepCloneComponentVariable("text","material")?s.material=this.material.clone():s.material=this.material,s.alignment=this.alignment,s.justification=this.justification,s},WL.PhysXComponent.prototype.pp_clone=function(e,t,i){let s=e.pp_addComponent(this.type,{angularDamping:this.angularDamping,angularVelocity:this.angularVelocity,dynamicFriction:this.dynamicFriction,extents:this.extents,kinematic:this.kinematic,linearDamping:this.linearDamping,linearVelocity:this.linearVelocity,mass:this.mass,restituition:this.restituition,shape:this.shape,shapeData:this.shapeData,static:this.static,staticFriction:this.staticFriction});return s.active=this.active,s},Object.defineProperty(WL.MeshComponent.prototype,"pp_clone",{enumerable:!1}),Object.defineProperty(WL.CollisionComponent.prototype,"pp_clone",{enumerable:!1}),Object.defineProperty(WL.TextComponent.prototype,"pp_clone",{enumerable:!1}),Object.defineProperty(WL.PhysXComponent.prototype,"pp_clone",{enumerable:!1}))});var Wl={};var He=H(()=>{Z();_WL&&_WL._componentTypes&&_WL._componentTypes[_WL._componentTypeIndices.cursor]?(_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.init=function(){this.session=null,this.collisionMask=1<<this.collisionGroup,this.maxDistance=100,this.doubleClickTimer=0,this.tripleClickTimer=0,this.multipleClickObject=null,this.multipleClickDelay=.3,this.visible=!1;let e=this.onDestroy.bind(this);WL.onSceneLoaded.push(e),this.onDestroyCallbacks=[()=>{let t=WL.onSceneLoaded.indexOf(e);t>=0&&WL.onSceneLoaded.splice(t,1)}],this.prevHitLocationLocalToTarget=[0,0,0],this.pointerId=null,this.lastClientX=null,this.lastClientY=null,this.lastWidth=null,this.lastHeight=null},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.start=function(){if(this.handedness==0){let t=this.object.getComponent("input");t?(this.handedness=t.handedness,this.input=t):console.warn("cursor component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];this.globalTarget=this.object.addComponent("cursor-target"),this.origin=new Float32Array(3),this.cursorObjScale=new Float32Array(3),this.direction=[0,0,0],this.tempQuat=new Float32Array(4),this.setViewComponent(this.object.getComponent("view")),this.isHovering=!1,this.visible=!0,this.isDown=!1,this.lastIsDown=!1,this.isUpWithNoDown=!1,this.isRealDown=!1,this.cursorPos=new Float32Array(3),this.hoveringObject=null;let e=this.setupVREvents.bind(this);WL.onXRSessionStart.push(e),this.onDestroyCallbacks.push(()=>{let t=WL.onXRSessionStart.indexOf(e);t>=0&&WL.onXRSessionStart.splice(t,1)}),this.showRay=!0,this.cursorRayObject&&(this.cursorRayObject.pp_setActive(!0),this.showRay=!1,this.cursorRayOrigin=new Float32Array(3),this.cursorRayScale=new Float32Array(3),this.cursorRayScale.set(this.cursorRayObject.scalingLocal),this._setCursorRayTransform(null)),this._setCursorVisibility(!1)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.setViewComponent=function(e){if(this.viewComponent=e,this.viewComponent!=null){let t=this.onClick.bind(this);WL.canvas.addEventListener("click",t);let i=this.onPointerDown.bind(this);WL.canvas.addEventListener("pointerdown",i);let s=this.onPointerMove.bind(this);WL.canvas.addEventListener("pointermove",s);let n=this.onPointerUp.bind(this);WL.canvas.addEventListener("pointerup",n);let a=this.onPointerLeave.bind(this);WL.canvas.addEventListener("pointerleave",a),this.projectionMatrix=new Float32Array(16),S.invert(this.projectionMatrix,this.viewComponent.projectionMatrix);let r=this.onViewportResize.bind(this);window.addEventListener("resize",r),this.onDestroyCallbacks.push(()=>{WL.canvas.removeEventListener("click",t),WL.canvas.removeEventListener("pointerdown",i),WL.canvas.removeEventListener("pointermove",s),WL.canvas.removeEventListener("pointerup",n),WL.canvas.removeEventListener("pointerleave",a),window.removeEventListener("resize",r)})}},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onViewportResize=function(){!this.viewComponent||S.invert(this.projectionMatrix,this.viewComponent.projectionMatrix)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype._setCursorRayTransform=function(e){if(!!this.cursorRayObject&&this.cursorRayScalingAxis!=4&&(this.cursorRayObject.resetScaling(),e!=null)){this.cursorRayObject.getTranslationWorld(this.cursorRayOrigin);let t=d.dist(this.cursorRayOrigin,e);this.cursorRayScale[this.cursorRayScalingAxis]=t,this.cursorRayObject.scale(this.cursorRayScale)}},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype._setCursorVisibility=function(e){this.visible=e,this.cursorObject&&this.cursorObject.pp_setActive(e)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.update=function(e){this.doubleClickTimer>0&&(this.doubleClickTimer-=e),this.tripleClickTimer>0&&(this.tripleClickTimer-=e),this.doUpdate(!1)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.doUpdate=function(e){if(this.session){if(this.arTouchDown&&this.input&&WL.xrSession.inputSources[0].handedness==="none"&&WL.xrSession.inputSources[0].gamepad){let i=WL.xrSession.inputSources[0].gamepad.axes;this.direction.vec3_set(i[0],-i[1],-1),this.updateDirection()}else this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction);let t=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(this.origin,this.direction,this.collisionMask):WL.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);t.hitCount>0?this.cursorPos.set(t.locations[0]):this.cursorPos.fill(0),this.hoverBehaviour(t,e)}else if(this.viewComponent!=null&&this.lastClientX!=null){let t=this.updateMousePos(this.lastClientX,this.lastClientY,this.lastWidth,this.lastHeight);this.hoverBehaviour(t,!1)}this.cursorObject&&(this.hoveringObject&&(this.cursorPos[0]!=0||this.cursorPos[1]!=0||this.cursorPos[2]!=0)?(this._setCursorVisibility(!0),this.cursorObject.setTranslationWorld(this.cursorPos),this._setCursorRayTransform(this.cursorPos)):(this.visible&&this.cursorRayObject&&this._setCursorRayTransform(null),this._setCursorVisibility(!1))),this.cursorRayObject&&this.cursorRayObject.pp_setActive(!0),this.hoveringObject==null&&(this.pointerId=null)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.hoverBehaviour=function(e,t,i=!1){if(!i&&e.hitCount>0){let s=!1;if(!this.hoveringObject||!this.hoveringObject.equals(e.objects[0])){if(this.hoveringObject){let r=this.hoveringObject.getComponent("cursor-target");r&&r.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this)}s=!0,this.hoveringObject=e.objects[0],this.styleCursor&&(document.body.style.cursor="pointer");let a=this.hoveringObject.getComponent("cursor-target");a&&a.onHover(this.hoveringObject,this),this.globalTarget.onHover(this.hoveringObject,this),!this._isDown()&&this.isRealDown&&(this.isDown=!1,this.lastIsDown=!1,this.isUpWithNoDown=!1,a&&a.onDownOnHover(this.hoveringObject,this),this.globalTarget.onDownOnHover(this.hoveringObject,this))}let n=this.hoveringObject.getComponent("cursor-target");!s&&this._isMoving(e.locations[0])&&(n&&n.onMove(this.hoveringObject,this),this.globalTarget.onMove(this.hoveringObject,this)),this._isDown()?(n&&n.onDown(this.hoveringObject,this),this.globalTarget.onDown(this.hoveringObject,this),this.tripleClickTimer>0&&this.multipleClickObject&&this.multipleClickObject.equals(this.hoveringObject)?(n&&n.onTripleClick(this.hoveringObject,this),this.globalTarget.onTripleClick(this.hoveringObject,this),this.tripleClickTimer=0):this.doubleClickTimer>0&&this.multipleClickObject&&this.multipleClickObject.equals(this.hoveringObject)?(n&&n.onDoubleClick(this.hoveringObject,this),this.globalTarget.onDoubleClick(this.hoveringObject,this),this.tripleClickTimer=this.multipleClickDelay,this.doubleClickTimer=0):(n&&n.onClick(this.hoveringObject,this),this.globalTarget.onClick(this.hoveringObject,this),this.tripleClickTimer=0,this.doubleClickTimer=this.multipleClickDelay,this.multipleClickObject=this.hoveringObject)):!this.isUpWithNoDown&&!s&&this._isUp()?(n&&n.onUp(this.hoveringObject,this),this.globalTarget.onUp(this.hoveringObject,this)):(this.isUpWithNoDown||s&&this._isUp())&&(n&&n.onUpWithNoDown(this.hoveringObject,this),this.globalTarget.onUpWithNoDown(this.hoveringObject,this)),this.prevHitLocationLocalToTarget=this.hoveringObject.pp_convertPositionWorldToLocal(e.locations[0],this.prevHitLocationLocalToTarget)}else if(this.hoveringObject&&(i||e.hitCount==0)){let s=this.hoveringObject.getComponent("cursor-target");s&&s.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this),this.hoveringObject=null,this.styleCursor&&(document.body.style.cursor="default")}this.hoveringObject?this.lastIsDown=this.isDown:(this.isDown=!1,this.lastIsDown=!1),this.isUpWithNoDown=!1},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.setupVREvents=function(e){this.session=e;let t=function(a){this.session=null}.bind(this);e.addEventListener("end",t);let i=this.onSelect.bind(this);e.addEventListener("select",i);let s=this.onSelectStart.bind(this);e.addEventListener("selectstart",s);let n=this.onSelectEnd.bind(this);e.addEventListener("selectend",n),this.onDestroyCallbacks.push(()=>{!this.session||(e.removeEventListener("end",t),e.removeEventListener("select",i),e.removeEventListener("selectstart",s),e.removeEventListener("selectend",n))}),this.onViewportResize()},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onSelect=function(e){},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onSelectStart=function(e){this.active&&(this.arTouchDown=!0,e.inputSource.handedness==this.handedness&&(this.isDown=!0)),this.isRealDown=!0},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onSelectEnd=function(e){this.active&&(this.arTouchDown=!1,e.inputSource.handedness==this.handedness&&(this.isDown||(this.isUpWithNoDown=!0),this.isDown=!1)),this.isRealDown=!1},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onPointerMove=function(e){if(this.active){if(this.pointerId!=null&&this.pointerId!=e.pointerId)return;let t=document.body.getBoundingClientRect(),i=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.hoverBehaviour(i,!1),this.hoveringObject!=null?this.pointerId=e.pointerId:this.pointerId=null}},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onClick=function(e){},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onPointerDown=function(e){if(this.active){if(this.pointerId!=null&&this.pointerId!=e.pointerId||e.button!==0)return;let t=document.body.getBoundingClientRect(),i=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.isDown=!0,this.isRealDown=!0,this.hoverBehaviour(i,!1),this.hoveringObject!=null?this.pointerId=e.pointerId:this.pointerId=null}else this.isRealDown=!0},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onPointerUp=function(e){if(this.active){if(this.pointerId!=null&&this.pointerId!=e.pointerId||e.button!==0)return;let t=document.body.getBoundingClientRect(),i=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.isDown||(this.isUpWithNoDown=!0),this.isDown=!1,this.isRealDown=!1,this.hoverBehaviour(i,!1),this.hoveringObject!=null?this.pointerId=e.pointerId:this.pointerId=null}else this.isRealDown=!1},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onPointerLeave=function(e){(this.pointerId==null||this.pointerId==e.pointerId)&&(this.active&&this.hoverBehaviour(null,!1,!0),this.pointerId=null,this.lastClientX=null,this.lastClientY=null,this.lastWidth=null,this.lastHeight=null)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.updateMousePos=function(e,t,i,s){this.lastClientX=e,this.lastClientY=t,this.lastWidth=i,this.lastHeight=s;let n=e/i,a=t/s;return this.direction.vec3_set(n*2-1,-a*2+1,-1),this.updateDirection()},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.updateDirection=function(){this.object.getTranslationWorld(this.origin),d.transformMat4(this.direction,this.direction,this.projectionMatrix),d.normalize(this.direction,this.direction),d.transformQuat(this.direction,this.direction,this.object.transformWorld);let e=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(this.origin,this.direction,this.collisionMask):WL.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);return e.hitCount>0?this.cursorPos.set(e.locations[0]):this.cursorPos.fill(0),e},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onDeactivate=function(){if(this.hoveringObject){let e=this.hoveringObject.getComponent("cursor-target");e&&e.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this)}this.hoveringObject=null,this.styleCursor&&(document.body.style.cursor="default"),this.isDown=!1,this.lastIsDown=!1,this.isUpWithNoDown=!1,this._setCursorVisibility(!1),this.cursorRayObject&&this.cursorRayObject.pp_setActive(!1),this.pointerId=null,this.lastClientX=null,this.lastClientY=null,this.lastWidth=null,this.lastHeight=null},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onActivate=function(){this.showRay=!0,this.isDown=!1,this.lastIsDown=!1,this.isUpWithNoDown=!1},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onDestroy=function(){for(let e of this.onDestroyCallbacks)e()},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype._isDown=function(){return this.isDown!==this.lastIsDown&&this.isDown},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype._isUp=function(){return this.isDown!==this.lastIsDown&&!this.isDown},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype._isMoving=function(){let e=[0,0,0];return function(i){let s=!1;return e=this.hoveringObject.pp_convertPositionWorldToLocal(i,e),e.vec_equals(this.prevHitLocationLocalToTarget,1e-4)||(s=!0),s}}()):console.error(`Wonderland Engine "cursor" component not found.
 Add the component to your project to avoid any issue with the PP bundle.`)});var we=T(()=>{_WL&&_WL._componentTypes&&_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]]?(_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.init=function(){this.hoverFunctions=[],this.unHoverFunctions=[],this.clickFunctions=[],this.doubleClickFunctions=[],this.tripleClickFunctions=[],this.moveFunctions=[],this.downFunctions=[],this.upFunctions=[],this.downOnHoverFunctions=[],this.upWithNoDownFunctions=[],this.isSurface=!1},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onHover=function(e,t){for(let i of this.hoverFunctions)i(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onUnhover=function(e,t){for(let i of this.unHoverFunctions)i(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onClick=function(e,t){for(let i of this.clickFunctions)i(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onMove=function(e,t){for(let i of this.moveFunctions)i(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onDown=function(e,t){for(let i of this.downFunctions)i(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onUp=function(e,t){for(let i of this.upFunctions)i(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addHoverFunction=function(e){this._validateCallback(e),this.hoverFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeHoverFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.hoverFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addUnHoverFunction=function(e){this._validateCallback(e),this.unHoverFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeUnHoverFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.unHoverFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addClickFunction=function(e){this._validateCallback(e),this.clickFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeClickFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.clickFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addMoveFunction=function(e){this._validateCallback(e),this.moveFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeMoveFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.moveFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addDownFunction=function(e){this._validateCallback(e),this.downFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeDownFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.downFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addUpFunction=function(e){this._validateCallback(e),this.upFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeUpFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.upFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype._removeItemOnce=function(e,t){var i=e.indexOf(t);return i>-1&&e.splice(i,1),e},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype._validateCallback=function(e){if(typeof e!="function")throw new TypeError(this.object.name+".cursor-target: Argument needs to be a function")},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onDoubleClick=function(e,t){for(let i of this.doubleClickFunctions)i(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addDoubleClickFunction=function(e){this._validateCallback(e),this.doubleClickFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeDoubleClickFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.doubleClickFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onTripleClick=function(e,t){for(let i of this.tripleClickFunctions)i(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addTripleClickFunction=function(e){this._validateCallback(e),this.tripleClickFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeTripleClickFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.tripleClickFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onDownOnHover=function(e,t){for(let i of this.downOnHoverFunctions)i(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addDownOnHoverFunction=function(e){this._validateCallback(e),this.downOnHoverFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeDownOnHoverFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.downOnHoverFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onUpWithNoDown=function(e,t){for(let i of this.upWithNoDownFunctions)i(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addUpWithNoDownFunction=function(e){this._validateCallback(e),this.upWithNoDownFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeUpWithNoDownFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.upWithNoDownFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.start=function(){},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.update=function(e){},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onActivate=function(){},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onDeactivate=function(){},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onDestroy=function(){}):console.error(`Wonderland Engine "cursor-target" component not found.
 Add the component to your project to avoid any issue with the PP bundle.`)});var Ne=T(()=>{_WL&&_WL._componentTypes&&_WL._componentTypes[_WL._componentTypeIndices["mouse-look"]]?(_WL._componentTypes[_WL._componentTypeIndices["mouse-look"]].prototype.init=function(){this.pointerId=null,this.prevMoveEvent=null,this.resetMovingDelay=.15,this.resetMovingTimer=new PP.Timer(this.resetMovingDelay,!1),this.isMoving=!1,document.body.addEventListener("pointermove",this._onMove.bind(this)),this.requireMouseDown&&(this.mouseButtonIndex==2&&WL.canvas.addEventListener("contextmenu",function(e){e.preventDefault()},!1),WL.canvas.addEventListener("pointerdown",function(e){if(this.pointerId==null&&!this.mouseDown&&e.button==this.mouseButtonIndex&&(this.pointerId=e.pointerId,this.mouseDown=!0,document.body.style.cursor="grabbing",e.button==1))return e.preventDefault(),!1}.bind(this)),document.body.addEventListener("pointerup",function(e){e.pointerId==this.pointerId&&this.mouseDown&&e.button==this.mouseButtonIndex&&(this.mouseDown=!1,document.body.style.cursor="initial")}.bind(this))),document.body.addEventListener("pointerleave",function(e){e.pointerId==this.pointerId&&(this.pointerId=null,this.prevMoveEvent=null,this.mouseDown&&(this.mouseDown=!1,document.body.style.cursor="initial"))}.bind(this))},_WL._componentTypes[_WL._componentTypeIndices["mouse-look"]].prototype.update=function(e){this.resetMovingTimer.isRunning()&&(this.resetMovingTimer.update(e),this.resetMovingTimer.isDone()&&(this.resetMovingTimer.reset(),this.isMoving=!1)),this.isMoving||((!this.requireMouseDown||!this.mouseDown)&&(this.pointerId=null),this.prevMoveEvent=null)},_WL._componentTypes[_WL._componentTypeIndices["mouse-look"]].prototype._onMove=function(){let e=PP.vec3_create(),t=PP.vec3_create(),i=PP.vec3_create(),s=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create();return function(r){if(!(this.pointerId!=null&&r.pointerId!=this.pointerId)&&this.active&&(this.mouseDown||!this.requireMouseDown)){e=this.object.pp_getBackward(e),t=this.object.pp_getUp(t),i.vec3_set(0,1,0),this.object.pp_getParent()!=null&&(i=this.object.pp_getParent().pp_getUp(i)),n=e.vec3_cross(i,n);let l=1;e.vec3_angle(i)<l?n=t.vec3_negate(n).vec3_cross(i,n):e.vec3_angle(i.vec3_negate(s))<l?n=t.vec3_cross(i,n):t.vec3_isConcordant(i)||n.vec3_negate(n),n.vec3_normalize(n);let y=r.movementX,c=r.movementY;(y==null||c==null)&&(this.prevMoveEvent!=null?(y=r.pageX-this.prevMoveEvent.pageX,c=r.pageY-this.prevMoveEvent.pageY):(y=0,c=0)),this.rotationX=-this.sensitity*y,this.rotationY=-this.sensitity*c,this.object.pp_rotateAxis(this.rotationY,n);let o=90-.001;a=this.object.pp_getUp(a);let m=Math.pp_angleClamp(a.vec3_angleSigned(i,n));if(Math.abs(m)>o){let u=(Math.abs(m)-o)*Math.pp_sign(m);this.object.pp_rotateAxis(u,n)}this.object.pp_rotateAxis(this.rotationX,i),this.prevMoveEvent=r,this.pointerId=r.pointerId,this.resetMovingTimer.start(this.resetMovingDelay),this.isMoving=!0}}}()):console.error(`Wonderland Engine "mouse-look" component not found.
 Add the component to your project to avoid any issue with the PP bundle.`)});var ct=T(ut=>{(function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var o=this||t;return o._counter=1e3,o._html5AudioPool=[],o.html5PoolSize=10,o._codecs={},o._howls=[],o._muted=!1,o._volume=1,o._canPlayEvent="canplaythrough",o._navigator=typeof window<"u"&&window.navigator?window.navigator:null,o.masterGain=null,o.noAudio=!1,o.usingWebAudio=!0,o.autoSuspend=!0,o.ctx=null,o.autoUnlock=!0,o._setup(),o},volume:function(o){var m=this||t;if(o=parseFloat(o),m.ctx||c(),typeof o<"u"&&o>=0&&o<=1){if(m._volume=o,m._muted)return m;m.usingWebAudio&&m.masterGain.gain.setValueAtTime(o,t.ctx.currentTime);for(var u=0;u<m._howls.length;u++)if(!m._howls[u]._webAudio)for(var h=m._howls[u]._getSoundIds(),_=0;_<h.length;_++){var P=m._howls[u]._soundById(h[_]);P&&P._node&&(P._node.volume=P._volume*o)}return m}return m._volume},mute:function(o){var m=this||t;m.ctx||c(),m._muted=o,m.usingWebAudio&&m.masterGain.gain.setValueAtTime(o?0:m._volume,t.ctx.currentTime);for(var u=0;u<m._howls.length;u++)if(!m._howls[u]._webAudio)for(var h=m._howls[u]._getSoundIds(),_=0;_<h.length;_++){var P=m._howls[u]._soundById(h[_]);P&&P._node&&(P._node.muted=o?!0:P._muted)}return m},stop:function(){for(var o=this||t,m=0;m<o._howls.length;m++)o._howls[m].stop();return o},unload:function(){for(var o=this||t,m=o._howls.length-1;m>=0;m--)o._howls[m].unload();return o.usingWebAudio&&o.ctx&&typeof o.ctx.close<"u"&&(o.ctx.close(),o.ctx=null,c()),o},codecs:function(o){return(this||t)._codecs[o.replace(/^x-/,"")]},_setup:function(){var o=this||t;if(o.state=o.ctx&&o.ctx.state||"suspended",o._autoSuspend(),!o.usingWebAudio)if(typeof Audio<"u")try{var m=new Audio;typeof m.oncanplaythrough>"u"&&(o._canPlayEvent="canplay")}catch{o.noAudio=!0}else o.noAudio=!0;try{var m=new Audio;m.muted&&(o.noAudio=!0)}catch{}return o.noAudio||o._setupCodecs(),o},_setupCodecs:function(){var o=this||t,m=null;try{m=typeof Audio<"u"?new Audio:null}catch{return o}if(!m||typeof m.canPlayType!="function")return o;var u=m.canPlayType("audio/mpeg;").replace(/^no$/,""),h=o._navigator?o._navigator.userAgent:"",_=h.match(/OPR\/([0-6].)/g),P=_&&parseInt(_[0].split("/")[1],10)<33,p=h.indexOf("Safari")!==-1&&h.indexOf("Chrome")===-1,g=h.match(/Version\/(.*?) /),b=p&&g&&parseInt(g[1],10)<15;return o._codecs={mp3:!!(!P&&(u||m.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!u,opus:!!m.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!m.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!m.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(m.canPlayType('audio/wav; codecs="1"')||m.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!m.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!m.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(m.canPlayType("audio/x-m4a;")||m.canPlayType("audio/m4a;")||m.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(m.canPlayType("audio/x-m4b;")||m.canPlayType("audio/m4b;")||m.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(m.canPlayType("audio/x-mp4;")||m.canPlayType("audio/mp4;")||m.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&m.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&m.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!m.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(m.canPlayType("audio/x-flac;")||m.canPlayType("audio/flac;")).replace(/^no$/,"")},o},_unlockAudio:function(){var o=this||t;if(!(o._audioUnlocked||!o.ctx)){o._audioUnlocked=!1,o.autoUnlock=!1,!o._mobileUnloaded&&o.ctx.sampleRate!==44100&&(o._mobileUnloaded=!0,o.unload()),o._scratchBuffer=o.ctx.createBuffer(1,1,22050);var m=function(u){for(;o._html5AudioPool.length<o.html5PoolSize;)try{var h=new Audio;h._unlocked=!0,o._releaseHtml5Audio(h)}catch{o.noAudio=!0;break}for(var _=0;_<o._howls.length;_++)if(!o._howls[_]._webAudio)for(var P=o._howls[_]._getSoundIds(),p=0;p<P.length;p++){var g=o._howls[_]._soundById(P[p]);g&&g._node&&!g._node._unlocked&&(g._node._unlocked=!0,g._node.load())}o._autoResume();var b=o.ctx.createBufferSource();b.buffer=o._scratchBuffer,b.connect(o.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof o.ctx.resume=="function"&&o.ctx.resume(),b.onended=function(){b.disconnect(0),o._audioUnlocked=!0,document.removeEventListener("touchstart",m,!0),document.removeEventListener("touchend",m,!0),document.removeEventListener("click",m,!0),document.removeEventListener("keydown",m,!0);for(var C=0;C<o._howls.length;C++)o._howls[C]._emit("unlock")}};return document.addEventListener("touchstart",m,!0),document.addEventListener("touchend",m,!0),document.addEventListener("click",m,!0),document.addEventListener("keydown",m,!0),o}},_obtainHtml5Audio:function(){var o=this||t;if(o._html5AudioPool.length)return o._html5AudioPool.pop();var m=new Audio().play();return m&&typeof Promise<"u"&&(m instanceof Promise||typeof m.then=="function")&&m.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(o){var m=this||t;return o._unlocked&&m._html5AudioPool.push(o),m},_autoSuspend:function(){var o=this;if(!(!o.autoSuspend||!o.ctx||typeof o.ctx.suspend>"u"||!t.usingWebAudio)){for(var m=0;m<o._howls.length;m++)if(o._howls[m]._webAudio){for(var u=0;u<o._howls[m]._sounds.length;u++)if(!o._howls[m]._sounds[u]._paused)return o}return o._suspendTimer&&clearTimeout(o._suspendTimer),o._suspendTimer=setTimeout(function(){if(!!o.autoSuspend){o._suspendTimer=null,o.state="suspending";var h=function(){o.state="suspended",o._resumeAfterSuspend&&(delete o._resumeAfterSuspend,o._autoResume())};o.ctx.suspend().then(h,h)}},3e4),o}},_autoResume:function(){var o=this;if(!(!o.ctx||typeof o.ctx.resume>"u"||!t.usingWebAudio))return o.state==="running"&&o.ctx.state!=="interrupted"&&o._suspendTimer?(clearTimeout(o._suspendTimer),o._suspendTimer=null):o.state==="suspended"||o.state==="running"&&o.ctx.state==="interrupted"?(o.ctx.resume().then(function(){o.state="running";for(var m=0;m<o._howls.length;m++)o._howls[m]._emit("resume")}),o._suspendTimer&&(clearTimeout(o._suspendTimer),o._suspendTimer=null)):o.state==="suspending"&&(o._resumeAfterSuspend=!0),o}};var t=new e,i=function(o){var m=this;if(!o.src||o.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}m.init(o)};i.prototype={init:function(o){var m=this;return t.ctx||c(),m._autoplay=o.autoplay||!1,m._format=typeof o.format!="string"?o.format:[o.format],m._html5=o.html5||!1,m._muted=o.mute||!1,m._loop=o.loop||!1,m._pool=o.pool||5,m._preload=typeof o.preload=="boolean"||o.preload==="metadata"?o.preload:!0,m._rate=o.rate||1,m._sprite=o.sprite||{},m._src=typeof o.src!="string"?o.src:[o.src],m._volume=o.volume!==void 0?o.volume:1,m._xhr={method:o.xhr&&o.xhr.method?o.xhr.method:"GET",headers:o.xhr&&o.xhr.headers?o.xhr.headers:null,withCredentials:o.xhr&&o.xhr.withCredentials?o.xhr.withCredentials:!1},m._duration=0,m._state="unloaded",m._sounds=[],m._endTimers={},m._queue=[],m._playLock=!1,m._onend=o.onend?[{fn:o.onend}]:[],m._onfade=o.onfade?[{fn:o.onfade}]:[],m._onload=o.onload?[{fn:o.onload}]:[],m._onloaderror=o.onloaderror?[{fn:o.onloaderror}]:[],m._onplayerror=o.onplayerror?[{fn:o.onplayerror}]:[],m._onpause=o.onpause?[{fn:o.onpause}]:[],m._onplay=o.onplay?[{fn:o.onplay}]:[],m._onstop=o.onstop?[{fn:o.onstop}]:[],m._onmute=o.onmute?[{fn:o.onmute}]:[],m._onvolume=o.onvolume?[{fn:o.onvolume}]:[],m._onrate=o.onrate?[{fn:o.onrate}]:[],m._onseek=o.onseek?[{fn:o.onseek}]:[],m._onunlock=o.onunlock?[{fn:o.onunlock}]:[],m._onresume=[],m._webAudio=t.usingWebAudio&&!m._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(m),m._autoplay&&m._queue.push({event:"play",action:function(){m.play()}}),m._preload&&m._preload!=="none"&&m.load(),m},load:function(){var o=this,m=null;if(t.noAudio){o._emit("loaderror",null,"No audio support.");return}typeof o._src=="string"&&(o._src=[o._src]);for(var u=0;u<o._src.length;u++){var h,_;if(o._format&&o._format[u])h=o._format[u];else{if(_=o._src[u],typeof _!="string"){o._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}h=/^data:audio\/([^;,]+);/i.exec(_),h||(h=/\.([^.]+)$/.exec(_.split("?",1)[0])),h&&(h=h[1].toLowerCase())}if(h||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),h&&t.codecs(h)){m=o._src[u];break}}if(!m){o._emit("loaderror",null,"No codec support for selected audio sources.");return}return o._src=m,o._state="loading",window.location.protocol==="https:"&&m.slice(0,5)==="http:"&&(o._html5=!0,o._webAudio=!1),new s(o),o._webAudio&&a(o),o},play:function(o,m){var u=this,h=null;if(typeof o=="number")h=o,o=null;else{if(typeof o=="string"&&u._state==="loaded"&&!u._sprite[o])return null;if(typeof o>"u"&&(o="__default",!u._playLock)){for(var _=0,P=0;P<u._sounds.length;P++)u._sounds[P]._paused&&!u._sounds[P]._ended&&(_++,h=u._sounds[P]._id);_===1?o=null:h=null}}var p=h?u._soundById(h):u._inactiveSound();if(!p)return null;if(h&&!o&&(o=p._sprite||"__default"),u._state!=="loaded"){p._sprite=o,p._ended=!1;var g=p._id;return u._queue.push({event:"play",action:function(){u.play(g)}}),g}if(h&&!p._paused)return m||u._loadQueue("play"),p._id;u._webAudio&&t._autoResume();var b=Math.max(0,p._seek>0?p._seek:u._sprite[o][0]/1e3),C=Math.max(0,(u._sprite[o][0]+u._sprite[o][1])/1e3-b),x=C*1e3/Math.abs(p._rate),v=u._sprite[o][0]/1e3,B=(u._sprite[o][0]+u._sprite[o][1])/1e3;p._sprite=o,p._ended=!1;var O=function(){p._paused=!1,p._seek=b,p._start=v,p._stop=B,p._loop=!!(p._loop||u._sprite[o][2])};if(b>=B){u._ended(p);return}var L=p._node;if(u._webAudio){var W=function(){u._playLock=!1,O(),u._refreshBuffer(p);var E=p._muted||u._muted?0:p._volume;L.gain.setValueAtTime(E,t.ctx.currentTime),p._playStart=t.ctx.currentTime,typeof L.bufferSource.start>"u"?p._loop?L.bufferSource.noteGrainOn(0,b,86400):L.bufferSource.noteGrainOn(0,b,C):p._loop?L.bufferSource.start(0,b,86400):L.bufferSource.start(0,b,C),x!==1/0&&(u._endTimers[p._id]=setTimeout(u._ended.bind(u,p),x)),m||setTimeout(function(){u._emit("play",p._id),u._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?W():(u._playLock=!0,u.once("resume",W),u._clearTimer(p._id))}else{var R=function(){L.currentTime=b,L.muted=p._muted||u._muted||t._muted||L.muted,L.volume=p._volume*t.volume(),L.playbackRate=p._rate;try{var E=L.play();if(E&&typeof Promise<"u"&&(E instanceof Promise||typeof E.then=="function")?(u._playLock=!0,O(),E.then(function(){u._playLock=!1,L._unlocked=!0,m?u._loadQueue():u._emit("play",p._id)}).catch(function(){u._playLock=!1,u._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),p._ended=!0,p._paused=!0})):m||(u._playLock=!1,O(),u._emit("play",p._id)),L.playbackRate=p._rate,L.paused){u._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}o!=="__default"||p._loop?u._endTimers[p._id]=setTimeout(u._ended.bind(u,p),x):(u._endTimers[p._id]=function(){u._ended(p),L.removeEventListener("ended",u._endTimers[p._id],!1)},L.addEventListener("ended",u._endTimers[p._id],!1))}catch(A){u._emit("playerror",p._id,A)}};L.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(L.src=u._src,L.load());var j=window&&window.ejecta||!L.readyState&&t._navigator.isCocoonJS;if(L.readyState>=3||j)R();else{u._playLock=!0,u._state="loading";var k=function(){u._state="loaded",R(),L.removeEventListener(t._canPlayEvent,k,!1)};L.addEventListener(t._canPlayEvent,k,!1),u._clearTimer(p._id)}}return p._id},pause:function(o){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"pause",action:function(){m.pause(o)}}),m;for(var u=m._getSoundIds(o),h=0;h<u.length;h++){m._clearTimer(u[h]);var _=m._soundById(u[h]);if(_&&!_._paused&&(_._seek=m.seek(u[h]),_._rateSeek=0,_._paused=!0,m._stopFade(u[h]),_._node))if(m._webAudio){if(!_._node.bufferSource)continue;typeof _._node.bufferSource.stop>"u"?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),m._cleanBuffer(_._node)}else(!isNaN(_._node.duration)||_._node.duration===1/0)&&_._node.pause();arguments[1]||m._emit("pause",_?_._id:null)}return m},stop:function(o,m){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"stop",action:function(){u.stop(o)}}),u;for(var h=u._getSoundIds(o),_=0;_<h.length;_++){u._clearTimer(h[_]);var P=u._soundById(h[_]);P&&(P._seek=P._start||0,P._rateSeek=0,P._paused=!0,P._ended=!0,u._stopFade(h[_]),P._node&&(u._webAudio?P._node.bufferSource&&(typeof P._node.bufferSource.stop>"u"?P._node.bufferSource.noteOff(0):P._node.bufferSource.stop(0),u._cleanBuffer(P._node)):(!isNaN(P._node.duration)||P._node.duration===1/0)&&(P._node.currentTime=P._start||0,P._node.pause(),P._node.duration===1/0&&u._clearSound(P._node))),m||u._emit("stop",P._id))}return u},mute:function(o,m){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"mute",action:function(){u.mute(o,m)}}),u;if(typeof m>"u")if(typeof o=="boolean")u._muted=o;else return u._muted;for(var h=u._getSoundIds(m),_=0;_<h.length;_++){var P=u._soundById(h[_]);P&&(P._muted=o,P._interval&&u._stopFade(P._id),u._webAudio&&P._node?P._node.gain.setValueAtTime(o?0:P._volume,t.ctx.currentTime):P._node&&(P._node.muted=t._muted?!0:o),u._emit("mute",P._id))}return u},volume:function(){var o=this,m=arguments,u,h;if(m.length===0)return o._volume;if(m.length===1||m.length===2&&typeof m[1]>"u"){var _=o._getSoundIds(),P=_.indexOf(m[0]);P>=0?h=parseInt(m[0],10):u=parseFloat(m[0])}else m.length>=2&&(u=parseFloat(m[0]),h=parseInt(m[1],10));var p;if(typeof u<"u"&&u>=0&&u<=1){if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,m)}}),o;typeof h>"u"&&(o._volume=u),h=o._getSoundIds(h);for(var g=0;g<h.length;g++)p=o._soundById(h[g]),p&&(p._volume=u,m[2]||o._stopFade(h[g]),o._webAudio&&p._node&&!p._muted?p._node.gain.setValueAtTime(u,t.ctx.currentTime):p._node&&!p._muted&&(p._node.volume=u*t.volume()),o._emit("volume",p._id))}else return p=h?o._soundById(h):o._sounds[0],p?p._volume:0;return o},fade:function(o,m,u,h){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"fade",action:function(){_.fade(o,m,u,h)}}),_;o=Math.min(Math.max(0,parseFloat(o)),1),m=Math.min(Math.max(0,parseFloat(m)),1),u=parseFloat(u),_.volume(o,h);for(var P=_._getSoundIds(h),p=0;p<P.length;p++){var g=_._soundById(P[p]);if(g){if(h||_._stopFade(P[p]),_._webAudio&&!g._muted){var b=t.ctx.currentTime,C=b+u/1e3;g._volume=o,g._node.gain.setValueAtTime(o,b),g._node.gain.linearRampToValueAtTime(m,C)}_._startFadeInterval(g,o,m,u,P[p],typeof h>"u")}}return _},_startFadeInterval:function(o,m,u,h,_,P){var p=this,g=m,b=u-m,C=Math.abs(b/.01),x=Math.max(4,C>0?h/C:h),v=Date.now();o._fadeTo=u,o._interval=setInterval(function(){var B=(Date.now()-v)/h;v=Date.now(),g+=b*B,g=Math.round(g*100)/100,b<0?g=Math.max(u,g):g=Math.min(u,g),p._webAudio?o._volume=g:p.volume(g,o._id,!0),P&&(p._volume=g),(u<m&&g<=u||u>m&&g>=u)&&(clearInterval(o._interval),o._interval=null,o._fadeTo=null,p.volume(u,o._id),p._emit("fade",o._id))},x)},_stopFade:function(o){var m=this,u=m._soundById(o);return u&&u._interval&&(m._webAudio&&u._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(u._interval),u._interval=null,m.volume(u._fadeTo,o),u._fadeTo=null,m._emit("fade",o)),m},loop:function(){var o=this,m=arguments,u,h,_;if(m.length===0)return o._loop;if(m.length===1)if(typeof m[0]=="boolean")u=m[0],o._loop=u;else return _=o._soundById(parseInt(m[0],10)),_?_._loop:!1;else m.length===2&&(u=m[0],h=parseInt(m[1],10));for(var P=o._getSoundIds(h),p=0;p<P.length;p++)_=o._soundById(P[p]),_&&(_._loop=u,o._webAudio&&_._node&&_._node.bufferSource&&(_._node.bufferSource.loop=u,u&&(_._node.bufferSource.loopStart=_._start||0,_._node.bufferSource.loopEnd=_._stop,o.playing(P[p])&&(o.pause(P[p],!0),o.play(P[p],!0)))));return o},rate:function(){var o=this,m=arguments,u,h;if(m.length===0)h=o._sounds[0]._id;else if(m.length===1){var _=o._getSoundIds(),P=_.indexOf(m[0]);P>=0?h=parseInt(m[0],10):u=parseFloat(m[0])}else m.length===2&&(u=parseFloat(m[0]),h=parseInt(m[1],10));var p;if(typeof u=="number"){if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,m)}}),o;typeof h>"u"&&(o._rate=u),h=o._getSoundIds(h);for(var g=0;g<h.length;g++)if(p=o._soundById(h[g]),p){o.playing(h[g])&&(p._rateSeek=o.seek(h[g]),p._playStart=o._webAudio?t.ctx.currentTime:p._playStart),p._rate=u,o._webAudio&&p._node&&p._node.bufferSource?p._node.bufferSource.playbackRate.setValueAtTime(u,t.ctx.currentTime):p._node&&(p._node.playbackRate=u);var b=o.seek(h[g]),C=(o._sprite[p._sprite][0]+o._sprite[p._sprite][1])/1e3-b,x=C*1e3/Math.abs(p._rate);(o._endTimers[h[g]]||!p._paused)&&(o._clearTimer(h[g]),o._endTimers[h[g]]=setTimeout(o._ended.bind(o,p),x)),o._emit("rate",p._id)}}else return p=o._soundById(h),p?p._rate:o._rate;return o},seek:function(){var o=this,m=arguments,u,h;if(m.length===0)o._sounds.length&&(h=o._sounds[0]._id);else if(m.length===1){var _=o._getSoundIds(),P=_.indexOf(m[0]);P>=0?h=parseInt(m[0],10):o._sounds.length&&(h=o._sounds[0]._id,u=parseFloat(m[0]))}else m.length===2&&(u=parseFloat(m[0]),h=parseInt(m[1],10));if(typeof h>"u")return 0;if(typeof u=="number"&&(o._state!=="loaded"||o._playLock))return o._queue.push({event:"seek",action:function(){o.seek.apply(o,m)}}),o;var p=o._soundById(h);if(p)if(typeof u=="number"&&u>=0){var g=o.playing(h);g&&o.pause(h,!0),p._seek=u,p._ended=!1,o._clearTimer(h),!o._webAudio&&p._node&&!isNaN(p._node.duration)&&(p._node.currentTime=u);var b=function(){g&&o.play(h,!0),o._emit("seek",h)};if(g&&!o._webAudio){var C=function(){o._playLock?setTimeout(C,0):b()};setTimeout(C,0)}else b()}else if(o._webAudio){var x=o.playing(h)?t.ctx.currentTime-p._playStart:0,v=p._rateSeek?p._rateSeek-p._seek:0;return p._seek+(v+x*Math.abs(p._rate))}else return p._node.currentTime;return o},playing:function(o){var m=this;if(typeof o=="number"){var u=m._soundById(o);return u?!u._paused:!1}for(var h=0;h<m._sounds.length;h++)if(!m._sounds[h]._paused)return!0;return!1},duration:function(o){var m=this,u=m._duration,h=m._soundById(o);return h&&(u=m._sprite[h._sprite][1]/1e3),u},state:function(){return this._state},unload:function(){for(var o=this,m=o._sounds,u=0;u<m.length;u++)m[u]._paused||o.stop(m[u]._id),o._webAudio||(o._clearSound(m[u]._node),m[u]._node.removeEventListener("error",m[u]._errorFn,!1),m[u]._node.removeEventListener(t._canPlayEvent,m[u]._loadFn,!1),m[u]._node.removeEventListener("ended",m[u]._endFn,!1),t._releaseHtml5Audio(m[u]._node)),delete m[u]._node,o._clearTimer(m[u]._id);var h=t._howls.indexOf(o);h>=0&&t._howls.splice(h,1);var _=!0;for(u=0;u<t._howls.length;u++)if(t._howls[u]._src===o._src||o._src.indexOf(t._howls[u]._src)>=0){_=!1;break}return n&&_&&delete n[o._src],t.noAudio=!1,o._state="unloaded",o._sounds=[],o=null,null},on:function(o,m,u,h){var _=this,P=_["_on"+o];return typeof m=="function"&&P.push(h?{id:u,fn:m,once:h}:{id:u,fn:m}),_},off:function(o,m,u){var h=this,_=h["_on"+o],P=0;if(typeof m=="number"&&(u=m,m=null),m||u)for(P=0;P<_.length;P++){var p=u===_[P].id;if(m===_[P].fn&&p||!m&&p){_.splice(P,1);break}}else if(o)h["_on"+o]=[];else{var g=Object.keys(h);for(P=0;P<g.length;P++)g[P].indexOf("_on")===0&&Array.isArray(h[g[P]])&&(h[g[P]]=[])}return h},once:function(o,m,u){var h=this;return h.on(o,m,u,1),h},_emit:function(o,m,u){for(var h=this,_=h["_on"+o],P=_.length-1;P>=0;P--)(!_[P].id||_[P].id===m||o==="load")&&(setTimeout(function(p){p.call(this,m,u)}.bind(h,_[P].fn),0),_[P].once&&h.off(o,_[P].fn,_[P].id));return h._loadQueue(o),h},_loadQueue:function(o){var m=this;if(m._queue.length>0){var u=m._queue[0];u.event===o&&(m._queue.shift(),m._loadQueue()),o||u.action()}return m},_ended:function(o){var m=this,u=o._sprite;if(!m._webAudio&&o._node&&!o._node.paused&&!o._node.ended&&o._node.currentTime<o._stop)return setTimeout(m._ended.bind(m,o),100),m;var h=!!(o._loop||m._sprite[u][2]);if(m._emit("end",o._id),!m._webAudio&&h&&m.stop(o._id,!0).play(o._id),m._webAudio&&h){m._emit("play",o._id),o._seek=o._start||0,o._rateSeek=0,o._playStart=t.ctx.currentTime;var _=(o._stop-o._start)*1e3/Math.abs(o._rate);m._endTimers[o._id]=setTimeout(m._ended.bind(m,o),_)}return m._webAudio&&!h&&(o._paused=!0,o._ended=!0,o._seek=o._start||0,o._rateSeek=0,m._clearTimer(o._id),m._cleanBuffer(o._node),t._autoSuspend()),!m._webAudio&&!h&&m.stop(o._id,!0),m},_clearTimer:function(o){var m=this;if(m._endTimers[o]){if(typeof m._endTimers[o]!="function")clearTimeout(m._endTimers[o]);else{var u=m._soundById(o);u&&u._node&&u._node.removeEventListener("ended",m._endTimers[o],!1)}delete m._endTimers[o]}return m},_soundById:function(o){for(var m=this,u=0;u<m._sounds.length;u++)if(o===m._sounds[u]._id)return m._sounds[u];return null},_inactiveSound:function(){var o=this;o._drain();for(var m=0;m<o._sounds.length;m++)if(o._sounds[m]._ended)return o._sounds[m].reset();return new s(o)},_drain:function(){var o=this,m=o._pool,u=0,h=0;if(!(o._sounds.length<m)){for(h=0;h<o._sounds.length;h++)o._sounds[h]._ended&&u++;for(h=o._sounds.length-1;h>=0;h--){if(u<=m)return;o._sounds[h]._ended&&(o._webAudio&&o._sounds[h]._node&&o._sounds[h]._node.disconnect(0),o._sounds.splice(h,1),u--)}}},_getSoundIds:function(o){var m=this;if(typeof o>"u"){for(var u=[],h=0;h<m._sounds.length;h++)u.push(m._sounds[h]._id);return u}else return[o]},_refreshBuffer:function(o){var m=this;return o._node.bufferSource=t.ctx.createBufferSource(),o._node.bufferSource.buffer=n[m._src],o._panner?o._node.bufferSource.connect(o._panner):o._node.bufferSource.connect(o._node),o._node.bufferSource.loop=o._loop,o._loop&&(o._node.bufferSource.loopStart=o._start||0,o._node.bufferSource.loopEnd=o._stop||0),o._node.bufferSource.playbackRate.setValueAtTime(o._rate,t.ctx.currentTime),m},_cleanBuffer:function(o){var m=this,u=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(t._scratchBuffer&&o.bufferSource&&(o.bufferSource.onended=null,o.bufferSource.disconnect(0),u))try{o.bufferSource.buffer=t._scratchBuffer}catch{}return o.bufferSource=null,m},_clearSound:function(o){var m=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);m||(o.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(o){this._parent=o,this.init()};s.prototype={init:function(){var o=this,m=o._parent;return o._muted=m._muted,o._loop=m._loop,o._volume=m._volume,o._rate=m._rate,o._seek=0,o._paused=!0,o._ended=!0,o._sprite="__default",o._id=++t._counter,m._sounds.push(o),o.create(),o},create:function(){var o=this,m=o._parent,u=t._muted||o._muted||o._parent._muted?0:o._volume;return m._webAudio?(o._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),o._node.gain.setValueAtTime(u,t.ctx.currentTime),o._node.paused=!0,o._node.connect(t.masterGain)):t.noAudio||(o._node=t._obtainHtml5Audio(),o._errorFn=o._errorListener.bind(o),o._node.addEventListener("error",o._errorFn,!1),o._loadFn=o._loadListener.bind(o),o._node.addEventListener(t._canPlayEvent,o._loadFn,!1),o._endFn=o._endListener.bind(o),o._node.addEventListener("ended",o._endFn,!1),o._node.src=m._src,o._node.preload=m._preload===!0?"auto":m._preload,o._node.volume=u*t.volume(),o._node.load()),o},reset:function(){var o=this,m=o._parent;return o._muted=m._muted,o._loop=m._loop,o._volume=m._volume,o._rate=m._rate,o._seek=0,o._rateSeek=0,o._paused=!0,o._ended=!0,o._sprite="__default",o._id=++t._counter,o},_errorListener:function(){var o=this;o._parent._emit("loaderror",o._id,o._node.error?o._node.error.code:0),o._node.removeEventListener("error",o._errorFn,!1)},_loadListener:function(){var o=this,m=o._parent;m._duration=Math.ceil(o._node.duration*10)/10,Object.keys(m._sprite).length===0&&(m._sprite={__default:[0,m._duration*1e3]}),m._state!=="loaded"&&(m._state="loaded",m._emit("load"),m._loadQueue()),o._node.removeEventListener(t._canPlayEvent,o._loadFn,!1)},_endListener:function(){var o=this,m=o._parent;m._duration===1/0&&(m._duration=Math.ceil(o._node.duration*10)/10,m._sprite.__default[1]===1/0&&(m._sprite.__default[1]=m._duration*1e3),m._ended(o)),o._node.removeEventListener("ended",o._endFn,!1)}};var n={},a=function(o){var m=o._src;if(n[m]){o._duration=n[m].duration,y(o);return}if(/^data:[^;]+;base64,/.test(m)){for(var u=atob(m.split(",")[1]),h=new Uint8Array(u.length),_=0;_<u.length;++_)h[_]=u.charCodeAt(_);l(h.buffer,o)}else{var P=new XMLHttpRequest;P.open(o._xhr.method,m,!0),P.withCredentials=o._xhr.withCredentials,P.responseType="arraybuffer",o._xhr.headers&&Object.keys(o._xhr.headers).forEach(function(p){P.setRequestHeader(p,o._xhr.headers[p])}),P.onload=function(){var p=(P.status+"")[0];if(p!=="0"&&p!=="2"&&p!=="3"){o._emit("loaderror",null,"Failed loading audio file with status: "+P.status+".");return}l(P.response,o)},P.onerror=function(){o._webAudio&&(o._html5=!0,o._webAudio=!1,o._sounds=[],delete n[m],o.load())},r(P)}},r=function(o){try{o.send()}catch{o.onerror()}},l=function(o,m){var u=function(){m._emit("loaderror",null,"Decoding audio data failed.")},h=function(_){_&&m._sounds.length>0?(n[m._src]=_,y(m,_)):u()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(o).then(h).catch(u):t.ctx.decodeAudioData(o,h,u)},y=function(o,m){m&&!o._duration&&(o._duration=m.duration),Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue())},c=function(){if(!!t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var o=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),m=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),u=m?parseInt(m[1],10):null;if(o&&u&&u<9){var h=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!h&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:t,Howl:i}}),typeof ut<"u"&&(ut.Howler=t,ut.Howl=i),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=t,global.Howl=i,global.Sound=s):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=i,window.Sound=s)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var s=i._howls.length-1;s>=0;s--)i._howls[s].stereo(t);return i},HowlerGlobal.prototype.pos=function(t,i,s){var n=this;if(!n.ctx||!n.ctx.listener)return n;if(i=typeof i!="number"?n._pos[1]:i,s=typeof s!="number"?n._pos[2]:s,typeof t=="number")n._pos=[t,i,s],typeof n.ctx.listener.positionX<"u"?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]);else return n._pos;return n},HowlerGlobal.prototype.orientation=function(t,i,s,n,a,r){var l=this;if(!l.ctx||!l.ctx.listener)return l;var y=l._orientation;if(i=typeof i!="number"?y[1]:i,s=typeof s!="number"?y[2]:s,n=typeof n!="number"?y[3]:n,a=typeof a!="number"?y[4]:a,r=typeof r!="number"?y[5]:r,typeof t=="number")l._orientation=[t,i,s,n,a,r],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(r,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(t,i,s,n,a,r);else return y;return l},Howl.prototype.init=function(t){return function(i){var s=this;return s._orientation=i.orientation||[1,0,0],s._stereo=i.stereo||null,s._pos=i.pos||null,s._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},s._onstereo=i.onstereo?[{fn:i.onstereo}]:[],s._onpos=i.onpos?[{fn:i.onpos}]:[],s._onorientation=i.onorientation?[{fn:i.onorientation}]:[],t.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,i){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"stereo",action:function(){s.stereo(t,i)}}),s;var n=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof t=="number")s._stereo=t,s._pos=[t,0,0];else return s._stereo;for(var a=s._getSoundIds(i),r=0;r<a.length;r++){var l=s._soundById(a[r]);if(l)if(typeof t=="number")l._stereo=t,l._pos=[t,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&e(l,n),n==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(t,0,0):l._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),s._emit("stereo",l._id);else return l._stereo}return s},Howl.prototype.pos=function(t,i,s,n){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(t,i,s,n)}}),a;if(i=typeof i!="number"?0:i,s=typeof s!="number"?-.5:s,typeof n>"u")if(typeof t=="number")a._pos=[t,i,s];else return a._pos;for(var r=a._getSoundIds(n),l=0;l<r.length;l++){var y=a._soundById(r[l]);if(y)if(typeof t=="number")y._pos=[t,i,s],y._node&&((!y._panner||y._panner.pan)&&e(y,"spatial"),typeof y._panner.positionX<"u"?(y._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),y._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),y._panner.positionZ.setValueAtTime(s,Howler.ctx.currentTime)):y._panner.setPosition(t,i,s)),a._emit("pos",y._id);else return y._pos}return a},Howl.prototype.orientation=function(t,i,s,n){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(t,i,s,n)}}),a;if(i=typeof i!="number"?a._orientation[1]:i,s=typeof s!="number"?a._orientation[2]:s,typeof n>"u")if(typeof t=="number")a._orientation=[t,i,s];else return a._orientation;for(var r=a._getSoundIds(n),l=0;l<r.length;l++){var y=a._soundById(r[l]);if(y)if(typeof t=="number")y._orientation=[t,i,s],y._node&&(y._panner||(y._pos||(y._pos=a._pos||[0,0,-.5]),e(y,"spatial")),typeof y._panner.orientationX<"u"?(y._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),y._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),y._panner.orientationZ.setValueAtTime(s,Howler.ctx.currentTime)):y._panner.setOrientation(t,i,s)),a._emit("orientation",y._id);else return y._orientation}return a},Howl.prototype.pannerAttr=function(){var t=this,i=arguments,s,n,a;if(!t._webAudio)return t;if(i.length===0)return t._pannerAttr;if(i.length===1)if(typeof i[0]=="object")s=i[0],typeof n>"u"&&(s.pannerAttr||(s.pannerAttr={coneInnerAngle:s.coneInnerAngle,coneOuterAngle:s.coneOuterAngle,coneOuterGain:s.coneOuterGain,distanceModel:s.distanceModel,maxDistance:s.maxDistance,refDistance:s.refDistance,rolloffFactor:s.rolloffFactor,panningModel:s.panningModel}),t._pannerAttr={coneInnerAngle:typeof s.pannerAttr.coneInnerAngle<"u"?s.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof s.pannerAttr.coneOuterAngle<"u"?s.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof s.pannerAttr.coneOuterGain<"u"?s.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof s.pannerAttr.distanceModel<"u"?s.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof s.pannerAttr.maxDistance<"u"?s.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof s.pannerAttr.refDistance<"u"?s.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof s.pannerAttr.rolloffFactor<"u"?s.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof s.pannerAttr.panningModel<"u"?s.pannerAttr.panningModel:t._panningModel});else return a=t._soundById(parseInt(i[0],10)),a?a._pannerAttr:t._pannerAttr;else i.length===2&&(s=i[0],n=parseInt(i[1],10));for(var r=t._getSoundIds(n),l=0;l<r.length;l++)if(a=t._soundById(r[l]),a){var y=a._pannerAttr;y={coneInnerAngle:typeof s.coneInnerAngle<"u"?s.coneInnerAngle:y.coneInnerAngle,coneOuterAngle:typeof s.coneOuterAngle<"u"?s.coneOuterAngle:y.coneOuterAngle,coneOuterGain:typeof s.coneOuterGain<"u"?s.coneOuterGain:y.coneOuterGain,distanceModel:typeof s.distanceModel<"u"?s.distanceModel:y.distanceModel,maxDistance:typeof s.maxDistance<"u"?s.maxDistance:y.maxDistance,refDistance:typeof s.refDistance<"u"?s.refDistance:y.refDistance,rolloffFactor:typeof s.rolloffFactor<"u"?s.rolloffFactor:y.rolloffFactor,panningModel:typeof s.panningModel<"u"?s.panningModel:y.panningModel};var c=a._panner;c?(c.coneInnerAngle=y.coneInnerAngle,c.coneOuterAngle=y.coneOuterAngle,c.coneOuterGain=y.coneOuterGain,c.distanceModel=y.distanceModel,c.maxDistance=y.maxDistance,c.refDistance=y.refDistance,c.rolloffFactor=y.rolloffFactor,c.panningModel=y.panningModel):(a._pos||(a._pos=t._pos||[0,0,-.5]),e(a,"spatial"))}return t},Sound.prototype.init=function(t){return function(){var i=this,s=i._parent;i._orientation=s._orientation,i._stereo=s._stereo,i._pos=s._pos,i._pannerAttr=s._pannerAttr,t.call(this),i._stereo?s.stereo(i._stereo):i._pos&&s.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var i=this,s=i._parent;return i._orientation=s._orientation,i._stereo=s._stereo,i._pos=s._pos,i._pannerAttr=s._pannerAttr,i._stereo?s.stereo(i._stereo):i._pos?s.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,s._refreshBuffer(i)),t.call(this)}}(Sound.prototype.reset);var e=function(t,i){i=i||"spatial",i==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()});var kl={};var wt,Ge=H(()=>{wt=pt(ct());WL.registerComponent("pp-spatial-audio-listener",{_myEnabled:{type:WL.Type.Enum,values:["always","vr","non vr"],default:"always"}},{init:function(){this._myOrigin=new Float32Array(3),this._myForward=new Float32Array(3),this._myUp=new Float32Array(3)},update:function(){(this._myEnabled==0||this._myEnabled==1&&WL.xrSession||this._myEnabled==2&&!WL.xrSession)&&(this.object.pp_getPosition(this._myOrigin),this.object.pp_getForward(this._myForward),this.object.pp_getUp(this._myUp),wt.Howler.pos(this._myOrigin[0],this._myOrigin[1],this._myOrigin[2]),wt.Howler.orientation(this._myForward[0],this._myForward[1],this._myForward[2],this._myUp[0],this._myUp[1],this._myUp[2]))}})});var Ue=T(()=>{WL.registerComponent("pp-audio-manager",{},{init(){PP.myAudioManager=new PP.AudioManagerClass},start(){},update(e){}});PP.myAudioManager=null});var jl={};var ht,qe=H(()=>{ht=pt(ct());PP.AudioManager=class{constructor(){this._myAudioSetupMap=new Map}createAudioPlayer(t){return this.getAudioSetup(t)!=null?new PP.AudioPlayer(this.getAudioSetup(t)):null}getAudioSetup(t){return this._myAudioSetupMap.get(t)}addAudioSetup(t,i,s=!0){this._myAudioSetupMap.set(t,i),s&&this.createAudioPlayer(t)}removeAudioSetup(t){this._myAudioSetupMap.delete(t)}setVolume(t){ht.Howler.volume(t)}setMute(t){ht.Howler.mute(t)}stop(){ht.Howler.stop()}}});var ze=T(()=>{PP.AudioEvent={END:"end",STOP:"stop",LOAD:"load",LOAD_ERROR:"loaderror",PLAY:"play",PLAY_ERROR:"playerror",PAUSE:"pause",MUTE:"mute",VOLUME:"volume",RATE:"rate",SEEK:"seek",FADE:"fade",UNLOCK:"unlock"};PP.AudioPlayer=class{constructor(t){typeof t=="string"?this._myAudioSetup=new PP.AudioSetup(audioSetupOrAudioFile):this._myAudioSetup=t.clone(),this._myAudio=new Howl({src:[this._myAudioSetup.myAudioFilePath],loop:this._myAudioSetup.myLoop,volume:this._myAudioSetup.myVolume,autoplay:this._myAudioSetup.myAutoplay,rate:this._myAudioSetup.myRate,pool:this._myAudioSetup.myPool,preload:!0}),this._myAudio._pannerAttr.refDistance=this._myAudioSetup.myReferenceDistance,this._myLastAudioID=null,this._myCallbackMap=new Map;for(let i in PP.AudioEvent)this._myCallbackMap.set(PP.AudioEvent[i],new Map);this._addListeners()}play(){let t=this._myAudio.play();t!=null&&(this._myLastAudioID=t,this.updatePosition(this._myAudioSetup.myPosition,!0),this.updatePitch(this._myAudioSetup.myPitch,!0),this.updateVolume(this._myAudioSetup.myVolume,!0))}stop(){this._myAudio.stop()}pause(){this._myAudio.pause()}resume(){this._myAudio.play()}isPlaying(t=!1){let i=!1;return t?i=this._myAudio.playing(this._myLastAudioID):i=this._myAudio.playing(),i}isLoaded(){return this._myAudio.state()=="loaded"}fade(t,i,s,n=!1){this.setVolume(i),n?this._myAudio.fade(t,i,s*1e3,this._myLastAudioID):this._myAudio.fade(t,i,s*1e3)}updatePosition(t,i=!1){this.setPosition(t),this._myAudioSetup.mySpatial&&t&&(i?this._myAudio.pos(t[0],t[1],t[2],this._myLastAudioID):this._myAudio.pos(t[0],t[1],t[2]))}updatePitch(t,i=!1){this.updateRate(t,i)}updateRate(t,i=!1){this.setRate(t),t!=null&&(i?this._myAudio.rate(t,this._myLastAudioID):this._myAudio.rate(t))}updateVolume(t,i=!1){this.setVolume(t),t!=null&&(i?this._myAudio.volume(t,this._myLastAudioID):this._myAudio.volume(t))}setSpatial(t){this._myAudioSetup.mySpatial=t}setPosition(t){this._myAudioSetup.myPosition=t}setPitch(t){this._myAudioSetup.myPitch=t}setRate(t){this._myAudioSetup.myRate=t}setVolume(t){this._myAudioSetup.myVolume=t}getDuration(){return this._myAudio.duration()}getVolume(){return this._myAudioSetup.myVolume}getPitch(){return this._myAudioSetup.myPitch}getRate(){return this._myAudioSetup.myRate}registerAudioEventListener(t,i,s){this._myCallbackMap.get(t).set(i,s)}unregisterAudioEventListener(t,i){this._myCallbackMap.get(t).delete(i)}_addListeners(){for(let t in PP.AudioEvent){let i=PP.AudioEvent[t];this._myAudio.on(i,function(s){let n=this._myCallbackMap.get(i);for(let a of n.values())a(s)}.bind(this))}}}});var Qe=T(()=>{PP.AudioSetup=class{constructor(t=null){this.myAudioFilePath=t?t.slice(0):null,this.myLoop=!1,this.myAutoplay=!1,this.myVolume=1,this._myRate=1,this.myPool=5,this.myPosition=null,this.mySpatial=!0,this.myReferenceDistance=1}clone(){let t=new PP.AudioSetup;return t.myAudioFilePath=this.myAudioFilePath.slice(0),t.myLoop=this.myLoop,t.myAutoplay=this.myAutoplay,t.myVolume=this.myVolume,t.myPitch=this.myPitch,t.myRate=this.myRate,t.myPool=this.myPool,t.myPosition=this.myPosition,t.mySpatial=this.mySpatial,t.myReferenceDistance=this.myReferenceDistance,t}get myPitch(){return this._myRate}get myRate(){return this._myRate}set myPitch(t){this._myRate=t}set myRate(t){this._myRate=t}}});var Fl={};var Xe,Ke=H(()=>{Xe=pt(ct());WL.registerComponent("pp-mute-everything",{},{init:function(){},start:function(){Xe.Howler.mute(!0)},update:function(e){}})});var Hl={};var Je=H(()=>{Z();WL.registerComponent("pp-benchmark-max-physx",{_myStaticDomeSize:{type:WL.Type.Float,default:40},_myStaticPhysXCount:{type:WL.Type.Int,default:1e3},_myDynamicDomeSize:{type:WL.Type.Float,default:80},_myDynamicPhysXCount:{type:WL.Type.Int,default:250},_myKinematicDomeSize:{type:WL.Type.Float,default:120},_myKinematicPhysXCount:{type:WL.Type.Int,default:250},_myRaycastCount:{type:WL.Type.Int,default:100},_myVisualizeRaycast:{type:WL.Type.Bool,default:!1},_myVisualizeRaycastDelay:{type:WL.Type.Float,default:.5},_myUseConvexMesh:{type:WL.Type.Bool,default:!1},_myShapeIndex:{type:WL.Type.Int,default:0},_myShapeScaleMultiplier:{type:WL.Type.Float,default:1},_myEnableLog:{type:WL.Type.Bool,default:!0}},{start:function(){this._myRootObject=WL.scene.addObject(this.object),this._myRaycastSetup=new PP.RaycastSetup,this._myRaycastResult=new PP.RaycastResult,this._myStaticPhysXObjects=[],this._myStaticPhysXComponents=[],this._myStaticPhysXCollectors=[],this._myDynamicPhysXObjects=[],this._myDynamicPhysXComponents=[],this._myDynamicPhysXCollectors=[],this._myKinematicPhysXObjects=[],this._myKinematicPhysXComponents=[],this._myKinematicPhysXCollectors=[],this._spawnDome(!0,!1),this._spawnDome(!1,!1),this._spawnDome(!1,!0),this._myStartTimer=new PP.Timer(1),this._myTimer=new PP.Timer(0),this._myDebugTimer=new PP.Timer(this._myVisualizeRaycastDelay),this._myEnableLogTimer=new PP.Timer(1),this._myFPSHistory=[];for(let e=0;e<7;e++)this._myFPSHistory.push(0);this._myAddVelocityDelay=10,this._myTranslateVec3=PP.vec3_create(),this._myRotateVec3=PP.vec3_create()},update:function(e){if(this._myStartTimer.update(e),this._myStartTimer.isDone()){if(this._myTimer.update(e),this._myDebugTimer.update(e),this._myEnableLogTimer.update(e),this._myTimer.isDone()){this._myTimer.start();let t=!1;this._myDebugTimer.isDone()&&(this._myDebugTimer.start(),t=!0),t=t&&this._myVisualizeRaycast,this._raycastTest(t)}if(this._myFPSHistory.pop(),this._myFPSHistory.unshift(Math.round(1/e)),this._myEnableLog&&this._myEnableLogTimer.isDone()){this._myEnableLogTimer.start(),console.clear(),console.log("Static PhysX Dome Size:",this._myStaticPhysXObjects.length),console.log("Dynamic PhysX Dome Size:",this._myDynamicPhysXObjects.length),console.log("Kinematic PhysX Dome Size:",this._myKinematicPhysXObjects.length);let t=0;for(let r of this._myStaticPhysXCollectors)t+=r.getCollisions().length;let i=0;for(let r of this._myDynamicPhysXCollectors)i+=r.getCollisions().length;let s=0;for(let r of this._myKinematicPhysXCollectors)s+=r.getCollisions().length;let n=(t+i+s)/2;console.log("Current Collisions Count:",n),console.log("Raycast Count:",this._myRaycastCount),console.log("FPS History:");let a="";for(let r of this._myFPSHistory)a=a.concat(r,`
`);console.log(a)}}if(this._myAddVelocityDelay>0&&(this._myAddVelocityDelay--,this._myAddVelocityDelay==0))for(let t of this._myDynamicPhysXComponents){t.kinematic=!1;let i=50;t.linearVelocity=[Math.pp_random(-i,i),Math.pp_random(-i,i),Math.pp_random(-i,i)],t.angularVelocity=[Math.pp_random(-i,i),Math.pp_random(-i,i),Math.pp_random(-i,i)]}for(let t of this._myKinematicPhysXObjects){let i=5*e;this._myTranslateVec3.vec3_set(Math.pp_random(-i,i),Math.pp_random(-i,i),Math.pp_random(-i,i)),t.pp_translate(this._myTranslateVec3),rotateStrength=50*e,this._myRotateVec3.vec3_set(Math.pp_random(-rotateStrength,rotateStrength),Math.pp_random(-rotateStrength,rotateStrength),Math.pp_random(-rotateStrength,rotateStrength)),t.pp_rotate(this._myRotateVec3)}},_raycastTest(e){let t=this._myRaycastCount,i=1e4;for(let s=0;s<t;s++){let n=[Math.pp_random(1,2)*Math.pp_randomSign(),Math.pp_random(1,2)*Math.pp_randomSign(),Math.pp_random(1,2)*Math.pp_randomSign()],a=[Math.pp_random(-1,1),Math.pp_random(-1,1),Math.pp_random(-1,1)];a.vec3_normalize(a),this._myRaycastSetup.myOrigin.vec3_copy(n),this._myRaycastSetup.myDirection.vec3_copy(a),this._myRaycastSetup.myDistance=i,this._myRaycastSetup.myBlockLayerFlags.setMask(255);let r=PP.PhysicsUtils.raycast(this._myRaycastSetup,this._myRaycastResult);e&&PP.myDebugVisualManager.drawRaycast(this._myDebugTimer.getDuration(),r,!0,5,.015)}},_spawnDome(e,t){let i=this._myStaticPhysXCount,s=this._myStaticPhysXObjects,n=Math.ceil(Math.sqrt(this._myStaticPhysXCount));e||(t?(n=Math.ceil(Math.sqrt(this._myDynamicPhysXCount)),i=this._myDynamicPhysXCount,s=this._myDynamicPhysXObjects):(n=Math.ceil(Math.sqrt(this._myKinematicPhysXCount)),i=this._myKinematicPhysXCount,s=this._myKinematicPhysXObjects));let a=Math.PI*2/n,r=Math.max(0,this._myStaticDomeSize-20),l=this._myStaticDomeSize+20;e||(t?(r=Math.max(0,this._myDynamicDomeSize-20),l=this._myDynamicDomeSize+20):(r=Math.max(0,this._myKinematicDomeSize-20),l=this._myKinematicDomeSize+20));let y=0,c=Math.pp_toRadians(10),o=[0,1,0],m=[0,0,-1];for(let u=0;u<n/2;u++){let h=[0,1,0],_=[];d.cross(_,m,h),d.normalize(_,_);for(let P=0;P<n;P++){if(s.length<i){let p=Math.random()*(l-r)+r,g=(Math.random()*2-1)*(c-y)+y,b=(Math.random()*2-1)*(c-y)+y,C=h.slice(0);C.vec3_rotateAxisRadians(g,_,C),C.vec3_rotateAxisRadians(b,o,C),d.scale(C,C,p),this._addPhysX(C,e,t)}if(h.vec3_rotateAxisRadians(a/2,_,h),s.length<i){let p=Math.random()*(l-r)+r,g=(Math.random()*2-1)*(c-y)+y,b=(Math.random()*2-1)*(c-y)+y,C=h.slice(0);C.vec3_rotateAxisRadians(g,_,C),C.vec3_rotateAxisRadians(b,o,C),d.scale(C,C,p),this._addPhysX(C,e,t)}h.vec3_rotateAxisRadians(a/2,_,h)}m.vec3_rotateAxisRadians(a,o,m)}},_addPhysX(e,t,i){let s=e,n=Math.pp_random(1,10),a=Math.pp_randomPick(WL.Shape.Sphere,WL.Shape.Box);this._myUseConvexMesh&&(a=WL.Shape.ConvexMesh,n*=this._myShapeScaleMultiplier);let r=WL.scene.addObject(this._myRootObject);r.pp_setPosition(s);let l=r.pp_addComponent("physx",{shape:a,shapeData:{index:this._myShapeIndex},extents:[n,n,n],static:t,kinematic:!i,mass:1});t?(this._myStaticPhysXObjects.push(r),this._myStaticPhysXComponents.push(l),this._myStaticPhysXCollectors.push(new PP.PhysXCollisionCollector(l))):i?(this._myDynamicPhysXObjects.push(r),this._myDynamicPhysXComponents.push(l),this._myDynamicPhysXCollectors.push(new PP.PhysXCollisionCollector(l))):(this._myKinematicPhysXObjects.push(r),this._myKinematicPhysXComponents.push(l),this._myKinematicPhysXCollectors.push(new PP.PhysXCollisionCollector(l)))}})});var Ye=T(()=>{WL.registerComponent("pp-benchmark-max-visible-triangles",{_myTargetFrameRate:{type:WL.Type.Int,default:-1},_myTargetFrameRateThreshold:{type:WL.Type.Int,default:3},_myStartPlaneCount:{type:WL.Type.Int,default:1},_myPlaneTriangles:{type:WL.Type.Int,default:100},_mySecondsBeforeDoubling:{type:WL.Type.Float,default:.5},_myDTHistoryToIgnorePercentage:{type:WL.Type.Float,default:.25},_myCloneMaterial:{type:WL.Type.Bool,default:!1},_myCloneMesh:{type:WL.Type.Bool,default:!1},_myEnableLog:{type:WL.Type.Bool,default:!0},_myPlaneMaterial:{type:WL.Type.Material},_myBackgroundMaterial:{type:WL.Type.Material},_myTextMaterial:{type:WL.Type.Material,default:null}},{_start(){this._myBackgroundSize=4,this._myBackgroundObject.pp_setActive(!0),this._myBackgroundObject.pp_setScale(this._myBackgroundSize+.1),this._myBackgroundObject.pp_translate([0,0,-.001]),this._myDoubleTimer=new PP.Timer(this._mySecondsBeforeDoubling),this._myIsDone=!1,this._myCurrentPlanes=this._myStartPlaneCount,this._myDTHistory=[],this._myUpperLimit=-1,this._myLowerLimit=0,this._myPlanes=[],this._mySkipNextFrames=0,this._myMaxWaitFrames=0,this._myMaxPlanesReached=!1,this._myFirstTime=!0},_update(e){{if(e<1e-5)return;if(e>.5&&this._myMaxWaitFrames>0){this._myMaxWaitFrames--;return}if(this._myMaxWaitFrames=10,this._mySkipNextFrames>0){this._mySkipNextFrames--;return}}if(!this._myIsDone&&(this._myDoubleTimer.update(e),this._myDTHistory.push(e),this._myDoubleTimer.isDone())){this._myDoubleTimer.start();let t=this._computeAverageFrameRate(!1);if(this._myFirstTime)this._myFirstTime=!1;else{let i=!1;t<this._myStableFrameRate-this._myTargetFrameRateThreshold?(this._myUpperLimit=this._myCurrentPlanes,i=!0,this._myUpperLimit==1&&(this._myLowerLimit=1)):(this._myLowerLimit=this._myCurrentPlanes,this._myUpperLimit>0&&(this._myUpperLimit=Math.max(this._myUpperLimit,this._myLowerLimit))),this._myTriangleTextComponent.text="Triangles: "+this._myCurrentPlanes*this._myRealTrianglesAmount,this._myPlaneTextComponent.text="Planes: "+this._myCurrentPlanes,this._myFPSTextComponent.text="FPS: "+t+" / "+this._myStableFrameRate,i?(this._myTriangleTextComponent.material.color=this._myLagColor,this._myPlaneTextComponent.material.color=this._myLagColor,this._myFPSTextComponent.material.color=this._myLagColor):(this._myTriangleTextComponent.material.color=this._myNormalColor,this._myPlaneTextComponent.material.color=this._myNormalColor,this._myFPSTextComponent.material.color=this._myNormalColor);let s=!1;(this._myUpperLimit>0&&!i&&this._myUpperLimit-this._myLowerLimit<=Math.max(2,1e3/this._myRealTrianglesAmount)||i&&this._myUpperLimit-this._myLowerLimit<=1||!i&&this._myMaxPlanesReached)&&(t<this._myStableFrameRate-this._myTargetFrameRateThreshold?(this._myLowerLimit=Math.max(1,Math.floor(this._myUpperLimit/2.5)),this._myUpperLimit=0,s=!0,this._myEnableLog&&console.log("Rst - Triangles:",this._myCurrentPlanes*this._myRealTrianglesAmount,"- Planes:",this._myCurrentPlanes,"- Frame Rate:",t)):(this._myMaxPlanesReached?this._myEnableLog&&(console.log("Aborted - Max Planes Reached"),this._myDoneTextComponent.text="Aborted - Max Planes Reached"):(this._displayPlanes(this._myLowerLimit),this._myEnableLog&&(console.log(`
End - Triangles:`,this._myLowerLimit*this._myRealTrianglesAmount,"- Planes:",this._myLowerLimit,"- Frame Rate:",t),console.log("Plane Triangles (Adjusted):",this._myRealTrianglesAmount),console.log("Target Frame Rate:",this._myStableFrameRate,"- Threshold: ",this._myStableFrameRate-this._myTargetFrameRateThreshold)),this._myTriangleTextComponent.text="Triangles: "+this._myLowerLimit*this._myRealTrianglesAmount,this._myPlaneTextComponent.text="Planes: "+this._myLowerLimit,this._myFPSTextComponent.text="FPS: "+t+" / "+this._myStableFrameRate,this._myDoneTextComponent.text="End"),this._myIsDone=!0)),i&&!s&&this._myEnableLog&&console.log("Lag - Triangles:",this._myCurrentPlanes*this._myRealTrianglesAmount,"- Planes:",this._myCurrentPlanes,"- Frame Rate:",t),this._myIsDone||(this._myUpperLimit>0?(this._myCurrentPlanes=Math.floor((this._myUpperLimit+this._myLowerLimit)/2),this._myCurrentPlanes=Math.max(this._myCurrentPlanes,1)):s?this._myCurrentPlanes=this._myLowerLimit:this._myCurrentPlanes=this._myLowerLimit*2,this._myCurrentPlanes>5e4?(this._myCurrentPlanes=5e4,this._myMaxPlanesReached=!0):this._myMaxPlanesReached=!1)}this._myIsDone||(this._displayPlanes(this._myCurrentPlanes),this._myElapsedTime=0,this._myFrameCount=0,this._mySkipNextFrames=30)}},_displayPlanes(e){for(;this._myPlanes.length>e;){let r=this._myPlanes.pop();this._myPlanePool.release(r)}for(;this._myPlanes.length<e;){let r=this._myPlanePool.get();this._myPlanes.push(r)}let t=1;for(;t*t<e;)t++;let i=.01,s=i*(t-1),n=(this._myBackgroundSize*2-s)/(t*2),a=e;for(let r=0;r<t&&a>0;r++)for(let l=0;l<t&&a>0;l++){let y=this._myPlanes[a-1];y.pp_setScale(n);let c=[-this._myBackgroundSize+n+l*n*2+l*i,this._myBackgroundSize-n-r*n*2-r*i,0];y.pp_setPositionLocal(c),y.pp_setActive(!0),a--}},start(){this._myLagColor=[.5,0,0,1],this._myNormalColor=[0,0,0,1],this._myRealTrianglesAmount=0,this._myTrianglesObject=WL.scene.addObject(this.object),this._myBackgroundObject=WL.scene.addObject(this._myTrianglesObject);{let t=this._myBackgroundObject.addComponent("mesh");t.mesh=PP.MeshUtils.createPlaneMesh(),t.material=this._myBackgroundMaterial.clone()}this._myPlaneObject=WL.scene.addObject(this._myTrianglesObject);{let t=this._myPlaneObject.addComponent("mesh");t.mesh=this._createPlaneMesh(this._myPlaneTriangles),this._myRealTrianglesAmount=t.mesh.indexData.length/3,t.material=this._myPlaneMaterial.clone()}let e=new PP.ObjectPoolParams;this._myCloneMesh?this._myRealTrianglesAmount<=4?e.myInitialPoolSize=15e3:this._myRealTrianglesAmount<=8?e.myInitialPoolSize=1e4:this._myRealTrianglesAmount<=64?e.myInitialPoolSize=7500:e.myInitialPoolSize=5e3:e.myInitialPoolSize=3e4,e.myPercentageToAddWhenEmpty=0,e.myAmountToAddWhenEmpty=1e4,e.myCloneParams=new PP.CloneParams,e.myCloneParams.myDeepCloneParams.setDeepCloneComponentVariable("mesh","material",this._myCloneMaterial),e.myCloneParams.myDeepCloneParams.setDeepCloneComponentVariable("mesh","mesh",this._myCloneMesh),this._myPlanePool=new PP.ObjectPool(this._myPlaneObject,e),this._myBackgroundObject.pp_setActive(!1),this._myPlaneObject.pp_setActive(!1),this._myStartTimer=new PP.Timer(this._mySecondsBeforeDoubling*2),this._mySessionStarted=!1,this._myTextsObject=WL.scene.addObject(this._myTrianglesObject),this._myTriangleTextObject=WL.scene.addObject(this._myTextsObject),this._myTriangleTextComponent=this._myTriangleTextObject.addComponent("text"),this._myTriangleTextComponent.alignment=WL.Alignment.Left,this._myTriangleTextComponent.justification=WL.Justification.Line,this._myTriangleTextComponent.material=this._myTextMaterial.clone(),this._myTriangleTextComponent.material.color=this._myNormalColor,this._myTriangleTextComponent.text=" ",this._myPlaneTextObject=WL.scene.addObject(this._myTextsObject),this._myPlaneTextComponent=this._myPlaneTextObject.addComponent("text"),this._myPlaneTextComponent.alignment=WL.Alignment.Left,this._myPlaneTextComponent.justification=WL.Justification.Line,this._myPlaneTextComponent.material=this._myTextMaterial.clone(),this._myPlaneTextComponent.material.color=this._myNormalColor,this._myPlaneTextComponent.text=" ",this._myFPSTextObject=WL.scene.addObject(this._myTextsObject),this._myFPSTextComponent=this._myFPSTextObject.addComponent("text"),this._myFPSTextComponent.alignment=WL.Alignment.Left,this._myFPSTextComponent.justification=WL.Justification.Line,this._myFPSTextComponent.material=this._myTextMaterial.clone(),this._myFPSTextComponent.material.color=this._myNormalColor,this._myFPSTextComponent.text=" ",this._myDoneTextObject=WL.scene.addObject(this._myTrianglesObject),this._myDoneTextComponent=this._myDoneTextObject.addComponent("text"),this._myDoneTextComponent.alignment=WL.Alignment.Center,this._myDoneTextComponent.justification=WL.Justification.Line,this._myDoneTextComponent.material=this._myTextMaterial.clone(),this._myDoneTextComponent.material.color=this._myNormalColor,this._myDoneTextComponent.text=" ",this._myTextsObject.pp_setPositionLocal([0,4.3,0]),this._myTextsObject.pp_setScale(2.75),this._myTriangleTextObject.pp_setPositionLocal([-1.4,0,0]),this._myPlaneTextObject.pp_setPositionLocal([.55,0,0]),this._myFPSTextObject.pp_setPositionLocal([-.315,0,0]),this._myDoneTextObject.pp_setPositionLocal([0,-4.6,0]),this._myDoneTextObject.pp_setScale(4),this._myDTHistory=[]},update(e){this._mySessionStarted?this._myStartTimer.isRunning()?(this._myStartTimer.update(e),this._myDTHistory.push(e),this._myStartTimer.isDone()&&(this._myStableFrameRate=this._computeAverageFrameRate(!0),this._myTargetFrameRate>0&&(this._myStableFrameRate=this._myTargetFrameRate),this._myEnableLog&&(console.log(`
Plane Triangles (Adjusted):`,this._myRealTrianglesAmount),console.log("Target Frame Rate:",this._myStableFrameRate,"- Threshold: ",this._myStableFrameRate-this._myTargetFrameRateThreshold),console.log("")),this._start())):this._update(e):this._mySessionStarted=WL.xrSession!=null},_computeAverageFrameRate(e){let t=0;this._myDTHistory.sort();let i=Math.floor(this._myDTHistory.length)*Math.min(.9,this._myDTHistoryToIgnorePercentage*(e?2:1));for(let n=0;n<i;n++)this._myDTHistory.pop();let s=0;for(let n of this._myDTHistory)s+=n;return s/=this._myDTHistory.length,t=Math.round(1/s),this._myDTHistory=[],t},_createPlaneMesh(e){let t=Math.ceil(e/2),i=1,s=1,n=1;for(;n*n<t;)n++;for(i=n,s=n;i>1&&s>1&&i*s>t&&(i-1)*s>=t;)i--;let a=new PP.MeshCreationParams;for(let l=0;l<i+1;l++)for(let y=0;y<s+1;y++){let c=2/s*y,o=2/i*l,m=new PP.MeshCreationVertexParams;m.myPosition=new PP.vec3_create,m.myPosition[0]=c-1,m.myPosition[1]=o-1,m.myPosition[2]=0,m.myTextureCoordinates=new PP.vec2_create,m.myTextureCoordinates[0]=c/2,m.myTextureCoordinates[1]=o/2,m.myNormal=new PP.vec3_create,m.myNormal[0]=0,m.myNormal[1]=0,m.myNormal[2]=1,a.myVertexes.push(m)}for(let l=0;l<i;l++)for(let y=0;y<s;y++){let c=new PP.MeshCreationTriangleParams;c.myIndexes[0]=l*(s+1)+y,c.myIndexes[1]=l*(s+1)+y+1,c.myIndexes[2]=(l+1)*(s+1)+y;let o=new PP.MeshCreationTriangleParams;o.myIndexes[0]=(l+1)*(s+1)+y,o.myIndexes[1]=l*(s+1)+y+1,o.myIndexes[2]=(l+1)*(s+1)+y+1,a.myTriangles.push(c),a.myTriangles.push(o)}return PP.MeshUtils.createMesh(a)}})});var Ze=T(()=>{Number.prototype.get=function(){return this.valueOf()};Object.defineProperty(Number.prototype,"get",{enumerable:!1});PP.NumberOverValue=class{constructor(t,i=null,s=0,n=0,a=PP.EasingFunction.linear,r=null){i==null&&(i=t),this._myStartNumber=t,this._myEndNumber=i,this._myStartInterpolationValue=s,this._myEndInterpolationValue=n,this._myEasingFunction=a,this._myRoundingFunction=r}get(t){let i=this._myEasingFunction(Math.pp_mapToRange(t,this._myStartInterpolationValue,this._myEndInterpolationValue,0,1)),s=Math.pp_lerp(this._myStartNumber,this._myEndNumber,i);return this._myRoundingFunction&&(s=this._myRoundingFunction(s,this._myStartNumber,this._myEndNumber)),s}getAverage(t){return this.get(t)}getRange(t){let i=this.get(t);return[i,i]}getMax(t){return this.get(t)}getMin(t){return this.get(t)}isInside(t,i){return this.get(i)==t}isInsideAngleRange(t,i){return this.isInsideAngleRangeDegrees(t,i)}isInsideAngleRangeDegrees(t,i){let s=this.get(i),n=Math.pp_angleClampDegrees(t),a=Math.pp_angleClampDegrees(s);return n==a}isInsideAngleRangeRadians(t,i){let s=this.get(i),n=Math.pp_angleClampRadians(t),a=Math.pp_angleClampRadians(s);return n==a}};PP.IntOverValue=class extends PP.NumberOverValue{constructor(t,i,s,n,a=PP.EasingFunction.linear,r=null){r==null&&(r=function(l,y,c){let o=null;return y<=c?o=Math.floor(l):o=Math.ceil(l),o}),super(t,i,s,n,a,r)}};PP.NumberRangeOverValue=class{constructor(t,i=null,s=0,n=0,a=PP.EasingFunction.linear,r=null){i==null&&(i=t),this._myStartNumberOverValue=new PP.NumberOverValue(t[0],i[0],s,n,a,r),this._myEndNumberOverValue=new PP.NumberOverValue(t[1],i[1],s,n,a,r),this._myRoundingFunction=r}get(t){let i=this._myStartNumberOverValue.get(t),s=this._myEndNumberOverValue.get(t),n=null;return this._myRoundingFunction?n=Math.pp_randomInt(i,s):n=Math.pp_random(i,s),n}getAverage(t){let i=this._myStartNumberOverValue.get(t),s=this._myEndNumberOverValue.get(t),n=(i+s)/2;return this._myRoundingFunction&&(n=this._myRoundingFunction(n,i,s)),n}getRange(t){let i=this._myStartNumberOverValue.get(t),s=this._myEndNumberOverValue.get(t);return[i,s]}getMax(t){let i=this._myStartNumberOverValue.get(t),s=this._myEndNumberOverValue.get(t);return Math.max(i,s)}getMin(t){let i=this._myStartNumberOverValue.get(t),s=this._myEndNumberOverValue.get(t);return Math.min(i,s)}isInside(t,i){let s=this._myStartNumberOverValue.get(i),n=this._myEndNumberOverValue.get(i),a=Math.min(s,n),r=Math.max(s,n);return t>=a&&t<=r}isInsideAngleRange(t,i){return this.isInsideAngleRangeDegrees(t,i)}isInsideAngleRangeDegrees(t,i){let s=this._myStartNumberOverValue.get(i),n=this._myEndNumberOverValue.get(i);return Math.pp_isInsideAngleRangeDegrees(t,s,n)}isInsideAngleRangeRadians(t,i){let s=this._myStartNumberOverValue.get(i),n=this._myEndNumberOverValue.get(i);return Math.pp_isInsideAngleRangeRadians(t,s,n)}};PP.IntRangeOverValue=class extends PP.NumberRangeOverValue{constructor(t,i,s,n,a=PP.EasingFunction.linear,r=null){r==null&&(r=function(l,y,c){let o=null;return y<=c?o=Math.floor(l):o=Math.ceil(l),o}),super(t,i,s,n,a,r)}}});var $e=T(()=>{PP.ObjectPoolManager=class{constructor(){this._myPoolMap=new Map}addPool(t,i,s=new PP.ObjectPoolParams){if(this._myPoolMap.has(t))console.error("Pool already created with this ID");else{let n=new PP.ObjectPool(i,s);this._myPoolMap.set(t,n)}}increasePool(t,i){let s=this._myPoolMap.get(t);s&&s.increase(i)}increasePoolPercentage(t,i){let s=this._myPoolMap.get(t);s&&s.increasePercentage(i)}getPool(t){return this._myPoolMap.get(t)}hasPool(t){return this._myPoolMap.has(t)}getObject(t){return this._myPoolMap.has(t)?this._myPoolMap.get(t).get():null}releaseObject(t,i){this._myPoolMap.get(t).release(i)}};PP.ObjectPoolParams=class{constructor(){this.myInitialPoolSize=0,this.myAmountToAddWhenEmpty=0,this.myPercentageToAddWhenEmpty=0,this.myCloneParams=void 0,this.myOptimizeObjectsAllocation=!0,this.myCloneCallback=void 0,this.mySetActiveCallback=void 0,this.myEqualCallback=void 0,this.myOptimizeObjectsAllocationCallback=void 0,this.myEnableDebugLog=!0}};PP.ObjectPool=class{constructor(t,i){this._myObjectPoolParams=i,this._myPrototype=this._clone(t),this._myAvailableObjects=[],this._myBusyObjects=[],this._addToPool(i.myInitialPoolSize,!1)}get(){let t=this._myAvailableObjects.shift();if(t==null){let i=Math.ceil(this._myBusyObjects.length*this._myObjectPoolParams.myPercentageToAddWhenEmpty);i+=this._myObjectPoolParams.myAmountToAddWhenEmpty,this._addToPool(i,this._myObjectPoolParams.myEnableDebugLog),t=this._myAvailableObjects.shift()}return t!=null&&this._myBusyObjects.push(t),t}release(t){let i=this._myBusyObjects.pp_remove(this._equals.bind(this,t));i&&(this._setActive(i,!1),this._myAvailableObjects.push(i))}increase(t){this._addToPool(t,!1)}increasePercentage(t){let i=Math.ceil(this.getSize()*t);this._addToPool(i,!1)}getSize(){return this._myBusyObjects.length+this._myAvailableObjects.length}getAvailableSize(){return this._myAvailableObjects.length}getBusySize(){return this._myAvailableObjects.length}_addToPool(t,i){if(!(t<=0)){this._myObjectPoolParams.myOptimizeObjectsAllocation&&(this._myObjectPoolParams.myOptimizeObjectsAllocationCallback?this._myObjectPoolParams.myOptimizeObjectsAllocationCallback(this._myPrototype,t):this._myPrototype.pp_reserveObjectsHierarchy!=null&&this._myPrototype.pp_reserveObjectsHierarchy(t));for(let s=0;s<t;s++)this._myAvailableObjects.push(this._clone(this._myPrototype));i&&console.warn("Added new elements to the pool:",t)}}_clone(t){let i=null;return this._myObjectPoolParams.myCloneCallback!=null?i=this._myObjectPoolParams.myCloneCallback(t,this._myObjectPoolParams.myCloneParams):t.pp_clone!=null?i=t.pp_clone(this._myObjectPoolParams.myCloneParams):t.clone!=null&&(i=t.clone(this._myObjectPoolParams.myCloneParams)),i==null?console.error("Object not cloneable, pool will return null"):this._setActive(i,!1),i}_setActive(t,i){this._myObjectPoolParams.mySetActiveCallback!=null?this._myObjectPoolParams.mySetActiveCallback(t,i):t.pp_setActive!=null?t.pp_setActive(i):t.setActive!=null&&t.setActive(i)}_equals(t,i){let s=!1;return this._myObjectPoolParams.myEqualCallback!=null?s=this._myObjectPoolParams.myEqualCallback(t,i):t.pp_equals!=null?s=t.pp_equals(i):t.equals!=null?s=t.equals(i):s=t==i,s}}});var ti=T(()=>{PP.PhysXCollisionCollector=class{constructor(t,i=!1){this._myPhysX=t,this._myIsTrigger=i,this._myCollisions=[],this._myCollisionsStart=[],this._myCollisionsEnd=[],this._myUpdateActive=!1,this._myCollisionsStartToProcess=[],this._myCollisionsEndToProcess=[],this._myCollisionCallbackID=null,this._myIsActive=!1,this.setActive(!0),this._myDebugActive=!1,this._myTriggerDesyncFixDelay=new PP.Timer(.1),this._myCollisionCallbacks=new Map,this._myCollisionStartCallbacks=new Map,this._myCollisionEndCallbacks=new Map}getPhysX(){return this._myPhysX}getCollisions(){return this._myCollisions}getCollisionsStart(){return this._myCollisionsStart}getCollisionsEnd(){return this._myCollisionsEnd}setActive(t){this._myIsActive!=t&&(this._myIsActive=t,this._myCollisions=[],this._myCollisionsStart=[],this._myCollisionsEnd=[],this._myUpdateActive=!1,this._myCollisionsStartToProcess=[],this._myCollisionsEndToProcess=[],this._myIsActive?this._myCollisionCallbackID=this._myPhysX.onCollision(this._onCollision.bind(this)):this._myCollisionCallbackID!=null&&(this._myPhysX.removeCollisionCallback(this._myCollisionCallbackID),this._myCollisionCallbackID=null))}setUpdateActive(t){this._myUpdateActive=t}update(t){!this._myIsActive||(this._myUpdateActive=!0,this._myCollisionsStart=this._myCollisionsStartToProcess,this._myCollisionsStartToProcess=[],this._myCollisionsEnd=this._myCollisionsEndToProcess,this._myCollisionsEndToProcess=[],this._myIsTrigger&&this._triggerDesyncFix(t))}destroy(){this._myCollisionCallbackID!=null&&(this._myPhysX.removeCollisionCallback(this._myCollisionCallbackID),this._myCollisionCallbackID=null)}setDebugActive(t){this._myDebugActive=t}registerCollisionEventListener(t,i){this._myCollisionCallbacks.set(t,i)}unregisterCollisionEventListener(t){this._myCollisionCallbacks.delete(t)}registerCollisionStartEventListener(t,i){this._myCollisionStartCallbacks.set(t,i)}unregisterCollisionStartEventListener(t){this._myCollisionStartCallbacks.delete(t)}registerCollisionEndEventListener(t,i){this._myCollisionEndCallbacks.set(t,i)}unregisterCollisionEndEventListener(t){this._myCollisionEndCallbacks.delete(t)}_onCollision(t,i){t==WL.CollisionEventType.Touch||t==WL.CollisionEventType.TriggerTouch?this._onCollisionStart(i):(t==WL.CollisionEventType.TouchLost||t==WL.CollisionEventType.TriggerTouchLost)&&this._onCollisionEnd(i),this._myCollisionCallbacks.size>0&&this._myCollisionCallbacks.forEach(function(s){s(this._myPhysX,i,t)})}_onCollisionStart(t){if(this._myDebugActive){let i=!1;for(let s of this._myCollisions)if(s.pp_equals(t.object)){i=!0;break}i&&console.error("Collision Start on object already collected")}this._myCollisions.push(t.object),this._myUpdateActive&&(this._myCollisionsStartToProcess.push(t.object),this._myCollisionsEndToProcess.pp_removeAll(function(i){return i.pp_equals(t.object)})),this._myDebugActive&&console.log("Collision Start -",this._myCollisions.length),this._myCollisionStartCallbacks.size>0&&this._myCollisionStartCallbacks.forEach(function(i){i(this._myPhysX,t,type)})}_onCollisionEnd(t){if(this._myDebugActive){let i=!1;for(let s of this._myCollisions)if(s.pp_equals(t.object)){i=!0;break}i||console.error("Collision End on object not collected")}this._myCollisions.pp_removeAll(function(i){return i.pp_equals(t.object)}),this._myUpdateActive&&(this._myCollisionsEndToProcess.push(t.object),this._myCollisionsStartToProcess.pp_removeAll(function(i){return i.pp_equals(t.object)})),this._myDebugActive&&console.log("Collision End -",this._myCollisions.length),this._myCollisionEndCallbacks.size>0&&this._myCollisionEndCallbacks.forEach(function(i){i(this._myPhysX,t,type)})}_triggerDesyncFix(t){if(this._myTriggerDesyncFixDelay.update(t),this._myTriggerDesyncFixDelay.isDone()){this._myTriggerDesyncFixDelay.start();let i=this._myCollisions.pp_findAll(function(s){let n=s.pp_getComponent("physx");return n==null||!n.active});if(i.length>0)for(let s of i){let n=s.pp_getComponent("physx");n?this._onCollisionEnd(n):console.error("NO PHYSX, HOW?")}}}}});var ei=T(()=>{PP.SaveManager=class{constructor(){this._mySaveCache=new Map,this._myCommitSavesDelayTimer=new PP.Timer(0,!1),this._myDelaySavesCommit=!0,this._myIDsToCommit=[],this._myCacheDefaultValueOnFail=!0,WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this)),this._myClearCallbacks=new Map,this._myDeleteCallbacks=new Map,this._myDeleteIDCallbacks=new Map,this._mySaveCallbacks=new Map,this._mySaveValueChangedCallbacks=new Map,this._mySaveIDCallbacks=new Map,this._mySaveValueChangedIDCallbacks=new Map,this._myCommitSaveCallbacks=new Map,this._myCommitSaveIDCallbacks=new Map,this._myCommitSavesCallbacks=new Map,this._myLoadCallbacks=new Map,this._myLoadIDCallbacks=new Map}setCommitSavesDelay(t){this._myCommitSavesDelayTimer.start(t)}setDelaySavesCommit(t){this._myDelaySavesCommit=t}setCacheDefaultValueOnFail(t){this._myCacheDefaultValueOnFail=t}update(t){this._myCommitSavesDelayTimer.isRunning()&&(this._myCommitSavesDelayTimer.update(t),this._myCommitSavesDelayTimer.isDone()&&this.commitSaves())}save(t,i,s=null){let n=!1;if(this._mySaveCache.has(t)&&(n=this._mySaveCache.get(t)===i),!n)if(this._mySaveCache.set(t,i),this._myDelaySavesCommit&&s==null||s!=null&&s)this._myIDsToCommit.pp_pushUnique(t),this._myCommitSavesDelayTimer.isRunning()||this._myCommitSavesDelayTimer.start();else{let a=this._commitSave(t,!1);if(this._myCommitSavesCallbacks.size>0){let r=!1;this._myCommitSavesCallbacks.forEach(function(l){l(r,a)})}}if(this._mySaveCallbacks.size>0&&this._mySaveCallbacks.forEach(function(a){a(t,i)}),this._mySaveIDCallbacks.size>0){let a=this._mySaveIDCallbacks.get(t);a?.forEach(function(r){r(t,i)})}if(!n&&(this._mySaveValueChangedCallbacks.size>0&&this._mySaveValueChangedCallbacks.forEach(function(a){a(t,i)}),this._mySaveValueChangedIDCallbacks.size>0)){let a=this._mySaveValueChangedIDCallbacks.get(t);a?.forEach(function(r){r(t,i)})}}commitSaves(){if(this._myIDsToCommit.length>0){let t=!1;for(let i of this._myIDsToCommit)if(this._mySaveCache.has(i)){let s=this._commitSave(i,!0);t=t||s}if(this._myIDsToCommit=[],this._myCommitSavesCallbacks.size>0){let i=!0;this._myCommitSavesCallbacks.forEach(function(s){s(i,t)})}}}has(t){return this._mySaveCache.has(t)||PP.SaveUtils.has(t)}delete(t){if(this._mySaveCache.delete(t),PP.SaveUtils.delete(t),this._myDeleteCallbacks.size>0&&this._myDeleteCallbacks.forEach(function(i){i(t)}),this._myDeleteIDCallbacks.size>0){let i=this._myDeleteIDCallbacks.get(t);i?.forEach(function(s){s(t)})}}clear(){this._mySaveCache.clear(),PP.SaveUtils.clear(),this._myClearCallbacks.size>0&&this._myClearCallbacks.forEach(function(t){t()})}load(t,i=null){return this._load(t,i,"load")}loadString(t,i=null){return this._load(t,i,"loadString")}loadNumber(t,i=null){return this._load(t,i,"loadNumber")}loadBool(t,i=null){return this._load(t,i,"loadBool")}getCommitSavesDelay(){return this._myCommitSavesDelayTimer.getDuration()}isDelaySavesCommit(){return this._myDelaySavesCommit}isCacheDefaultValueOnFail(){return this._myCacheDefaultValueOnFail}_commitSave(t,i){let s=this._mySaveCache.get(t),n=!1;try{PP.SaveUtils.save(t,s)}catch{n=!0}if(this._myCommitSaveCallbacks.size>0&&this._myCommitSaveCallbacks.forEach(function(a){a(t,s,i,n)}),this._myCommitSaveIDCallbacks.size>0){let a=this._myCommitSaveIDCallbacks.get(t);a?.forEach(function(r){r(t,s,i,n)})}return n}_load(t,i,s){let n=null,a=!1,r=!1;if(this._mySaveCache.has(t))n=this._mySaveCache.get(t),n==null&&i!=null&&(n=i,this._myCacheDefaultValueOnFail&&this._mySaveCache.set(t,n)),r=!0;else{let l=null;try{l=PP.SaveUtils[s](t,null)}catch{l=null,a=!0}l==null?n=i:n=l,l!=null||this._myCacheDefaultValueOnFail?this._mySaveCache.set(t,n):this._mySaveCache.set(t,null)}if(this._myLoadCallbacks.size>0&&this._myLoadCallbacks.forEach(function(l){l(t,n,r,a)}),this._myLoadIDCallbacks.size>0){let l=this._myLoadIDCallbacks.get(t);l?.forEach(function(y){y(t,n,r,a)})}return n}_onXRSessionStart(t){t.addEventListener("visibilitychange",function(i){i.session.visibilityState!="visible"&&this._onXRSessionInterrupt()}.bind(this))}_onXRSessionEnd(){this._onXRSessionInterrupt()}_onXRSessionInterrupt(){this.commitSaves()}registerClearEventListener(t,i){this._myClearCallbacks.set(t,i)}unregisterClearEventListener(t){this._myClearCallbacks.delete(t)}registerDeleteEventListener(t,i){this._myDeleteCallbacks.set(t,i)}unregisterDeleteEventListener(t){this._myDeleteCallbacks.delete(t)}registerDeleteIDEventListener(t,i,s){let n=this._myDeleteIDCallbacks.get(t);n==null&&(this._myDeleteIDCallbacks.set(t,new Map),n=this._myDeleteIDCallbacks.get(t)),n.set(i,s)}unregisterDeleteIDEventListener(t,i){let s=this._myDeleteIDCallbacks.get(t);s!=null&&(s.delete(i),s.size<=0&&this._myDeleteIDCallbacks.delete(t))}registerSaveEventListener(t,i){this._mySaveCallbacks.set(t,i)}unregisterSaveEventListener(t){this._mySaveCallbacks.delete(t)}registerSaveIDEventListener(t,i,s){let n=this._mySaveIDCallbacks.get(t);n==null&&(this._mySaveIDCallbacks.set(t,new Map),n=this._mySaveIDCallbacks.get(t)),n.set(i,s)}unregisterSaveIDEventListener(t,i){let s=this._mySaveIDCallbacks.get(t);s!=null&&(s.delete(i),s.size<=0&&this._mySaveIDCallbacks.delete(t))}registerSaveValueChangedEventListener(t,i){this._mySaveValueChangedCallbacks.set(t,i)}unregisterSaveValueChangedEventListener(t){this._mySaveValueChangedCallbacks.delete(t)}registerSaveValueChangedIDEventListener(t,i,s){let n=this._mySaveValueChangedIDCallbacks.get(t);n==null&&(this._mySaveValueChangedIDCallbacks.set(t,new Map),n=this._mySaveValueChangedIDCallbacks.get(t)),n.set(i,s)}unregisterSaveValueChangedIDEventListener(t,i){let s=this._mySaveValueChangedIDCallbacks.get(t);s!=null&&(s.delete(i),s.size<=0&&this._mySaveValueChangedIDCallbacks.delete(t))}registerCommitSavesEventListener(t,i){this._myCommitSavesCallbacks.set(t,i)}unregisterCommitSavesEventListener(t){this._myCommitSavesCallbacks.delete(t)}registerCommitSaveEventListener(t,i){this._myCommitSaveCallbacks.set(t,i)}unregisterCommitSaveEventListener(t){this._myCommitSaveCallbacks.delete(t)}registerCommitSaveIDEventListener(t,i,s){let n=this._myCommitSaveIDCallbacks.get(t);n==null&&(this._myCommitSaveIDCallbacks.set(t,new Map),n=this._myCommitSaveIDCallbacks.get(t)),n.set(i,s)}unregisterCommitSaveIDEventListener(t,i){let s=this._myCommitSaveIDCallbacks.get(t);s!=null&&(s.delete(i),s.size<=0&&this._myCommitSaveIDCallbacks.delete(t))}registerLoadEventListener(t,i){this._myLoadCallbacks.set(t,i)}unregisterLoadEventListener(t){this._myLoadCallbacks.delete(t)}registerLoadIDEventListener(t,i,s){let n=this._myLoadIDCallbacks.get(t);n==null&&(this._myLoadIDCallbacks.set(t,new Map),n=this._myLoadIDCallbacks.get(t)),n.set(i,s)}unregisterLoadIDEventListener(t,i){let s=this._myLoadIDCallbacks.get(t);s!=null&&(s.delete(i),s.size<=0&&this._myLoadIDCallbacks.delete(t))}}});var ii=T(()=>{PP.Timer=class{constructor(t,i=!0){this._myDuration=t,this._myOnEndCallbacks=new Map,this._myDone=!1,this._myJustDone=!1,this._myStarted=!1,i?this.start():this.reset()}start(t=null){this.reset(t),this._myStarted=!0}end(){this._done()}reset(t=null){t!=null&&(this._myDuration=Math.max(0,t)),this._myTimeLeft=this._myDuration,this._myDone=!1,this._myJustDone=!1,this._myStarted=!1}update(t){this._myJustDone=!1,this.isRunning()&&(this._myTimeLeft=Math.max(0,this._myTimeLeft-t),this._myTimeLeft==0&&this._done())}isDone(){return this._myDone}isJustDone(){return this._myJustDone}isStarted(){return this._myStarted}isRunning(){return this.isStarted()&&!this.isDone()}getDuration(){return this._myDuration}setDuration(t){this._myDuration=Math.max(0,t)}getTimeLeft(){return this._myTimeLeft}getPercentage(){let t=1;return this._myTimeLeft>0&&(t=(this._myDuration-this._myTimeLeft)/this._myDuration),Math.pp_clamp(t,0,1)}onEnd(t,i=null){this._myOnEndCallbacks.set(i,t)}unregisterOnEnd(t=null){this._myOnEndCallbacks.delete(t)}_done(){if(this._myTimeLeft=0,this._myDone=!0,this._myJustDone=!0,this._myOnEndCallbacks.size>0)for(let t of this._myOnEndCallbacks.values())t()}}});var si=T(()=>{WL.registerComponent("pp-clear-console-on-xr-session-start",{},{init:function(){},start:function(){this._myFirstTime=!0,WL.onXRSessionStart.push(function(){this._myFirstTime&&(this._myFirstTime=!1,console.clear())}.bind(this))},update:function(e){}})});var ni=T(()=>{WL.registerComponent("pp-set-active",{_myActive:{type:WL.Type.Bool,default:!0},_mySetActiveOn:{type:WL.Type.Enum,values:["self","children","descendants","hierarchy"],default:"hierarchy"},_mySetActiveWhen:{type:WL.Type.Enum,values:["init","start","first_update"],default:"init"}},{init:function(){this.active&&this._mySetActiveWhen==0&&this._setActive()},start:function(){this._mySetActiveWhen==1&&this._setActive(),this._myFirst=!0},update:function(e){this._mySetActiveWhen==2&&this._myFirst&&(this._myFirst=!1,this._setActive())},_setActive(){this._mySetActiveOn==0?this.object.pp_setActiveSelf(this._myActive):this._mySetActiveOn==1?this.object.pp_setActiveChildren(this._myActive):this._mySetActiveOn==2?this.object.pp_setActiveDescendants(this._myActive):this.object.pp_setActiveHierarchy(this._myActive)}})});var ai=T(()=>{WL.registerComponent("pp-adjust-hierarchy-physx-scale",{_myWhen:{type:WL.Type.Enum,values:["init","start","first_update"],default:"start"}},{init:function(){this.active&&this._myWhen==0&&this._adjustScale()},start:function(){this._myWhen==1&&this._adjustScale(),this._myFirst=!0},update:function(e){this._myWhen==2&&this._myFirst&&(this._myFirst=!1,this._adjustScale())},_adjustScale(){let e=this.object.pp_getScale(),t=this.object.pp_getComponentsHierarchy("physx");for(let i of t)i.extents[0]=i.extents[0]*e[0],i.extents[1]=i.extents[1]*e[1],i.extents[2]=i.extents[2]*e[2],i.active&&(i.active=!1,i.active=!0)}})});var oi=T(()=>{WL.registerComponent("pp-get-player-objects",{_myPlayer:{type:WL.Type.Object},_myPlayerPivot:{type:WL.Type.Object},_myNonVRCamera:{type:WL.Type.Object},_myEyeLeft:{type:WL.Type.Object},_myEyeRight:{type:WL.Type.Object},_myHead:{type:WL.Type.Object},_myNonVRHead:{type:WL.Type.Object},_myVRHead:{type:WL.Type.Object},_myHandLeft:{type:WL.Type.Object},_myHandRight:{type:WL.Type.Object}},{init:function(){PP.myPlayerObjects.myPlayer=this._myPlayer,PP.myPlayerObjects.myPlayerPivot=this._myPlayerPivot,PP.myPlayerObjects.myNonVRCamera=this._myNonVRCamera,PP.myPlayerObjects.myHead=this._myHead,PP.myPlayerObjects.myNonVRHead=this._myNonVRHead,PP.myPlayerObjects.myVRHead=this._myVRHead,PP.myPlayerObjects.myEyeLeft=this._myEyeLeft,PP.myPlayerObjects.myEyeRight=this._myEyeRight,PP.myPlayerObjects.myHandLeft=this._myHandLeft,PP.myPlayerObjects.myHandRight=this._myHandRight,PP.myPlayerObjects.myEyes=[],PP.myPlayerObjects.myEyes[PP.Handedness.LEFT]=this._myEyeLeft,PP.myPlayerObjects.myEyes[PP.Handedness.RIGHT]=this._myEyeRight,PP.myPlayerObjects.myHands=[],PP.myPlayerObjects.myHands[PP.Handedness.LEFT]=this._myHandLeft,PP.myPlayerObjects.myHands[PP.Handedness.RIGHT]=this._myHandRight,PP.myPlayerObjects.myPlayerPivot==null&&(PP.myPlayerObjects.myPlayerPivot=PP.myPlayerObjects.myPlayer)}});PP.myPlayerObjects={myPlayer:null,myPlayerPivot:null,myNonVRCamera:null,myNonVRHead:null,myVRHead:null,myHead:null,myEyeLeft:null,myEyeRight:null,myEyes:[],myHandLeft:null,myHandRight:null,myHands:[]}});var ri=T(()=>{WL.registerComponent("pp-get-default-resources",{_myPlane:{type:WL.Type.Mesh},_myCube:{type:WL.Type.Mesh},_mySphere:{type:WL.Type.Mesh},_myCone:{type:WL.Type.Mesh},_myCylinder:{type:WL.Type.Mesh},_myCircle:{type:WL.Type.Mesh},_myFlatOpaque:{type:WL.Type.Material},_myFlatTransparentNoDepth:{type:WL.Type.Material},_myPhongOpaque:{type:WL.Type.Material},_myText:{type:WL.Type.Material}},{init(){PP.myDefaultResources.myMeshes.myPlane=PP.MeshUtils.cloneMesh(this._myPlane),PP.myDefaultResources.myMeshes.myCube=PP.MeshUtils.cloneMesh(this._myCube),PP.myDefaultResources.myMeshes.mySphere=PP.MeshUtils.cloneMesh(this._mySphere),PP.myDefaultResources.myMeshes.myCone=PP.MeshUtils.cloneMesh(this._myCone),PP.myDefaultResources.myMeshes.myCylinder=PP.MeshUtils.cloneMesh(this._myCylinder),PP.myDefaultResources.myMeshes.myCircle=PP.MeshUtils.cloneMesh(this._myCircle),PP.myDefaultResources.myMeshes.myInvertedCube=PP.MeshUtils.invertMesh(this._myCube),PP.myDefaultResources.myMeshes.myInvertedSphere=PP.MeshUtils.invertMesh(this._mySphere),PP.myDefaultResources.myMeshes.myInvertedCone=PP.MeshUtils.invertMesh(this._myCone),PP.myDefaultResources.myMeshes.myInvertedCylinder=PP.MeshUtils.invertMesh(this._myCylinder),this._myFlatOpaque!=null&&(PP.myDefaultResources.myMaterials.myFlatOpaque=this._myFlatOpaque.clone()),this._myFlatTransparentNoDepth!=null&&(PP.myDefaultResources.myMaterials.myFlatTransparentNoDepth=this._myFlatTransparentNoDepth.clone()),this._myPhongOpaque!=null&&(PP.myDefaultResources.myMaterials.myPhongOpaque=this._myPhongOpaque.clone()),this._myText!=null&&(PP.myDefaultResources.myMaterials.myText=this._myText.clone())}});PP.myDefaultResources={myMeshes:{myPlane:null,myCube:null,mySphere:null,myCone:null,myCylinder:null,myCircle:null,myInvertedCube:null,myInvertedSphere:null,myInvertedCone:null,myInvertedCylinder:null},myMaterials:{myFlatOpaque:null,myFlatTransparentNoDepth:null,myPhongOpaque:null,myText:null}}});var li=T(()=>{WL.registerComponent("pp-show-fps",{_myRefreshSeconds:{type:WL.Type.Float,default:.25},_myTextMaterial:{type:WL.Type.Material}},{init:function(){},start(){this._myTimer=new PP.Timer(this._myRefreshSeconds),this._myTotalDT=0,this._myFrames=0,this._myVisualFPSParent=this.object.pp_addObject();let e=new PP.VisualTextParams;e.myText="0",e.myTransform.mat4_setPositionRotationScale([-.115,-.115,.35],[0,180,0],[.3,.3,.3]),this._myTextMaterial!=null?e.myMaterial=this._myTextMaterial.clone():(e.myMaterial=PP.myDefaultResources.myMaterials.myText.clone(),e.myMaterial.color=[0,1,0,1]),e.myParent=this._myVisualFPSParent,this._myVisualFPS=new PP.VisualText(e),PP.myEasyTuneVariables.add(new PP.EasyTuneNumber("FPS X",-.25,.1,3)),PP.myEasyTuneVariables.add(new PP.EasyTuneNumber("FPS Y",-.13,.1,3)),PP.myEasyTuneVariables.add(new PP.EasyTuneNumber("FPS Z",.35,.1,3))},update:function(){let e=PP.quat2_create();return function(i){if(this._myTotalDT+=i,this._myFrames++,this._myTimer.update(i),this._myTimer.isDone()){this._myTimer.start();let s=Math.round(this._myFrames/this._myTotalDT),n=this._myVisualFPS.getParams();PP.XRUtils.isSessionActive()?n.myTransform.mat4_setPositionRotationScale([-.115,-.115,.35],[0,180,0],[.3,.3,.3]):n.myTransform.mat4_setPositionRotationScale([-.25,-.13,.35],[0,180,0],[.3,.3,.3]),n.myText=s.toFixed(0),this._myVisualFPS.paramsUpdated(),this._myTotalDT=0,this._myFrames=0}this._myVisualFPSParent.pp_setTransformQuat(PP.myPlayerObjects.myHead.pp_getTransformQuat(e))}}()})});var mi=T(()=>{PP.StateData=class{constructor(t,i){this.myID=t,this.myObject=i}};PP.TransitionData=class{constructor(t,i,s,n,a){this.myID=t,this.myFromState=i,this.myToState=s,this.myObject=n,this.mySkipStateFunction=a}};PP.PendingPerform=class{constructor(t,...i){this.myID=t,this.myArgs=i}};PP.PerformMode={IMMEDIATE:0,DELAYED:1};PP.PerformDelayedMode={QUEUE:0,KEEP_FIRST:1,KEEP_LAST:2};PP.SkipStateFunction={NONE:0,END:1,START:2,BOTH:3};PP.FSM=class{constructor(t=PP.PerformMode.IMMEDIATE,i=PP.PerformDelayedMode.QUEUE){this._myCurrentStateData=null,this._myStateMap=new Map,this._myTransitionMap=new Map,this._myDebugLogActive=!1,this._myDebugShowDelayedInfo=!1,this._myDebugLogName="FSM",this._myPerformMode=t,this._myPerformDelayedMode=i,this._myPendingPerforms=[],this._myCurrentlyPerformedTransition=null,this._myInitCallbacks=new Map,this._myInitIDCallbacks=new Map,this._myTransitionCallbacks=new Map,this._myTransitionIDCallbacks=[]}addState(t,i=null){let s=null;!i||typeof i=="function"?(s={},typeof i=="function"?s.update=i:s.update=null,s.clone=function(){let a={};return a.update=this.update,a.clone=this.clone,a}):s=i;let n=new PP.StateData(t,s);this._myStateMap.set(t,n),this._myTransitionMap.set(t,new Map)}addTransition(t,i,s,n=null,a=PP.SkipStateFunction.NONE){let r=null;if(!n||typeof n=="function"?(r={},typeof n=="function"?r.perform=n:r.perform=null,r.clone=function(){let l={};return l.perform=this.perform,l.clone=this.clone,l}):r=n,this.hasState(t)&&this.hasState(i)){let l=this._getTransitionMapFromState(t),y=new PP.TransitionData(s,this.getState(t),this.getState(i),r,a);l.set(s,y)}else!this.hasState(t)&&!this.hasState(i)?console.error("Can't add transition:",s,"- from state not found:",t,"- to state not found:",i):this.hasState(t)?this.hasState(i)||console.error("Can't add transition:",s,"- to state not found:",i):console.error("Can't add transition:",s,"- from state not found:",t)}init(t,i=null,...s){let n=i;if(i&&typeof i=="function"&&(n={},n.performInit=i),this.hasState(t)){let a=this._myStateMap.get(t);if(this._myDebugLogActive&&console.log(this._myDebugLogName,"- Init:",t),n&&n.performInit?n.performInit(this,a,...s):a.myObject&&a.myObject.init&&a.myObject.init(this,a,...s),this._myCurrentStateData=a,this._myInitCallbacks.size>0&&this._myInitCallbacks.forEach(function(r){r(this,a,n,...s)}.bind(this)),this._myInitIDCallbacks.size>0){let r=this._myInitIDCallbacks.get(t);r?.forEach(function(l){l(this,a,n,...s)}.bind(this))}}else this._myDebugLogActive&&console.warn(this._myDebugLogName,"- Init state not found:",t)}update(t,...i){if(this._myPendingPerforms.length>0){for(let s=0;s<this._myPendingPerforms.length;s++)this._perform(this._myPendingPerforms[s].myID,PP.PerformMode.DELAYED,...this._myPendingPerforms[s].myArgs);this._myPendingPerforms=[]}this._myCurrentStateData&&this._myCurrentStateData.myObject&&this._myCurrentStateData.myObject.update&&this._myCurrentStateData.myObject.update(t,this,...i)}perform(t,...i){this._myPerformMode==PP.PerformMode.DELAYED?this.performDelayed(t,...i):this.performImmediate(t,...i)}performDelayed(t,...i){let s=!1;switch(this._myPerformDelayedMode){case PP.PerformDelayedMode.QUEUE:this._myPendingPerforms.push(new PP.PendingPerform(t,...i)),s=!0;break;case PP.PerformDelayedMode.KEEP_FIRST:this.hasPendingPerforms()||(this._myPendingPerforms.push(new PP.PendingPerform(t,...i)),s=!0);break;case PP.PerformDelayedMode.KEEP_LAST:this.resetPendingPerforms(),this._myPendingPerforms.push(new PP.PendingPerform(t,...i)),s=!0;break}return s}performImmediate(t,...i){return this._perform(t,PP.PerformMode.IMMEDIATE,...i)}canPerform(t){return this.hasTransitionFromState(this._myCurrentStateData.myID,t)}canGoTo(t,i=null){return this.hasTransitionFromStateToState(this._myCurrentStateData.myID,t,i)}isInState(t){return this._myCurrentStateData!=null&&this._myCurrentStateData.myID==t}isPerformingTransition(){return this._myCurrentlyPerformedTransition!=null}getCurrentlyPerformedTransition(){return this._myCurrentlyPerformedTransition}hasBeenInit(){return this._myCurrentStateData!=null}reset(){this.resetState(),this.resetPendingPerforms()}resetState(){this._myCurrentStateData=null}resetPendingPerforms(){this._myPendingPerforms=[]}getCurrentState(){return this._myCurrentStateData}getCurrentTransitions(){return this.getTransitionsFromState(this._myCurrentStateData.myID)}getCurrentTransitionsToState(t){return this.getTransitionsFromStateToState(this._myCurrentStateData.myID,t)}getState(t){return this._myStateMap.get(t)}getStates(){return this._myStateMap.values()}getTransitions(){let t=[];for(let i of this._myTransitionMap.values())for(let s of i.values())t.push(s);return t}getTransitionsFromState(t){let i=this._getTransitionMapFromState(t);return Array.from(i.values())}getTransitionsFromStateToState(t,i){let s=this._getTransitionMapFromState(t),n=[];for(let a of s.values())a.myToState.myID==i&&n.push(a);return n}removeState(t){if(this.hasState(t)){this._myStateMap.delete(t),this._myTransitionMap.delete(t);for(let i of this._myTransitionMap.values()){let s=[];for(let[n,a]of i.entries())a.myToState.myID==t&&s.push(n);for(let n of s)i.delete(n)}return!0}return!1}removeTransitionFromState(t,i){let s=this._getTransitionMapFromState(t);return s?s.delete(i):!1}hasState(t){return this._myStateMap.has(t)}hasTransitionFromState(t,i){return this.getTransitionsFromState(t).findIndex(function(a){return a.myID==i})>=0}hasTransitionFromStateToState(t,i,s=null){let n=this.getTransitionsFromStateToState(t,i),a=!1;return s?a=n.findIndex(function(l){return l.myID==s})>=0:a=n.length>0,a}setPerformMode(t){this._myPerformMode=t}getPerformMode(){return this._myPerformMode}setPerformDelayedMode(t){this._myPerformDelayedMode=t}getPerformDelayedMode(){return this._myPerformDelayedMode}hasPendingPerforms(){return this._myPendingPerforms.length>0}getPendingPerforms(){return this._myPendingPerforms.slice(0)}clone(t=!1){if(!this.isCloneable(t))return null;let i=new PP.FSM;i._myDebugLogActive=this._myDebugLogActive,i._myDebugShowDelayedInfo=this._myDebugShowDelayedInfo,i._myDebugLogName=this._myDebugLogName.slice(0),i._myPerformMode=this._myPerformMode,i._myPerformDelayedMode=this._myPerformDelayedMode,i._myPendingPerforms=this._myPendingPerforms.slice(0);for(let s of this._myStateMap.entries()){let n=null;t?n=new PP.StateData(s[1].myID,s[1].myObject.clone()):n=new PP.StateData(s[1].myID,s[1].myObject),i._myStateMap.set(n.myID,n)}for(let s of this._myTransitionMap.entries()){let n=new Map;i._myTransitionMap.set(s[0],n);for(let a of s[1].entries()){let r=null,l=i.getState(a[1].myFromState.myID),y=i.getState(a[1].myToState.myID);t?r=new PP.TransitionData(a[1].myID,l,y,a[1].myObject.clone(),a[1].mySkipStateFunction):r=new PP.TransitionData(a[1].myID,l,y,a[1].myObject,a[1].mySkipStateFunction),n.set(r.myID,r)}}return this._myCurrentStateData&&(i._myCurrentStateData=i.getState(this._myCurrentStateData.myID)),i}isCloneable(t=!1){if(!t)return!0;let i=!0;for(let s of this._myStateMap.entries())i=i&&s[1].myObject.clone!=null;for(let s of this._myTransitionMap.entries())for(let n of s[1].entries())i=i&&n[1].myObject.clone!=null;return i}setDebugLogActive(t,i=null,s=!1){this._myDebugLogActive=t,this._myDebugShowDelayedInfo=s,i&&(this._myDebugLogName="FSM: ".concat(i))}registerInitEventListener(t,i){this._myInitCallbacks.set(t,i)}unregisterInitEventListener(t){this._myInitCallbacks.delete(t)}registerInitIDEventListener(t,i,s){let n=this._myInitIDCallbacks.get(t);n==null&&(this._myInitIDCallbacks.set(t,new Map),n=this._myInitIDCallbacks.get(t)),n.set(i,s)}unregisterInitIDEventListener(t,i){let s=this._myInitIDCallbacks.get(t);s!=null&&(s.delete(i),s.size<=0&&this._myInitIDCallbacks.delete(t))}registerTransitionEventListener(t,i){this._myTransitionCallbacks.set(t,i)}unregisterTransitionEventListener(t){this._myTransitionCallbacks.delete(t)}registerTransitionIDEventListener(t,i,s,n,a){let r=null;for(let l of this._myTransitionIDCallbacks)if(l[0]==t&&l[1]==i&&l[2]==s){r=l[3];break}if(r==null){let l=[];l[0]=t,l[1]=i,l[2]=s,l[3]=new Map,r=l[3],this._myTransitionIDCallbacks.push(l)}r.set(n,a)}unregisterTransitionIDEventListener(t,i,s,n){let a=null;for(let r of this._myTransitionIDCallbacks)if(r[0]==t&&r[1]==i&&r[2]==s){a=r[3];break}a!=null&&(a.delete(n),a.size<=0&&this._myTransitionIDCallbacks.pp_remove(r=>r[0]==t&&r[1]==i&&r[2]==s))}_perform(t,i,...s){if(this.isPerformingTransition()){let n=this.getCurrentlyPerformedTransition(),a=[this._myDebugLogName,"- Trying to perform:",t];return this._myDebugShowDelayedInfo&&a.push(i==PP.PerformMode.DELAYED?"- Delayed":"- Immediate"),a.push("- But another transition is currently being performed -",n.myID),console.warn(...a),!1}if(this._myCurrentStateData){if(this.canPerform(t)){let a=this._myTransitionMap.get(this._myCurrentStateData.myID).get(t);this._myCurrentlyPerformedTransition=a;let r=this._myCurrentStateData,l=this._myStateMap.get(a.myToState.myID);if(this._myDebugLogActive){let y=[this._myDebugLogName,"- From:",r.myID,"- To:",l.myID,"- With:",t];this._myDebugShowDelayedInfo&&y.push(i==PP.PerformMode.DELAYED?"- Delayed":"- Immediate"),console.log(...y)}if(a.mySkipStateFunction!=PP.SkipStateFunction.END&&a.mySkipStateFunction!=PP.SkipStateFunction.BOTH&&r.myObject&&r.myObject.end&&r.myObject.end(this,a,...s),a.myObject&&a.myObject.perform&&a.myObject.perform(this,a,...s),a.mySkipStateFunction!=PP.SkipStateFunction.START&&a.mySkipStateFunction!=PP.SkipStateFunction.BOTH&&l.myObject&&l.myObject.start&&l.myObject.start(this,a,...s),this._myCurrentStateData=a.myToState,this._myTransitionCallbacks.size>0&&this._myTransitionCallbacks.forEach(function(y){y(this,r,l,a,i,...s)}.bind(this)),this._myTransitionIDCallbacks.length>0){let y=[];for(let c of this._myTransitionIDCallbacks)(c[0]==null||c[0]==r.myID)&&(c[1]==null||c[1]==l.myID)&&(c[2]==null||c[2]==a.myID)&&y.push(c[3]);for(let c of this.transitionIDMaps)c.forEach(function(o){o(this,r,l,a,i,...s)}.bind(this))}return this._myCurrentlyPerformedTransition=null,!0}else if(this._myDebugLogActive){let n=[this._myDebugLogName,"- No Transition:",t,"- From:",this._myCurrentStateData.myID];this._myDebugShowDelayedInfo&&n.push(i==PP.PerformMode.DELAYED?"- Delayed":"- Immediate"),console.warn(...n)}}else if(this._myDebugLogActive){let n=[this._myDebugLogName,"- FSM not initialized yet"];this._myDebugShowDelayedInfo&&n.push(i==PP.PerformMode.DELAYED?"- Delayed":"- Immediate"),console.warn(...n)}return!1}_getTransitionMapFromState(t){return this._myTransitionMap.get(t)}}});var yi=T(()=>{PP.State=class{update(t,i,...s){}init(t,i,...s){}start(t,i,...s){}end(t,i,...s){}}});var ui=T(()=>{PP.Transition=class{performInit(t,i,...s){}perform(t,i,...s){}}});var ci=T(()=>{PP.TimerState=class extends PP.State{constructor(t=0,i=null,...s){super(),this._myTransitionToPerformOnEnd=i,this._myTransitionArgs=s,this._myTimer=new PP.Timer(t,!1)}setDuration(t){this._myTimer.setDuration(t)}setTransitionToPerformOnEnd(t,...i){this._myTransitionToPerformOnEnd=t,this._myTransitionArgs=i}onEnd(t,i=null){this._myTimer.onEnd(t,i)}unregisterOnEnd(t=null){this._myTimer.unregisterOnEnd(t)}update(t,i){this._myTimer.update(t),this._myTimer.isDone()&&this._myTransitionToPerformOnEnd!=null&&i.perform(this._myTransitionToPerformOnEnd,...this._myTransitionArgs)}start(t,i,s=null,n=null,...a){this._myTimer.start(s),n!=null&&(this._myTransitionToPerformOnEnd=n,this._myTransitionArgs=a)}init(t,i,s=null,n=null,...a){this._myTimer.start(s),n!=null&&(this._myTransitionToPerformOnEnd=n,this._myTransitionArgs=a)}}});var hi=T(()=>{PP.CAUtils={_myDummyServer:null,_myUseDummyServerOnSDKMissing:!1,_myUseDummyServerOnError:!1,setUseDummyServerOnSDKMissing:function(e){PP.CAUtils._myUseDummyServerOnSDKMissing=e},setUseDummyServerOnError:function(e){PP.CAUtils._myUseDummyServerOnError=e},setDummyServer:function(e){PP.CAUtils._myDummyServer=e},isUseDummyServerOnSDKMissing:function(){return PP.CAUtils._myUseDummyServerOnSDKMissing},isUseDummyServerOnError:function(){return PP.CAUtils._myUseDummyServerOnError},getDummyServer:function(){return PP.CAUtils._myDummyServer},isSDKAvailable:function(){return"casdk"in window},getLeaderboard:function(e,t,i,s,n,a,r=null){if(PP.CAUtils.isSDKAvailable())i?PP.CAUtils.getUser(function(l){let y=l.displayName;casdk.getLeaderboard(e,t,i,s).then(function(c){if(c.leaderboard){let o=!1;for(let m of c.leaderboard)if(m.displayName==y&&m.score!=0){o=!0;break}if(o)n&&n(c.leaderboard);else if(PP.CAUtils._myUseDummyServerOnError&&r==null||r!=null&&r)PP.CAUtils.getLeaderboardDummy(e,t,i,s,n,a);else if(a){let m={};m.reason="Searching for around player but the user has not submitted a score yet",m.type=PP.CAUtils.ErrorType.USER_HAS_NO_SCORE,a(m,c)}}else if(PP.CAUtils._myUseDummyServerOnError&&r==null||r!=null&&r)PP.CAUtils.getLeaderboardDummy(e,t,i,s,n,a);else if(a){let o={};o.reason="Get leaderboard failed",o.type=PP.CAUtils.ErrorType.GET_LEADERBOARD_FAILED,a(o,c)}})},function(){if(PP.CAUtils._myUseDummyServerOnError&&r==null||r!=null&&r)PP.CAUtils.getLeaderboardDummy(e,t,i,s,n,a);else if(a){let l={};l.reason="Searching for around player but the user can't be retrieved",l.type=PP.CAUtils.ErrorType.GET_USER_FAILED,a(l,result)}},!1):casdk.getLeaderboard(e,t,i,s).then(function(l){if(l.leaderboard)n&&n(l.leaderboard);else if(PP.CAUtils._myUseDummyServerOnError&&r==null||r!=null&&r)PP.CAUtils.getLeaderboardDummy(e,t,i,s,n,a);else if(a){let y={};y.reason="Get leaderboard failed",y.type=PP.CAUtils.ErrorType.GET_LEADERBOARD_FAILED,a(y,l)}});else if(PP.CAUtils._myUseDummyServerOnSDKMissing&&r==null||r!=null&&r)PP.CAUtils.getLeaderboardDummy(e,t,i,s,n,a);else if(a){let l={};l.reason="Construct Arcade SDK missing",l.type=PP.CAUtils.ErrorType.CA_SDK_MISSING,a(l,null)}},getLeaderboardDummy(e,t,i,s,n,a){if(PP.CAUtils._myDummyServer)PP.CAUtils._myDummyServer.getLeaderboard(e,t,i,s,n,a);else if(a){let r={};r.reason="Dummy server not initialized",r.type=PP.CAUtils.ErrorType.DUMMY_NOT_INITIALIZED,a(r)}},submitScore:function(e,t,i,s,n=null){if(PP.CAUtils.isSDKAvailable())casdk.submitScore(e,t).then(function(a){if(a.error){if(PP.CAUtils._myUseDummyServerOnError&&n==null||n!=null&&n)PP.CAUtils.submitScoreDummy(e,t,i,s);else if(s){let r={};r.reason="Submit score failed",r.type=PP.CAUtils.ErrorType.SUBMIT_SCORE_FAILED,s(r,a)}}else i()});else if(PP.CAUtils._myUseDummyServerOnSDKMissing&&n==null||n!=null&&n)PP.CAUtils.submitScoreDummy(e,t,i,s);else if(s){let a={};a.reason="Construct Arcade SDK missing",a.type=PP.CAUtils.ErrorType.CA_SDK_MISSING,s(a,null)}},submitScoreDummy(e,t,i,s){if(PP.CAUtils._myDummyServer)PP.CAUtils._myDummyServer.submitScore(e,t,i,s);else if(s){let n={};n.reason="Dummy server not initialized",n.type=PP.CAUtils.ErrorType.DUMMY_NOT_INITIALIZED,s(n)}},getUser:function(e,t,i=null){if(PP.CAUtils.isSDKAvailable())casdk.getUser().then(function(s){if(s.user)e&&e(s.user);else if(PP.CAUtils._myUseDummyServerOnError&&i==null||i!=null&&i)PP.CAUtils.getUserDummy(e,t);else if(t){let n={};n.reason="Get user failed",n.type=PP.CAUtils.ErrorType.GET_USER_FAILED,t(n,s)}});else if(PP.CAUtils._myUseDummyServerOnSDKMissing&&i==null||i!=null&&i)PP.CAUtils.getUserDummy(e,t);else if(t){let s={};s.reason="Construct Arcade SDK missing",s.type=PP.CAUtils.ErrorType.CA_SDK_MISSING,t(s,null)}},getUserDummy(e,t){if(PP.CAUtils._myDummyServer)PP.CAUtils._myDummyServer.getUser(e,t);else if(t){let i={};i.reason="Dummy server not initialized",i.type=PP.CAUtils.ErrorType.DUMMY_NOT_INITIALIZED,t(i)}},ErrorType:{DUMMY_NOT_INITIALIZED:0,CA_SDK_MISSING:1,SUBMIT_SCORE_FAILED:2,GET_LEADERBOARD_FAILED:3,GET_USER_FAILED:4,USER_HAS_NO_SCORE:5}};PP.CADummyServer=class{constructor(){}getLeaderboard(t,i,s,n,a,r){let l=null;for(s?l=[{rank:7,displayName:"Player 1",score:1e6},{rank:8,displayName:"Player 2",score:1e6},{rank:9,displayName:"Player 3",score:9e5},{rank:10,displayName:"Player 4",score:8e5},{rank:11111,displayName:"Player 5",score:7e7},{rank:22222,displayName:"VeryLongName_06",score:6e5},{rank:33333,displayName:"Player 7",score:5e5},{rank:44444,displayName:"Player 8",score:4e5},{rank:55555,displayName:"Player 9",score:3e5},{rank:66666,displayName:"Player 10",score:2e5}]:l=[{rank:0,displayName:"Player 1",score:1e6},{rank:1,displayName:"Player 2",score:1e6},{rank:2,displayName:"Player 3",score:9e5},{rank:3,displayName:"Player 4",score:8e5},{rank:4,displayName:"Player 5",score:7e5},{rank:5,displayName:"Player 6",score:6e5},{rank:6,displayName:"Player 7",score:5e5},{rank:7,displayName:"Player 8",score:4e5},{rank:8,displayName:"Player 9",score:3e5},{rank:9,displayName:"Player 10",score:2e5}];l.length>n;)l.pop();a&&a(l)}submitScore(t,i,s,n){s&&s()}getUser(t,i){let s={};s.displayName="Jonathan",t&&t(s)}}});var pi=T(()=>{PP.ColorUtils={rgbToHsv:function(e){let t=e.pp_clone(),i=e[0],s=e[1],n=e[2];var a=Math.max(i,s,n),r=Math.min(i,s,n),l=a-r,y,c=a===0?0:l/a,o=a;switch(a){case r:y=0;break;case i:y=s-n+l*(s<n?6:0),y/=6*l;break;case s:y=n-i+l*2,y/=6*l;break;case n:y=i-s+l*4,y/=6*l;break}return t[0]=y,t[1]=c,t[2]=o,t},hsvToRgb:function(e){let t=e.pp_clone(),i=e[0],s=e[1],n=e[2],a,r,l,y,c,o,m,u;switch(y=Math.floor(i*6),c=i*6-y,o=n*(1-s),m=n*(1-c*s),u=n*(1-(1-c)*s),y%6){case 0:a=n,r=u,l=o;break;case 1:a=m,r=n,l=o;break;case 2:a=o,r=n,l=u;break;case 3:a=o,r=m,l=n;break;case 4:a=u,r=o,l=n;break;case 5:a=n,r=o,l=m;break}return t[0]=a,t[1]=r,t[2]=l,t},rgbCodeToHuman(e){return PP.ColorUtils.color1To255(e)},rgbHumanToCode(e){return PP.ColorUtils.color255To1(e)},hsvCodeToHuman(e){return PP.ColorUtils.color1To255(e)},hsvHumanToCode(e){return PP.ColorUtils.color255To1(e)},color255To1(e){let t=e.pp_clone();for(let i=0;i<t.length;i++)t[i]/=255,t[i]=Math.pp_clamp(t[i],0,1);return t},color1To255(e){let t=e.pp_clone();for(let i=0;i<t.length;i++)t[i]=Math.round(t[i]*255),t[i]=Math.pp_clamp(t[i],0,255);return t}}});var di=T(()=>{PP.MeshCreationVertexParams=class{constructor(){this.myPosition=null,this.myTextureCoordinates=null,this.myNormal=null,this.myColor=null}};PP.MeshCreationTriangleParams=class{constructor(){this.myIndexes=new Uint32Array(3)}};PP.MeshCreationParams=class{constructor(){this.myVertexes=[],this.myTriangles=[]}};PP.MeshUtils={createPlaneMesh:function(){let e=4,t=new PP.MeshCreationParams;for(let a=0;a<e;++a){let r=new PP.MeshCreationVertexParams;r.myPosition=new PP.vec3_create,r.myPosition[0]=-1+(a&1)*2,r.myPosition[1]=-1+((a&2)>>1)*2,r.myPosition[2]=0,r.myTextureCoordinates=new PP.vec2_create,r.myTextureCoordinates[0]=a&1,r.myTextureCoordinates[1]=(a&2)>>1,r.myNormal=new PP.vec3_create,r.myNormal[0]=0,r.myNormal[1]=0,r.myNormal[2]=1,t.myVertexes.push(r)}let i=new PP.MeshCreationTriangleParams;i.myIndexes[0]=0,i.myIndexes[1]=1,i.myIndexes[2]=2;let s=new PP.MeshCreationTriangleParams;return s.myIndexes[0]=2,s.myIndexes[1]=1,s.myIndexes[2]=3,t.myTriangles.push(i),t.myTriangles.push(s),PP.MeshUtils.createMesh(t)},createMesh:function(e){let t=[];for(let c of e.myTriangles)t.push(c.myIndexes[0]),t.push(c.myIndexes[1]),t.push(c.myIndexes[2]);let i=new Uint32Array(t.length);i.pp_copy(t);let s=e.myVertexes.length,n=new WL.Mesh({vertexCount:s,indexData:i,indexType:WL.MeshIndexType.UnsignedInt}),a=null,r=null,l=null,y=null;try{a=n.attribute(WL.MeshAttribute.Position)}catch{a=null}try{r=n.attribute(WL.MeshAttribute.TextureCoordinate)}catch{r=null}try{l=n.attribute(WL.MeshAttribute.Normal)}catch{l=null}try{y=n.attribute(WL.MeshAttribute.Color)}catch{y=null}for(let c=0;c<e.myVertexes.length;c++){let o=e.myVertexes[c];a!=null&&o.myPosition&&a.set(c,o.myPosition),r!=null&&o.myTextureCoordinates&&r.set(c,o.myTextureCoordinates),l!=null&&o.myNormal&&l.set(c,o.myNormal),y!=null&&o.myColor&&y.set(c,o.myColor)}return n},cloneMesh:function(){let e=PP.vec3_create(),t=PP.vec2_create(),i=PP.vec3_create(),s=PP.vec4_create();return function(a){if(a==null)return null;let r=new Uint32Array(a.indexData.length);for(let p=0;p<a.indexData.length;p++)r[p]=a.indexData[p];let l=new WL.Mesh({vertexCount:a.vertexCount,indexData:r,indexType:WL.MeshIndexType.UnsignedInt}),y=null,c=null,o=null,m=null,u=null,h=null,_=null,P=null;try{y=a.attribute(WL.MeshAttribute.Position),u=l.attribute(WL.MeshAttribute.Position)}catch{y=null,u=null}try{c=a.attribute(WL.MeshAttribute.TextureCoordinate),h=l.attribute(WL.MeshAttribute.TextureCoordinate)}catch{c=null,h=null}try{o=a.attribute(WL.MeshAttribute.Normal),_=l.attribute(WL.MeshAttribute.Normal)}catch{o=null,_=null}try{m=a.attribute(WL.MeshAttribute.Color),P=l.attribute(WL.MeshAttribute.Color)}catch{m=null,P=null}for(let p=0;p<a.vertexCount;p++)y!=null&&u!=null&&u.set(p,y.get(p,e)),c!=null&&h!=null&&h.set(p,c.get(p,t)),o!=null&&_!=null&&_.set(p,o.get(p,i)),m!=null&&P!=null&&P.set(p,m.get(p,s));return l}}(),invertMesh:function(){let e=PP.vec3_create(),t=PP.vec2_create(),i=PP.vec3_create(),s=PP.vec4_create();return function(a){if(a==null)return null;let r=new Uint32Array(a.indexData.length);for(let p=0;p<a.indexData.length/3;p++)r[p*3+0]=a.indexData[p*3+2],r[p*3+1]=a.indexData[p*3+1],r[p*3+2]=a.indexData[p*3+0];let l=new WL.Mesh({vertexCount:a.vertexCount,indexData:r,indexType:WL.MeshIndexType.UnsignedInt}),y=null,c=null,o=null,m=null,u=null,h=null,_=null,P=null;try{y=a.attribute(WL.MeshAttribute.Position),u=l.attribute(WL.MeshAttribute.Position)}catch{y=null,u=null}try{c=a.attribute(WL.MeshAttribute.TextureCoordinate),h=l.attribute(WL.MeshAttribute.TextureCoordinate)}catch{c=null,h=null}try{o=a.attribute(WL.MeshAttribute.Normal),_=l.attribute(WL.MeshAttribute.Normal)}catch{o=null,_=null}try{m=a.attribute(WL.MeshAttribute.Color),P=l.attribute(WL.MeshAttribute.Color)}catch{m=null,P=null}for(let p=0;p<a.vertexCount;p++)y!=null&&u!=null&&u.set(p,y.get(p,e)),c!=null&&h!=null&&h.set(p,c.get(p,t)),o!=null&&_!=null&&(o.get(p,i),i.vec3_negate(i),_.set(p,i)),m!=null&&P!=null&&P.set(p,m.get(p,s));return l}}(),setAlpha:function(){let e=PP.vec4_create();return function(i,s){let n=i.pp_getComponentsHierarchy("mesh");for(let a of n)a.material.color!=null&&(e.vec4_copy(a.material.color),e[3]=s,a.material.color=e),a.material.diffuseColor!=null&&(e.vec4_copy(a.material.diffuseColor),e[3]=s,a.material.diffuseColor=e),a.material.ambientColor!=null&&(e.vec4_copy(a.material.ambientColor),e[3]=s,a.material.ambientColor=e)}}(),setMaterial:function(e,t,i=!1){let s=e.pp_getComponentsHierarchy("mesh");for(let n of s)i?n.material=t.clone():n.material=t},setClonedMaterials:function(e){let t=e.pp_getComponentsHierarchy("mesh");for(let i of t)i.material=i.material.clone()},setSpecularColor:function(e,t){let i=e.pp_getComponentsHierarchy("mesh");for(let s of i)s.material.specularColor!=null&&(s.material.specularColor=t)},setFogColor:function(e,t){let i=e.pp_getComponentsHierarchy("mesh");for(let s of i)s.material.fogColor!=null&&(s.material.fogColor=t)}}});var _i=T(()=>{PP.SaveUtils={save:function(e,t){t!=null&&localStorage.setItem(e,t)},has:function(e){return PP.SaveUtils.loadString(e,null)!=null},delete:function(e){return localStorage.removeItem(e)},clear:function(){return localStorage.clear()},load:function(e,t=null){return PP.SaveUtils.loadString(e,t)},loadString:function(e,t=null){let i=localStorage.getItem(e);return i==null&&(i=t),i},loadNumber:function(e,t=null){let i=PP.SaveUtils.loadString(e);return i!=null?Number(i):t},loadBool:function(e,t=null){let i=PP.SaveUtils.loadString(e);return i=="true"?!0:i=="false"?!1:t}}});var Pi=T(()=>{PP.TextUtils={setClonedMaterials:function(e){let t=e.pp_getComponentsHierarchy("text");for(let i of t)i.material=i.material.clone()}}});var gi=T(()=>{PP.XRUtils={isDeviceEmulated:function(){return"CustomWebXRPolyfill"in window},isSessionActive:function(){return WL.xrSession!=null},isReferenceSpaceLocalFloor:function(){return!["local","viewer"].includes(WebXR.refSpace)}}});var fi=T(()=>{PP.BrowserUtils={isMobile:function(){return/Mobi/i.test(window.navigator.userAgent)},isDesktop:function(){return!PP.BrowserUtils.isMobile()}}});var Ti=T(()=>{PP.PhysicsUtils={_myLayerFlagsAmount:8,_myLayerFlagsNames:["0","1","2","3","4","5","6","7"],setLayerFlagsAmount:function(e){PP.PhysicsUtils._myLayerFlagsAmount=e},setLayerFlagsNames:function(e){PP.PhysicsUtils._myLayerFlagsNames=e},getLayerFlagsAmount:function(){return PP.PhysicsUtils._myLayerFlagsAmount},getLayerFlagsNames:function(){return PP.PhysicsUtils._myLayerFlagsNames},raycast:function(){let e=(t,i)=>t.pp_equals(i);return function(i,s=new PP.RaycastResult){let n=WL.physics.rayCast(i.myOrigin,i.myDirection,i.myBlockLayerFlags.getMask(),i.myDistance);s.myRaycastSetup=i;let a=0,r=0;for(let l=0;l<n.hitCount;l++){let y=!0;y=y&&(i.myObjectsToIgnore.length==0||!i.myObjectsToIgnore.pp_hasEqual(n.objects[l],e));let c=y&&n.distances[l]==0&&i.myOrigin.vec3_distance(n.locations[l])<1e-5&&Math.abs(i.myDirection.vec3_angle(n.normals[l])-180)<1e-5;if(y=y&&(!i.myIgnoreHitsInsideCollision||!c),y){let o=null;a<s.myHits.length?o=s.myHits[a]:s._myUnusedHits!=null&&s._myUnusedHits.length>0?(o=s._myUnusedHits.pop(),s.myHits.push(o)):(o=new PP.RaycastHit,s.myHits.push(o)),o.myPosition.vec3_copy(n.locations[l]),o.myNormal.vec3_copy(n.normals[l]),o.myDistance=n.distances[l],o.myObject=n.objects[l],o.myIsInsideCollision=c,r++,a++}}if(s.myHits.length>r){s._myUnusedHits==null&&(s._myUnusedHits=[]);let l=s.myHits.length-r;for(let y=0;y<l;y++)s._myUnusedHits.push(s.myHits.pop())}return s}}()}});var bi=T(()=>{PP.RaycastSetup=class{constructor(){this.myOrigin=[0,0,0],this.myDirection=[0,0,0],this.myDistance=0,this.myBlockLayerFlags=new PP.PhysicsLayerFlags,this.myObjectsToIgnore=[],this.myIgnoreHitsInsideCollision=!1}copy(t){this.myOrigin.vec3_copy(t.myOrigin),this.myDirection.vec3_copy(t.myDirection),this.myDistance=t.myDistance,this.myBlockLayerFlags.copy(t.myBlockLayerFlags),this.myObjectsToIgnore.pp_copy(t.myObjectsToIgnore),this.myIgnoreHitsInsideCollision=t.myIgnoreHitsInsideCollision}};PP.RaycastResult=class{constructor(){this.myRaycastSetup=null,this.myHits=[],this._myUnusedHits=null}isColliding(t=!1){return t?this.getFirstHitOutsideCollision()!=null:this.myHits.length>0}getFirstHitInsideCollision(){let t=null;for(let i of this.myHits)if(i.myIsInsideCollision){t=i;break}return t}getFirstHitOutsideCollision(){let t=null;for(let i of this.myHits)if(!i.myIsInsideCollision){t=i;break}return t}getHitsInsideCollision(){let t=[];for(let i of this.myHits)i.myIsInsideCollision&&t.push(i);return t}getHitsOutsideCollision(){let t=[];for(let i of this.myHits)i.myIsInsideCollision||t.push(i);return t}removeHit(t){let i=this.myHits.pp_removeIndex(t);return i!=null&&(this._myUnusedHits==null&&(this._myUnusedHits=[]),this._myUnusedHits.push(i)),i}copy(t){}};PP.RaycastResult.prototype.copy=function(){let e=function(t,i){return t==null&&(t=new PP.RaycastHit),t.copy(i),t};return function(i){if(i.myRaycastSetup==null?this.myRaycastSetup=null:(this.myRaycastSetup==null&&(this.myRaycastSetup=new PP.RaycastSetup),this.myRaycastSetup.copy(i.myRaycastSetup)),this.myHits.length>i.myHits.length){this._myUnusedHits==null&&(this._myUnusedHits=[]);for(let s=0;s<this.myHits.length-i.myHits.length;s++)this._myUnusedHits.push(this.myHits.pop())}else if(this.myHits.length<i.myHits.length&&this._myUnusedHits!=null){let s=Math.min(this._myUnusedHits.length,i.myHits.length-this.myHits.length);for(let n=0;n<s;n++)this.myHits.push(this._myUnusedHits.pop())}this.myHits.pp_copy(i.myHits,e)}}();PP.RaycastHit=class{constructor(){this.myPosition=[0,0,0],this.myNormal=[0,0,0],this.myDistance=0,this.myObject=null,this.myIsInsideCollision=!1}isValid(){return this.myObject!=null}copy(t){this.myPosition.vec3_copy(t.myPosition),this.myNormal.vec3_copy(t.myNormal),this.myDistance=t.myDistance,this.myObject=t.myObject,this.myIsInsideCollision=t.myIsInsideCollision}reset(){this.myPosition.vec3_zero(),this.myNormal.vec3_zero(),this.myDistance=0,this.myObject=null,this.myIsInsideCollision=!1}};Object.defineProperty(PP.RaycastResult.prototype,"copy",{enumerable:!1})});var Ci=T(()=>{PP.PhysicsLayerFlags=class{constructor(){this._myLayerMask=0}setFlagActive(t,i){let s=t;if(isNaN(t)&&(s=PP.PhysicsUtils.getLayerFlagsNames().pp_findIndexEqual(t)),s>=0&&s<PP.PhysicsUtils.getLayerFlagsAmount()){let n=1<<s;i?this._myLayerMask=this._myLayerMask|n:this._myLayerMask=this._myLayerMask&~n}}isFlagActive(t){let i=t;isNaN(t)&&(i=PP.PhysicsUtils.getLayerFlagsNames().pp_findIndexEqual(t));let s=!1;if(i>=0&&i<PP.PhysicsUtils.getLayerFlagsAmount()){let n=1<<i;s=!!(this._myLayerMask&n)}return s}setAllFlagsActive(t){t?this._myLayerMask=Math.pow(2,PP.PhysicsUtils.getLayerFlagsAmount())-1:this._myLayerMask=0}getMask(){return this._myLayerMask}setMask(t){this._myLayerMask=t}copy(t){this._myLayerMask=t._myLayerMask}}});var Si=T(()=>{PP.VisualManager=class{constructor(){this._myVisualElementPrototypeCreationCallbacks=new Map,this._myVisualElementTypeMap=new Map,this._myVisualElementLastID=0,this._myVisualElementsPool=new PP.ObjectPoolManager,this._myVisualElementsToShow=[],this._myActive=!0,this._addStandardVisualElementTypes()}setActive(t){this._myActive!=t&&(this._myActive=t,this._myActive||this.clearDraw())}isActive(){return this._myActive}start(){}update(t){this._updateDraw(t)}draw(t,i=0,s=null){if(!this._myActive)return 0;let n=null,a=!1;if(s!=null&&this._myVisualElementTypeMap.has(t.myType)){let y=this._myVisualElementTypeMap.get(t.myType);y.has(s)&&(n=y.get(s)[0],n.setParams(t),n.setVisible(!1),a=!0)}if(n==null&&(n=this._getVisualElement(t)),n==null)return console.error("Couldn't create the requested visual element"),null;this._myVisualElementTypeMap.has(t.myType)||this._myVisualElementTypeMap.set(t.myType,new Map);let r=this._myVisualElementTypeMap.get(t.myType),l=null;if(!a)l=this._myVisualElementLastID+1,this._myVisualElementLastID=l,r.set(l,[n,new PP.Timer(i,i!=null)]);else{l=s;let y=r.get(l);y[0]=n,y[1].reset(i),i!=null&&y[1].start()}return this._myVisualElementsToShow.push(n),l}getDraw(t){let i=null;for(let s of this._myVisualElementTypeMap.values())if(s.has(t)){i=s.get(t)[0];break}return i}clearDraw(t=null){if(t==null){for(let i of this._myVisualElementTypeMap.values())for(let s of i.values())this._myVisualElementsPool.releaseObject(s[0].getParams().myType,s[0]);this._myVisualElementsToShow=[],this._myVisualElementTypeMap=new Map,this._myVisualElementLastID=0}else for(let i of this._myVisualElementTypeMap.values())if(i.has(t)){let s=i.get(t);this._myVisualElementsPool.releaseObject(s[0].getParams().myType,s[0]),i.delete(t),this._myVisualElementsToShow.pp_removeEqual(s[0]);break}}allocateDraw(t,i){this._myVisualElementsPool.hasPool(t)||this._addVisualElementTypeToPool(t);let s=this._myVisualElementsPool.getPool(t),n=s.getAvailableSize()-i;n<0&&s.increase(-n)}addVisualElementType(t,i){this._myVisualElementPrototypeCreationCallbacks.set(t,i)}removeVisualElementType(t){this._myVisualElementPrototypeCreationCallbacks.delete(t)}_updateDraw(t){for(let i of this._myVisualElementsToShow)i.setVisible(!0);this._myVisualElementsToShow=[];for(let i of this._myVisualElementTypeMap.values()){let s=[];for(let n of i.entries()){let a=n[1];a[1].isDone()&&(this._myVisualElementsPool.releaseObject(a[0].getParams().myType,a[0]),s.push(n[0])),a[1].update(t)}for(let n of s)i.delete(n)}}_getVisualElement(t){let i=null;return this._myVisualElementsPool.hasPool(t.myType)||this._addVisualElementTypeToPool(t.myType),i=this._myVisualElementsPool.getObject(t.myType),i?.setParams(t),i}_addVisualElementTypeToPool(t){let i=new PP.ObjectPoolParams;i.myInitialPoolSize=10,i.myAmountToAddWhenEmpty=0,i.myPercentageToAddWhenEmpty=.5,i.myEnableDebugLog=!1,i.mySetActiveCallback=function(n,a){n.setVisible(a)};let s=null;this._myVisualElementPrototypeCreationCallbacks.has(t)&&(s=this._myVisualElementPrototypeCreationCallbacks.get(t)()),s!=null?(s.setVisible(!1),s.setAutoRefresh(!0),this._myVisualElementsPool.addPool(t,s,i)):console.error("Visual element type not supported")}_addStandardVisualElementTypes(){this.addVisualElementType(PP.VisualElementType.LINE,()=>new PP.VisualLine),this.addVisualElementType(PP.VisualElementType.MESH,()=>new PP.VisualMesh),this.addVisualElementType(PP.VisualElementType.POINT,()=>new PP.VisualPoint),this.addVisualElementType(PP.VisualElementType.ARROW,()=>new PP.VisualArrow),this.addVisualElementType(PP.VisualElementType.TEXT,()=>new PP.VisualText),this.addVisualElementType(PP.VisualElementType.TRANSFORM,()=>new PP.VisualTransform),this.addVisualElementType(PP.VisualElementType.RAYCAST,()=>new PP.VisualRaycast),this.addVisualElementType(PP.VisualElementType.TORUS,()=>new PP.VisualTorus)}}});var xi=T(()=>{PP.VisualElementType={MESH:0,LINE:1,POINT:2,TEXT:3,ARROW:4,TRANSFORM:5,RAYCAST:6,TORUS:7}});var vi=T(()=>{PP.VisualLineParams=class{constructor(){this.myStart=[0,0,0],this.myDirection=[0,0,1],this.myLength=0,this.myThickness=.005,this.myMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=null,this.myType=PP.VisualElementType.LINE}setStartEnd(t,i){return i.vec3_sub(t,this.myDirection),this.myLength=this.myDirection.vec3_length(),this.myDirection.vec3_normalize(this.myDirection),this.myStart.vec3_copy(t),this}};PP.VisualLine=class{constructor(t=new PP.VisualLineParams){this._myParams=t,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myLineRootObject=null,this._myLineObject=null,this._myLineMeshComponent=null,this._myFlatOpaqueMaterial=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(t){this._myVisible!=t&&(this._myVisible=t,this._myLineRootObject.pp_setActive(t))}setAutoRefresh(t){this._myAutoRefresh=t}getParams(){return this._myParams}setParams(t){this._myParams=t,this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(t){this._myDirty&&(this._refresh(),this._myDirty=!1)}_build(){this._myLineRootObject=WL.scene.addObject(null),this._myLineObject=WL.scene.addObject(this._myLineRootObject),this._myLineMeshComponent=this._myLineObject.addComponent("mesh")}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let t=new PP.VisualLineParams;t.myStart.vec3_copy(this._myParams.myStart),t.myDirection.vec3_copy(this._myParams.myDirection),t.myLength=this._myParams.myLength,t.myThickness=this._myParams.myThickness,t.myMesh=this._myParams.myMesh,this._myParams.myMaterial!=null?t.myMaterial=this._myParams.myMaterial.clone():t.myMaterial=null,this._myParams.myColor!=null?t.myColor.vec4_copy(this._myParams.myColor):t.myColor=null,t.myParent=this._myParams.myParent;let i=new PP.VisualLine(t);return i.setAutoRefresh(this._myAutoRefresh),i.setVisible(this._myVisible),i._myDirty=this._myDirty,i}};PP.VisualLine.prototype._refresh=function(){let e=PP.vec3_create(),t=PP.vec3_create(),i=PP.vec3_create(0,1,0);return function(){this._myLineRootObject.pp_setParent(this._myParams.myParent==null?PP.myVisualData.myRootObject:this._myParams.myParent,!1),this._myLineRootObject.pp_setPositionLocal(this._myParams.myStart),this._myLineObject.pp_resetPositionLocal(),this._myLineObject.pp_resetScaleLocal(),e.vec3_set(this._myParams.myThickness/2,this._myParams.myLength/2,this._myParams.myThickness/2),this._myLineObject.pp_scaleObject(e),this._myLineObject.pp_setUpLocal(this._myParams.myDirection,i),t.vec3_set(0,this._myParams.myLength/2,0),this._myLineObject.pp_translateObject(t),this._myParams.myMesh!=null?this._myLineMeshComponent.mesh=this._myParams.myMesh:this._myLineMeshComponent.mesh=PP.myDefaultResources.myMeshes.myCylinder,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myLineMeshComponent.material=PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone()),this._myLineMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myLineMeshComponent.material=this._myParams.myMaterial}}();Object.defineProperty(PP.VisualLine.prototype,"_refresh",{enumerable:!1})});var Bi=T(()=>{PP.VisualMeshParams=class{constructor(){this.myTransform=PP.mat4_create(),this.myMesh=null,this.myMaterial=null,this.myParent=null,this.myType=PP.VisualElementType.MESH}};PP.VisualMesh=class{constructor(t=new PP.VisualMeshParams){this._myParams=t,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myMeshObject=null,this._myMeshComponent=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(t){this._myVisible!=t&&(this._myVisible=t,this._myMeshObject.pp_setActive(t))}setAutoRefresh(t){this._myAutoRefresh=t}getParams(){return this._myParams}setParams(t){this._myParams=t,this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(t){this._myDirty&&(this._refresh(),this._myDirty=!1)}_refresh(){this._myMeshObject.pp_setParent(this._myParams.myParent==null?PP.myVisualData.myRootObject:this._myParams.myParent,!1),this._myMeshObject.pp_setTransformLocal(this._myParams.myTransform),this._myParams.myMesh==null?this._myMeshComponent.mesh=PP.myDefaultResources.myMeshes.mySphere:this._myMeshComponent.mesh=this._myParams.myMesh,this._myParams.myMaterial==null?this._myMeshComponent.material=PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial:this._myMeshComponent.material=this._myParams.myMaterial}_build(){this._myMeshObject=WL.scene.addObject(null),this._myMeshComponent=this._myMeshObject.addComponent("mesh")}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let t=new PP.VisualMeshParams;t.myTransform.pp_copy(this._myParams.myTransform),this._myParams.myMesh!=null?t.myMesh=this._myParams.myMesh:t.myMesh=null,this._myParams.myMaterial!=null?t.myMaterial=this._myParams.myMaterial.clone():t.myMaterial=null,t.myParent=this._myParams.myParent;let i=new PP.VisualMesh(t);return i.setAutoRefresh(this._myAutoRefresh),i.setVisible(this._myVisible),i._myDirty=this._myDirty,i}}});var Mi=T(()=>{PP.VisualPointParams=class{constructor(){this.myPosition=[0,0,0],this.myRadius=.005,this.myMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=null,this.myType=PP.VisualElementType.POINT}};PP.VisualPoint=class{constructor(t=new PP.VisualPointParams){this._myParams=t,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myPointObject=null,this._myPointMeshComponent=null,this._myFlatOpaqueMaterial=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(t){this._myVisible!=t&&(this._myVisible=t,this._myPointObject.pp_setActive(t))}setAutoRefresh(t){this._myAutoRefresh=t}getParams(){return this._myParams}setParams(t){this._myParams=t,this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(t){this._myDirty&&(this._refresh(),this._myDirty=!1)}_build(){this._myPointObject=WL.scene.addObject(null),this._myPointMeshComponent=this._myPointObject.addComponent("mesh")}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let t=new PP.VisualPointParams;t.myPosition.vec3_copy(this._myParams.myPosition),t.myRadius=this._myParams.myRadius,t.myMesh=this._myParams.myMesh,this._myParams.myMaterial!=null?t.myMaterial=this._myParams.myMaterial.clone():t.myMaterial=null,this._myParams.myColor!=null?t.myColor.vec4_copy(this._myParams.myColor):t.myColor=null,t.myParent=this._myParams.myParent;let i=new PP.VisualPoint(t);return i.setAutoRefresh(this._myAutoRefresh),i.setVisible(this._myVisible),i._myDirty=this._myDirty,i}};PP.VisualPoint.prototype._refresh=function(){let e=PP.vec3_create(0,0,0);return function(){this._myPointObject.pp_setParent(this._myParams.myParent==null?PP.myVisualData.myRootObject:this._myParams.myParent,!1),this._myPointObject.pp_setPositionLocal(this._myParams.myPosition),this._myPointObject.pp_setRotationLocal(e),this._myPointObject.pp_setScaleLocal(this._myParams.myRadius),this._myParams.myMesh!=null?this._myPointMeshComponent.mesh=this._myParams.myMesh:this._myPointMeshComponent.mesh=PP.myDefaultResources.myMeshes.mySphere,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myPointMeshComponent.material=PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone()),this._myPointMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myPointMeshComponent.material=this._myParams.myMaterial}}();Object.defineProperty(PP.VisualPoint.prototype,"_refresh",{enumerable:!1})});var Ii=T(()=>{PP.VisualArrowParams=class{constructor(){this.myStart=[0,0,0],this.myDirection=[0,0,1],this.myLength=0,this.myThickness=.005,this.myLineMesh=null,this.myArrowMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=null,this.myType=PP.VisualElementType.ARROW}setStartEnd(t,i){return i.vec3_sub(t,this.myDirection),this.myLength=this.myDirection.vec3_length(),this.myDirection.vec3_normalize(this.myDirection),this.myStart.vec3_copy(t),this}};PP.VisualArrow=class{constructor(t=new PP.VisualArrowParams){this._myParams=t,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualLine=new PP.VisualLine,this._myVisualLine.setAutoRefresh(!1),this._myArrowRootObject=null,this._myArrowObject=null,this._myArrowMeshComponent=null,this._myFlatOpaqueMaterial=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(t){this._myVisible!=t&&(this._myVisible=t,this._myVisualLine.setVisible(t),this._myArrowRootObject.pp_setActive(t))}setAutoRefresh(t){this._myAutoRefresh=t}getParams(){return this._myParams}setParams(t){this._myParams=t,this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh(),this._myVisualLine.forceRefresh()}update(t){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualLine.update(t)}_build(){this._myArrowRootObject=WL.scene.addObject(null),this._myArrowObject=WL.scene.addObject(this._myArrowRootObject),this._myArrowMeshComponent=this._myArrowObject.addComponent("mesh")}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let t=new PP.VisualArrowParams;t.myStart.vec3_copy(this._myParams.myStart),t.myDirection.vec3_copy(this._myParams.myDirection),t.myLength=this._myParams.myLength,t.myThickness=this._myParams.myThickness,t.myArrowMesh=this._myParams.myArrowMesh,t.myLineMesh=this._myParams.myLineMesh,this._myParams.myMaterial!=null?t.myMaterial=this._myParams.myMaterial.clone():t.myMaterial=null,this._myParams.myColor!=null?t.myColor.vec4_copy(this._myParams.myColor):t.myColor=null,t.myParent=this._myParams.myParent;let i=new PP.VisualArrow(t);return i.setAutoRefresh(this._myAutoRefresh),i.setVisible(this._myVisible),i._myDirty=this._myDirty,i}};PP.VisualArrow.prototype._refresh=function(){let e=PP.vec3_create(),t=PP.vec3_create(),i=PP.vec3_create(),s=PP.vec3_create(),n=PP.vec3_create(0,1,0);return function(){this._myArrowRootObject.pp_setParent(this._myParams.myParent==null?PP.myVisualData.myRootObject:this._myParams.myParent,!1),this._myParams.myDirection.vec3_scale(Math.max(.001,this._myParams.myLength-this._myParams.myThickness*4),e),e.vec3_add(this._myParams.myStart,e),this._myArrowRootObject.pp_setPositionLocal(e),this._myArrowRootObject.pp_setUpLocal(this._myParams.myDirection,n),t.vec3_set(0,this._myParams.myThickness*2-1e-5,0),this._myArrowRootObject.pp_translateObject(t),this._myArrowObject.pp_resetScaleLocal(),i.vec3_set(this._myParams.myThickness*1.25,this._myParams.myThickness*2,this._myParams.myThickness*1.25),this._myArrowObject.pp_scaleObject(i),this._myParams.myArrowMesh!=null?this._myArrowMeshComponent.mesh=this._myParams.myArrowMesh:this._myArrowMeshComponent.mesh=PP.myDefaultResources.myMeshes.myCone,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myArrowMeshComponent.material=PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone()),this._myArrowMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myArrowMeshComponent.material=this._myParams.myMaterial,s=e.vec3_sub(this._myParams.myStart,s);let r=this._myVisualLine.getParams();r.myStart.vec3_copy(this._myParams.myStart),r.myDirection=s.vec3_normalize(r.myDirection),r.myLength=s.vec3_length(),r.myThickness=this._myParams.myThickness,r.myMesh=this._myParams.myLineMesh,r.myMaterial=this._myArrowMeshComponent.material,r.myParent=this._myParams.myParent,this._myVisualLine.paramsUpdated()}}();Object.defineProperty(PP.VisualArrow.prototype,"_refresh",{enumerable:!1})});var Li=T(()=>{PP.VisualTextParams=class{constructor(){this.myText="",this.myAlignment=WL.Alignment.Center,this.myJustification=WL.Justification.Middle,this.myTransform=PP.mat4_create(),this.myMaterial=null,this.myColor=null,this.myParent=null,this.myType=PP.VisualElementType.TEXT}};PP.VisualText=class{constructor(t=new PP.VisualTextParams){this._myParams=t,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myTextObject=null,this._myTextComponent=null,this._myTextMaterial=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(t){this._myVisible!=t&&(this._myVisible=t,this._myTextObject.pp_setActive(t))}setAutoRefresh(t){this._myAutoRefresh=t}getParams(){return this._myParams}setParams(t){this._myParams=t,this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(t){this._myDirty&&(this._refresh(),this._myDirty=!1)}_refresh(){this._myTextObject.pp_setParent(this._myParams.myParent==null?PP.myVisualData.myRootObject:this._myParams.myParent,!1),this._myTextObject.pp_setTransformLocal(this._myParams.myTransform),this._myParams.myMaterial==null?this._myParams.myColor==null?this._myTextComponent.material=PP.myVisualData.myDefaultMaterials.myDefaultTextMaterial:(this._myTextMaterial==null&&(this._myTextMaterial=PP.myDefaultResources.myMaterials.myText.clone()),this._myTextComponent.material=this._myTextMaterial,this._myTextMaterial.color=this._myParams.myColor):this._myTextComponent.material=this._myParams.myMaterial,this._myTextComponent.text=this._myParams.myText,this._myTextComponent.alignment=this._myParams.myAlignment,this._myTextComponent.justification=this._myParams.myJustification,this._myDirty=!1}_build(){this._myTextObject=WL.scene.addObject(null),this._myTextComponent=this._myTextObject.addComponent("text")}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let t=new PP.VisualTextParams;t.myText=this._myParams.myText,t.myAlignment=this._myParams.myAlignment,t.myJustification=this._myParams.myJustification,t.myTransform.mat4_copy(this._myParams.myTransform),this._myParams.myMaterial!=null?t.myMaterial=this._myParams.myMaterial.clone():t.myMaterial=null,this._myParams.myColor!=null?t.myColor.vec4_copy(this._myParams.myColor):t.myColor=null,t.myParent=this._myParams.myParent;let i=new PP.VisualText(t);return i.setAutoRefresh(this._myAutoRefresh),i.setVisible(this._myVisible),i._myDirty=this._myDirty,i}}});var Vi=T(()=>{PP.VisualTransformParams=class{constructor(){this.myTransform=PP.mat4_create(),this.myLength=.2,this.myThickness=.005,this.myForwardMaterial=null,this.myUpMaterial=null,this.myRightMaterial=null,this.myParent=null,this.myType=PP.VisualElementType.TRANSFORM}};PP.VisualTransform=class{constructor(t=new PP.VisualTransformParams){this._myParams=t,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualRight=new PP.VisualArrow,this._myVisualUp=new PP.VisualArrow,this._myVisualForward=new PP.VisualArrow,this._myVisualRight.setAutoRefresh(!1),this._myVisualUp.setAutoRefresh(!1),this._myVisualForward.setAutoRefresh(!1),this.forceRefresh(),this.setVisible(!0)}setVisible(t){this._myVisible!=t&&(this._myVisible=t,this._myVisualRight.setVisible(t),this._myVisualUp.setVisible(t),this._myVisualForward.setVisible(t))}setAutoRefresh(t){this._myAutoRefresh=t}getParams(){return this._myParams}setParams(t){this._myParams=t,this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh(),this._myVisualRight.forceRefresh(),this._myVisualUp.forceRefresh(),this._myVisualForward.forceRefresh()}update(t){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualRight.update(t),this._myVisualUp.update(t),this._myVisualForward.update(t)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let t=new PP.VisualTransformParams;t.myTransform.mat4_copy(this._myParams.myTransform),t.myLength=this._myParams.myLength,t.myThickness=this._myParams.myThickness,this._myParams.myRightMaterial!=null?t.myRightMaterial=this._myParams.myRightMaterial.clone():t.myRightMaterial=null,this._myParams.myUpMaterial!=null?t.myUpMaterial=this._myParams.myUpMaterial.clone():t.myUpMaterial=null,this._myParams.myForwardMaterial!=null?t.myForwardMaterial=this._myParams.myForwardMaterial.clone():t.myForwardMaterial=null,t.myParent=this._myParams.myParent;let i=new PP.VisualTransform(t);return i.setAutoRefresh(this._myAutoRefresh),i.setVisible(this._myVisible),i._myDirty=this._myDirty,i}};PP.VisualTransform.prototype._refresh=function(){let e=[PP.vec3_create(),PP.vec3_create(),PP.vec3_create()],t=PP.vec3_create(),i=PP.vec3_create();return function(){e=this._myParams.myTransform.mat4_getAxes(e),t=this._myParams.myTransform.mat4_getScale(t);let n=0;for(let a of t)n=Math.max(a,n);n==0?(t[0]=1,t[1]=1,t[2]=1):(t[0]=t[0]/n,t[1]=t[1]/n,t[2]=t[2]/n),i=this._myParams.myTransform.mat4_getPosition(i);{let a=this._myVisualRight.getParams();a.myStart.vec3_copy(i),a.myDirection=e[0].vec3_negate(a.myDirection).vec3_normalize(a.myDirection),a.myLength=Math.max(this._myParams.myLength*t[0],.001),a.myThickness=this._myParams.myThickness,this._myParams.myRightMaterial==null?a.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultRightMaterial:a.myMaterial=this._myParams.myRightMaterial,a.myParent=this._myParams.myParent,this._myVisualRight.paramsUpdated()}{let a=this._myVisualUp.getParams();a.myStart.vec3_copy(i),a.myDirection=e[1].vec3_normalize(a.myDirection),a.myLength=Math.max(this._myParams.myLength*t[1],.001),a.myThickness=this._myParams.myThickness,this._myParams.myUpMaterial==null?a.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultUpMaterial:a.myMaterial=this._myParams.myUpMaterial,a.myParent=this._myParams.myParent,this._myVisualUp.paramsUpdated()}{let a=this._myVisualForward.getParams();a.myStart.vec3_copy(i),a.myDirection=e[2].vec3_normalize(a.myDirection),a.myLength=Math.max(this._myParams.myLength*t[2],.001),a.myThickness=this._myParams.myThickness,this._myParams.myForwardMaterial==null?a.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultForwardMaterial:a.myMaterial=this._myParams.myForwardMaterial,a.myParent=this._myParams.myParent,this._myVisualForward.paramsUpdated()}}}();Object.defineProperty(PP.VisualTransform.prototype,"_refresh",{enumerable:!1})});var Ai=T(()=>{PP.VisualRaycastParams=class{constructor(){this._myRaycastResult=new PP.RaycastResult,this.myHitNormalLength=.2,this.myThickness=.005,this.myShowOnlyFirstHit=!0,this.myRayMaterial=null,this.myHitNormalMaterial=null,this.myParent=null,this.myType=PP.VisualElementType.RAYCAST}get myRaycastResult(){return this._myRaycastResult}set myRaycastResult(t){this._myRaycastResult.copy(t)}};PP.VisualRaycast=class{constructor(t=new PP.VisualRaycastParams){this._myParams=t,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualRaycast=new PP.VisualArrow,this._myVisualRaycast.setAutoRefresh(!1),this._myVisualRaycastHitList=[],this._addVisualRaycastHit(),this.forceRefresh(),this.setVisible(!0)}setVisible(t){if(this._myVisible!=t)if(this._myVisible=t,this._myVisible){if(this._myParams.myRaycastResult.myRaycastSetup!=null&&this._myVisualRaycast.setVisible(!0),this._myParams.myRaycastResult.myHits.length>0){let i=Math.min(this._myParams.myRaycastResult.myHits.length,this._myVisualRaycastHitList.length);for(let s=0;s<i;s++)this._myVisualRaycastHitList[s].setVisible(!0)}}else{this._myVisualRaycast.setVisible(!1);for(let i of this._myVisualRaycastHitList)i.setVisible(!1)}}setAutoRefresh(t){this._myAutoRefresh=t}getParams(){return this._myParams}setParams(t){this._myParams=t,this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){if(this._refresh(),this._myVisualRaycast.forceRefresh(),this._myParams.myRaycastResult.myHits.length>0){let t=Math.min(this._myParams.myRaycastResult.myHits.length,this._myVisualRaycastHitList.length);for(let i=0;i<t;i++)this._myVisualRaycastHitList[i].forceRefresh()}}update(t){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualRaycast.update(t);for(let i of this._myVisualRaycastHitList)i.update(t)}_refresh(){for(let t of this._myVisualRaycastHitList)t.setVisible(!1);if(this._myParams.myRaycastResult.myHits.length>0){let t=this._myParams.myShowOnlyFirstHit?this._myParams.myRaycastResult.myHits.pp_first().myDistance:this._myParams.myRaycastResult.myHits.pp_last().myDistance;{let s=this._myVisualRaycast.getParams();s.myStart.vec3_copy(this._myParams.myRaycastResult.myRaycastSetup.myOrigin),s.myDirection.vec3_copy(this._myParams.myRaycastResult.myRaycastSetup.myDirection),s.myLength=t,s.myThickness=this._myParams.myThickness,this._myParams.myRayMaterial==null?s.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultRayMaterial:s.myMaterial=this._myParams.myRayMaterial,s.myParent=this._myParams.myParent,this._myVisualRaycast.paramsUpdated(),this._myVisualRaycast.setVisible(this._myVisible)}let i=this._myParams.myShowOnlyFirstHit?1:this._myParams.myRaycastResult.myHits.length;for(;i>this._myVisualRaycastHitList.length;)this._addVisualRaycastHit();for(let s=0;s<i;s++){let n=this._myVisualRaycastHitList[s];{let a=n.getParams();a.myStart.vec3_copy(this._myParams.myRaycastResult.myHits[s].myPosition),a.myDirection.vec3_copy(this._myParams.myRaycastResult.myHits[s].myNormal),a.myLength=this._myParams.myHitNormalLength,a.myThickness=this._myParams.myThickness,this._myParams.myHitNormalMaterial==null?a.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultHitNormalMaterial:a.myMaterial=this._myParams.myHitNormalMaterial,a.myParent=this._myParams.myParent,n.paramsUpdated(),n.setVisible(this._myVisible)}}}else if(this._myParams.myRaycastResult.myRaycastSetup!=null){let t=this._myVisualRaycast.getParams();t.myStart.vec3_copy(this._myParams.myRaycastResult.myRaycastSetup.myOrigin),t.myDirection.vec3_copy(this._myParams.myRaycastResult.myRaycastSetup.myDirection),t.myLength=this._myParams.myRaycastResult.myRaycastSetup.myDistance,t.myThickness=this._myParams.myThickness,this._myParams.myRayMaterial==null?t.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultRayMaterial:t.myMaterial=this._myParams.myRayMaterial,t.myParent=this._myParams.myParent,this._myVisualRaycast.paramsUpdated(),this._myVisualRaycast.setVisible(this._myVisible)}else this._myVisualRaycast.setVisible(!1)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let t=new PP.VisualRaycastParams;t.myRaycastResult=this._myParams.myRaycastResult,t.myHitNormalLength=this._myParams.myHitNormalLength,t.myThickness=this._myParams.myThickness,t.myShowOnlyFirstHit=this._myParams.myShowOnlyFirstHit,this._myParams.myRayMaterial!=null?t.myRayMaterial=this._myParams.myRayMaterial.clone():t.myRayMaterial=null,this._myParams.myHitNormalMaterial!=null?t.myHitNormalMaterial=this._myParams.myHitNormalMaterial.clone():t.myHitNormalMaterial=null,t.myParent=this._myParams.myParent;let i=new PP.VisualRaycast(t);return i.setAutoRefresh(this._myAutoRefresh),i.setVisible(this._myVisible),i._myDirty=this._myDirty,i}_addVisualRaycastHit(){let t=new PP.VisualArrow;t.setAutoRefresh(!1),t.setVisible(!1),this._myVisualRaycastHitList.push(t)}}});var Di=T(()=>{PP.VisualTorusParams=class{constructor(){this.myTransform=PP.mat4_create(),this.myRadius=0,this.mySegmentsAmount=12,this.mySegmentThickness=.05,this.mySegmentMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=null,this.myType=PP.VisualElementType.TORUS}};PP.VisualTorus=class{constructor(t=new PP.VisualTorusParams){this._myParams=t,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myTorusRootObject=null,this._myVisualSegmentList=[],this._myFlatOpaqueMaterial=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(t){if(this._myVisible!=t)if(this._myVisible=t,this._myVisible){let i=Math.min(this._myParams.mySegmentsAmount,this._myVisualSegmentList.length);for(let s=0;s<i;s++)this._myVisualSegmentList[s].setVisible(!0)}else for(let i of this._myVisualSegmentList)i.setVisible(!1)}setAutoRefresh(t){this._myAutoRefresh=t}getParams(){return this._myParams}setParams(t){this._myParams=t,this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh();let t=Math.min(this._myParams.mySegmentsAmount,this._myVisualSegmentList.length);for(let i=0;i<t;i++)this._myVisualSegmentList[i].forceRefresh()}update(t){this._myDirty&&(this._refresh(),this._myDirty=!1);for(let i of this._myVisualSegmentList)i.update(t)}_build(){this._myTorusRootObject=WL.scene.addObject(null),this._fillSegmentList()}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}_fillSegmentList(){for(;this._myVisualSegmentList.length<this._myParams.mySegmentsAmount;){let t=new PP.VisualLine;t.setAutoRefresh(!1),t.setVisible(!1),t.getParams().myParent=this._myTorusRootObject,this._myVisualSegmentList.push(t)}}clone(){let t=new PP.VisualTorusParams;t.myRadius=this._myParams.myRadius,t.mySegmentsAmount=this._myParams.mySegmentsAmount,t.mySegmentThickness=this._myParams.mySegmentThickness,t.myTransform.mat4_copy(this._myParams.myTransform),t.mySegmentMesh=this._myParams.mySegmentMesh,this._myParams.myMaterial!=null?t.myMaterial=this._myParams.myMaterial.clone():t.myMaterial=null,this._myParams.myColor!=null?t.myColor.vec4_copy(this._myParams.myColor):t.myColor=null,t.myParent=this._myParams.myParent;let i=new PP.VisualTorus(t);return i.setAutoRefresh(this._myAutoRefresh),i.setVisible(this._myVisible),i._myDirty=this._myDirty,i}};PP.VisualTorus.prototype._refresh=function(){let e=PP.vec3_create(),t=PP.vec3_create(),i=PP.vec3_create(),s=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(0,1,0);return function(){this._fillSegmentList();for(let y of this._myVisualSegmentList)y.setVisible(!1);this._myTorusRootObject.pp_setParent(this._myParams.myParent==null?PP.myVisualData.myRootObject:this._myParams.myParent,!1),this._myTorusRootObject.pp_setTransformLocal(this._myParams.myTransform);let l=2*Math.PI/this._myParams.mySegmentsAmount;e.vec3_set(this._myParams.myRadius,0,0);for(let y=0;y<this._myParams.mySegmentsAmount;y++){t=e.vec3_rotateAxisRadians(l,a,t),i=t.vec3_sub(e,i).vec3_normalize(i);let c=Math.tan(l/2)*this._myParams.mySegmentThickness/2;s=e.vec3_sub(i.vec3_scale(c,s),s),n=t.vec3_add(i.vec3_scale(c,n),n);let o=this._myVisualSegmentList[y],m=o.getParams();m.setStartEnd(s,n),m.myThickness=this._myParams.mySegmentThickness,m.myMesh=this._myParams.mySegmentMesh,this._myParams.myMaterial==null?this._myParams.myColor==null?m.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone()),m.myMaterial=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):m.myMaterial=this._myParams.myMaterial,o.paramsUpdated(),o.setVisible(this._myVisible),e.vec3_copy(t)}}}();Object.defineProperty(PP.VisualTorus.prototype,"_refresh",{enumerable:!1})});var Ri=T(()=>{WL.registerComponent("pp-visual-manager",{},{init:function(){this.active&&(PP.myVisualData.myRootObject=WL.scene.addObject(null),PP.myVisualManager=new PP.VisualManager)},start(){PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultTextMaterial=PP.myDefaultResources.myMaterials.myText.clone(),PP.myVisualData.myDefaultMaterials.myDefaultRightMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultRightMaterial.color=[1,0,0,1],PP.myVisualData.myDefaultMaterials.myDefaultUpMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultUpMaterial.color=[0,1,0,1],PP.myVisualData.myDefaultMaterials.myDefaultForwardMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultForwardMaterial.color=[0,0,1,1],PP.myVisualData.myDefaultMaterials.myDefaultRayMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultRayMaterial.color=[0,1,0,1],PP.myVisualData.myDefaultMaterials.myDefaultHitNormalMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultHitNormalMaterial.color=[1,0,0,1],PP.myVisualManager.start()},update(e){PP.myVisualManager.update(e)}});PP.myVisualManager=null;PP.myVisualData={myRootObject:null,myDefaultMaterials:{myDefaultMeshMaterial:null,myDefaultTextMaterial:null,myDefaultRightMaterial:null,myDefaultUpMaterial:null,myDefaultForwardMaterial:null,myDefaultRayMaterial:null,myDefaultHitNormalMaterial:null}}});var Ei=T(()=>{PP.DebugManager=class{constructor(){this._myDebugVisualManager=new PP.DebugVisualManager}getDebugVisualManager(){return this._myDebugVisualManager}start(){this._myDebugVisualManager.start()}update(t){this._myDebugVisualManager.update(t)}}});var Oi=T(()=>{PP.DebugVisualManager=class extends PP.VisualManager{drawLine(t,i,s,n,a=[0,1,0,1],r=.005){let l=new PP.VisualLineParams;l.myStart.vec3_copy(i),l.myDirection.vec3_copy(s),l.myLength=n,l.myThickness=r,l.myColor=PP.vec4_create(),l.myColor.vec4_copy(a),this.draw(l,t)}drawLineEnd(t,i,s,n=[0,1,0,1],a=.005){}drawArrow(t,i,s,n,a=[0,1,0,1],r=.005){let l=new PP.VisualArrowParams;l.myStart.vec3_copy(i),l.myDirection.vec3_copy(s),l.myLength=n,l.myThickness=r,l.myColor=PP.vec4_create(),l.myColor.vec4_copy(a),this.draw(l,t)}drawArrowEnd(t,i,s,n=[0,1,0,1],a=.005){}drawPoint(t,i,s=[0,1,0,1],n=.005){let a=new PP.VisualPointParams;a.myPosition.vec3_copy(i),a.myRadius=n,a.myColor=PP.vec4_create(),a.myColor.vec4_copy(s),this.draw(a,t)}drawText(t,i,s,n=[0,1,0,1],a=WL.Alignment.Center,r=WL.Justification.Middle){let l=new PP.VisualTextParams;l.myText=i,l.myAlignment=a,l.myJustification=r,l.myTransform.mat4_copy(s),l.myColor=PP.vec4_create(),l.myColor.vec4_copy(n),this.draw(l,t)}drawRaycast(t,i,s=!0,n=.2,a=.005){let r=new PP.VisualRaycastParams;r.myRaycastResult=i,r.myShowOnlyFirstHit=s,r.myHitNormalLength=n,r.myThickness=a,this.draw(r,t)}drawTransform(t,i,s=.2,n=.005){let a=new PP.VisualTransformParams;a.myTransform.mat4_copy(i),a.myLength=s,a.myThickness=n,this.draw(a,t)}};PP.DebugVisualManager.prototype.drawLineEnd=function(){let e=PP.vec3_create();return function(i,s,n,a=[0,1,0,1],r=.005){e=n.vec3_sub(s,e),length=e.vec3_length(),e.vec3_normalize(e),this.drawLine(i,s,e,length,a,r)}}();PP.DebugVisualManager.prototype.drawArrowEnd=function(){let e=PP.vec3_create();return function(i,s,n,a=[0,1,0,1],r=.005){e=n.vec3_sub(s,e),length=e.vec3_length(),e.vec3_normalize(e),this.drawArrow(i,s,e,length,a,r)}}();Object.defineProperty(PP.DebugVisualManager.prototype,"drawLineEnd",{enumerable:!1});Object.defineProperty(PP.DebugVisualManager.prototype,"drawArrowEnd",{enumerable:!1})});var Wi=T(()=>{WL.registerComponent("pp-debug-transform",{_myLength:{type:WL.Type.Float,default:.1},_myThickness:{type:WL.Type.Float,default:.005}},{init:function(){},start:function(){this._myDebugTransformParams=new PP.VisualTransformParams,this._myDebugTransformParams.myLength=this._myLength,this._myDebugTransformParams.myThickness=this._myThickness},update:function(e){this.object.pp_getTransform(this._myDebugTransformParams.myTransform),PP.myDebugVisualManager.draw(this._myDebugTransformParams)}})});var ki=T(()=>{WL.registerComponent("pp-debug-manager",{},{init:function(){this.active&&(PP.myDebugManager=new PP.DebugManager,PP.myDebugVisualManager=PP.myDebugManager.getDebugVisualManager())},start(){PP.myDebugManager.start()},update(e){PP.myDebugManager.update(e)}});PP.myDebugManager=null;PP.myDebugVisualManager=null});var ji=T(()=>{PP.Direction2DTo3DConverterParams=class{constructor(){this.myStartFlyingForward=!1,this.myStartFlyingRight=!1,this.myAutoUpdateFlyForward=!1,this.myAutoUpdateFlyRight=!1,this.myResetFlyForwardWhenZero=!1,this.myResetFlyRightWhenZero=!1,this.myMinAngleToFlyForwardUp=90,this.myMinAngleToFlyForwardDown=90,this.myMinAngleToFlyRightUp=90,this.myMinAngleToFlyRightDown=90}};PP.Direction2DTo3DConverter=class{constructor(t=new PP.Direction2DTo3DConverterParams){this._myParams=t,this._myIsFlyingForward=this._myParams.myStartFlyingForward,this._myIsFlyingRight=this._myParams.myStartFlyingRight,this._myLastValidFlatForward=PP.vec3_create(),this._myLastValidFlatRight=PP.vec3_create(),this._myMinAngleToBeValid=5}convert(t,i,s=null,n=PP.vec3_create()){return this.convertTransform(t,i,s,n)}isFlying(){return this._myIsFlyingForward||this._myIsFlyingRight}isFlyingForward(){return this._myIsFlyingForward}isFlyingRight(){return this._myIsFlyingRight}startFlying(){this._myIsFlyingForward=!0,this._myIsFlyingRight=!0}startFlyingForward(){this._myIsFlyingForward=!0}startFlyingRight(){this._myIsFlyingRight=!0}stopFlying(){this._myIsFlyingForward=!1,this._myIsFlyingRight=!1}stopFlyingForward(){this._myIsFlyingForward=!1}stopFlyingRight(){this._myIsFlyingRight=!1}resetFly(){this.resetFlyForward(),this.resetFlyRight()}resetFlyForward(){this._myParams.myStartFlyingForward?this.startFlyingForward():this.stopFlyingForward(),this._myLastValidFlatForward.vec3_zero()}resetFlyRight(){this._myParams.myStartFlyingRight?this.startFlyingRight():this.stopFlyingRight(),this._myLastValidFlatRight.vec3_zero()}convertForward(t,i,s=null,n=PP.vec3_create()){}convertTransform(t,i,s=null,n=PP.vec3_create()){return this.convertTransformMatrix(t,i,s,n)}convertTransformMatrix(t,i,s=null,n=PP.vec3_create()){}convertTransformQuat(t,i,s=null,n=PP.vec3_create()){}convertRotationQuat(t,i,s=null,n=PP.vec3_create()){}};PP.Direction2DTo3DConverter.prototype.convertForward=function(){let e=PP.quat_create();return function(i,s,n=null,a=PP.vec3_create()){return e.quat_identity(),e.quat_setForward(s,n),this.convertRotationQuat(i,e,n,a)}}();PP.Direction2DTo3DConverter.prototype.convertTransformMatrix=function(){let e=PP.quat_create();return function(i,s,n=null,a=PP.vec3_create()){return e=s.mat4_getRotationQuat(e),this.convertRotationQuat(i,e,n,a)}}();PP.Direction2DTo3DConverter.prototype.convertTransformQuat=function(){let e=PP.quat_create();return function(i,s,n=null,a=PP.vec3_create()){return e=s.quat2_getRotationQuat(e),this.convertRotationQuat(i,e,n,a)}}();PP.Direction2DTo3DConverter.prototype.convertRotationQuat=function(){let e=PP.vec3_create(),t=PP.vec3_create(),i=PP.vec3_create(),s=PP.vec3_create(),n=PP.vec3_create();return function(r,l,y=null,c=PP.vec3_create()){if(r.vec2_isZero())return this._myParams.myAutoUpdateFlyForward&&this._myParams.myResetFlyForwardWhenZero&&this.resetFlyForward(),this._myParams.myAutoUpdateFlyRight&&this._myParams.myResetFlyRightWhenZero&&this.resetFlyRight(),[0,0,0];if(r[0]==0&&this._myLastValidFlatRight.vec3_zero(),r[1]==0&&this._myLastValidFlatForward.vec3_zero(),e=l.quat_getForward(e),t=l.quat_getRight(t),y!=null){if(i=y.vec3_negate(i),this._myParams.myAutoUpdateFlyForward){let o=e.vec3_angle(y);this._myIsFlyingForward=this._myIsFlyingForward||o<90-this._myParams.myMinAngleToFlyForwardUp||o>90+this._myParams.myMinAngleToFlyForwardDown}if(this._myParams.myAutoUpdateFlyRight){let o=t.vec3_angle(y);this._myIsFlyingRight=this._myIsFlyingRight||o<90-this._myParams.myMinAngleToFlyRightUp||o>90+this._myParams.myMinAngleToFlyRightDown}this._myIsFlyingForward||(!this._myLastValidFlatForward.vec3_isZero(1e-6)&&(e.vec3_angle(y)<this._myMinAngleToBeValid||e.vec3_angle(i)<this._myMinAngleToBeValid)&&(e.vec3_isConcordant(this._myLastValidFlatForward)?e.pp_copy(this._myLastValidFlatForward):e=this._myLastValidFlatForward.vec3_negate(e)),e=e.vec3_removeComponentAlongAxis(y,e),e.vec3_normalize(e)),this._myIsFlyingRight||(!this._myLastValidFlatRight.vec3_isZero(1e-6)&&(t.vec3_angle(y)<this._myMinAngleToBeValid||t.vec3_angle(i)<this._myMinAngleToBeValid)&&(t.vec3_isConcordant(this._myLastValidFlatRight)?t.pp_copy(this._myLastValidFlatRight):t=this._myLastValidFlatRight.vec3_negate(t)),t=t.vec3_removeComponentAlongAxis(y,t),t.vec3_normalize(t)),(e.vec3_angle(y)>this._myMinAngleToBeValid&&e.vec3_angle(i)>this._myMinAngleToBeValid||r[1]!=0&&this._myLastValidFlatForward.vec3_isZero(1e-6))&&(this._myLastValidFlatForward=e.vec3_removeComponentAlongAxis(y,this._myLastValidFlatForward),this._myLastValidFlatForward.vec3_normalize(this._myLastValidFlatForward)),(t.vec3_angle(y)>this._myMinAngleToBeValid&&t.vec3_angle(i)>this._myMinAngleToBeValid||r[0]!=0&&this._myLastValidFlatRight.vec3_isZero(1e-6))&&(this._myLastValidFlatRight=t.vec3_removeComponentAlongAxis(y,this._myLastValidFlatRight),this._myLastValidFlatRight.vec3_normalize(this._myLastValidFlatRight))}return c=t.vec3_scale(r[0],n).vec3_add(e.vec3_scale(r[1],s),c),y!=null&&!this._myIsFlyingForward&&!this._myIsFlyingRight&&(c=c.vec3_removeComponentAlongAxis(y,c)),c.vec3_normalize(c),c}}()});var Fi=T(()=>{WL.registerComponent("pp-grabbable",{_myThrowLinearVelocityMultiplier:{type:WL.Type.Float,default:1},_myThrowAngularVelocityMultiplier:{type:WL.Type.Float,default:1},_myKinematicValueOnRelease:{type:WL.Type.Enum,values:["true","false","keep"],default:"false"}},{init:function(){this._myIsGrabbed=!1,this._myGrabber=null,this._myGrabCallbacks=new Map,this._myThrowCallbacks=new Map,this._myReleaseCallbacks=new Map},start:function(){this._myOldParent=this.object.parent,this._myPhysX=this.object.pp_getComponent("physx"),this._myOldKinematicValue=null},onDeactivate:function(){this.release()},grab:function(e){this.isGrabbed()||(this._myOldKinematicValue=this._myPhysX.kinematic),this.release(),this._myPhysX.kinematic=!0,this._myOldParent=this.object.parent,this.object.pp_setParent(e),this._myIsGrabbed=!0,this._myGrabCallbacks.forEach(function(t){t(e,this)}.bind(this))},throw:function(e,t){if(this._myIsGrabbed){let i=this._myGrabber;this._release(),this._myPhysX.linearVelocity=e.vec3_scale(this._myThrowLinearVelocityMultiplier),this._myPhysX.angularVelocity=t.vec3_scale(this._myThrowAngularVelocityMultiplier),this._myThrowCallbacks.forEach(function(s){s(i,this)}.bind(this)),this._myReleaseCallbacks.forEach(function(s){s(i,this,!0)}.bind(this))}},release(){if(this._myIsGrabbed){let e=this._myGrabber;this._release(),this._myReleaseCallbacks.forEach(function(t){t(e,this,!1)}.bind(this))}},getLinearVelocity(){let e=PP.vec3_create();return this._myPhysX.linearVelocity.vec3_clone(e),e},getAngularVelocity(){return this.getAngularVelocityDegrees()},getAngularVelocityDegrees(){let e=PP.vec3_create();return this._myPhysX.angularVelocity.vec3_toDegrees(e),e},getAngularVelocityRadians(){let e=PP.vec3_create();return this._myPhysX.angularVelocity.vec3_clone(e),e},isGrabbed(){return this._myIsGrabbed},getGrabber(){return this._myGrabber},registerGrabEventListener(e,t){this._myGrabCallbacks.set(e,t)},unregisterGrabEventListener(e){this._myGrabCallbacks.delete(e)},registerThrowEventListener(e,t){this._myThrowCallbacks.set(e,t)},unregisterThrowEventListener(e){this._myThrowCallbacks.delete(e)},registerReleaseEventListener(e,t){this._myReleaseCallbacks.set(e,t)},unregisterReleaseEventListener(e){this._myReleaseCallbacks.delete(e)},_release(){this.object.pp_setParent(this._myOldParent),this._myIsGrabbed=!1,this._myGrabber=null,this._myKinematicValueOnRelease==0?this._myPhysX.kinematic=!0:this._myKinematicValueOnRelease==1?this._myPhysX.kinematic=!1:this._myOldKinematicValue!=null&&(this._myPhysX.kinematic=this._myOldKinematicValue),this._myPhysX.kinematic&&(this._myPhysX.linearVelocity=[0,0,0],this._myPhysX.angularVelocity=[0,0,0])}})});var Hi=T(()=>{WL.registerComponent("pp-grabber-hand",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myGrabButton:{type:WL.Type.Enum,values:["select","squeeze","both","both_exclusive"],default:"squeeze"},_mySnapOnPivot:{type:WL.Type.Bool,default:!1},_myMaxNumberOfObjects:{type:WL.Type.Int,default:1},_myThrowVelocitySource:{type:WL.Type.Enum,values:["hand","grabbable"],default:"hand"},_myThrowLinearVelocityMultiplier:{type:WL.Type.Float,default:1},_myThrowMaxLinearSpeed:{type:WL.Type.Float,default:15},_myThrowAngularVelocityMultiplier:{type:WL.Type.Float,default:.5},_myThrowMaxAngularSpeed:{type:WL.Type.Float,default:1080},_myThrowLinearVelocityBoost:{type:WL.Type.Float,default:1.75},_myThrowLinearVelocityBoostMinSpeedThreshold:{type:WL.Type.Float,default:.6},_myThrowLinearVelocityBoostMaxSpeedThreshold:{type:WL.Type.Float,default:2.5}},{init:function(){this._myGrabbables=[],this._myGamepad=null,this._myActiveGrabButton=null,this._myLinearVelocityHistorySize=5,this._myLinearVelocityHistorySpeedAverageSamplesFromStart=1,this._myLinearVelocityHistoryDirectionAverageSamplesFromStart=3,this._myLinearVelocityHistoryDirectionAverageSkipFromStart=0,this._myHandLinearVelocityHistory=new Array(this._myLinearVelocityHistorySize),this._myHandLinearVelocityHistory.fill([0,0,0]),this._myAngularVelocityHistorySize=1,this._myHandAngularVelocityHistory=new Array(this._myAngularVelocityHistorySize),this._myHandAngularVelocityHistory.fill([0,0,0]),this._myThrowMaxAngularSpeedRadians=Math.pp_toRadians(this._myThrowMaxAngularSpeed),this._myGrabCallbacks=new Map,this._myThrowCallbacks=new Map,this._myDebugActive=!1},start:function(){this._myHandedness==PP.HandednessIndex.LEFT?this._myGamepad=PP.myLeftGamepad:this._myGamepad=PP.myRightGamepad,this._myPhysX=this.object.pp_getComponent("physx"),this._myCollisionsCollector=new PP.PhysXCollisionCollector(this._myPhysX,!0)},update:function(e){this._myCollisionsCollector.update(e),this._myGrabbables.length>0&&(this._updateLinearVelocityHistory(),this._updateAngularVelocityHistory())},grab:function(e=null){this._grab(e)},throw:function(e=null){this._throw(e)},registerGrabEventListener(e,t){this._myGrabCallbacks.set(e,t)},unregisterGrabEventListener(e){this._myGrabCallbacks.delete(e)},registerThrowEventListener(e,t){this._myThrowCallbacks.set(e,t)},unregisterThrowEventListener(e){this._myThrowCallbacks.delete(e)},onActivate(){this._myGamepad!=null&&(this._myGrabButton==0?(this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_START,this,this._grab.bind(this,PP.GamepadButtonID.SELECT)),this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_END,this,this._throw.bind(this,PP.GamepadButtonID.SELECT))):this._myGrabButton==1?(this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_START,this,this._grab.bind(this,PP.GamepadButtonID.SQUEEZE)),this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_END,this,this._throw.bind(this,PP.GamepadButtonID.SQUEEZE))):(this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_START,this,this._grab.bind(this,PP.GamepadButtonID.SQUEEZE)),this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_END,this,this._throw.bind(this,PP.GamepadButtonID.SQUEEZE)),this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_START,this,this._grab.bind(this,PP.GamepadButtonID.SELECT)),this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_END,this,this._throw.bind(this,PP.GamepadButtonID.SELECT))))},onDeactivate(){this._myGamepad!=null&&(this._myGrabButton==0?(this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_END,this)):this._myGrabButton==1?(this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_END,this)):(this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_END,this),this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_END,this)))},_grab:function(e){if(!(this._myGrabbables.length>=this._myMaxNumberOfObjects)&&(this._myGrabButton==2||this._myActiveGrabButton==null||this._myActiveGrabButton==e||e==null)){let t=[],i=this._myCollisionsCollector.getCollisions();for(let n=0;n<i.length;n++){let a=i[n].getComponent("pp-grabbable");a&&a.active&&t.push(a)}let s=this.object.pp_getPosition();t.sort(function(n,a){let r=n.object.pp_getPosition(),l=a.object.pp_getPosition(),y=r.vec3_distance(s),c=l.vec3_distance(s);return Math.pp_sign(y-c,0)});for(let n of t){if(!this._isAlreadyGrabbed(n)){let a=new PP.GrabberHandGrabbableData(n,this._myThrowVelocitySource==1,this._myLinearVelocityHistorySize,this._myAngularVelocityHistorySize);this._myGrabbables.push(a),n.grab(this.object),n.registerReleaseEventListener(this,this._onRelease.bind(this)),this._mySnapOnPivot&&n.object.resetTranslation(),this._myGrabCallbacks.forEach(function(r){r(this,n)}.bind(this))}if(this._myGrabbables.length>=this._myMaxNumberOfObjects)break}this._myGrabbables.length>0&&this._myActiveGrabButton==null&&(this._myActiveGrabButton=e)}},_throw:function(e){if(this._myGrabButton==2||this._myActiveGrabButton==null||this._myActiveGrabButton==e||e==null){if(this._myGrabbables.length>0){let t=null,i=null;this._myThrowVelocitySource==0&&(t=this._computeReleaseLinearVelocity(this._myHandLinearVelocityHistory),i=this._computeReleaseAngularVelocity(this._myHandAngularVelocityHistory));for(let s of this._myGrabbables){let n=s.getGrabbable();n.unregisterReleaseEventListener(this),this._myThrowVelocitySource==1&&(t=this._computeReleaseLinearVelocity(s.getLinearVelocityHistory()),i=this._computeReleaseAngularVelocity(s.getAngularVelocityHistory())),n.throw(t,i),this._myThrowCallbacks.forEach(function(a){a(this,n)}.bind(this))}this._myGrabbables=[]}this._myActiveGrabButton=null}},_onRelease(e,t){t.unregisterReleaseEventListener(this),this._myGrabbables.pp_remove(i=>i.getGrabbable()==t),this._myGrabbables.length<=0&&(this._myActiveGrabButton=null)},_updateLinearVelocityHistory(){let e=this._myGamepad.getHandPose();this._myHandLinearVelocityHistory.unshift(e.getLinearVelocity().pp_clone()),this._myHandLinearVelocityHistory.pop();for(let t of this._myGrabbables)t.updateLinearVelocityHistory()},_updateAngularVelocityHistory(){let e=this._myGamepad.getHandPose();this._myHandAngularVelocityHistory.unshift(e.getAngularVelocityRadians().pp_clone()),this._myHandAngularVelocityHistory.pop();for(let t of this._myGrabbables)t.updateAngularVelocityHistory()},_computeReleaseLinearVelocity(e){let t=e[0].vec3_length();for(let l=1;l<this._myLinearVelocityHistorySpeedAverageSamplesFromStart;l++)t+=e[l].vec3_length();t/=this._myLinearVelocityHistorySpeedAverageSamplesFromStart;let i=Math.pp_mapToRange(t,this._myThrowLinearVelocityBoostMinSpeedThreshold,this._myThrowLinearVelocityBoostMaxSpeedThreshold,0,1);i=PP.EasingFunction.easeIn(i),t+=t*(i*this._myThrowLinearVelocityBoost),t*=this._myThrowLinearVelocityMultiplier,t=Math.pp_clamp(t,0,this._myThrowMaxLinearSpeed),this._myDebugActive&&this._debugDirectionLines(e);let n=this._myLinearVelocityHistoryDirectionAverageSamplesFromStart,a=this._myLinearVelocityHistoryDirectionAverageSkipFromStart+this._myLinearVelocityHistoryDirectionAverageSamplesFromStart,r=[0,0,0];for(let l=this._myLinearVelocityHistoryDirectionAverageSkipFromStart;l<a;l++){let y=e[l];y.vec3_scale(n,y),r.vec3_add(y,r),n--}return r.vec3_normalize(r),r.vec3_scale(t,r),r},_computeReleaseAngularVelocity(e){let t=e[0],i=t.vec3_length();i=Math.pp_clamp(i*this._myThrowAngularVelocityMultiplier,0,this._myThrowMaxAngularSpeedRadians);let s=t;return s.vec3_normalize(s),s.vec3_scale(i,s),s},_debugDirectionLines(e){for(let t=this._myLinearVelocityHistoryDirectionAverageSkipFromStart+this._myLinearVelocityHistoryDirectionAverageSamplesFromStart;t>this._myLinearVelocityHistoryDirectionAverageSkipFromStart;t--){let i=t-this._myLinearVelocityHistoryDirectionAverageSkipFromStart,s=t-this._myLinearVelocityHistoryDirectionAverageSkipFromStart,n=[0,0,0];for(let r=this._myLinearVelocityHistoryDirectionAverageSkipFromStart;r<s;r++){let l=e[r].pp_clone();l.vec3_scale(i,l),n.vec3_add(l,n),i--}n.vec3_normalize(n);let a=1/t;PP.myDebugVisualManager.drawLine(5,this.object.pp_getPosition(),n,.2,[olor,a,a,1])}},_isAlreadyGrabbed(e){return this._myGrabbables.pp_find(i=>i.getGrabbable()==e)!=null}});PP.GrabberHandGrabbableData=class{constructor(t,i,s,n){this._myGrabbable=t,this._myUseGrabbableAsVelocitySource=i,this._myUseGrabbableAsVelocitySource&&(this._myLinearVelocityHistory=new Array(s),this._myLinearVelocityHistory.fill([0,0,0]),this._myAngularVelocityHistory=new Array(n),this._myAngularVelocityHistory.fill([0,0,0]))}getGrabbable(){return this._myGrabbable}getLinearVelocityHistory(){return this._myLinearVelocityHistory}getAngularVelocityHistory(){return this._myAngularVelocityHistory}updateLinearVelocityHistory(){this._myUseGrabbableAsVelocitySource&&(this._myLinearVelocityHistory.unshift(this._myGrabbable.getLinearVelocity()),this._myLinearVelocityHistory.pop())}updateAngularVelocityHistory(){this._myUseGrabbableAsVelocitySource&&(this._myAngularVelocityHistory.unshift(this._myGrabbable.getAngularVelocityRadians()),this._myAngularVelocityHistory.pop())}}});var wi=T(()=>{WL.registerComponent("pp-finger-cursor",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myEnableMultipleClicks:{type:WL.Type.Bool,default:!0},_myCollisionGroup:{type:WL.Type.Int,default:1},_myCollisionSize:{type:WL.Type.Float,default:.0125},_myCursorObject:{type:WL.Type.Object,default:null}},{init:function(){this._myLastTarget=null,this._myReferenceSpace=null,this._myHandInputSource=null,this._myHandednessString=["left","right"][this._myHandedness],this._myDoubleClickTimer=0,this._myTripleClickTimer=0,this._myMultipleClickObject=null,this._myMultipleClickDelay=.3},start:function(){this._myCursorObjectRoot=WL.scene.addObject(null),this._myCursorObject==null?this._myCursorObject=this._myCursorObjectRoot.pp_addObject():this._myCursorObject.pp_setParent(this._myCursorObjectRoot),this._myCollisionComponent=this._myCursorObject.addComponent("collision"),this._myCollisionComponent.collider=WL.Collider.Sphere,this._myCollisionComponent.group=1<<this._myCollisionGroup,this._myCollisionComponent.extents=[this._myCollisionSize,this._myCollisionSize,this._myCollisionSize],WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))},update:function(e){if(this._myDoubleClickTimer>0&&(this._myDoubleClickTimer-=e),this._myTripleClickTimer>0&&(this._myTripleClickTimer-=e),this._myCursorObjectRoot.pp_setTransformQuat(PP.myPlayerObjects.myPlayerPivot.pp_getTransformQuat()),this._updateHand(),this._myHandInputSource){let t=this._myCollisionComponent.queryOverlaps(),i=null;for(let s=0;s<t.length;++s){let a=t[s].object.getComponent("cursor-target");if(a&&(i==null||!a.isSurface)&&(i=a,!a.isSurface))break}i?i.equals(this._myLastTarget)||(this._targetTouchEnd(),this._myLastTarget=i,this._targetTouchStart()):this._targetTouchEnd()}else this._targetTouchEnd()},_targetTouchStart:function(){this._myLastTarget.onHover(this._myLastTarget.object,this),this._myLastTarget.onDown(this._myLastTarget.object,this)},_targetTouchEnd:function(){this._myLastTarget&&(this._myEnableMultipleClicks&&this._myTripleClickTimer>0&&this._myMultipleClickObject&&this._myMultipleClickObject.equals(this._myLastTarget.object)?(this._myLastTarget.onTripleClick(this._myLastTarget.object,this),this._myTripleClickTimer=0):this._myEnableMultipleClicks&&this._myDoubleClickTimer>0&&this._myMultipleClickObject&&this._myMultipleClickObject.equals(this._myLastTarget.object)?(this._myLastTarget.onDoubleClick(this._myLastTarget.object,this),this._myTripleClickTimer=this._myMultipleClickDelay,this._myDoubleClickTimer=0):(this._myLastTarget.onClick(this._myLastTarget.object,this),this._myTripleClickTimer=0,this._myDoubleClickTimer=this._myMultipleClickDelay,this._myMultipleClickObject=this._myLastTarget.object),this._myLastTarget.onUp(this._myLastTarget.object,this),this._myLastTarget.onUnhover(this._myLastTarget.object,this),this._myLastTarget=null)},onActivate:function(){this._myCursorObjectRoot.pp_setActive(!0)},onDeactivate:function(){this._myCursorObjectRoot.pp_setActive(!1)},_updateHand(){if(this._myHandInputSource=PP.InputUtils.getInputSource(this._myHandednessString,PP.InputSourceType.TRACKED_HAND),this._myHandInputSource){let e=Module.webxr_frame.getJointPose(this._myHandInputSource.hand.get("index-finger-tip"),this._myReferenceSpace);e&&(this._myCursorObject.pp_setRotationLocalQuat([e.transform.orientation.x,e.transform.orientation.y,e.transform.orientation.z,e.transform.orientation.w]),this._myCursorObject.pp_setPositionLocal([e.transform.position.x,e.transform.position.y,e.transform.position.z]))}},_onXRSessionStart:function(e){e.requestReferenceSpace(WebXR.refSpace).then(function(t){this._myReferenceSpace=t}.bind(this))},_onXRSessionEnd:function(e){this._myReferenceSpace=null}})});var Ni=T(()=>{PP.Handedness={LEFT:"left",RIGHT:"right"};PP.HandednessIndex={LEFT:0,RIGHT:1};PP.InputSourceType={GAMEPAD:0,TRACKED_HAND:1};PP.TrackedHandJointID={WRIST:"wrist",THUMB_METACARPAL:"thumb-metacarpal",THUMB_PHALANX_PROXIMAL:"thumb-phalanx-proximal",THUMB_PHALANX_DISTAL:"thumb-phalanx-distal",THUMB_TIP:"thumb-tip",INDEX_FINGER_METACARPAL:"index-finger-metacarpal",INDEX_FINGER_PHALANX_PROXIMAL:"index-finger-phalanx-proximal",INDEX_FINGER_PHALANX_INTERMEDIATE:"index-finger-phalanx-intermediate",INDEX_FINGER_PHALANX_DISTAL:"index-finger-phalanx-distal",INDEX_FINGER_TIP:"index-finger-tip",MIDDLE_FINGER_METACARPAL:"middle-finger-metacarpal",MIDDLE_FINGER_PHALANX_PROXIMAL:"middle-finger-phalanx-proximal",MIDDLE_FINGER_PHALANX_INTERMEDIATE:"middle-finger-phalanx-intermediate",MIDDLE_FINGER_PHALANX_DISTAL:"middle-finger-phalanx-distal",MIDDLE_FINGER_TIP:"middle-finger-tip",RING_FINGER_METACARPAL:"ring-finger-metacarpal",RING_FINGER_PHALANX_PROXIMAL:"ring-finger-phalanx-proximal",RING_FINGER_PHALANX_INTERMEDIATE:"ring-finger-phalanx-intermediate",RING_FINGER_PHALANX_DISTAL:"ring-finger-phalanx-distal",RING_FINGER_TIP:"ring-finger-tip",PINKY_FINGER_METACARPAL:"pinky-finger-metacarpal",PINKY_FINGER_PHALANX_PROXIMAL:"pinky-finger-phalanx-proximal",PINKY_FINGER_PHALANX_INTERMEDIATE:"pinky-finger-phalanx-intermediate",PINKY_FINGER_PHALANX_DISTAL:"pinky-finger-phalanx-distal",PINKY_FINGER_TIP:"pinky-finger-tip"};PP.TrackedHandJointIDIndex={WRIST:0,THUMB_METACARPAL:1,THUMB_PHALANX_PROXIMAL:2,THUMB_PHALANX_DISTAL:3,THUMB_TIP:4,INDEX_FINGER_METACARPAL:5,INDEX_FINGER_PHALANX_PROXIMAL:6,INDEX_FINGER_PHALANX_INTERMEDIATE:7,INDEX_FINGER_PHALANX_DISTAL:8,INDEX_FINGER_TIP:9,MIDDLE_FINGER_METACARPAL:10,MIDDLE_FINGER_PHALANX_PROXIMAL:11,MIDDLE_FINGER_PHALANX_INTERMEDIATE:12,MIDDLE_FINGER_PHALANX_DISTAL:13,MIDDLE_FINGER_TIP:14,RING_FINGER_METACARPAL:15,RING_FINGER_PHALANX_PROXIMAL:16,RING_FINGER_PHALANX_INTERMEDIATE:17,RING_FINGER_PHALANX_DISTAL:18,RING_FINGER_TIP:19,PINKY_FINGER_METACARPAL:20,PINKY_FINGER_PHALANX_PROXIMAL:21,PINKY_FINGER_PHALANX_INTERMEDIATE:22,PINKY_FINGER_PHALANX_DISTAL:23,PINKY_FINGER_TIP:24}});var Gi=T(()=>{PP.InputUtils={getHandednessByIndex:function(e){let t=null;switch(e){case PP.HandednessIndex.LEFT:t=PP.Handedness.LEFT;break;case PP.HandednessIndex.RIGHT:t=PP.Handedness.RIGHT;break}return t},getInputSource:function(e,t){let i=null;if(WL.xrSession&&WL.xrSession.inputSources)for(let s=0;s<WL.xrSession.inputSources.length;s++){let n=WL.xrSession.inputSources[s];if((!t||t==PP.InputSourceType.GAMEPAD&&!n.hand||t==PP.InputSourceType.TRACKED_HAND&&n.hand)&&n.handedness==e){i=n;break}}return i},getInputSourceTypeByHandedness:function(e){let t=PP.InputUtils.getInputSource(e);return PP.InputUtils.getInputSourceType(t)},getInputSourceType:function(e){let t=null;return e&&(e.hand?t=PP.InputSourceType.TRACKED_HAND:t=PP.InputSourceType.GAMEPAD),t},getOppositeHandedness:function(e){let t=null;switch(e){case PP.Handedness.LEFT:t=PP.Handedness.RIGHT;break;case PP.Handedness.RIGHT:t=PP.Handedness.LEFT;break}return t},getJointIDByIndex:function(e){let t=null,i=null;for(let s in PP.TrackedHandJointIDIndex)if(PP.TrackedHandJointIDIndex[s]==e){i=s;break}return i!=null&&(t=PP.TrackedHandJointID[i]),t}}});var Ui=T(()=>{PP.KeyID={_0:"0",_1:"1",_2:"2",_3:"3",_4:"4",_5:"5",_6:"6",_7:"7",_8:"8",_9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z",UP:"ArrowUp",DOWN:"ArrowDown",LEFT:"ArrowLeft",RIGHT:"ArrowRight",SPACE:" ",ENTER:"Enter",BACKSPACE:"Backspace",ESC:"Escape",SHIFT_LEFT:"ShiftLeft",SHIFT_RIGHT:"ShiftRight",CONTROL_LEFT:"ControlLeft",CONTROL_RIGHT:"ControlRight",ALT_LEFT:"AltLeft",ALT_RIGHT:"AltRight"};PP.Keyboard=class{constructor(){this._myKeyInfos=new Map;for(let t in PP.KeyID)this.addKey(PP.KeyID[t])}isKeyPressed(t){let i=!1;return this._myKeyInfos.has(t)&&(i=this._myKeyInfos.get(t).myIsPressed),i}isKeyPressStart(t){let i=!1;return this._myKeyInfos.has(t)&&(i=this._myKeyInfos.get(t).myIsPressStart),i}isKeyPressEnd(t){let i=!1;return this._myKeyInfos.has(t)&&(i=this._myKeyInfos.get(t).myIsPressEnd),i}addKey(t){this._myKeyInfos.set(t,this._createKeyInfo())}start(){window.addEventListener("keydown",this._keyDown.bind(this)),window.addEventListener("keyup",this._keyUp.bind(this))}update(t){if(!document.hasFocus())for(let i of this._myKeyInfos.values())i.myIsPressed&&(i.myIsPressed=!1,i.myIsPressEndToProcess=!0);for(let i of this._myKeyInfos.values())i.myIsPressStart=i.myIsPressStartToProcess,i.myIsPressEnd=i.myIsPressEndToProcess,i.myIsPressStartToProcess=!1,i.myIsPressEndToProcess=!1}_keyDown(t){this._keyPressedChanged(t.key,!0),t.key!=t.code&&this._keyPressedChanged(t.code,!0)}_keyUp(t){this._keyPressedChanged(t.key,!1),t.key!=t.code&&this._keyPressedChanged(t.code,!1)}_keyPressedChanged(t,i){if(this._myKeyInfos.has(t)){let s=this._myKeyInfos.get(t);i?(s.myIsPressed=!0,s.myIsPressStartToProcess=!0):(s.myIsPressed=!1,s.myIsPressEndToProcess=!0)}}_createKeyInfo(){return{myIsPressed:!1,myIsPressStart:!1,myIsPressStartToProcess:!1,myIsPressEnd:!1,myIsPressEndToProcess:!1}}}});var qi=T(()=>{PP.MouseButtonID={LEFT:0,MIDDLE:1,RIGHT:2};PP.Mouse=class{constructor(){this._myButtonInfos=new Map;for(let t in PP.MouseButtonID)this._myButtonInfos.set(PP.MouseButtonID[t],this._createButtonInfo());this._myPreventContextMenuCallback=this._preventContextMenu.bind(this),this._myPreventMiddleButtonScrollCallback=this._preventMiddleButtonScroll.bind(this),this._myInternalMousePosition=PP.vec2_create(),this._myScreenSize=PP.vec2_create(),this._updateScreenSize(),this._myResetMovingDelay=.15,this._myResetMovingTimer=new PP.Timer(this._myResetMovingDelay,!1),this._myIsMoving=!1,this._myIsInsideView=!1,this._myIsValid=!1,this._myPointerUpOnPointerLeave=!0,this._myContextMenuActive=!0,this._myMiddleButtonScrollActive=!0,this._myPointerID=null,this._myLastValidPointerEvent=null,this._myPointerEventValidCallbacks=new Map,this._myProjectionMatrixInverse=PP.mat4_create(),this._myRotationQuat=PP.quat_create(),this._myOriginWorld=PP.vec3_create(),this._myDirectionWorld=PP.vec3_create()}start(){this._myOnPointerMoveCallback=this._onPointerAction.bind(this,this._onPointerMove.bind(this)),document.body.addEventListener("pointermove",this._myOnPointerMoveCallback),this._myOnPointerDownCallback=this._onPointerAction.bind(this,this._onPointerDown.bind(this)),document.body.addEventListener("pointerdown",this._myOnPointerDownCallback),this._myOnPointerUpCallback=this._onPointerAction.bind(this,this._onPointerUp.bind(this)),document.body.addEventListener("pointerup",this._myOnPointerUpCallback),this._myOnPointerLeaveCallback=this._onPointerLeave.bind(this),document.body.addEventListener("pointerleave",this._myOnPointerLeaveCallback),this._myOnPointerEnterCallback=this._onPointerEnter.bind(this),document.body.addEventListener("pointerenter",this._myOnPointerEnterCallback),this._myOnMouseDownCallback=this._onMouseAction.bind(this,this._onPointerDown.bind(this)),document.body.addEventListener("mousedown",this._myOnMouseDownCallback),this._myOnMouseUpCallback=this._onMouseAction.bind(this,this._onPointerUp.bind(this)),document.body.addEventListener("mouseup",this._myOnMouseUpCallback)}update(t){this._myResetMovingTimer.isRunning()&&(this._myResetMovingTimer.update(t),this._myResetMovingTimer.isDone()&&(this._myResetMovingTimer.reset(),this._myIsMoving=!1));for(let i of this._myButtonInfos.values())i.myIsPressStart=i.myIsPressStartToProcess,i.myIsPressEnd=i.myIsPressEndToProcess,i.myIsPressStartToProcess=!1,i.myIsPressEndToProcess=!1;this._updateScreenSize(),!this.isAnyButtonPressed()&&!this._myIsMoving&&(this._myPointerID=null),this._myLastValidPointerEvent!=null&&(this._isPointerEventValid(this._myLastValidPointerEvent)||(this._myIsInsideView&&this._onPointerLeave(this._myLastValidPointerEvent),this._myLastValidPointerEvent=null))}destroy(){document.body.removeEventListener("pointermove",this._myOnPointerMoveCallback),document.body.removeEventListener("pointerdown",this._myOnPointerDownCallback),document.body.removeEventListener("pointerup",this._myOnPointerUpCallback),document.body.removeEventListener("pointerleave",this._myOnPointerLeaveCallback),document.body.removeEventListener("pointerenter",this._myOnPointerEnterCallback),document.body.removeEventListener("mousedown",this._myOnMouseDownCallback),document.body.removeEventListener("mouseup",this._myOnMouseUpCallback),document.body.removeEventListener("contextmenu",this._myPreventContextMenuCallback),document.body.removeEventListener("mousedown",this._myPreventMiddleButtonScrollCallback)}isValid(){return this._myIsValid}isButtonPressed(t){let i=!1;return this._myButtonInfos.has(t)&&(i=this._myButtonInfos.get(t).myIsPressed),i}isAnyButtonPressed(){let t=!1;for(let i of this._myButtonInfos.values())if(i.myIsPressed){t=!0;break}return t}isButtonPressStart(t){let i=!1;return this._myButtonInfos.has(t)&&(i=this._myButtonInfos.get(t).myIsPressStart),i}isButtonPressEnd(t=null){let i=!1;return this._myButtonInfos.has(t)&&(i=this._myButtonInfos.get(t).myIsPressEnd),i}isMoving(){return this._myIsMoving}isInsideView(){return this._myIsInsideView}isTargetingRenderCanvas(){return this.isInsideView()&&this._myLastValidPointerEvent!=null&&this._myLastValidPointerEvent.target==WL.canvas}raycastWorld(t,i=new PP.RaycastResult){return this.getOriginWorld(t.myOrigin),this.getDirectionWorld(t.myDirection),i=PP.PhysicsUtils.raycast(t,i),i}getPositionScreen(t=PP.vec2_create()){let i=t;return i[0]=this._myInternalMousePosition[0],i[1]=this._myScreenSize[1]-1-this._myInternalMousePosition[1],i}getPositionScreenNormalized(t=PP.vec2_create()){let i=t;return i[0]=this._myScreenSize[0]==0?0:this._myInternalMousePosition[0]/this._myScreenSize[0]*2-1,i[1]=this._myScreenSize[1]==0?0:(this._myScreenSize[1]-1-this._myInternalMousePosition[1])/this._myScreenSize[1]*2-1,i}getScreenSize(){return this._myScreenSize}getPositionWorld(t,i=PP.vec3_create()){let s=this.getOriginWorld(this._myOriginWorld),n=this.getDirectionWorld(this._myDirectionWorld);return i=s.vec3_add(n.vec3_scale(t,i),i),i}getOriginWorld(t=PP.vec3_create()){return PP.XRUtils.isSessionActive()?PP.myPlayerObjects.myEyeLeft.pp_getPosition(t):PP.myPlayerObjects.myNonVRCamera.pp_getPosition(t),t}getDirectionWorld(t=PP.vec3_create()){let i=this._myInternalMousePosition[0]/this._myScreenSize[0],s=this._myInternalMousePosition[1]/this._myScreenSize[1],n=t;n.vec3_set(i*2-1,-s*2+1,-1);let a=this._myProjectionMatrixInverse;PP.XRUtils.isSessionActive()?a=PP.myPlayerObjects.myEyeLeft.pp_getComponentHierarchy("view").projectionMatrix.mat4_invert(a):a=PP.myPlayerObjects.myNonVRCamera.pp_getComponentHierarchy("view").projectionMatrix.mat4_invert(a),n.vec3_transformMat4(a,n),n.vec3_normalize(n);let r=n;return PP.XRUtils.isSessionActive()?r=n.vec3_transformQuat(PP.myPlayerObjects.myEyeLeft.pp_getRotationQuat(this._myRotationQuat),n):r=n.vec3_transformQuat(PP.myPlayerObjects.myNonVRCamera.pp_getRotationQuat(this._myRotationQuat),n),r.vec3_normalize(r),t}setTouchValid(t){let i="internal_touch_valid_callback";t?this.removePointerEventValidCallback(i):this.addPointerEventValidCallback(i,function(s){return s.pointerType=="mouse"})}setTargetOnlyRenderCanvas(t){let i="internal_target_only_render_canvas_callback";t?this.addPointerEventValidCallback(i,function(s){return s.target==WL.canvas}):this.removePointerEventValidCallback(i)}getLastValidPointerEvent(){return this._myLastValidPointerEvent}addPointerEventValidCallback(t,i){this._myPointerEventValidCallbacks.set(t,i)}removePointerEventValidCallback(t){this._myPointerEventValidCallbacks.delete(t)}isPointerUpOnPointerLeave(){return this._myPointerUpOnPointerLeave}setPointerUpOnPointerLeave(t){this._myPointerUpOnPointerLeave=t}isContextMenuActive(){return this._myContextMenuActive}setContextMenuActive(t){this._myContextMenuActive!=t&&(t?document.body.removeEventListener("contextmenu",this._myPreventContextMenuCallback):document.body.addEventListener("contextmenu",this._myPreventContextMenuCallback,!1),this._myContextMenuActive=t)}isMiddleButtonScrollActive(){return this._myMiddleButtonScrollActive}setMiddleButtonScrollActive(t){this._myMiddleButtonScrollActive!=t&&(t?document.body.removeEventListener("mousedown",this._myPreventMiddleButtonScrollCallback):document.body.addEventListener("mousedown",this._myPreventMiddleButtonScrollCallback,!1),this._myMiddleButtonScrollActive=t)}setResetMovingDelay(t){this._myResetMovingDelay=t}getResetMovingDelay(){return this._myResetMovingDelay}_onPointerAction(t,i){if(!!this._isPointerEventIDValid(i)){if(!this._isPointerEventValid(i)){this._myIsInsideView&&this._onPointerLeave(i);return}this._myIsInsideView||this._onPointerEnter(i),t(i),this._updatePositionAndScreen(i),this._updatePointerData(i)}}_onMouseAction(t,i){!this._myIsInsideView||!this._isMouseAllowed()||!this._isPointerEventIDValid(this._myLastValidPointerEvent)||!this._isPointerEventValid(this._myLastValidPointerEvent)||t(i)}_onPointerMove(t){this._myResetMovingTimer.start(this._myResetMovingDelay),this._myIsMoving=!0}_onPointerDown(t){let i=this._myButtonInfos.get(t.button);i.myIsPressed||(i.myIsPressed=!0,i.myIsPressStartToProcess=!0)}_onPointerUp(t){let i=this._myButtonInfos.get(t.button);i.myIsPressed&&(i.myIsPressed=!1,i.myIsPressEndToProcess=!0)}_onPointerLeave(t){if(!(!this._myIsInsideView||this._myLastValidPointerEvent==null||t.pointerId!=this._myLastValidPointerEvent.pointerId)){if(this._myIsInsideView=!1,this._myIsMoving=!1,this._myPointerUpOnPointerLeave)for(let i of this._myButtonInfos.values())i.myIsPressed&&(i.myIsPressed=!1,i.myIsPressEndToProcess=!0);this._myPointerID=null}}_onPointerEnter(t){this._myIsInsideView&&this._myPointerID!=null||!this._isPointerEventIDValid(t)||!this._isPointerEventValid(t)||(this._myIsInsideView=!0,this._updatePositionAndScreen(t),this._updatePointerData(t))}_preventContextMenu(t){!this._isPointerEventIDValid(t)||!this._isPointerEventValid(t)||t.preventDefault()}_preventMiddleButtonScroll(t){if(!(!this._isPointerEventIDValid(t)||!this._isPointerEventValid(t))&&t.button==1)return t.preventDefault(),!1}_updatePositionAndScreen(t){this._updateScreenSize(),this._myInternalMousePosition[0]=t.clientX,this._myInternalMousePosition[1]=t.clientY,this._myIsValid=!0}_updateScreenSize(){let t=document.body.getBoundingClientRect();this._myScreenSize[0]=t.width,this._myScreenSize[1]=t.height}_updatePointerData(t){this._myPointerID=t.pointerId,this._myLastValidPointerEvent=t}_isPointerEventIDValid(t){return t==null?!1:this._myPointerID==null||this._myPointerID==t.pointerId}_isPointerEventValid(t){if(t==null)return!1;let i=!0;for(let s of this._myPointerEventValidCallbacks.values())if(!s(t)){i=!1;break}return i}_isMouseAllowed(){return this._myLastValidPointerEvent!=null&&this._myLastValidPointerEvent.pointerId==1}_createButtonInfo(){return{myIsPressed:!1,myIsPressStart:!1,myIsPressStartToProcess:!1,myIsPressEnd:!1,myIsPressEndToProcess:!1}}}});var zi=T(()=>{PP.InputManager=class{constructor(){this._myMouse=new PP.Mouse,this._myKeyboard=new PP.Keyboard,this._myGamepadManager=new PP.GamepadManager}start(){this._myMouse.start(),this._myKeyboard.start(),this._myGamepadManager.start()}update(t){this._myMouse.update(t),this._myKeyboard.update(t),this._myGamepadManager.update(t)}getMouse(){return this._myMouse}getKeyboard(){return this._myKeyboard}getGamepadManager(){return this._myGamepadManager}}});var Qi=T(()=>{WL.registerComponent("pp-input-manager",{_myGamepadFixForward:{type:WL.Type.Bool,default:!0},_myMousePreventContextMenu:{type:WL.Type.Bool,default:!0},_myMousePreventMiddleButtonScroll:{type:WL.Type.Bool,default:!0}},{init(){this._myInputManager=new PP.InputManager,PP.myInputManager=this._myInputManager,PP.myMouse=this._myInputManager.getMouse(),PP.myKeyboard=this._myInputManager.getKeyboard(),PP.myGamepadManager=this._myInputManager.getGamepadManager(),PP.myGamepads=PP.myGamepadManager.getGamepads(),PP.myLeftGamepad=PP.myGamepadManager.getLeftGamepad(),PP.myRightGamepad=PP.myGamepadManager.getRightGamepad()},start(){this._myInputManager.start(),this._setupMousePrevent(),this._addGamepadCores()},update(e){this._myInputManager.update(e)},_setupMousePrevent(){this._myMousePreventContextMenu&&PP.myMouse.setContextMenuActive(!1),this._myMousePreventMiddleButtonScroll&&PP.myMouse.setMiddleButtonScrollActive(!1)},_addGamepadCores(){let e=new PP.HandPoseParams;e.myReferenceObject=PP.myPlayerObjects.myPlayerPivot,e.myFixForward=this._myFixForward,e.myForceEmulatedVelocities=!1;let t=new PP.XRGamepadCore(PP.Handedness.LEFT,e),i=new PP.XRGamepadCore(PP.Handedness.RIGHT,e);PP.myLeftGamepad.addGamepadCore("left_xr_gamepad",t),PP.myRightGamepad.addGamepadCore("right_xr_gamepad",i);let s=new PP.KeyboardGamepadCore(PP.Handedness.LEFT,t.getHandPose()),n=new PP.KeyboardGamepadCore(PP.Handedness.RIGHT,i.getHandPose());PP.myLeftGamepad.addGamepadCore("left_keyboard_gamepad",s),PP.myRightGamepad.addGamepadCore("right_keyboard_gamepad",n)}});PP.myInputManager=null;PP.myMouse=null;PP.myKeyboard=null;PP.myGamepadManager=null;PP.myGamepads=null;PP.myLeftGamepad=null;PP.myRightGamepad=null});var Xi=T(()=>{WL.registerComponent("pp-switch-hand-object",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myGamepad:{type:WL.Type.Object},_myTrackedHand:{type:WL.Type.Object}},{init:function(){},start:function(){this._myHandednessType=PP.InputUtils.getHandednessByIndex(this._myHandedness),this._myFirstUpdate=!0,this._myCurrentInputSourceType=null},onActivate(){this._myFirstUpdate=!0},update:function(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,this._start());let t=PP.InputUtils.getInputSourceTypeByHandedness(this._myHandednessType);t!=null&&this._myCurrentInputSourceType!=t&&(this._myCurrentInputSourceType=t,t==PP.InputSourceType.TRACKED_HAND?(this._myGamepad!=null&&this._myGamepad.pp_setActive(!1),this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!0)):t==PP.InputSourceType.GAMEPAD&&(this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!1),this._myGamepad!=null&&this._myGamepad.pp_setActive(!0)))},_start(){this._myGamepad!=null&&this._myGamepad.pp_setActive(!1),this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!1),this._myCurrentInputSourceType=null}})});var Ki=T(()=>{WL.registerComponent("pp-tracked-hand-draw-joint",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0},_myJointID:{type:WL.Type.Enum,values:["Wrist","Thumb Metacarpal","Thumb Phalanx Proximal","Thumb Phalanx Distal","Thumb Tip","Index Metacarpal","Index Phalanx Proximal","Index Phalanx Intermediate","Index Phalanx Distal","Index Tip","Middle Metacarpal","Middle Phalanx Proximal","Middle Phalanx Intermediate","Middle Phalanx Distal","Middle Tip","Ring Metacarpal","Ring Phalanx Proximal","Ring Phalanx Intermediate","Ring Phalanx Distal","Ring Tip","Pinky Metacarpal","Pinky Phalanx Proximal","Pinky Phalanx Intermediate","Pinky Phalanx Distal","Pinky Tip"],default:"Wrist"},_myJointMesh:{type:WL.Type.Mesh},_myJointMaterial:{type:WL.Type.Material}},{init:function(){this._myHandednessInternal=PP.InputUtils.getHandednessByIndex(this._myHandedness),this._myJointIDInternal=PP.InputUtils.getJointIDByIndex(this._myJointID),this._myTrackedHandJointPose=new PP.TrackedHandJointPose(this._myHandednessInternal,this._myJointIDInternal),this._myTrackedHandJointPose.setFixForward(this._myFixForward)},start:function(){this._myTrackedHandJointPose.start(),this._buildTrackedHandHierarchy()},update:function(e){this._myTrackedHandJointPose.update(e),this._myJointMeshObject.pp_setTransformLocalQuat(this._myTrackedHandJointPose.getTransformQuat()),this._myJointMeshObject.pp_setScaleLocal(this._myTrackedHandJointPose.getJointRadius())},_buildTrackedHandHierarchy(){this._myJointMeshObject=this.object.pp_addObject();let e=this._myJointMeshObject.pp_addComponent("mesh");e.mesh=this._myJointMesh,e.material=this._myJointMaterial,this._myJointMeshObject.pp_setScaleLocal(0)}})});var Ji=T(()=>{WL.registerComponent("pp-tracked-hand-draw-all-joints",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0},_myHideMetacarpals:{type:WL.Type.Bool,default:!0},_myJointMesh:{type:WL.Type.Mesh},_myJointMaterial:{type:WL.Type.Material}},{init:function(){},start:function(){this._buildTrackedHandHierarchy()},update:function(e){},_buildTrackedHandHierarchy(){this._myTrackedHandMeshObject=this.object.pp_addObject(),this._myJointMeshObjectList=[];for(let e in PP.TrackedHandJointID){let t=PP.TrackedHandJointID[e];if(!this._myHideMetacarpals||t!=PP.TrackedHandJointID.THUMB_METACARPAL&&t!=PP.TrackedHandJointID.INDEX_FINGER_METACARPAL&&t!=PP.TrackedHandJointID.MIDDLE_FINGER_METACARPAL&&t!=PP.TrackedHandJointID.RING_FINGER_METACARPAL&&t!=PP.TrackedHandJointID.PINKY_FINGER_METACARPAL){let i=this._myTrackedHandMeshObject.pp_addObject();this._myJointMeshObjectList[t]=i,i.pp_addComponent("pp-tracked-hand-draw-joint",{_myHandedness:this._myHandedness,_myFixForward:this._myFixForward,_myJointID:PP.TrackedHandJointIDIndex[e],_myJointMesh:this._myJointMesh,_myJointMaterial:this._myJointMaterial})}}}})});var Yi=T(()=>{WL.registerComponent("pp-tracked-hand-draw-skin",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0},_myHandSkin:{type:WL.Type.Skin,default:null}},{init:function(){this._myHandednessInternal=PP.InputUtils.getHandednessByIndex(this._myHandedness),this._myTrackedHandPose=new PP.TrackedHandPose(this._myHandednessInternal),this._myTrackedHandPose.setFixForward(this._myFixForward)},start:function(){this._myTrackedHandPose.start(),this._prepareJoints()},update:function(t){this._myTrackedHandPose.update(t);for(let i=0;i<this._myJoints.length;i++){let s=this._myJoints[i],n=s.name,a=this._myTrackedHandPose.getJointPose(n);s.pp_setTransformLocalQuat(a.getTransformQuat())}},_prepareJoints(){this._myJoints=[];let e=this._myHandSkin.jointIds;for(let t=0;t<e.length;t++)this._myJoints[t]=new WL.Object(e[t])}})});var Zi=T(()=>{PP.GamepadButtonID={SELECT:0,SQUEEZE:1,TOUCHPAD:2,THUMBSTICK:3,BOTTOM_BUTTON:4,TOP_BUTTON:5,THUMB_REST:6};PP.GamepadButtonEvent={PRESS_START:0,PRESS_END:1,PRESSED:2,NOT_PRESSED:3,TOUCH_START:4,TOUCH_END:5,TOUCHED:6,NOT_TOUCHED:7,VALUE_CHANGED:8,ALWAYS:9};PP.GamepadAxesEvent={X_CHANGED:0,Y_CHANGED:1,AXES_CHANGED:2,ALWAYS:3};PP.GamepadButtonInfo=class{constructor(t,i){this.myID=t,this.myHandedness=i,this.myIsPressed=!1,this.myPrevIsPressed=!1,this.myIsTouched=!1,this.myPrevIsTouched=!1,this.myValue=0,this.myPrevValue=0,this.myTimePressed=0,this.myPrevTimePressed=0,this.myTimeNotPressed=0,this.myPrevTimeNotPressed=0,this.myTimeTouched=0,this.myPrevTimeTouched=0,this.myTimeNotTouched=0,this.myPrevTimeNotTouched=0,this.myMultiplePressStartCount=0,this.myPrevMultiplePressStartCount=0,this.myMultiplePressEndCount=0,this.myPrevMultiplePressEndCount=0,this.myMultipleTouchStartCount=0,this.myPrevMultipleTouchStartCount=0,this.myMultipleTouchEndCount=0,this.myPrevMultipleTouchEndCount=0}getID(){return this.myID}getHandedness(){return this.myHandedness}getValue(){return this.myValue}isPressed(){return this.myIsPressed}isTouched(){return this.myIsTouched}isPressStart(t=null){return this.myIsPressed&&!this.myPrevIsPressed&&(t==null||this.myMultiplePressStartCount==t)}isPressEnd(t=null){return!this.myIsPressed&&this.myPrevIsPressed&&(t==null||this.myMultiplePressEndCount==t)}isTouchStart(t=null){return this.myIsTouched&&!this.myPrevIsTouched&&(t==null||this.myMultipleTouchStartCount==t)}isTouchEnd(t=null){return!this.myIsTouched&&this.myPrevIsTouched&&(t==null||this.myMultipleTouchEndCount==t)}clone(){let t=new PP.GamepadButtonInfo(this.myID,this.myHandedness);return t.myIsPressed=this.myIsPressed,t.myPrevIsPressed=this.myPrevIsPressed,t.myIsTouched=this.myIsTouched,t.myPrevIsTouched=this.myPrevIsTouched,t.myValue=this.myValue,t.myPrevValue=this.myPrevValue,t.myTimePressed=this.myTimePressed,t.myPrevTimePressed=this.myPrevTimePressed,t.myTimeNotPressed=this.myTimeNotPressed,t.myPrevTimeNotPressed=this.myPrevTimeNotPressed,t.myTimeTouched=this.myTimeTouched,t.myPrevTimeTouched=this.myPrevTimeTouched,t.myTimeNotTouched=this.myTimeNotTouched,t.myPrevTimeNotTouched=this.myPrevTimeNotTouched,t.myMultiplePressStartCount=this.myMultiplePressStartCount,t.myPrevMultiplePressStartCount=this.myPrevMultiplePressStartCount,t.myMultiplePressEndCount=this.myMultiplePressEndCount,t.myPrevMultiplePressEndCount=this.myPrevMultiplePressEndCount,t.myMultipleTouchStartCount=this.myMultipleTouchStartCount,t.myPrevMultipleTouchStartCount=this.myPrevMultipleTouchStartCount,t.myMultipleTouchEndCount=this.myMultipleTouchEndCount,t.myPrevMultipleTouchEndCount=this.myPrevMultipleTouchEndCount,t}};PP.GamepadAxesInfo=class{constructor(t){this.myHandedness=t,this.myAxes=PP.vec2_create(0,0),this.myPrevAxes=PP.vec2_create(0,0)}getAxes(){return this.myAxes}getHandedness(){return this.myHandedness}clone(){let t=new PP.GamepadAxesInfo(this.myHandedness);return t.myAxes.vec2_copy(this.myAxes),t.myPrevAxes.vec2_copy(this.myPrevAxes),t}};PP.GamepadPulseInfo=class{constructor(){this.myIntensity=0,this.myDuration=0,this.myIsDevicePulsing=!1}clone(){let t=new PP.GamepadPulseInfo;return t.myIntensity=this.myIntensity,t.myDuration=this.myDuration,t.myIsDevicePulsing=this.myIsDevicePulsing,t}}});var $i=T(()=>{PP.BaseGamepad=class{constructor(t){this._myHandedness=t,this._myButtonInfos=[];for(let i in PP.GamepadButtonID)this._myButtonInfos[PP.GamepadButtonID[i]]=new PP.GamepadButtonInfo(PP.GamepadButtonID[i],this._myHandedness);this._myAxesInfo=new PP.GamepadAxesInfo(this._myHandedness),this._myButtonCallbacks=[];for(let i in PP.GamepadButtonID){this._myButtonCallbacks[PP.GamepadButtonID[i]]=[];for(let s in PP.GamepadButtonEvent)this._myButtonCallbacks[PP.GamepadButtonID[i]][PP.GamepadButtonEvent[s]]=new Map}this._myAxesCallbacks=[];for(let i in PP.GamepadAxesEvent)this._myAxesCallbacks[PP.GamepadAxesEvent[i]]=new Map;this._myPulseInfo=new PP.GamepadPulseInfo,this._myMultiplePressMaxDelay=.3,this._myMultipleTouchMaxDelay=.3}getHandedness(){return this._myHandedness}getButtonInfo(t){return this._myButtonInfos[t]}registerButtonEventListener(t,i,s,n){this._myButtonCallbacks[t][i].set(s,n)}unregisterButtonEventListener(t,i,s){this._myButtonCallbacks[t][i].delete(s)}getAxesInfo(){return this._myAxesInfo}registerAxesEventListener(t,i,s){this._myAxesCallbacks[t].set(i,s)}unregisterAxesEventListener(t,i){this._myAxesCallbacks[t].delete(i)}pulse(t,i=0){this._myPulseInfo.myIntensity=Math.min(Math.max(t,0),1),this._myPulseInfo.myDuration=Math.max(i,0)}stopPulse(){this._myPulseInfo.myIntensity=0,this._myPulseInfo.myDuration=0}isPulsing(){return this._myPulseInfo.myIntensity>0||this._myPulseInfo.myDuration>0}getPulseInfo(){return this._myPulseInfo}getMultiplePressMaxDelay(){return this._myMultiplePressMaxDelay}setMultiplePressMaxDelay(t){this._myMultiplePressMaxDelay=t}getMultipleTouchMaxDelay(){return this._myMultipleTouchMaxDelay}setMultipleTouchMaxDelay(t){this._myMultipleTouchMaxDelay=t}getHandPose(){return null}isGamepadActive(){return!0}_start(){}_preUpdate(t){}_postUpdate(t){}_getButtonData(t){return this._createButtonData()}_getAxesData(){return this._createAxesData()}_getHapticActuators(){return[]}start(){this._start()}update(t){this._preUpdate(t),this._preUpdateButtonInfos(),this._updateButtonInfos(),this._postUpdateButtonInfos(t),this._preUpdateAxesInfos(),this._updateAxesInfos(),this._postUpdateAxesInfos(),this._updatePulse(t),this._postUpdate(t)}_preUpdateButtonInfos(){this._myButtonInfos.forEach(function(t){t.myPrevIsPressed=t.myIsPressed,t.myPrevIsTouched=t.myIsTouched,t.myPrevValue=t.myValue})}_updateButtonInfos(){this._updateSingleButtonInfo(PP.GamepadButtonID.SELECT),this._updateSingleButtonInfo(PP.GamepadButtonID.SQUEEZE),this._updateSingleButtonInfo(PP.GamepadButtonID.TOUCHPAD),this._updateSingleButtonInfo(PP.GamepadButtonID.THUMBSTICK),this._updateSingleButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON),this._updateSingleButtonInfo(PP.GamepadButtonID.TOP_BUTTON),this._updateSingleButtonInfo(PP.GamepadButtonID.THUMB_REST)}_updateSingleButtonInfo(t){let i=this._myButtonInfos[t],s=this._getButtonData(t);i.myIsPressed=s.myIsPressed,i.myIsTouched=s.myIsTouched,i.myValue=s.myValue}_postUpdateButtonInfos(t){this._myButtonInfos.forEach(function(i){i.myIsPressed?(i.myTimePressed+=t,i.myPrevIsPressed||(i.myMultiplePressStartCount+=1,i.myPrevTimeNotPressed=i.myTimeNotPressed,i.myTimeNotPressed=0),i.myPrevTimeNotPressed+i.myTimePressed>this._myMultiplePressMaxDelay&&i.myMultiplePressEndCount>0&&(i.myPrevMultiplePressEndCount=i.myMultiplePressEndCount,i.myMultiplePressEndCount=0),i.myTimePressed>this._myMultiplePressMaxDelay&&i.myMultiplePressStartCount>0&&(i.myPrevMultiplePressStartCount=i.myMultiplePressStartCount,i.myMultiplePressStartCount=0)):(i.myTimeNotPressed+=t,i.myPrevIsPressed&&(i.myMultiplePressEndCount+=1,i.myPrevTimePressed=i.myTimePressed,i.myTimePressed=0),i.myPrevTimePressed+i.myTimeNotPressed>this._myMultiplePressMaxDelay&&i.myMultiplePressStartCount>0&&(i.myPrevMultiplePressStartCount=i.myMultiplePressStartCount,i.myMultiplePressStartCount=0),i.myTimeNotPressed>this._myMultiplePressMaxDelay&&i.myMultiplePressEndCount>0&&(i.myPrevMultiplePressEndCount=i.myMultiplePressEndCount,i.myMultiplePressEndCount=0)),i.myIsTouched?(i.myTimeTouched+=t,i.myPrevIsTouched||(i.myMultipleTouchStartCount+=1,i.myPrevTimeNotTouched=i.myTimeNotTouched,i.myTimeNotTouched=0),i.myPrevTimeNotTouched+i.myTimeTouched>this._myMultipleTouchMaxDelay&&i.myMultipleTouchEndCount>0&&(i.myPrevMultipleTouchEndCount=i.myMultipleTouchEndCount,i.myMultipleTouchEndCount=0),i.myTimeTouched>this._myMultipleTouchMaxDelay&&i.myMultipleTouchStartCount>0&&(i.myPrevMultipleTouchStartCount=i.myMultipleTouchStartCount,i.myMultipleTouchStartCount=0)):(i.myTimeNotTouched+=t,i.myPrevIsTouched&&(i.myMultipleTouchEndCount+=1,i.myPrevTimeTouched=i.myTimeTouched,i.myTimeTouched=0),i.myPrevTimeTouched+i.myTimeNotTouched>this._myMultipleTouchMaxDelay&&i.myMultipleTouchStartCount>0&&(i.myPrevMultipleTouchStartCount=i.myMultipleTouchStartCount,i.myMultipleTouchStartCount=0),i.myTimeNotTouched>this._myMultipleTouchMaxDelay&&i.myMultipleTouchEndCount>0&&(i.myPrevMultipleTouchEndCount=i.myMultipleTouchEndCount,i.myMultipleTouchEndCount=0))}.bind(this));for(let i in PP.GamepadButtonID){let s=this._myButtonInfos[PP.GamepadButtonID[i]],n=this._myButtonCallbacks[PP.GamepadButtonID[i]];if(s.myIsPressed&&!s.myPrevIsPressed){let r=n[PP.GamepadButtonEvent.PRESS_START];this._triggerCallbacks(r,s)}if(!s.myIsPressed&&s.myPrevIsPressed){let r=n[PP.GamepadButtonEvent.PRESS_END];this._triggerCallbacks(r,s)}if(s.myIsPressed){let r=n[PP.GamepadButtonEvent.PRESSED];this._triggerCallbacks(r,s)}else{let r=n[PP.GamepadButtonEvent.NOT_PRESSED];this._triggerCallbacks(r,s)}if(s.myIsTouched&&!s.myPrevIsTouched){let r=n[PP.GamepadButtonEvent.TOUCH_START];this._triggerCallbacks(r,s)}if(!s.myIsTouched&&s.myPrevIsTouched){let r=n[PP.GamepadButtonEvent.TOUCH_END];this._triggerCallbacks(r,s)}if(s.myIsTouched){let r=n[PP.GamepadButtonEvent.TOUCHED];this._triggerCallbacks(r,s)}else{let r=n[PP.GamepadButtonEvent.NOT_TOUCHED];this._triggerCallbacks(r,s)}if(s.myValue!=s.myPrevValue){let r=n[PP.GamepadButtonEvent.VALUE_CHANGED];this._triggerCallbacks(r,s)}let a=n[PP.GamepadButtonEvent.ALWAYS];this._triggerCallbacks(a,s)}this._mySelectStart=!1,this._mySelectEnd=!1,this._mySqueezeStart=!1,this._mySqueezeEnd=!1}_preUpdateAxesInfos(){this._myAxesInfo.myPrevAxes[0]=this._myAxesInfo.myAxes[0],this._myAxesInfo.myPrevAxes[1]=this._myAxesInfo.myAxes[1]}_updateAxesInfos(){let t=this._getAxesData();this._myAxesInfo.myAxes[0]=t[0],this._myAxesInfo.myAxes[1]=t[1]}_postUpdateAxesInfos(){if(this._myAxesInfo.myAxes[0]!=this._myAxesInfo.myPrevAxes[0]){let i=this._myAxesCallbacks[PP.GamepadAxesEvent.X_CHANGED];this._triggerCallbacks(i,this._myAxesInfo)}if(this._myAxesInfo.myAxes[1]!=this._myAxesInfo.myPrevAxes[1]){let i=this._myAxesCallbacks[PP.GamepadAxesEvent.Y_CHANGED];this._triggerCallbacks(i,this._myAxesInfo)}if(this._myAxesInfo.myAxes[0]!=this._myAxesInfo.myPrevAxes[0]||this._myAxesInfo.myAxes[1]!=this._myAxesInfo.myPrevAxes[1]){let i=this._myAxesCallbacks[PP.GamepadAxesEvent.AXES_CHANGED];this._triggerCallbacks(i,this._myAxesInfo)}let t=this._myAxesCallbacks[PP.GamepadAxesEvent.ALWAYS];this._triggerCallbacks(t,this._myAxesInfo)}_updatePulse(t){if(this._myPulseInfo.myIsDevicePulsing||this._myPulseInfo.myIntensity>0){let i=this._getHapticActuators();if(i.length>0){if(this._myPulseInfo.myIntensity>0){for(let s of i)s.pulse(this._myPulseInfo.myIntensity,1e3);this._myPulseInfo.myIsDevicePulsing=!0}else if(this._myPulseInfo.myIsDevicePulsing){for(let s of i)s.reset();this._myPulseInfo.myIsDevicePulsing=!1}}else this._myPulseInfo.myIsDevicePulsing=!1}this._myPulseInfo.myDuration-=t,this._myPulseInfo.myDuration<=0&&(this._myPulseInfo.myIntensity=0,this._myPulseInfo.myDuration=0)}_triggerCallbacks(t,i){for(let s of t.values())s(i,this)}_createButtonData(){return{myIsPressed:!1,myIsTouched:!1,myValue:0}}_createAxesData(){return PP.vec2_create(0,0)}}});var ts=T(()=>{PP.UniversalGamepad=class extends PP.BaseGamepad{constructor(t){super(t),this._myGamepadCores=new Map,this._myStarted=!1,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}addGamepadCore(t,i){i.getHandedness()==this.getHandedness()&&(this._myGamepadCores.set(t,i),this._myStarted&&i.start())}getGamepadCore(t){return this._myGamepadCores.get(t)}removeGamepadCore(t){this._myGamepadCores.get(t)&&this._myGamepadCores.delete(t)}removeAllGamepadCores(){for(let t of this._myGamepadCores.keys())this.removeGamepadCore(t)}getHandPose(){let t=null;for(let i of this._myGamepadCores.values()){if(i.isGamepadCoreActive()){let s=i.getHandPose();(t==null||s!=null&&s.isValid())&&(t=s)}if(t!=null&&t.isValid())break}return t}isGamepadActive(){let t=!1;for(let i of this._myGamepadCores.values())if(i.isGamepadCoreActive()){t=!0;break}return t}_start(){for(let t of this._myGamepadCores.values())t.start();this._myStarted=!0}_preUpdate(t){for(let i of this._myGamepadCores.values())i.preUpdate(t)}_postUpdate(t){for(let i of this._myGamepadCores.values())i.postUpdate(t)}_getButtonData(t){this._myButtonData.myIsPressed=!1,this._myButtonData.myIsTouched=!1,this._myButtonData.myValue=0;for(let i of this._myGamepadCores.values())if(i.isGamepadCoreActive()){let s=i.getButtonData(t);this._myButtonData.myIsPressed=this._myButtonData.myIsPressed||s.myIsPressed,this._myButtonData.myIsTouched=this._myButtonData.myIsTouched||s.myIsTouched,Math.abs(s.myValue)>Math.abs(this._myButtonData.myValue)&&(this._myButtonData.myValue=s.myValue)}return this._myButtonData}_getAxesData(){this._myAxesData.vec2_zero();for(let t of this._myGamepadCores.values())if(t.isGamepadCoreActive()){let i=t.getAxesData();Math.abs(i[0])>Math.abs(this._myAxesData[0])&&(this._myAxesData[0]=i[0]),Math.abs(i[1])>Math.abs(this._myAxesData[1])&&(this._myAxesData[1]=i[1])}return this._myAxesData}_getHapticActuators(){this._myHapticActuators.pp_clear();for(let t of this._myGamepadCores.values())t.isGamepadCoreActive()&&this._myHapticActuators.push(...t.getHapticActuators());return this._myHapticActuators}}});var es=T(()=>{PP.GamepadCore=class{constructor(t,i){this._myHandedness=t,this._myHandPose=i}getHandedness(){return this._myHandedness}getHandPose(){return this._myHandPose}isGamepadCoreActive(){return!0}start(){}preUpdate(t){}postUpdate(t){}getButtonData(t){return this._createButtonData()}getAxesData(){return this._createAxesData()}getHapticActuators(){return[]}_createButtonData(){return{myIsPressed:!1,myIsTouched:!1,myValue:0}}_createAxesData(){return PP.vec2_create(0,0)}}});var is=T(()=>{PP.XRGamepadCore=class extends PP.GamepadCore{constructor(t,i=new PP.HandPoseParams){super(t,new PP.HandPose(t,i)),this._mySelectPressed=!1,this._mySqueezePressed=!1,this._myIsXRSessionActive=!1,this._myInputSource=null,this._myGamepad=null,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){return this._myIsXRSessionActive&&this._myGamepad!=null&&(this._myGamepad.connected==null||this._myGamepad.connected)}start(){this._myHandPose.start(),WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}preUpdate(t){this._updateHandPose(t)}getButtonData(t){if(this._myButtonData.myIsPressed=!1,this._myButtonData.myIsTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive()){if(t<this._myGamepad.buttons.length){let i=this._myGamepad.buttons[t];t!=PP.GamepadButtonID.SELECT&&t!=PP.GamepadButtonID.SQUEEZE?this._myButtonData.myIsPressed=i.pressed:this._myButtonData.myIsPressed=this._getSpecialButtonPressed(t),this._myButtonData.myIsTouched=i.touched,this._myButtonData.myValue=i.value}else if(t==PP.GamepadButtonID.TOP_BUTTON&&this._myGamepad.buttons.length>=3){let i=this._myGamepad.buttons[2];this._myButtonData.myIsPressed=i.pressed,this._myButtonData.myIsTouched=i.touched,this._myButtonData.myValue=i.value}}return this._myButtonData}getAxesData(){if(this._myAxesData.vec2_zero(),this.isGamepadCoreActive()){let t=this._myGamepad.axes;t.length==4?(Math.abs(t[0])>Math.abs(t[2])?this._myAxesData[0]=t[0]:this._myAxesData[0]=t[2],Math.abs(t[1])>Math.abs(t[3])?this._myAxesData[1]=t[1]:this._myAxesData[1]=t[3]):t.length==2&&(this._myAxesData[0]=t[0],this._myAxesData[1]=t[1]),this._myAxesData[1]=-this._myAxesData[1]}return this._myAxesData}getHapticActuators(){return this._myHapticActuators.pp_clear(),this.isGamepadCoreActive()&&(this._myGamepad.hapticActuators!=null&&this._myGamepad.hapticActuators.length>0&&this._myHapticActuators.push(...this._myGamepad.hapticActuators),this._myGamepad.vibrationActuator!=null&&this._myHapticActuators.push(this._myGamepad.vibrationActuator)),this._myHapticActuators}_updateHandPose(t){this._myHandPose.update(t),this._myInputSource=this._myHandPose.getInputSource(),this._myInputSource!=null?this._myGamepad=this._myInputSource.gamepad:this._myGamepad=null}_getSpecialButtonPressed(t){let i=!1;return this.isGamepadCoreActive()&&(t==PP.GamepadButtonID.SELECT?i=this._mySelectPressed:t==PP.GamepadButtonID.SQUEEZE&&(i=this._mySqueezePressed)),i}_onXRSessionStart(t){t.addEventListener("selectstart",this._selectStart.bind(this)),t.addEventListener("selectend",this._selectEnd.bind(this)),t.addEventListener("squeezestart",this._squeezeStart.bind(this)),t.addEventListener("squeezeend",this._squeezeEnd.bind(this)),this._myIsXRSessionActive=!0}_onXRSessionEnd(t){this._myIsXRSessionActive=!1}_selectStart(t){this._myInputSource!=null&&this._myInputSource==t.inputSource&&(this._mySelectPressed=!0)}_selectEnd(t){this._myInputSource!=null&&this._myInputSource==t.inputSource&&(this._mySelectPressed=!1)}_squeezeStart(t){this._myInputSource!=null&&this._myInputSource==t.inputSource&&(this._mySqueezePressed=!0)}_squeezeEnd(t){this._myInputSource!=null&&this._myInputSource==t.inputSource&&(this._mySqueezePressed=!1)}}});var ss=T(()=>{PP.KeyboardGamepadCore=class extends PP.GamepadCore{constructor(t,i=null){super(t,i),this._myHandPoseUpdateActive=!1,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}setHandPoseUpdateActive(t){this._myHandPoseUpdateActive=t}isHandPoseUpdateActive(){return this._myHandPoseUpdateActive}isGamepadCoreActive(){return!PP.XRUtils.isSessionActive()}start(){this._myHandPose&&this._myHandPoseUpdateActive&&this._myHandPose.start()}preUpdate(t){this._myHandPose&&this._myHandPoseUpdateActive&&this._myHandPose.update(t)}getButtonData(t){if(this._myButtonData.myIsPressed=!1,this._myButtonData.myIsTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive())if(this.getHandedness()==PP.Handedness.LEFT)switch(t){case PP.GamepadButtonID.SELECT:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.E)||PP.myKeyboard.isKeyPressed(PP.KeyID.e);break;case PP.GamepadButtonID.SQUEEZE:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.Q)||PP.myKeyboard.isKeyPressed(PP.KeyID.q);break;case PP.GamepadButtonID.TOUCHPAD:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.X)||PP.myKeyboard.isKeyPressed(PP.KeyID.x);break;case PP.GamepadButtonID.THUMBSTICK:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.R)||PP.myKeyboard.isKeyPressed(PP.KeyID.r);break;case PP.GamepadButtonID.BOTTOM_BUTTON:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.C)||PP.myKeyboard.isKeyPressed(PP.KeyID.c);break;case PP.GamepadButtonID.TOP_BUTTON:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.F)||PP.myKeyboard.isKeyPressed(PP.KeyID.f);break;case PP.GamepadButtonID.THUMB_REST:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.V)||PP.myKeyboard.isKeyPressed(PP.KeyID.v);break}else switch(t){case PP.GamepadButtonID.SELECT:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.U)||PP.myKeyboard.isKeyPressed(PP.KeyID.u);break;case PP.GamepadButtonID.SQUEEZE:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.O)||PP.myKeyboard.isKeyPressed(PP.KeyID.o);break;case PP.GamepadButtonID.TOUCHPAD:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.M)||PP.myKeyboard.isKeyPressed(PP.KeyID.m);break;case PP.GamepadButtonID.THUMBSTICK:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.Y)||PP.myKeyboard.isKeyPressed(PP.KeyID.y);break;case PP.GamepadButtonID.BOTTOM_BUTTON:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.N)||PP.myKeyboard.isKeyPressed(PP.KeyID.n);break;case PP.GamepadButtonID.TOP_BUTTON:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.H)||PP.myKeyboard.isKeyPressed(PP.KeyID.h);break;case PP.GamepadButtonID.THUMB_REST:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.B)||PP.myKeyboard.isKeyPressed(PP.KeyID.b);break}return this._myButtonData.myIsPressed&&(this._myButtonData.myIsTouched=!0,this._myButtonData.myValue=1),this._myButtonData}getAxesData(){return this._myAxesData.vec2_zero(),this.isGamepadCoreActive()&&(this.getHandedness()==PP.Handedness.LEFT?((PP.myKeyboard.isKeyPressed(PP.KeyID.W)||PP.myKeyboard.isKeyPressed(PP.KeyID.w))&&(this._myAxesData[1]+=1),(PP.myKeyboard.isKeyPressed(PP.KeyID.S)||PP.myKeyboard.isKeyPressed(PP.KeyID.s))&&(this._myAxesData[1]+=-1),(PP.myKeyboard.isKeyPressed(PP.KeyID.D)||PP.myKeyboard.isKeyPressed(PP.KeyID.d))&&(this._myAxesData[0]+=1),(PP.myKeyboard.isKeyPressed(PP.KeyID.A)||PP.myKeyboard.isKeyPressed(PP.KeyID.a))&&(this._myAxesData[0]+=-1)):((PP.myKeyboard.isKeyPressed(PP.KeyID.I)||PP.myKeyboard.isKeyPressed(PP.KeyID.i)||PP.myKeyboard.isKeyPressed(PP.KeyID.UP))&&(this._myAxesData[1]+=1),(PP.myKeyboard.isKeyPressed(PP.KeyID.K)||PP.myKeyboard.isKeyPressed(PP.KeyID.k)||PP.myKeyboard.isKeyPressed(PP.KeyID.DOWN))&&(this._myAxesData[1]+=-1),(PP.myKeyboard.isKeyPressed(PP.KeyID.L)||PP.myKeyboard.isKeyPressed(PP.KeyID.l)||PP.myKeyboard.isKeyPressed(PP.KeyID.RIGHT))&&(this._myAxesData[0]+=1),(PP.myKeyboard.isKeyPressed(PP.KeyID.J)||PP.myKeyboard.isKeyPressed(PP.KeyID.j)||PP.myKeyboard.isKeyPressed(PP.KeyID.LEFT))&&(this._myAxesData[0]+=-1))),this._myAxesData}getHapticActuators(){return this._myHapticActuators}}});var ns=T(()=>{PP.VirtualGamepadGamepadCore=class extends PP.GamepadCore{constructor(t,i,s=null){super(i,s),this._myHandPoseUpdateActive=!1,this._myVirtualGamepad=t,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}setHandPoseUpdateActive(t){this._myHandPoseUpdateActive=t}isHandPoseUpdateActive(){return this._myHandPoseUpdateActive}isGamepadCoreActive(){return this._myVirtualGamepad.isVisible()}start(){this._myHandPose&&this._myHandPoseUpdateActive&&this._myHandPose.start()}preUpdate(t){this._myHandPose&&this._myHandPoseUpdateActive&&this._myHandPose.update(t)}getButtonData(t){return this._myButtonData.myIsPressed=!1,this._myButtonData.myIsTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive()&&this._myVirtualGamepad.isButtonPressed(this._myHandedness,t)&&(this._myButtonData.myIsPressed=!0,this._myButtonData.myIsTouched=!0,this._myButtonData.myValue=1),this._myButtonData}getAxesData(){return this._myAxesData.vec2_zero(),this.isGamepadCoreActive()&&this._myVirtualGamepad.getAxes(this._myHandedness,this._myAxesData),this._myAxesData}getHapticActuators(){return this._myHapticActuators}}});var as=T(()=>{WL.registerComponent("pp-gamepad-mesh-animator",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_mySelect:{type:WL.Type.Object,default:null},_mySqueeze:{type:WL.Type.Object,default:null},_myThumbstick:{type:WL.Type.Object,default:null},_myTopButton:{type:WL.Type.Object,default:null},_myBottomButton:{type:WL.Type.Object,default:null},_mySelectRotateAngle:{type:WL.Type.Float,default:15},_mySqueezeRotateAngle:{type:WL.Type.Float,default:11},_myThumbstickRotateAngle:{type:WL.Type.Float,default:15},_myThumbstickPressOffset:{type:WL.Type.Float,default:625e-6},_myTopButtonPressOffset:{type:WL.Type.Float,default:.0015},_myBottomButtonPressOffset:{type:WL.Type.Float,default:.0015},_myUsePressForSqueeze:{type:WL.Type.Bool,default:!1},_mySqueezePressOffset:{type:WL.Type.Float,default:.0015}},{start:function(){let e=null;this._myHandedness==0?e=PP.myLeftGamepad:e=PP.myRightGamepad,this._mySelect!=null&&(this._mySelectOriginalRotation=this._mySelect.pp_getRotationLocalQuat(),this._mySelectOriginalLeft=this._mySelect.pp_getLeftLocal()),this._mySqueeze!=null&&(this._mySqueezeOriginalPosition=this._mySqueeze.pp_getPositionLocal(),this._mySqueezeOriginalRotation=this._mySqueeze.pp_getRotationLocalQuat(),this._mySqueezeOriginalLeft=this._mySqueeze.pp_getLeftLocal(),this._mySqueezeOriginalForward=this._mySqueeze.pp_getForwardLocal()),this._myThumbstick!=null&&(this._myThumbstickOriginalPosition=this._myThumbstick.pp_getPositionLocal(),this._myThumbstickOriginalRotation=this._myThumbstick.pp_getRotationLocalQuat(),this._myThumbstickOriginalLeft=this._myThumbstick.pp_getLeftLocal(),this._myThumbstickOriginalUp=this._myThumbstick.pp_getUpLocal(),this._myThumbstickOriginalForward=this._myThumbstick.pp_getForwardLocal()),this._myTopButton!=null&&(this._myTopButtonOriginalPosition=this._myTopButton.pp_getPositionLocal(),this._myTopButtonOriginalUp=this._myTopButton.pp_getUpLocal()),this._myBottomButton!=null&&(this._myBottomButtonOriginalPosition=this._myBottomButton.pp_getPositionLocal(),this._myBottomButtonOriginalUp=this._myBottomButton.pp_getUpLocal()),this._myThumbstick!=null&&(e.registerButtonEventListener(PP.GamepadButtonID.THUMBSTICK,PP.GamepadButtonEvent.PRESS_START,this,this._thumbstickPressedStart.bind(this)),e.registerButtonEventListener(PP.GamepadButtonID.THUMBSTICK,PP.GamepadButtonEvent.PRESS_END,this,this._thumbstickPressedEnd.bind(this))),this._myTopButton!=null&&(e.registerButtonEventListener(PP.GamepadButtonID.TOP_BUTTON,PP.GamepadButtonEvent.PRESS_START,this,this._topButtonPressedStart.bind(this)),e.registerButtonEventListener(PP.GamepadButtonID.TOP_BUTTON,PP.GamepadButtonEvent.PRESS_END,this,this._topButtonPressedEnd.bind(this))),this._myBottomButton!=null&&(e.registerButtonEventListener(PP.GamepadButtonID.BOTTOM_BUTTON,PP.GamepadButtonEvent.PRESS_START,this,this._bottomButtonPressedStart.bind(this)),e.registerButtonEventListener(PP.GamepadButtonID.BOTTOM_BUTTON,PP.GamepadButtonEvent.PRESS_END,this,this._bottomButtonPressedEnd.bind(this))),this._mySelect!=null&&e.registerButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.VALUE_CHANGED,this,this._selectValueChanged.bind(this)),this._mySqueeze!=null&&e.registerButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.VALUE_CHANGED,this,this._squeezeValueChanged.bind(this)),this._myThumbstick!=null&&e.registerAxesEventListener(PP.GamepadAxesEvent.AXES_CHANGED,this,this._thumbstickValueChanged.bind(this))},_thumbstickPressedStart:function(){let e=PP.vec3_create();return function(i,s){this._myThumbstickOriginalUp.vec3_scale(-this._myThumbstickPressOffset,e),this._myThumbstick.pp_translateLocal(e)}}(),_thumbstickPressedEnd:function(t,i){this._myThumbstick.pp_setPositionLocal(this._myThumbstickOriginalPosition)},_topButtonPressedStart:function(e,t){this._myTopButton.pp_translateAxisLocal(-this._myTopButtonPressOffset,this._myTopButtonOriginalUp)},_topButtonPressedEnd:function(e,t){this._myTopButton.pp_setPositionLocal(this._myTopButtonOriginalPosition)},_bottomButtonPressedStart:function(e,t){this._myBottomButton.pp_translateAxisLocal(-this._myBottomButtonPressOffset,this._myBottomButtonOriginalUp)},_bottomButtonPressedEnd:function(e,t){this._myBottomButton.pp_setPositionLocal(this._myBottomButtonOriginalPosition)},_selectValueChanged:function(e,t){this._mySelect.pp_setRotationLocalQuat(this._mySelectOriginalRotation),e.myValue>1e-5&&this._mySelect.pp_rotateAxisLocal(this._mySelectRotateAngle*e.myValue,this._mySelectOriginalLeft)},_squeezeValueChanged:function(e,t){if(this._mySqueeze.pp_setPositionLocal(this._mySqueezeOriginalPosition),this._mySqueeze.pp_setRotationLocalQuat(this._mySqueezeOriginalRotation),e.myValue>1e-5)if(this._myUsePressForSqueeze){let i=this._mySqueezePressOffset;this._myHandedness==1&&(i*=-1),this._mySqueeze.pp_translateAxisLocal(i*e.myValue,this._mySqueezeOriginalLeft)}else{let i=-this._mySqueezeRotateAngle;this._myHandedness==1&&(i*=-1),this._mySqueeze.pp_rotateAxisLocal(i*e.myValue,this._mySqueezeOriginalForward)}},_thumbstickValueChanged:function(e,t){this._myThumbstick.pp_setRotationLocalQuat(this._myThumbstickOriginalRotation);let i=this._myThumbstickRotateAngle*e.myAxes[1],s=this._myThumbstickRotateAngle*e.myAxes[0];Math.abs(i)>1e-4&&this._myThumbstick.pp_rotateAxisLocal(i,this._myThumbstickOriginalLeft),Math.abs(s)>1e-4&&this._myThumbstick.pp_rotateAxisLocal(s,this._myThumbstickOriginalForward)}})});var os=T(()=>{PP.GamepadManager=class{constructor(){this._myLeftGamepad=new PP.UniversalGamepad(PP.Handedness.LEFT),this._myRightGamepad=new PP.UniversalGamepad(PP.Handedness.RIGHT)}start(){this._myLeftGamepad.start(),this._myRightGamepad.start()}update(t){this._myLeftGamepad.update(t),this._myRightGamepad.update(t)}getLeftGamepad(){return this._myLeftGamepad}getRightGamepad(){return this._myRightGamepad}getGamepad(t){let i=null;switch(t){case PP.Handedness.LEFT:i=this._myLeftGamepad;break;case PP.Handedness.RIGHT:i=this._myRightGamepad;break;default:i=null}return i}getGamepads(){let t=[];return t[PP.Handedness.LEFT]=this._myLeftGamepad,t[PP.Handedness.RIGHT]=this._myRightGamepad,t}}});var rs=T(()=>{PP.GamepadUtils={_mySimultaneousPressMaxDelay:.15,_mySimultaneousTouchMaxDelay:.15,setSimultaneousPressMaxDelay:function(e){PP.GamepadUtils._mySimultaneousPressMaxDelay=e},setSimultaneousTouchMaxDelay:function(e){PP.GamepadUtils._mySimultaneousTouchMaxDelay=e},getSimultaneousPressMaxDelay:function(){return PP.GamepadUtils._mySimultaneousPressMaxDelay},getSimultaneousTouchMaxDelay:function(){return PP.GamepadUtils._mySimultaneousTouchMaxDelay},isAnyButtonPressStart:function(...e){let t=null,i=e;isNaN(e[0])||(t=e[0],i=e.slice(1));for(let n of i)if(n.length==1)for(let a in PP.GamepadButtonID)n.push(PP.GamepadButtonID[a]);let s=!1;for(let n of i){let a=n[0];for(let r=1;r<n.length;r++){let l=n[r];if(a.getButtonInfo(l).isPressStart(t)){s=!0;break}}if(s)break}return s},areButtonsPressStart:function(...e){let t=null,i=e;isNaN(e[0])||(t=e[0],i=e.slice(1));for(let a of i)if(a.length==1)for(let r in PP.GamepadButtonID)a.push(PP.GamepadButtonID[r]);let s=!0,n=!1;for(let a of i){let r=a[0];for(let l=1;l<a.length;l++){let y=a[l],c=r.getButtonInfo(y);if(!(c.myIsPressed&&(t==null||c.myMultiplePressStartCount==t)&&c.myTimePressed<PP.GamepadUtils._mySimultaneousPressMaxDelay)){s=!1;break}c.isPressStart(t)&&(n=!0)}if(!s)break}return s&&n},isAnyButtonPressEnd:function(...e){let t=null,i=e;isNaN(e[0])||(t=e[0],i=e.slice(1));for(let n of i)if(n.length==1)for(let a in PP.GamepadButtonID)n.push(PP.GamepadButtonID[a]);let s=!1;for(let n of i){let a=n[0];for(let r=1;r<n.length;r++){let l=n[r];if(a.getButtonInfo(l).isPressEnd(t)){s=!0;break}}if(s)break}return s},areButtonsPressEnd:function(...e){let t=null,i=e;isNaN(e[0])||(t=e[0],i=e.slice(1));for(let a of i)if(a.length==1)for(let r in PP.GamepadButtonID)a.push(PP.GamepadButtonID[r]);let s=!0,n=!1;for(let a of i){let r=a[0];for(let l=1;l<a.length;l++){let y=a[l],c=r.getButtonInfo(y);if(!(!c.myIsPressed&&(t==null||c.myMultiplePressEndCount==t)&&c.myTimeNotPressed<PP.GamepadUtils._mySimultaneousPressMaxDelay)){s=!1;break}c.isPressEnd(t)&&(n=!0)}if(!s)break}return s&&n},isAnyButtonTouchStart:function(...e){let t=null,i=e;isNaN(e[0])||(t=e[0],i=e.slice(1));for(let n of i)if(n.length==1)for(let a in PP.GamepadButtonID)n.push(PP.GamepadButtonID[a]);let s=!1;for(let n of i){let a=n[0];for(let r=1;r<n.length;r++){let l=n[r];if(a.getButtonInfo(l).isTouchStart(t)){s=!0;break}}if(s)break}return s},areButtonsTouchStart:function(...e){let t=null,i=e;isNaN(e[0])||(t=e[0],i=e.slice(1));for(let a of i)if(a.length==1)for(let r in PP.GamepadButtonID)a.push(PP.GamepadButtonID[r]);let s=!0,n=!1;for(let a of i){let r=a[0];for(let l=1;l<a.length;l++){let y=a[l],c=r.getButtonInfo(y);if(!(c.myIsTouched&&(t==null||c.myMultipleTouchStartCount==t)&&c.myTimeTouched<PP.GamepadUtils._mySimultaneousTouchMaxDelay)){s=!1;break}c.isTouchStart(t)&&(n=!0)}if(!s)break}return s&&n},isAnyButtonTouchEnd:function(...e){let t=null,i=e;isNaN(e[0])||(t=e[0],i=e.slice(1));for(let n of i)if(n.length==1)for(let a in PP.GamepadButtonID)n.push(PP.GamepadButtonID[a]);let s=!1;for(let n of i){let a=n[0];for(let r=1;r<n.length;r++){let l=n[r];if(a.getButtonInfo(l).isTouchEnd(t)){s=!0;break}}if(s)break}return s},areButtonsTouchEnd:function(...e){let t=null,i=e;isNaN(e[0])||(t=e[0],i=e.slice(1));for(let a of i)if(a.length==1)for(let r in PP.GamepadButtonID)a.push(PP.GamepadButtonID[r]);let s=!0,n=!1;for(let a of i){let r=a[0];for(let l=1;l<a.length;l++){let y=a[l],c=r.getButtonInfo(y);if(!(!c.myIsTouched&&(t==null||c.myMultipleTouchEndCount==t)&&c.myTimeNotTouched<PP.GamepadUtils._mySimultaneousTouchMaxDelay)){s=!1;break}c.isTouchEnd(t)&&(n=!0)}if(!s)break}return s&&n}}});var ls=T(()=>{WL.registerComponent("pp-gamepad-control-scheme",{_myShowOnStart:{type:WL.Type.Bool,default:!0},_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_mySelectText:{type:WL.Type.String,default:""},_mySqueezeText:{type:WL.Type.String,default:""},_myThumbstickText:{type:WL.Type.String,default:""},_myBottomButtonText:{type:WL.Type.String,default:""},_myTopButtonText:{type:WL.Type.String,default:""},_mySelect:{type:WL.Type.Object,default:null},_mySqueeze:{type:WL.Type.Object,default:null},_myThumbstick:{type:WL.Type.Object,default:null},_myBottomButton:{type:WL.Type.Object,default:null},_myTopButton:{type:WL.Type.Object,default:null},_myTextScaleMultiplier:{type:WL.Type.Float,default:1},_myTextOffsetMultiplier:{type:WL.Type.Float,default:1},_myLineLengthMultiplier:{type:WL.Type.Float,default:1},_myLineThicknessMultiplier:{type:WL.Type.Float,default:1},_myDistanceFromButtonsMultiplier:{type:WL.Type.Float,default:1},_myTextMaterial:{type:WL.Type.Material},_myLineMaterial:{type:WL.Type.Material}},{init:function(){},start:function(){this._myTextMaterialFinal=this._myTextMaterial!=null?this._myTextMaterial:PP.myDefaultResources.myMaterials.myText.clone(),this._myLineMaterialFinal=this._myLineMaterial!=null?this._myLineMaterial:PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),this._myHandednessType=PP.InputUtils.getHandednessByIndex(this._myHandedness),this._myControlSchemeDirection=this._myHandednessType==PP.Handedness.LEFT?1:-1,this._myVisible=!1,this._mySetVisibleNextUpdate=!1,this._createControlScheme(),this.setVisible(this._myShowOnStart),this._myVisibleBackup=this._myVisible},update:function(e){this._mySetVisibleNextUpdate&&(this._mySetVisibleNextUpdate=!1,this.setVisible(!1),this.setVisible(this._myVisibleBackup))},onActivate(){this._mySetVisibleNextUpdate=!0},onDeactivate(){this._myVisibleBackup=this._myVisible,this.setVisible(!1)},isVisible(){return this._myVisible},setVisible(e){this._myVisible=e,this._myRootObject!=null&&(this._myRootObject.pp_setActive(this._myVisible),this._myVisible&&this._hideEmptySchemes())},setSelectText(e){this._mySelectText=e,this._mySelectTextComponent.text=this._mySelectText,this.setVisible(this._myVisible)},setSqueezeText(e){this._mySqueezeText=e,this._mySqueezeTextComponent.text=this._mySqueezeText,this.setVisible(this._myVisible)},setThumbstickText(e){this._myThumbstickText=e,this._myThumbstickTextComponent.text=this._myThumbstickText,this.setVisible(this._myVisible)},setBottomButtonText(e){this._myBottomButtonText=e,this._myBottomButtonTextComponent.text=this._myBottomButtonText,this.setVisible(this._myVisible)},setTopButtonText(e){this._myTopButtonText=e,this._myTopButtonTextComponent.text=this._myTopButtonText,this.setVisible(this._myVisible)},_createControlScheme(){this._myRootObject=this.object.pp_addObject();let e=.02*this._myDistanceFromButtonsMultiplier,t=.0935*this._myLineLengthMultiplier,i=this._myThumbstick;this._mySelectObject=this._myRootObject.pp_addObject(),this._mySelectTextComponent=this._addScheme(this._mySelect,i,[0,0,e],[t*this._myControlSchemeDirection,0,0],this._mySelectObject),this._mySelectTextComponent.text=this._mySelectText,this._mySqueezeObject=this._myRootObject.pp_addObject(),this._mySqueezeTextComponent=this._addScheme(this._mySqueeze,i,[e*this._myControlSchemeDirection,0,0],[t*this._myControlSchemeDirection,0,0],this._mySqueezeObject),this._mySqueezeTextComponent.text=this._mySqueezeText,this._myThumbstickObject=this._myRootObject.pp_addObject(),this._myThumbstickTextComponent=this._addScheme(this._myThumbstick,i,[0,e,0],[-t*this._myControlSchemeDirection,0,0],this._myThumbstickObject),this._myThumbstickTextComponent.text=this._myThumbstickText;let s=this._myThumbstick.pp_getPositionLocal(),n=this._myThumbstick.pp_getUpLocal();{let l=this._myBottomButton.pp_getPositionLocal().vec3_sub(s).vec3_valueAlongAxis(n);this._myBottomButtonObject=this._myRootObject.pp_addObject(),this._myBottomButtonTextComponent=this._addScheme(this._myBottomButton,i,[0,e-l,0],[0,0,-t],this._myBottomButtonObject),this._myBottomButtonTextComponent.text=this._myBottomButtonText}{let l=this._myTopButton.pp_getPositionLocal().vec3_sub(s).vec3_valueAlongAxis(n);this._myTopButtonObject=this._myRootObject.pp_addObject(),this._myTopButtonTextComponent=this._addScheme(this._myTopButton,i,[0,e-l,0],[-t*this._myControlSchemeDirection,0,0].vec3_rotateAxis(-45*this._myControlSchemeDirection,[0,1,0]),this._myTopButtonObject),this._myTopButtonTextComponent.text=this._myTopButtonText}},_addScheme(e,t,i,s,n){let a=e.pp_getPositionLocal(),r=t.pp_getForwardLocal(),l=t.pp_getRightLocal(),y=t.pp_getUpLocal(),c=a.vec3_add(l.vec3_scale(i[0]));c.vec3_add(y.vec3_scale(i[1]),c),c.vec3_add(r.vec3_scale(i[2]),c);let o=c.vec3_add(l.vec3_scale(s[0]));o.vec3_add(y.vec3_scale(s[1]),o),o.vec3_add(r.vec3_scale(s[2]),o);let m=.01*this._myTextOffsetMultiplier,u=o.vec3_add(r.vec3_scale(-m));return this._addLine(c,o,n),this._addText(u,r,y,n)},_addLine(e,t,i){let s=t.vec3_sub(e),n=s.vec3_length();s.vec3_normalize(s),lineRootObject=i.pp_addObject(),lineObject=lineRootObject.pp_addObject();let a=lineObject.addComponent("mesh");a.mesh=PP.myDefaultResources.myMeshes.myCylinder,a.material=this._myLineMaterialFinal,lineRootObject.pp_setPositionLocal(e);let r=.001*this._myLineThicknessMultiplier;lineObject.pp_scaleObject([r/2,n/2,r/2]),lineObject.pp_setUpLocal(s),lineObject.pp_translateObject([0,n/2,0])},_addText(e,t,i,s){let n=s.pp_addObject();n.pp_setPositionLocal(e),n.pp_lookToLocal(i,t),n.pp_scaleObject(.0935*this._myTextScaleMultiplier);let a=n.pp_addComponent("text");return a.alignment=WL.Alignment.Center,a.justification=WL.Justification.Top,a.material=this._myTextMaterialFinal,a},_hideEmptySchemes(){this._mySelectText.length==0&&this._mySelectObject.pp_setActive(!1),this._mySqueezeText.length==0&&this._mySqueezeObject.pp_setActive(!1),this._myThumbstickText.length==0&&this._myThumbstickObject.pp_setActive(!1),this._myBottomButtonText.length==0&&this._myBottomButtonObject.pp_setActive(!1),this._myTopButtonText.length==0&&this._myTopButtonObject.pp_setActive(!1)}})});var ms=T(()=>{PP.VirtualGamepad=class{constructor(t=new PP.VirtualGamepadParams){this._myParams=t,this._myVisible=!0,this._myVirtualGamepadContainer=null,this._myVirtualGamepadVirtualButtons=[],this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT]=[],this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT]=[],this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT][PP.GamepadButtonID.SELECT]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT][PP.GamepadButtonID.SQUEEZE]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT][PP.GamepadButtonID.THUMBSTICK]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT][PP.GamepadButtonID.TOP_BUTTON]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT][PP.GamepadButtonID.BOTTOM_BUTTON]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT][PP.GamepadButtonID.SELECT]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT][PP.GamepadButtonID.SQUEEZE]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT][PP.GamepadButtonID.THUMBSTICK]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT][PP.GamepadButtonID.TOP_BUTTON]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT][PP.GamepadButtonID.BOTTOM_BUTTON]=null,this._myButtonsAmount=this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT].length,this._myVirtualGamepadVirtualThumbsticks=[],this._myVirtualGamepadVirtualThumbsticks[PP.Handedness.LEFT]=null,this._myVirtualGamepadVirtualThumbsticks[PP.Handedness.RIGHT]=null}isVisible(){return this._myVisible}setVisible(t){if(this._myVisible!=t&&(this._myVisible=t,this._myVirtualGamepadContainer!=null)){this._myVisible?this._myVirtualGamepadContainer.style.display="block":this._myVirtualGamepadContainer.style.display="none";for(let i in this._myVirtualGamepadVirtualButtons)for(let s in this._myVirtualGamepadVirtualButtons[i]){let n=this._myVirtualGamepadVirtualButtons[i][s];n?.setActive(this._myVisible)}for(let i in this._myVirtualGamepadVirtualThumbsticks){let s=this._myVirtualGamepadVirtualThumbsticks[i];s?.setActive(this._myVisible)}}}isButtonPressed(t,i){if(!this._myVisible)return!1;let s=this._myVirtualGamepadVirtualButtons[t][i];return s!=null?s.isPressed():!1}getAxes(t,i=PP.vec2_create(0,0)){if(!this._myVisible)return i;let s=this._myVirtualGamepadVirtualThumbsticks[t];return s!=null&&i.vec2_copy(s.getAxes()),i}start(){this._buildVirtualGamepad();let t=this._myVisible;this._myVisible=!this._myVisible,this.setVisible(t)}update(t){if(this._myParams.myAutoUpdateVisibility&&(PP.XRUtils.isSessionActive()&&WL.vrSupported==1?this.setVisible(!1):this._myParams.myShowOnDesktop&&PP.BrowserUtils.isDesktop()&&WL.vrSupported==0?this.setVisible(!0):this._myParams.myShowOnHeadset&&PP.BrowserUtils.isDesktop()&&WL.vrSupported==1?this.setVisible(!0):this._myParams.myShowOnMobile&&PP.BrowserUtils.isMobile()?this.setVisible(!0):this.setVisible(!1)),this._myVisible){for(let i in this._myVirtualGamepadVirtualButtons)for(let s in this._myVirtualGamepadVirtualButtons[i]){let n=this._myVirtualGamepadVirtualButtons[i][s];n?.update(t)}for(let i in this._myVirtualGamepadVirtualThumbsticks){let s=this._myVirtualGamepadVirtualThumbsticks[i];s?.update(t)}this._setMouseHoverActive(!(this._myParams.myDisableMouseHoverWhenPressed&&this._isAnyElementPressed()))}}_buildVirtualGamepad(){this._documentBodySetup(),this._myVirtualGamepadContainer=document.createElement("div"),this._myVirtualGamepadContainer.style.display="block",this._myVirtualGamepadContainer.style.opacity=this._myParams.myOpacity.toString(),document.body.appendChild(this._myVirtualGamepadContainer);let t=document.createElement("div");this._myVirtualGamepadContainer.appendChild(t);let i=document.createElement("div");this._myVirtualGamepadContainer.appendChild(i);let s=this._myParams.myButtonsOrder[PP.Handedness.LEFT].length;for(let n=0;n<s;n++){if(this._myParams.myButtonsOrder[PP.Handedness.LEFT][n]!=null){let a=this._myParams.myButtonsOrder[PP.Handedness.LEFT][n][0],r=this._myParams.myButtonsOrder[PP.Handedness.LEFT][n][1];this._buildButton(t,PP.Handedness.LEFT,n,a,r)}if(this._myParams.myButtonsOrder[PP.Handedness.RIGHT][n]!=null){let a=this._myParams.myButtonsOrder[PP.Handedness.RIGHT][n][0],r=this._myParams.myButtonsOrder[PP.Handedness.RIGHT][n][1];this._buildButton(i,PP.Handedness.RIGHT,n,a,r)}}if(this._myParams.myThumbsticksOrder[PP.Handedness.LEFT]!=null){let n=this._myParams.myThumbsticksOrder[PP.Handedness.LEFT];this._buildThumbstick(t,PP.Handedness.LEFT,n)}if(this._myParams.myThumbsticksOrder[PP.Handedness.RIGHT]!=null){let n=this._myParams.myThumbsticksOrder[PP.Handedness.RIGHT];this._buildThumbstick(i,PP.Handedness.RIGHT,n)}}_documentBodySetup(){document.body.style.overflow="hidden",document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",document.body.style.webkitTapHighlightColor="transparent",document.body.style.touchAction="none",document.addEventListener("gesturestart",function(t){t.preventDefault()})}_buildButton(t,i,s,n,a){let r=new PP.VirtualGamepadVirtualButton(t,this._myParams,i,s,n,a);this._myVirtualGamepadVirtualButtons[n][a]=r}_buildThumbstick(t,i,s){let n=new PP.VirtualGamepadVirtualThumbstick(t,this._myParams,i,s);this._myVirtualGamepadVirtualThumbsticks[s]=n}_createSizeValue(t,i){return"min("+t.toFixed(3)+"vmax,"+(t*i).toFixed(3)+"vw)"}_isAnyElementPressed(){let t=!1;for(let i in this._myVirtualGamepadVirtualButtons)for(let s in this._myVirtualGamepadVirtualButtons[i]){let n=this._myVirtualGamepadVirtualButtons[i][s];if(n!=null&&n.isPressed()){t=!0;break}}if(!t)for(let i in this._myVirtualGamepadVirtualThumbsticks){let s=this._myVirtualGamepadVirtualThumbsticks[i];if(s!=null&&s.isPressed()){t=!0;break}}return t}_setMouseHoverActive(t){for(let i in this._myVirtualGamepadVirtualButtons)for(let s in this._myVirtualGamepadVirtualButtons[i]){let n=this._myVirtualGamepadVirtualButtons[i][s];n?.setMouseHoverActive(t)}for(let i in this._myVirtualGamepadVirtualThumbsticks){let s=this._myVirtualGamepadVirtualThumbsticks[i];s?.setMouseHoverActive(t)}}}});var ys=T(()=>{WL.registerComponent("pp-virtual-gamepad",{_myShowOnDesktop:{type:WL.Type.Bool,default:!1},_myShowOnMobile:{type:WL.Type.Bool,default:!0},_myShowOnHeadset:{type:WL.Type.Bool,default:!1},_myReleaseOnPointerLeave:{type:WL.Type.Bool,default:!1},_myAddToUniversalGamepad:{type:WL.Type.Bool,default:!0},_myOpacity:{type:WL.Type.Float,default:.5},_myIconColor:{type:WL.Type.String,default:"#e0e0e0"},_myBackgroundColor:{type:WL.Type.String,default:"#616161"},_myInterfaceScale:{type:WL.Type.Float,default:1},_myMarginScale:{type:WL.Type.Float,default:1},ADVANCED_PARAMS_BELOW:{type:WL.Type.String,default:""},_myLabelFontSize:{type:WL.Type.Float,default:2},_myLabelFontFamily:{type:WL.Type.String,default:"sans-serif"},_myLabelFontWeight:{type:WL.Type.String,default:"bold"},_myImagePressedBrightness:{type:WL.Type.Float,default:.5},_myLeftSelectButtonVisible:{type:WL.Type.Bool,default:!0},_myLeftSelectButtonOrderIndex:{type:WL.Type.Int,default:1},_myLeftSelectButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"frame"},_myLeftSelectButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myLeftSqueezeButtonVisible:{type:WL.Type.Bool,default:!0},_myLeftSqueezeButtonOrderIndex:{type:WL.Type.Int,default:0},_myLeftSqueezeButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"square"},_myLeftSqueezeButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myLeftThumbstickButtonVisible:{type:WL.Type.Bool,default:!0},_myLeftThumbstickButtonOrderIndex:{type:WL.Type.Int,default:4},_myLeftThumbstickButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"dot"},_myLeftThumbstickButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myLeftTopButtonVisible:{type:WL.Type.Bool,default:!0},_myLeftTopButtonOrderIndex:{type:WL.Type.Int,default:2},_myLeftTopButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"circle"},_myLeftTopButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myLeftBottomButtonVisible:{type:WL.Type.Bool,default:!0},_myLeftBottomButtonOrderIndex:{type:WL.Type.Int,default:3},_myLeftBottomButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"ring"},_myLeftBottomButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myRightSelectButtonVisible:{type:WL.Type.Bool,default:!0},_myRightSelectButtonOrderIndex:{type:WL.Type.Int,default:1},_myRightSelectButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"frame"},_myRightSelectButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myRightSqueezeButtonVisible:{type:WL.Type.Bool,default:!0},_myRightSqueezeButtonOrderIndex:{type:WL.Type.Int,default:0},_myRightSqueezeButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"square"},_myRightSqueezeButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myRightThumbstickButtonVisible:{type:WL.Type.Bool,default:!0},_myRightThumbstickButtonOrderIndex:{type:WL.Type.Int,default:4},_myRightThumbstickButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"dot"},_myRightThumbstickButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myRightTopButtonVisible:{type:WL.Type.Bool,default:!0},_myRightTopButtonOrderIndex:{type:WL.Type.Int,default:2},_myRightTopButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"circle"},_myRightTopButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myRightBottomButtonVisible:{type:WL.Type.Bool,default:!0},_myRightBottomButtonOrderIndex:{type:WL.Type.Int,default:3},_myRightBottomButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"ring"},_myRightBottomButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""}},{start(){let e=new PP.VirtualGamepadParams;e.defaultSetup();for(let t in e.myButtonParams)for(let i in e.myButtonParams[t]){let s=e.myButtonParams[t][i];s.myIconParams.myBackgroundColor=this._myBackgroundColor,s.myIconParams.myBackgroundPressedColor=this._myIconColor,s.myIconParams.myIconColor=this._myIconColor,s.myIconParams.myIconPressedColor=this._myBackgroundColor}for(let t in e.myThumbstickParams){let i=e.myThumbstickParams[t];i.myBackgroundColor=this._myBackgroundColor,i.myIconParams.myBackgroundColor=this._myIconColor,i.myIconParams.myBackgroundPressedColor=this._myIconColor,i.myIconParams.myIconColor=this._myBackgroundColor,i.myIconParams.myIconPressedColor=this._myBackgroundColor}e.myOpacity=this._myOpacity,e.myReleaseOnPointerLeave=this._myReleaseOnPointerLeave,e.myInterfaceScale=this._myInterfaceScale,e.myMarginScale=this._myMarginScale,e.myShowOnDesktop=this._myShowOnDesktop,e.myShowOnMobile=this._myShowOnMobile,e.myShowOnHeadset=this._myShowOnHeadset,e.myShowOnDesktop||e.myShowOnMobile||e.myShowOnHeadset?e.myAutoUpdateVisibility=!0:e.myAutoUpdateVisibility=!1,this._advancedSetup(e),this._myVirtualGamepad=new PP.VirtualGamepad(e),e.myAutoUpdateVisibility||this._myVirtualGamepad.setVisible(!1),this._myVirtualGamepad.start(),this._myFirstUpdate=!0},update(e){if(this._myFirstUpdate&&(this._myFirstUpdate=!1,this._myAddToUniversalGamepad)){let t=new PP.VirtualGamepadGamepadCore(this._myVirtualGamepad,PP.Handedness.LEFT,PP.myLeftGamepad.getGamepadCore("left_xr_gamepad").getHandPose()),i=new PP.VirtualGamepadGamepadCore(this._myVirtualGamepad,PP.Handedness.RIGHT,PP.myRightGamepad.getGamepadCore("right_xr_gamepad").getHandPose());PP.myLeftGamepad.addGamepadCore("left_virtual_gamepad",t),PP.myRightGamepad.addGamepadCore("right_virtual_gamepad",i)}this._myVirtualGamepad.update(e)},_advancedSetup(e){e.myButtonsOrder[PP.Handedness.LEFT]=[null,null,null,null,null],e.myButtonsOrder[PP.Handedness.RIGHT]=[null,null,null,null,null];{let t=e.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SELECT];t.myIconParams.myIconType=this._myLeftSelectButtonIconType,t.myIconParams.myLabel=this._myLeftSelectIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftSelectIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftSelectButtonVisible&&(e.myButtonsOrder[PP.Handedness.LEFT][this._myLeftSelectButtonOrderIndex]=[PP.Handedness.LEFT,PP.GamepadButtonID.SELECT])}{let t=e.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SQUEEZE];t.myIconParams.myIconType=this._myLeftSqueezeButtonIconType,t.myIconParams.myLabel=this._myLeftSqueezeIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftSqueezeIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftSqueezeButtonVisible&&(e.myButtonsOrder[PP.Handedness.LEFT][this._myLeftSqueezeButtonOrderIndex]=[PP.Handedness.LEFT,PP.GamepadButtonID.SQUEEZE])}{let t=e.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.THUMBSTICK];t.myIconParams.myIconType=this._myLeftThumbstickButtonIconType,t.myIconParams.myLabel=this._myLeftThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftThumbstickButtonVisible&&(e.myButtonsOrder[PP.Handedness.LEFT][this._myLeftThumbstickButtonOrderIndex]=[PP.Handedness.LEFT,PP.GamepadButtonID.THUMBSTICK])}{let t=e.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.TOP_BUTTON];t.myIconParams.myIconType=this._myLeftTopButtonIconType,t.myIconParams.myLabel=this._myLeftTopButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftTopButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftTopButtonVisible&&(e.myButtonsOrder[PP.Handedness.LEFT][this._myLeftTopButtonOrderIndex]=[PP.Handedness.LEFT,PP.GamepadButtonID.TOP_BUTTON])}{let t=e.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.BOTTOM_BUTTON];t.myIconParams.myIconType=this._myLeftBottomButtonIconType,t.myIconParams.myLabel=this._myLeftBottomButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftBottomButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftBottomButtonVisible&&(e.myButtonsOrder[PP.Handedness.LEFT][this._myLeftBottomButtonOrderIndex]=[PP.Handedness.LEFT,PP.GamepadButtonID.BOTTOM_BUTTON])}{let t=e.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SELECT];t.myIconParams.myIconType=this._myRightSelectButtonIconType,t.myIconParams.myLabel=this._myRightSelectIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightSelectIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightSelectButtonVisible&&(e.myButtonsOrder[PP.Handedness.RIGHT][this._myRightSelectButtonOrderIndex]=[PP.Handedness.RIGHT,PP.GamepadButtonID.SELECT])}{let t=e.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SQUEEZE];t.myIconParams.myIconType=this._myRightSqueezeButtonIconType,t.myIconParams.myLabel=this._myRightSqueezeIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightSqueezeIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightSqueezeButtonVisible&&(e.myButtonsOrder[PP.Handedness.RIGHT][this._myRightSqueezeButtonOrderIndex]=[PP.Handedness.RIGHT,PP.GamepadButtonID.SQUEEZE])}{let t=e.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.THUMBSTICK];t.myIconParams.myIconType=this._myRightThumbstickButtonIconType,t.myIconParams.myLabel=this._myRightThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightThumbstickButtonVisible&&(e.myButtonsOrder[PP.Handedness.RIGHT][this._myRightThumbstickButtonOrderIndex]=[PP.Handedness.RIGHT,PP.GamepadButtonID.THUMBSTICK])}{let t=e.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.TOP_BUTTON];t.myIconParams.myIconType=this._myRightTopButtonIconType,t.myIconParams.myLabel=this._myRightTopButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightTopButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightTopButtonVisible&&(e.myButtonsOrder[PP.Handedness.RIGHT][this._myRightTopButtonOrderIndex]=[PP.Handedness.RIGHT,PP.GamepadButtonID.TOP_BUTTON])}{let t=e.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.BOTTOM_BUTTON];t.myIconParams.myIconType=this._myRightBottomButtonIconType,t.myIconParams.myLabel=this._myRightBottomButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightBottomButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightBottomButtonVisible&&(e.myButtonsOrder[PP.Handedness.RIGHT][this._myRightBottomButtonOrderIndex]=[PP.Handedness.RIGHT,PP.GamepadButtonID.BOTTOM_BUTTON])}}})});var us=T(()=>{PP.VirtualGamepadButtonParams=class{constructor(){this.myIconParams=new PP.VirtualGamepadIconParams}};PP.VirtualGamepadThumbstickParams=class{constructor(){this.myBackgroundColor="",this.myBackgroundPressedColor="",this.myMaxDistanceFromCenterMultiplier=1,this.myReleaseTransitionSeconds=.2,this.myMoveTransitionSeconds=0,this.myIconParams=new PP.VirtualGamepadIconParams}};PP.VirtualGamepadParams=class{constructor(){this.myShowOnDesktop=!1,this.myShowOnMobile=!1,this.myShowOnHeadset=!1,this.myAutoUpdateVisibility=!1,this.myOpacity=1,this.myInterfaceScale=1,this.myMarginScale=1,this.myReleaseOnPointerLeave=!1,this.myStopPropagatingMouseDownEvents=!0,this.myButtonParams=[],this.myButtonParams[PP.Handedness.LEFT]=[],this.myButtonParams[PP.Handedness.RIGHT]=[],this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SELECT]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SQUEEZE]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.THUMBSTICK]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.TOP_BUTTON]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.BOTTOM_BUTTON]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SELECT]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SQUEEZE]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.THUMBSTICK]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.TOP_BUTTON]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.BOTTOM_BUTTON]=new PP.VirtualGamepadButtonParams,this.myThumbstickParams=[],this.myThumbstickParams[PP.Handedness.LEFT]=new PP.VirtualGamepadThumbstickParams,this.myThumbstickParams[PP.Handedness.RIGHT]=new PP.VirtualGamepadThumbstickParams,this.myButtonsOrder=[],this.myButtonsOrder[PP.Handedness.LEFT]=[null,null,null,null,null],this.myButtonsOrder[PP.Handedness.RIGHT]=[null,null,null,null,null],this.myThumbsticksOrder=[],this.myThumbsticksOrder[PP.Handedness.LEFT]=null,this.myThumbsticksOrder[PP.Handedness.RIGHT]=null,this.myValidPointerButtons=[],this.myMarginLeft=0,this.myMarginRight=0,this.myMarginBottom=0,this.myThumbstickSize=0,this.myButtonSize=0,this.myButtonsRingRadius=0,this.myButtonsRingStartAngle=0,this.myButtonsRingEndAngle=0,this.myFontSize=0,this.myMinSizeMultiplier=0,this.myDisableMouseHoverWhenPressed=!1}defaultSetup(){this.myShowOnMobile=!0,this.myAutoUpdateVisibility=!0,this.myOpacity=.5;let t="#616161",i="#e0e0e0",s=.75,n=.75;for(let a in this.myButtonParams)for(let r in this.myButtonParams[a]){let l=this.myButtonParams[a][r];l.myIconParams.myBackgroundColor=t,l.myIconParams.myBackgroundPressedColor=i,l.myIconParams.myIconColor=i,l.myIconParams.myIconPressedColor=t,l.myIconParams.myOverallHoveredBrightness=s}this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SQUEEZE].myIconParams.myIconType=PP.VirtualGamepadIconType.SQUARE,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SQUEEZE].myIconParams.myIconType=PP.VirtualGamepadIconType.SQUARE,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SELECT].myIconParams.myIconType=PP.VirtualGamepadIconType.FRAME,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SELECT].myIconParams.myIconType=PP.VirtualGamepadIconType.FRAME,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.TOP_BUTTON].myIconParams.myIconType=PP.VirtualGamepadIconType.CIRCLE,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.TOP_BUTTON].myIconParams.myIconType=PP.VirtualGamepadIconType.CIRCLE,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.BOTTOM_BUTTON].myIconParams.myIconType=PP.VirtualGamepadIconType.RING,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.BOTTOM_BUTTON].myIconParams.myIconType=PP.VirtualGamepadIconType.RING,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.THUMBSTICK].myIconParams.myIconType=PP.VirtualGamepadIconType.DOT,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.THUMBSTICK].myIconParams.myIconType=PP.VirtualGamepadIconType.DOT;for(let a in this.myThumbstickParams){let r=this.myThumbstickParams[a];r.myBackgroundColor=t,r.myIconParams.myBackgroundColor=i,r.myIconParams.myBackgroundPressedColor=i,r.myIconParams.myIconColor=t,r.myIconParams.myIconPressedColor=t,r.myIconParams.myOverallHoveredBrightness=n}this.myButtonsOrder[PP.Handedness.LEFT][0]=[PP.Handedness.LEFT,PP.GamepadButtonID.SQUEEZE],this.myButtonsOrder[PP.Handedness.LEFT][1]=[PP.Handedness.LEFT,PP.GamepadButtonID.SELECT],this.myButtonsOrder[PP.Handedness.LEFT][2]=[PP.Handedness.LEFT,PP.GamepadButtonID.TOP_BUTTON],this.myButtonsOrder[PP.Handedness.LEFT][3]=[PP.Handedness.LEFT,PP.GamepadButtonID.BOTTOM_BUTTON],this.myButtonsOrder[PP.Handedness.LEFT][4]=[PP.Handedness.LEFT,PP.GamepadButtonID.THUMBSTICK],this.myButtonsOrder[PP.Handedness.RIGHT][0]=[PP.Handedness.RIGHT,PP.GamepadButtonID.SQUEEZE],this.myButtonsOrder[PP.Handedness.RIGHT][1]=[PP.Handedness.RIGHT,PP.GamepadButtonID.SELECT],this.myButtonsOrder[PP.Handedness.RIGHT][2]=[PP.Handedness.RIGHT,PP.GamepadButtonID.TOP_BUTTON],this.myButtonsOrder[PP.Handedness.RIGHT][3]=[PP.Handedness.RIGHT,PP.GamepadButtonID.BOTTOM_BUTTON],this.myButtonsOrder[PP.Handedness.RIGHT][4]=[PP.Handedness.RIGHT,PP.GamepadButtonID.THUMBSTICK],this.myThumbsticksOrder[PP.Handedness.LEFT]=PP.Handedness.LEFT,this.myThumbsticksOrder[PP.Handedness.RIGHT]=PP.Handedness.RIGHT,this.myMarginLeft=3,this.myMarginRight=3,this.myMarginBottom=3,this.myThumbstickSize=15,this.myButtonSize=5,this.myButtonsRingRadius=12,this.myButtonsRingStartAngle=385,this.myButtonsRingEndAngle=245,this.myMinSizeMultiplier=5/3,this.myDisableMouseHoverWhenPressed=!0,this.myValidPointerButtons=[0]}}});var cs=T(()=>{PP.VirtualGamepadVirtualButton=class{constructor(t,i,s,n,a,r){this._myButtonElement=null,this._myButtonIcon=null,this._myIsActive=!0,this._myPointerID=null,this._myPointerButton=null,this._myIsPressed=!1,this._myVirtualGamepadParams=i,this._myParams=this._myVirtualGamepadParams.myButtonParams[a][r],this._build(t,s,n),this._myButtonElement.addEventListener("pointerdown",this._onPointerDown.bind(this,this._myVirtualGamepadParams.myStopPropagatingPointerDownEvents)),document.body.addEventListener("pointerup",this._onPointerUp.bind(this)),this._myVirtualGamepadParams.myReleaseOnPointerLeave&&document.body.addEventListener("pointerleave",this._onPointerLeave.bind(this)),this._myButtonElement.addEventListener("mouseenter",this._onButtonElementEnter.bind(this)),this._myButtonElement.addEventListener("mouseleave",this._onButtonElementLeave.bind(this))}isPressed(){return this._myIsActive&&this._myIsPressed}setActive(t){this._myIsActive!=t&&(this.reset(),this._myButtonIcon.reset()),this._myIsActive=t}setMouseHoverActive(t){this._myButtonIcon.setMouseHoverActive(t)}reset(){this._myButtonIcon.setPressed(!1),this._myIsPressed=!1,this._myPointerID=null,this._myPointerButton=null}update(t){this._myButtonIcon.update(t)}_onPointerDown(t,i){!this._myIsActive||this._myIsPressed||!this._myVirtualGamepadParams.myValidPointerButtons.pp_hasEqual(i.button)||(t&&i.stopPropagation(),i.preventDefault(),this._myButtonIcon.setPressed(!0),this._myPointerID=i.pointerId,this._myPointerButton=i.button,this._myIsPressed=!0)}_onPointerUp(t){!this._myIsActive||!this._myIsPressed||this._myPointerID==t.pointerId&&(this._myPointerButton!=null&&this._myPointerButton!=t.button||this.reset())}_onPointerLeave(t){!this._myIsActive||this._myPointerID==t.pointerId&&this.reset()}_onButtonElementEnter(t){!this._myIsActive||this._myButtonIcon.onMouseEnter(t)}_onButtonElementLeave(t){!this._myIsActive||this._myButtonIcon.onMouseLeave(t)}_build(t,i,s){let n=this._myVirtualGamepadParams.myButtonSize*this._myVirtualGamepadParams.myInterfaceScale,a=this._myVirtualGamepadParams.myButtonsRingRadius*this._myVirtualGamepadParams.myInterfaceScale,r=this._myVirtualGamepadParams.myThumbstickSize*this._myVirtualGamepadParams.myInterfaceScale,l=this._myVirtualGamepadParams.myMarginBottom*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,y=this._myVirtualGamepadParams.myMarginLeft*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,c=this._myVirtualGamepadParams.myMarginRight*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,o=this._myVirtualGamepadParams.myButtonsRingStartAngle,m=this._myVirtualGamepadParams.myButtonsRingEndAngle,u=Math.max(1,this._myVirtualGamepadParams.myMinSizeMultiplier/this._myVirtualGamepadParams.myInterfaceScale),h=this._myVirtualGamepadParams.myButtonsOrder[PP.Handedness.LEFT].length,_=(m-o)/(h-1),P=Math.pp_angleClamp(o+_*s);i==PP.Handedness.RIGHT&&(P=270+(270-P),P=Math.pp_angleClamp(P,!0));let p=360-P,g=document.createElement("div");g.style.position="absolute",g.style.width=this._createSizeValue(n,u),g.style.height=this._createSizeValue(n,u);let b=l+r/2-n/2;if(g.style.bottom=this._createSizeValue(b,u),i==PP.Handedness.LEFT){let C=y+r/2-n/2;g.style.left=this._createSizeValue(C,u)}else{let C=c+r/2-n/2;g.style.right=this._createSizeValue(C,u)}g.style.transform="rotate("+P+"deg) translateX("+this._createSizeValue(a,u)+")",t.appendChild(g),this._myButtonElement=document.createElement("div"),this._myButtonElement.style.position="absolute",this._myButtonElement.style.width="100%",this._myButtonElement.style.height="100%",this._myButtonElement.style.transform="rotate("+p+"deg)",g.appendChild(this._myButtonElement),this._myButtonIcon=new PP.VirtualGamepadIcon(this._myButtonElement,this._myParams.myIconParams,u,this._myVirtualGamepadParams.myInterfaceScale)}_createSizeValue(t,i){return"min("+t.toFixed(3)+"vmax,"+(t*i).toFixed(3)+"vw)"}}});var hs=T(()=>{PP.VirtualGamepadVirtualThumbstick=class{constructor(t,i,s,n){this._myThumbstickElement=null,this._myThumbstickElementHoverCheck=null,this._myThumbstickIcon=null,this._myThumbstickContainer=null,this._myIsActive=!0,this._myPointerID=null,this._myPointerButton=null,this._myThumbstickDragStartPosition=PP.vec2_create(),this._myAxes=PP.vec2_create(),this._myIsPressed=!1,this._myVirtualGamepadParams=i,this._myParams=this._myVirtualGamepadParams.myThumbstickParams[n],this._build(t,s),this._myThumbstickElement.addEventListener("pointerdown",this._onPointerDown.bind(this,this._myVirtualGamepadParams.myStopPropagatingPointerDownEvents)),document.body.addEventListener("pointerup",this._onPointerUp.bind(this)),document.body.addEventListener("pointermove",this._onPointerMove.bind(this)),this._myVirtualGamepadParams.myReleaseOnPointerLeave&&document.body.addEventListener("pointerleave",this._onPointerLeave.bind(this)),this._myThumbstickElement.addEventListener("mouseenter",this._onThumbstickElementEnter.bind(this)),this._myThumbstickElement.addEventListener("mouseleave",this._onThumbstickElementLeave.bind(this))}isPressed(){return this._myIsActive&&this._myIsPressed}getAxes(){return this._myAxes}setActive(t){this._myIsActive!=t&&(this.reset(),this._myThumbstickIcon.reset()),this._myIsActive=t}setMouseHoverActive(t){this._myThumbstickIcon.setMouseHoverActive(t)}reset(){this._myThumbstickIcon.setPressed(!1),this._myAxes[0]=0,this._myAxes[1]=0,this._myIsPressed=!1,this._myPointerID=null,this._myPointerButton=null,this._myThumbstickElement.style.transition="all "+this._myParams.myReleaseTransitionSeconds+"s ease 0s",this._myThumbstickElement.style.transform="translate(0px, 0px)"}update(t){this._myThumbstickIcon.update(t)}_onPointerDown(t,i){!this._myIsActive||this._myIsPressed||!this._myVirtualGamepadParams.myValidPointerButtons.pp_hasEqual(i.button)||(t&&i.stopPropagation(),i.preventDefault(),this._myThumbstickIcon.setPressed(!0),this._myPointerID=i.pointerId,this._myPointerButton=i.button,this._myThumbstickDragStartPosition[0]=i.clientX,this._myThumbstickDragStartPosition[1]=i.clientY,this._myIsPressed=!0)}_onPointerUp(t){if(!this._myIsActive||!this._myIsPressed||this._myPointerID!=t.pointerId||this._myPointerButton!=null&&this._myPointerButton!=t.button)return;this.reset();let i=this._myThumbstickElementHoverCheck.getBoundingClientRect();t.clientX>=i.left&&t.clientX<=i.right&&t.clientY>=i.top&&t.clientY<=i.bottom||this._myThumbstickIcon.resetMouseHoverCount()}_onPointerLeave(t){!this._myIsActive||this._myPointerID==t.pointerId&&this.reset()}_onThumbstickElementEnter(t){this._myThumbstickIcon.onMouseEnter(t)}_onThumbstickElementLeave(t){this._myThumbstickIcon.onMouseLeave(t)}_onPointerMove(t){if(!this._myIsActive||!this._myIsPressed||t.pointerId!=this._myPointerID)return;let i=t.clientX,s=t.clientY,a=this._myThumbstickContainer.getBoundingClientRect().width/2*this._myParams.myMaxDistanceFromCenterMultiplier,r=i-this._myThumbstickDragStartPosition[0],l=s-this._myThumbstickDragStartPosition[1],y=Math.atan2(l,r),c=Math.min(a,Math.hypot(r,l)),o=c*Math.cos(y),m=c*Math.sin(y);this._myThumbstickElement.style.transition="all "+this._myParams.myMoveTransitionSeconds+"s ease-out 0s",this._myThumbstickElement.style.transform="translate("+o+"px, "+m+"px)",this._myAxes[0]=o/a,this._myAxes[1]=-(m/a)}_build(t,i){let s=this._myVirtualGamepadParams.myThumbstickSize*this._myVirtualGamepadParams.myInterfaceScale,n=this._myVirtualGamepadParams.myMarginBottom*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,a=this._myVirtualGamepadParams.myMarginLeft*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,r=this._myVirtualGamepadParams.myMarginRight*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,l=Math.max(1,this._myVirtualGamepadParams.myMinSizeMultiplier/this._myVirtualGamepadParams.myInterfaceScale);this._myThumbstickContainer=document.createElement("div"),this._myThumbstickContainer.style.position="absolute",this._myThumbstickContainer.style.width=this._createSizeValue(s,l),this._myThumbstickContainer.style.height=this._createSizeValue(s,l),this._myThumbstickContainer.style.bottom=this._createSizeValue(n,l),i==PP.Handedness.LEFT?this._myThumbstickContainer.style.left=this._createSizeValue(a,l):this._myThumbstickContainer.style.right=this._createSizeValue(r,l),t.appendChild(this._myThumbstickContainer);let y=document.createElementNS("http://www.w3.org/2000/svg","svg");y.style.position="absolute",y.style.width="100%",y.style.height="100%",this._myThumbstickContainer.appendChild(y);let c=document.createElementNS("http://www.w3.org/2000/svg","circle");c.setAttributeNS(null,"cx","50%"),c.setAttributeNS(null,"cy","50%"),c.setAttributeNS(null,"r","48%"),c.style.fill=this._myParams.myBackgroundColor,y.appendChild(c),this._myThumbstickElementHoverCheck=document.createElement("div"),this._myThumbstickElementHoverCheck.style.position="absolute",this._myThumbstickElementHoverCheck.style.width="34%",this._myThumbstickElementHoverCheck.style.height="34%",this._myThumbstickElementHoverCheck.style.top="33%",this._myThumbstickElementHoverCheck.style.left="33%",this._myThumbstickContainer.appendChild(this._myThumbstickElementHoverCheck),this._myThumbstickElement=document.createElement("div"),this._myThumbstickElement.style.position="absolute",this._myThumbstickElement.style.width="34%",this._myThumbstickElement.style.height="34%",this._myThumbstickElement.style.top="33%",this._myThumbstickElement.style.left="33%",this._myThumbstickContainer.appendChild(this._myThumbstickElement),this._myThumbstickIcon=new PP.VirtualGamepadIcon(this._myThumbstickElement,this._myParams.myIconParams,l,this._myVirtualGamepadParams.myScale)}_createSizeValue(t,i){return"min("+t.toFixed(3)+"vmax,"+(t*i).toFixed(3)+"vw)"}}});var ps=T(()=>{PP.VirtualGamepadIconType={NONE:0,LABEL:1,IMAGE:2,DOT:3,CIRCLE:4,SQUARE:5,RING:6,FRAME:7};PP.VirtualGamepadIconParams=class{constructor(){this.myBackgroundColor="",this.myBackgroundPressedColor="",this.myIconColor="",this.myIconPressedColor="",this.myIconType=PP.VirtualGamepadIconType.NONE,this.myOverallHoveredBrightness=1,this.myLabel="",this.myLabelFontSize=0,this.myLabelFontFamily="",this.myLabelFontWeight="",this.myImageURL="",this.myImagePressedBrightness=1}};PP.VirtualGamepadIcon=class{constructor(t,i,s,n){this._myParams=i,this._myIconContainerElement=null,this._myBackgroundElement=null,this._myIconElement=null,this._myPressed=!1,this._myMouseHoverCount=0,this._myIsMouseHoverActive=!0,this._build(t,s,n)}update(t){this._myPressed||this._myMouseHoverCount==0||!this._myIsMouseHoverActive?this._myIconContainerElement.style.filter="none":this._myIconContainerElement.style.filter="brightness("+this._myParams.myOverallHoveredBrightness+")"}reset(){this.setPressed(!1),this._myMouseHoverCount=0,this._myIconContainerElement.style.filter="none"}setPressed(t){this._myPressed!=t&&(this._myPressed=t,this._myParams.myIconType!=PP.VirtualGamepadIconType.NONE&&this._myIconElement!=null&&(this._myPressed?(this._myBackgroundElement.style.fill=this._myParams.myBackgroundPressedColor,this._myIconElement.style.strokeWidth.length>0?this._myIconElement.style.stroke=this._myParams.myIconPressedColor:this._myIconElement.style.fill=this._myParams.myIconPressedColor,this._myParams.myIconType==PP.VirtualGamepadIconType.IMAGE&&(this._myIconElement.style.filter="brightness("+this._myParams.myImagePressedBrightness+")")):(this._myBackgroundElement.style.fill=this._myParams.myBackgroundColor,this._myIconElement.style.strokeWidth.length>0?this._myIconElement.style.stroke=this._myParams.myIconColor:this._myIconElement.style.fill=this._myParams.myIconColor,this._myParams.myIconType==PP.VirtualGamepadIconType.IMAGE&&(this._myIconElement.style.filter="none"))))}onMouseEnter(){this._myMouseHoverCount++}onMouseLeave(){this._myMouseHoverCount--,this._myMouseHoverCount=Math.max(0,this._myMouseHoverCount)}resetMouseHoverCount(){this._myMouseHoverCount=0}setMouseHoverActive(t){this._myIsMouseHoverActive=t}_build(t,i,s){switch(this._myIconContainerElement=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._myIconContainerElement.style.position="absolute",this._myIconContainerElement.style.width="100%",this._myIconContainerElement.style.height="100%",t.appendChild(this._myIconContainerElement),this._myBackgroundElement=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._myBackgroundElement.setAttributeNS(null,"cx","50%"),this._myBackgroundElement.setAttributeNS(null,"cy","50%"),this._myBackgroundElement.setAttributeNS(null,"r","50%"),this._myBackgroundElement.style.fill=this._myParams.myBackgroundColor,this._myIconContainerElement.appendChild(this._myBackgroundElement),this._myParams.myIconType){case PP.VirtualGamepadIconType.NONE:break;case PP.VirtualGamepadIconType.LABEL:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","text"),this._myIconElement.setAttributeNS(null,"x","50%"),this._myIconElement.setAttributeNS(null,"y","50%"),this._myIconElement.style.textAlign="center",this._myIconElement.style.textAnchor="middle",this._myIconElement.style.dominantBaseline="central",this._myIconElement.style.alignmentBaseline="central",this._myIconElement.style.fontFamily=this._myParams.myLabelFontFamily,this._myIconElement.style.fontWeight=this._myParams.myLabelFontWeight,this._myIconElement.style.fontSize=this._createSizeValue(this._myParams.myLabelFontSize*s,i),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.textContent=this._myParams.myLabel,this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.IMAGE:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","image"),this._myIconElement.setAttributeNS(null,"x","0%"),this._myIconElement.setAttributeNS(null,"y","0%"),this._myIconElement.setAttribute("href",this._myParams.myImageURL),this._myIconElement.style.width="100%",this._myIconElement.style.height="100%",this._myIconElement.style.filter="none",this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.DOT:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","17.5%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.CIRCLE:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","24%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.SQUARE:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._myIconElement.setAttributeNS(null,"x","28%"),this._myIconElement.setAttributeNS(null,"y","28%"),this._myIconElement.setAttributeNS(null,"rx","10%"),this._myIconElement.setAttributeNS(null,"ry","10%"),this._myIconElement.setAttributeNS(null,"width","44%"),this._myIconElement.setAttributeNS(null,"height","44%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.transformOrigin="center",this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.RING:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","20%"),this._myIconElement.style.fill="#00000000",this._myIconElement.style.stroke=this._myParams.myIconColor,this._myIconElement.style.strokeWidth="10%",this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.FRAME:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._myIconElement.setAttributeNS(null,"x","31.5%"),this._myIconElement.setAttributeNS(null,"y","31.5%"),this._myIconElement.setAttributeNS(null,"rx","10%"),this._myIconElement.setAttributeNS(null,"ry","10%"),this._myIconElement.setAttributeNS(null,"width","37%"),this._myIconElement.setAttributeNS(null,"height","37%"),this._myIconElement.style.fill="#00000000",this._myIconElement.style.stroke=this._myParams.myIconColor,this._myIconElement.style.strokeWidth="10%",this._myIconElement.style.transformOrigin="center",this._myIconContainerElement.appendChild(this._myIconElement);break}}_createSizeValue(t,i){return"min("+t.toFixed(3)+"vmax,"+(t*i).toFixed(3)+"vw)"}_invertColors(){this._myIconElement.style.strokeWidth.length>0?(this._myBackgroundElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.stroke=this._myParams.myBackgroundColor):(this._myBackgroundElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.fill=this._myParams.myBackgroundColor)}}});var ds=T(()=>{PP.BasePoseParams=class{constructor(){this.myReferenceObject=null,this.myFixForward=!0,this.myForceEmulatedVelocities=!1}};PP.BasePose=class{constructor(t=new PP.BasePoseParams){this._myFixForward=t.myFixForward,this._myForceEmulatedVelocities=t.myForceEmulatedVelocities,this._myReferenceSpace=null,this._myReferenceObject=t.myReferenceObject,this._myPosition=[0,0,0],this._myRotation=[0,0,0,1],this._myPrevPosition=[0,0,0],this._myPrevRotation=[0,0,0,1],this._myLinearVelocity=[0,0,0],this._myAngularVelocity=[0,0,0],this._myIsValid=!1,this._myIsLinearVelocityEmulated=!0,this._myIsAngularVelocityEmulated=!0}setReferenceObject(t){this._myReferenceObject=t}getReferenceObject(){return this._myReferenceObject}setFixForward(t){this._myFixForward=t}isFixForward(){return this._myFixForward}setForceEmulatedVelocities(t){this._myForceEmulatedVelocities=t}isForceEmulatedVelocities(){return this._myForceEmulatedVelocities}getReferenceSpace(){return this._myReferenceSpace}getInputSource(){return this._myInputSource}getPosition(){}getRotation(){return this.getRotationDegrees()}getRotationDegrees(){return this.getRotationQuat().quat_toDegrees()}getRotationRadians(){return this.getRotationQuat().quat_toRadians()}getRotationQuat(){}getTransform(){return this.getTransformMatrix()}getTransformMatrix(){}getTransformQuat(){}getLinearVelocity(){}getAngularVelocity(){return this.getAngularVelocityDegrees()}getAngularVelocityDegrees(){}getAngularVelocityRadians(){}isValid(){return this._myIsValid}isLinearVelocityEmulated(){return this._myIsLinearVelocityEmulated}isAngularVelocityEmulated(){return this._myIsAngularVelocityEmulated}start(){WL.xrSession&&this._onXRSessionStart(!0,WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this,!1)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}update(t){this._myPrevPosition.vec3_copy(this._myPosition),this._myPrevRotation.quat_copy(this._myRotation);let i=Module.webxr_frame;if(i&&this._isReadyToGetPose()){let s=null;try{s=this._getPose(i)}catch{}s?(this._myPosition[0]=s.transform.position.x,this._myPosition[1]=s.transform.position.y,this._myPosition[2]=s.transform.position.z,this._myRotation[0]=s.transform.orientation.x,this._myRotation[1]=s.transform.orientation.y,this._myRotation[2]=s.transform.orientation.z,this._myRotation[3]=s.transform.orientation.w,s.linearVelocity&&!this._myForceEmulatedVelocities?(this._myLinearVelocity[0]=s.linearVelocity.x,this._myLinearVelocity[1]=s.linearVelocity.y,this._myLinearVelocity[2]=s.linearVelocity.z,this._myIsLinearVelocityEmulated=!1):(this._computeEmulatedLinearVelocity(t),this._myIsLinearVelocityEmulated=!0),s.angularVelocity&&!this._myForceEmulatedVelocities?(this._myAngularVelocity[0]=s.angularVelocity.x,this._myAngularVelocity[1]=s.angularVelocity.y,this._myAngularVelocity[2]=s.angularVelocity.z,this._myIsAngularVelocityEmulated=!1):(this._computeEmulatedAngularVelocity(t),this._myIsAngularVelocityEmulated=!0),this._myIsValid=!0):(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0,this._myAngularVelocity[0]=0,this._myAngularVelocity[1]=0,this._myAngularVelocity[2]=0,this._myIsValid=!1,this._myIsLinearVelocityEmulated=!0,this._myIsAngularVelocityEmulated=!0),this._updateHook(t,s)}else this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0,this._myAngularVelocity[0]=0,this._myAngularVelocity[1]=0,this._myAngularVelocity[2]=0,this._myIsValid=!1,this._myIsLinearVelocityEmulated=!0,this._myIsAngularVelocityEmulated=!0,this._updateHook(t,null)}_isReadyToGetPose(){return!0}_getPose(t){return null}_updateHook(t,i){}_onXRSessionStartHook(t,i){}_onXRSessionEndHook(){}_computeEmulatedLinearVelocity(t){t>0?(this._myPosition.vec3_sub(this._myPrevPosition,this._myLinearVelocity),this._myLinearVelocity.vec3_scale(1/t,this._myLinearVelocity)):(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0)}_onXRSessionStart(t,i){i.requestReferenceSpace(WebXR.refSpace).then(function(s){this._myReferenceSpace=s}.bind(this)),this._onXRSessionStartHook(t,i)}_onXRSessionEnd(){this._onXRSessionEndHook(),this._myReferenceSpace=null}};PP.BasePose.prototype.getPosition=function(){let e=PP.vec3_create(),t=PP.mat4_create();return function(){return this._myReferenceObject==null?this._myPosition:this._myPosition.vec3_convertPositionToWorld(this._myReferenceObject.pp_getTransform(t),e)}}();PP.BasePose.prototype.getRotationQuat=function(){let e=PP.quat_create(),t=PP.quat_create(),i=PP.vec3_create();return function(){return e.quat_copy(this._myRotation),this._myFixForward&&e.quat_rotateAxisRadians(Math.PI,e.quat_getUp(i),e),this._myReferenceObject==null?e:e.quat_toWorld(this._myReferenceObject.pp_getRotationQuat(t),e)}}();PP.BasePose.prototype.getTransformMatrix=function(){let e=PP.mat4_create();return function(){return this.getTransformQuat().quat2_toMatrix(e)}}();PP.BasePose.prototype.getTransformQuat=function(){let e=PP.quat2_create(),t=PP.quat2_create();return function(){return e.quat2_setPositionRotationQuat(this._myPosition,this.getRotationQuat()),this._myReferenceObject==null?e:e.quat_toWorld(this._myReferenceObject.pp_getTransformQuat(t),e)}}();PP.BasePose.prototype.getLinearVelocity=function(){let e=PP.vec3_create(),t=PP.mat4_create();return function(){return this._myReferenceObject==null?this._myLinearVelocity:this._myLinearVelocity.vec3_convertDirectionToWorld(this._myReferenceObject.pp_getTransform(t),e)}}();PP.BasePose.prototype.getAngularVelocityDegrees=function(){let e=PP.vec3_create();return function(){this.getAngularVelocityRadians().vec3_toDegrees(e)}}();PP.BasePose.prototype.getAngularVelocityRadians=function(){let e=PP.vec3_create(),t=PP.mat4_create();return function(){return this._myReferenceObject==null?this._myAngularVelocity:this._myAngularVelocity.vec3_convertDirectionToWorld(this._myReferenceObject.pp_getTransform(t),e)}}();PP.BasePose.prototype._computeEmulatedAngularVelocity=function(){let e=PP.vec3_create(),t=PP.vec3_create();return function(s){s>0?(e=this._myRotation.quat_toRadians(e),t=this._myPrevRotation.quat_toRadians(t),e.vec3_sub(t,this._myAngularVelocity),this._myAngularVelocity.vec3_scale(1/s,this._myAngularVelocity)):(this._myAngularVelocity[0]=0,this._myAngularVelocity[1]=0,this._myAngularVelocity[2]=0)}}();Object.defineProperty(PP.BasePose.prototype,"getPosition",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getRotationQuat",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getTransformMatrix",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getTransformQuat",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getLinearVelocity",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getAngularVelocityDegrees",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getAngularVelocityRadians",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"_computeEmulatedAngularVelocity",{enumerable:!1})});var _s=T(()=>{PP.HandPoseParams=class extends PP.BasePoseParams{constructor(){super(),this.myFixTrackedHandRotation=!0}};PP.HandPose=class extends PP.BasePose{constructor(t,i=new PP.HandPoseParams){super(i),this._myInputSource=null,this._myHandedness=t,this._myFixTrackedHandRotation=i.myFixTrackedHandRotation,this._myIsTrackedHand=!1}getInputSourceType(){return this._myInputSource==null?null:PP.InputUtils.getInputSourceType(this._myInputSource)}isFixTrackedHandRotation(){return this._myFixTrackedHandRotation}setFixTrackedHandRotation(t){this.myFixTrackedHandRotation=t}_isReadyToGetPose(){return this._myInputSource!=null}_getPose(t){return t.getPose(this._myInputSource.gripSpace,this._myReferenceSpace)}_onXRSessionStartHook(t,i){if(i.addEventListener("inputsourceschange",function(s){if(s.removed)for(let n of s.removed)n==this._myInputSource&&(this._myInputSource=null);if(s.added)for(let n of s.added)n.handedness==this._myHandedness&&(this._myInputSource=n,this._myIsTrackedHand=PP.InputUtils.getInputSourceType(this._myInputSource)==PP.InputSourceType.TRACKED_HAND)}.bind(this)),t&&this._myInputSource==null&&i.inputSources)for(let s of i.inputSources)s.handedness==this._myHandedness&&(this._myInputSource=s,this._myIsTrackedHand=PP.InputUtils.getInputSourceType(this._myInputSource)==PP.InputSourceType.TRACKED_HAND)}_onXRSessionEndHook(){this._myInputSource=null}};PP.HandPose.prototype.getRotationQuat=function(){let e=PP.quat_create(),t=PP.quat_create(),i=PP.vec3_create(),s=PP.vec3_create(),n=PP.vec3_create();return function(){if(e.quat_copy(this._myRotation),this._myFixForward&&e.quat_rotateAxisRadians(Math.PI,e.quat_getUp(i),e),this._myFixTrackedHandRotation&&this._myIsTrackedHand){e.quat_rotateAxis(-60,e.quat_getRight(s),e);let r=20;r=this._myHandedness==PP.Handedness.LEFT?r:-r,e.quat_rotateAxis(r,e.quat_getForward(n),e)}return this._myReferenceObject==null?e:e.quat_toWorld(this._myReferenceObject.pp_getRotationQuat(t),e)}}();Object.defineProperty(PP.HandPose.prototype,"getRotationQuat",{enumerable:!1})});var Ps=T(()=>{PP.HeadPose=class extends PP.BasePose{_getPose(t){return t.getViewerPose(this._myReferenceSpace)}}});var gs=T(()=>{PP.TrackedHandJointPose=class extends PP.BasePose{constructor(t,i,s=new PP.BasePoseParams){super(s),this._myInputSource=null,this._myHandedness=t,this._myTrackedHandJointID=i,this._myJointRadius=0}getTrackedHandJointID(){return this._myTrackedHandJointID}setTrackedHandJointID(t){this._myTrackedHandJointID=t}getJointRadius(){return this._myJointRadius}_isReadyToGetPose(){return this._myInputSource!=null}_getPose(t){return t.getJointPose(this._myInputSource.hand.get(this._myTrackedHandJointID),this._myReferenceSpace)}_updateHook(t,i){i!=null&&(this._myJointRadius=i.radius)}_onXRSessionStartHook(t,i){if(i.addEventListener("inputsourceschange",function(s){if(s.removed)for(let n of s.removed)n==this._myInputSource&&(this._myInputSource=null);if(s.added)for(let n of s.added)n.handedness==this._myHandedness&&PP.InputUtils.getInputSourceType(n)==PP.InputSourceType.TRACKED_HAND&&(this._myInputSource=n)}.bind(this)),t&&this._myInputSource==null&&i.inputSources)for(let s of i.inputSources)s.handedness==this._myHandedness&&PP.InputUtils.getInputSourceType(s)==PP.InputSourceType.TRACKED_HAND&&(this._myInputSource=s)}_onXRSessionEndHook(){this._myInputSource=null}}});var fs=T(()=>{PP.TrackedHandPoseParams=class extends PP.BasePoseParams{constructor(t=!0){if(super(),this.myTrackedHandJointIDList=[],t)for(let i in PP.TrackedHandJointID)this.myTrackedHandJointIDList.push([PP.TrackedHandJointID[i]])}};PP.TrackedHandPose=class{constructor(t,i=new PP.TrackedHandPoseParams){this._myHandedness=t,this._myFixForward=i.myFixForward,this._myForceEmulatedVelocities=i.myForceEmulatedVelocities,this._myReferenceObject=i.myReferenceObject,this._myTrackedHandJointPoseParams=new PP.BasePoseParams,this._myTrackedHandJointPoseParams.myFixForward=this._myFixForward,this._myTrackedHandJointPoseParams.myForceEmulatedVelocities=this._myForceEmulatedVelocities,this._myTrackedHandJointPoseParams.myReferenceObject=this._myReferenceObject,this._myTrackedHandJointPoseList=[];for(let s of i.myTrackedHandJointIDList){let n=new PP.TrackedHandJointPose(this._myHandedness,s,this._myTrackedHandJointPoseParams);this._myTrackedHandJointPoseList[s]=n}}start(){for(let t in this._myTrackedHandJointPoseList)this._myTrackedHandJointPoseList[t].start()}update(t){for(let i in this._myTrackedHandJointPoseList)this._myTrackedHandJointPoseList[i].update(t)}getJointPose(t){return this._myTrackedHandJointPoseList[t]}getJointPoseByIndex(t){return this._myTrackedHandJointPoseList[PP.InputUtils.getJointIDByIndex(t)]}addTrackedHandJointID(t){if(!this._myTrackedHandJointPoseList.pp_has(i=>i.getTrackedHandJointID()==t)){let i=new PP.TrackedHandJointPose(this._myHandedness,t,this._myTrackedHandJointPoseParams);this._myTrackedHandJointPoseList.push(i)}}removeTrackedHandJointID(t){this._myTrackedHandJointPoseList.pp_remove(i=>i.getTrackedHandJointID()==t)}setReferenceObject(t){this._myReferenceObject=t,this._myTrackedHandJointPoseParams.myReferenceObject=this._myReferenceObject;for(let i in this._myTrackedHandJointPoseList)this._myTrackedHandJointPoseList[i].setReferenceObject(t)}getReferenceObject(){return this._myReferenceObject}setFixForward(t){this._myFixForward=t,this._myTrackedHandJointPoseParams.myFixForward=this._myFixForward;for(let i in this._myTrackedHandJointPoseList)this._myTrackedHandJointPoseList[i].setFixForward(t)}isFixForward(){return this._myFixForward}setForceEmulatedVelocities(t){this._myForceEmulatedVelocities=t,this._myTrackedHandJointPoseParams.myForceEmulatedVelocities=this._myForceEmulatedVelocities;for(let i in this._myTrackedHandJointPoseList)this._myTrackedHandJointPoseList[i].setForceEmulatedVelocities(t)}isForceEmulatedVelocities(){return this._myForceEmulatedVelocities}}});var Ts=T(()=>{WL.registerComponent("pp-set-player-height",{_myEyesHeight:{type:WL.Type.Float,default:1.65},_mySetOnlyOnStart:{type:WL.Type.Bool,default:!1}},{start(){let e=this.object.pp_getPositionLocal();this.object.pp_setPositionLocal([e[0],this._myEyesHeight,e[2]]),this._myHeightSetOnce=!1,WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))},_onXRSessionStart(){if(this.active&&(!this._mySetOnlyOnStart||!this._myHeightSetOnce)){let e=this.object.pp_getPositionLocal();PP.XRUtils.isReferenceSpaceLocalFloor()?this.object.pp_setPositionLocal([e[0],0,e[2]]):PP.XRUtils.isDeviceEmulated()?this.object.pp_setPositionLocal([e[0],0,e[2]]):this.object.pp_setPositionLocal([e[0],this._myEyesHeight,e[2]]),this._myHeightSetOnce=!0}},_onXRSessionEnd(){if(this.active&&!this._mySetOnlyOnStart){let e=this.object.pp_getPositionLocal();this.object.pp_setPositionLocal([e[0],this._myEyesHeight,e[2]])}}})});var bs=T(()=>{WL.registerComponent("pp-set-hand-local-transform",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0}},{init:function(){this._myHandPose=new PP.HandPose(PP.InputUtils.getHandednessByIndex(this._myHandedness)),this._myHandPose.setFixForward(this._myFixForward)},start:function(){this._myHandPose.start()},update:function(){let e=PP.quat2_create();return function(i){this._myHandPose.update(i),this.object.pp_setTransformLocalQuat(this._myHandPose.getTransformQuat(e))}}()})});var Cs=T(()=>{WL.registerComponent("pp-set-head-local-transform",{_myNonVRCamera:{type:WL.Type.Object},_myFixForward:{type:WL.Type.Bool,default:!0}},{init:function(){this._myHeadPose=new PP.HeadPose,this._myHeadPose.setFixForward(this._myFixForward)},start:function(){this._myHeadPose.start()},update:function(){let e=PP.quat2_create(),t=PP.quat_create(),i=PP.vec3_create(),s=PP.vec3_create();return function(a){this._myHeadPose.update(a),PP.XRUtils.isSessionActive()?this.object.pp_setTransformLocalQuat(this._myHeadPose.getTransformQuat(e)):(t=this._myNonVRCamera.pp_getRotationLocalQuat(t),this._myFixForward&&t.quat_rotateAxisRadians(Math.PI,t.quat_getUp(i),t),this.object.pp_setPositionLocal(this._myNonVRCamera.pp_getPositionLocal(s)),this.object.pp_setRotationLocalQuat(t))}}()})});var Ss=T(()=>{WL.registerComponent("pp-set-vr-head-local-transform",{_myFixForward:{type:WL.Type.Bool,default:!0}},{init:function(){this._myHeadPose=new PP.HeadPose,this._myHeadPose.setFixForward(this._myFixForward)},start:function(){this._myHeadPose.start()},update:function(){let e=PP.quat2_create();return function(i){this._myHeadPose.update(i),this.object.pp_setTransformLocalQuat(this._myHeadPose.getTransformQuat(e))}}()})});var xs=T(()=>{WL.registerComponent("pp-set-non-vr-head-local-transform",{_myNonVRCamera:{type:WL.Type.Object},_myFixForward:{type:WL.Type.Bool,default:!0}},{init:function(){},start:function(){},update:function(e){let t=PP.quat_create(),i=PP.vec3_create(),s=PP.vec3_create();return function(a){t=this._myNonVRCamera.pp_getRotationLocalQuat(t),this._myFixForward&&t.quat_rotateAxisRadians(Math.PI,t.quat_getUp(i),t),this.object.pp_setPositionLocal(this._myNonVRCamera.pp_getPositionLocal(s)),this.object.pp_setRotationLocalQuat(t)}}()})});var vs=T(()=>{WL.registerComponent("pp-set-tracked-hand-joint-local-transform",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0},_mySetLocalScaleAsJointRadius:{type:WL.Type.Bool,default:!1},_myJointID:{type:WL.Type.Enum,values:["Wrist","Thumb Metacarpal","Thumb Phalanx Proximal","Thumb Phalanx Distal","Thumb Tip","Index Metacarpal","Index Phalanx Proximal","Index Phalanx Intermediate","Index Phalanx Distal","Index Tip","Middle Metacarpal","Middle Phalanx Proximal","Middle Phalanx Intermediate","Middle Phalanx Distal","Middle Tip","Ring Metacarpal","Ring Phalanx Proximal","Ring Phalanx Intermediate","Ring Phalanx Distal","Ring Tip","Pinky Metacarpal","Pinky Phalanx Proximal","Pinky Phalanx Intermediate","Pinky Phalanx Distal","Pinky Tip"],default:"Wrist"}},{init:function(){this._myHandednessInternal=PP.InputUtils.getHandednessByIndex(this._myHandedness),this._myJointIDInternal=PP.InputUtils.getJointIDByIndex(this._myJointID),this._myTrackedHandJointPose=new PP.TrackedHandJointPose(this._myHandednessInternal,this._myJointIDInternal),this._myTrackedHandJointPose.setFixForward(this._myFixForward)},start:function(){this._myTrackedHandJointPose.start()},update:function(e){this._myTrackedHandJointPose.update(e),this.object.pp_setTransformLocalQuat(this._myTrackedHandJointPose.getTransformQuat()),this._mySetLocalScaleAsJointRadius&&this.object.pp_setScaleLocal(this._myTrackedHandJointPose.getJointRadius())}})});var Bs=T(()=>{WL.registerComponent("pp-copy-hand-transform",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"}},{init:function(){this._myHandednessType=this._myHandedness==0?PP.Handedness.LEFT:PP.Handedness.RIGHT},update:function(e){let t=PP.myPlayerObjects.myHands[this._myHandednessType];this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}})});var Ms=T(()=>{WL.registerComponent("pp-copy-head-transform",{},{update:function(e){let t=PP.myPlayerObjects.myHead;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}})});var Is=T(()=>{WL.registerComponent("pp-copy-player-transform",{},{update:function(e){let t=PP.myPlayerObjects.myPlayer;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}})});var Ls=T(()=>{WL.registerComponent("pp-copy-player-pivot-transform",{},{update:function(e){let t=PP.myPlayerObjects.myPlayerPivot;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}})});var Vs=T(()=>{PP.ToolHandedness={NONE:null,LEFT:"left",RIGHT:"right"};PP.ToolInputSourceType={NONE:null,GAMEPAD:0,TRACKED_HAND:1}});var As=T(()=>{WL.registerComponent("pp-tool-cursor",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0},_myApplyDefaultCursorOffset:{type:WL.Type.Bool,default:!0},_myPulseOnHover:{type:WL.Type.Bool,default:!1},_myShowFingerCursor:{type:WL.Type.Bool,default:!1}},{init:function(){this._myHandednessString=["left","right"][this._myHandedness],this._myCursorPositionDefaultOffset=[0,-.035,-.05],this._myCursorRotationDefaultOffset=[-30,0,0],this._myCursorMeshScale=[.0025,.0025,.0025],this._myCursorColor=[255/255,255/255,255/255,1],this._myCursorTargetCollisionGroup=7},start:function(){this._myFixForwardObject=WL.scene.addObject(this.object),this._myFixForward&&this._myFixForwardObject.pp_rotateObject([0,180,0]),this._myCursorObjectVR=WL.scene.addObject(this._myFixForwardObject),this._myApplyDefaultCursorOffset&&(this._myCursorObjectVR.pp_setPositionLocal(this._myCursorPositionDefaultOffset),this._myCursorObjectVR.pp_rotateObject(this._myCursorRotationDefaultOffset));{let i=WL.scene.addObject(this._myCursorObjectVR);i.pp_setScale(this._myCursorMeshScale);let s=i.addComponent("mesh");s.mesh=PP.myDefaultResources.myMeshes.mySphere,s.material=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),s.material.color=this._myCursorColor;let n=this._myCursorObjectVR.addComponent("cursor",{collisionGroup:this._myCursorTargetCollisionGroup,handedness:this._myHandedness+1,cursorObject:i});n.rayCastMode=0,this._myPulseOnHover&&n.globalTarget.addHoverFunction(this._pulseOnHover.bind(this))}this._myCursorObjectNonVR=WL.scene.addObject(null);{let i=this._myCursorObjectNonVR.addComponent("cursor",{collisionGroup:this._myCursorTargetCollisionGroup,handedness:this._myHandedness+1});i.rayCastMode=0,this._myPulseOnHover&&i.globalTarget.addHoverFunction(this._pulseOnHover.bind(this)),i.setViewComponent(PP.myPlayerObjects.myNonVRCamera.getComponent("view"))}let e=null,t=.0125;if(this._myShowFingerCursor){e=this.object.pp_addObject();let i=e.addComponent("mesh");i.mesh=PP.myDefaultResources.myMeshes.mySphere,i.material=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),i.material.color=this._myCursorColor,e.pp_setScale(t)}this._myFingerCursorObject=WL.scene.addObject(this.object),this._myFingerCursorComponent=this._myFingerCursorObject.addComponent("pp-finger-cursor",{_myHandedness:this._myHandedness,_myEnableMultipleClicks:!0,_myCollisionGroup:this._myCursorTargetCollisionGroup,_myCollisionSize:t,_myCursorObject:e}),this._myCursorObjectVR.pp_setActive(!1),this._myCursorObjectNonVR.pp_setActive(!1),this._myFingerCursorObject.pp_setActive(!1)},update:function(){let e=PP.quat2_create();return function(i){let s=this._isUsingHand();this._myFingerCursorObject.pp_setActive(s),s?(this._myCursorObjectNonVR.pp_setActive(!1),this._myCursorObjectVR.pp_setActive(!1)):PP.XRUtils.isSessionActive()?(this._myCursorObjectVR.pp_setActive(!s),this._myCursorObjectNonVR.pp_setActive(!1)):(this._myCursorObjectNonVR.pp_setActive(!s),this._myCursorObjectVR.pp_setActive(!1),this._myCursorObjectNonVR.pp_setTransformQuat(PP.myPlayerObjects.myNonVRCamera.pp_getTransformQuat(e)))}}(),_isUsingHand:function(){let e=!1;if(WL.xrSession&&WL.xrSession.inputSources)for(let t=0;t<WL.xrSession.inputSources.length;t++){let i=WL.xrSession.inputSources[t];if(i.hand&&i.handedness==this._myHandednessString){e=!0;break}}return e},_pulseOnHover:function(e){let t=e.getComponent("cursor-target");t&&!t.isSurface&&(this._myHandedness==0?PP.myLeftGamepad&&PP.myLeftGamepad.pulse(.4,0):PP.myRightGamepad&&PP.myRightGamepad.pulse(.4,0))}})});var Ds=T(()=>{PP.ConsoleVRWidgetSetup=class{constructor(){this._initializeBuildSetup(),this._initializeRuntimeSetup()}_initializeBuildSetup(){this.myBackgroundColor=[46/255,46/255,46/255,1],this.myCursorTargetCollisionCollider=2,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=[255/255,255/255,255/255,1],this.myTextAlignment=2,this.myTextJustification=2,this.myTextColor=this.myDefaultTextColor,this.myMessageTypeColors=[],this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.LOG]=this.myDefaultTextColor,this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.ERROR]=[255/255,40/255,40/255,1],this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.WARN]=[250/255,220/255,40/255,1],this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.INFO]=[60/255,200/255,255/255,1],this.myMessagesPanelPosition=[0,.075,0],this.myMessagesBackgroundScale=[.34,.15,1];{let t=.03,i=t*this.myMessagesBackgroundScale[0]/this.myMessagesBackgroundScale[1]*.8,s=-this.myMessagesBackgroundScale[0]+this.myMessagesBackgroundScale[0]*t,n=this.myMessagesBackgroundScale[1]-this.myMessagesBackgroundScale[1]*i;this.myMessagesTextsPanelPosition=[s,n,.007]}this.myMessagesTextsPanelScale=[.1,.1,.1],this.myMessagesTextStartString=`.
`,this.myMessagesTextAlignment=1,this.myMessagesTextJustification=3,this.myMessagesTextPositions=[],this.myMessagesTextPositions[PP.ConsoleVRWidget.MessageType.LOG]=[0,0,1e-5],this.myMessagesTextPositions[PP.ConsoleVRWidget.MessageType.ERROR]=[0,0,0],this.myMessagesTextPositions[PP.ConsoleVRWidget.MessageType.WARN]=[0,0,0],this.myMessagesTextPositions[PP.ConsoleVRWidget.MessageType.INFO]=[0,0,0],this.myMessagesTextColors=[],this.myMessagesTextColors[PP.ConsoleVRWidget.MessageType.LOG]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.LOG],this.myMessagesTextColors[PP.ConsoleVRWidget.MessageType.ERROR]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.ERROR],this.myMessagesTextColors[PP.ConsoleVRWidget.MessageType.WARN]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.WARN],this.myMessagesTextColors[PP.ConsoleVRWidget.MessageType.INFO]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.INFO],this.myButtonsPanelPosition=[0,-.11,.015],this.myButtonBackgroundScale=[.04,.02,1],this.myButtonTextPosition=[0,0,.007],this.myButtonTextScale=[.18,.18,.18],this.myButtonCursorTargetPosition=[0,0,0],this.myButtonCursorTargetPosition[2]=this.myButtonTextPosition[2],this.myButtonsCollisionCollider=this.myCursorTargetCollisionCollider,this.myButtonsCollisionGroup=this.myCursorTargetCollisionGroup,this.myButtonsCollisionExtents=this.myButtonBackgroundScale.slice(0),this.myButtonsCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myClearButtonTextLabel="clear",this.myUpButtonTextLabel="up",this.myDownButtonTextLabel="down",this.myFilterButtonsTextColors=[],this.myFilterButtonsTextColors[PP.ConsoleVRWidget.MessageType.LOG]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.LOG],this.myFilterButtonsTextColors[PP.ConsoleVRWidget.MessageType.ERROR]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.ERROR],this.myFilterButtonsTextColors[PP.ConsoleVRWidget.MessageType.WARN]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.WARN],this.myFilterButtonsTextColors[PP.ConsoleVRWidget.MessageType.INFO]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.INFO],this.myFilterButtonsTextLabel=[],this.myFilterButtonsTextLabel[PP.ConsoleVRWidget.MessageType.LOG]="log",this.myFilterButtonsTextLabel[PP.ConsoleVRWidget.MessageType.ERROR]="error",this.myFilterButtonsTextLabel[PP.ConsoleVRWidget.MessageType.WARN]="warn",this.myFilterButtonsTextLabel[PP.ConsoleVRWidget.MessageType.INFO]="info";{let t=7,i=Math.max(.68,this.myButtonBackgroundScale[0]*t),s=2+3+4+4+1+2,n=Math.max((i-t*this.myButtonBackgroundScale[0]*2)/s,0),a=this.myButtonBackgroundScale[0],r=-i/2;this.myFilterButtonsPositions=[],this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.LOG]=[r+n*2+a,0,0],this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.ERROR]=[this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.LOG][0]+a+n+a,0,0],this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.WARN]=[this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.ERROR][0]+a+n+a,0,0],this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.INFO]=[this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.WARN][0]+a+n+a,0,0],this.myClearButtonPosition=[this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.INFO][0]+a+n*4+a,0,0],this.myUpButtonPosition=[this.myClearButtonPosition[0]+a+n*4+a,0,0],this.myDownButtonPosition=[this.myUpButtonPosition[0]+a+n+a,0,0]}this.myNotifyIconBackgroundScale=[.01,.01,1],this.myNotifyIconPanelPositions=[],this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE]=[0,0,0],this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE][0]=-this.myMessagesBackgroundScale[0]+this.myNotifyIconBackgroundScale[0]+.01,this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE][1]=-this.myMessagesBackgroundScale[1]+this.myNotifyIconBackgroundScale[1]+.01,this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE][2]=this.myMessagesTextsPanelPosition[2]-1e-5,this.myNotifyIconPanelPositions[PP.ToolHandedness.LEFT]=this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE],this.myNotifyIconPanelPositions[PP.ToolHandedness.RIGHT]=this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE],this.myNotifyIconCursorTargetPosition=[0,0,0],this.myNotifyIconCursorTargetPosition[2]=this.myButtonsPanelPosition[2]+this.myButtonTextPosition[2]-this.myMessagesTextsPanelPosition[2],this.myNotifyIconCollisionExtents=this.myNotifyIconBackgroundScale.slice(0),this.myNotifyIconCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myNotifyIconColor=[210/255,210/255,210/255,1],this.myPointerCollisionCollider=this.myCursorTargetCollisionCollider,this.myPointerCollisionGroup=this.myCursorTargetCollisionGroup;{let t=Math.abs(this.myMessagesPanelPosition[1]-this.myMessagesBackgroundScale[1]-(this.myButtonsPanelPosition[1]+this.myButtonBackgroundScale[1])),i=this.myMessagesBackgroundScale[1]+this.myButtonBackgroundScale[1]+t/2;this.myPointerCollisionExtents=[this.myMessagesBackgroundScale[0],i,this.myCursorTargetCollisionThickness]}this.myPointerCursorTargetPosition=[0,0,0],this.myPointerCursorTargetPosition[1]=this.myMessagesPanelPosition[1]+this.myMessagesBackgroundScale[1]-this.myPointerCollisionExtents[1],this.myPointerCursorTargetPosition[2]=this.myButtonsPanelPosition[2]+this.myButtonTextPosition[2]-1e-4}_initializeRuntimeSetup(){this.myTabString="     ",this.myAssertStartString="Assertion failed:",this.myMaxCharactersPerLine=100,this.myMaxLineSplits=50,this.myMaxLines=22,this.myMaxMessages=2e3,this.myMaxMessagesDeletePad=2e3,this.myLinesBetweenMessages=1,this.myButtonHoverColor=[150/255,150/255,150/255,1],this.myButtonDisabledTextColor=this.myBackgroundColor,this.myButtonDisabledBackgroundColor=[110/255,110/255,110/255,1],this.myFilterButtonDisabledTextColor=this.myButtonDisabledTextColor,this.myFilterButtonDisabledBackgroundColor=this.myButtonDisabledBackgroundColor,this.myScrollDelay=.1,this.myScrollAmount=1,this.myScrollThumbstickHandedness=PP.ToolHandedness.RIGHT,this.myScrollThumbstickDelay=.1,this.myScrollThumbstickMinThreshold=.2,this.myScrollThumbstickAmount=3,this.myPulseDelay=5,this.myPulseIntensity=.3,this.myPulseDuration=.085,this.myClearBrowserConsoleWhenClearPressed=!0,this.myGamepadScrollOnlyOnHover=!0}}});var Rs=T(()=>{PP.ConsoleVRWidgetUI=class{build(t,i,s){this._myParentObject=t,this._mySetup=i,this._myAdditionalSetup=s,this._myPlaneMesh=PP.MeshUtils.createPlaneMesh(),this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonVR(),WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}setVisible(t){this.myPivotObject.pp_setActiveHierarchy(t)}_createSkeleton(){this.myPivotObject=WL.scene.addObject(this._myParentObject),this._createMessagesSkeleton(),this._createButtonsSkeleton(),this._createPointerSkeleton()}_createMessagesSkeleton(){this.myMessagesPanel=WL.scene.addObject(this.myPivotObject),this.myMessagesBackground=WL.scene.addObject(this.myMessagesPanel),this.myMessagesTextsPanel=WL.scene.addObject(this.myMessagesPanel),this.myMessagesTexts=[];for(let t in PP.ConsoleVRWidget.MessageType)this.myMessagesTexts[PP.ConsoleVRWidget.MessageType[t]]=WL.scene.addObject(this.myMessagesTextsPanel);this.myNotifyIconPanel=WL.scene.addObject(this.myMessagesPanel),this.myNotifyIconBackground=WL.scene.addObject(this.myNotifyIconPanel),this.myNotifyIconCursorTarget=WL.scene.addObject(this.myNotifyIconPanel)}_createButtonsSkeleton(){this.myButtonsPanel=WL.scene.addObject(this.myPivotObject),this.myFilterButtonsPanels=[],this.myFilterButtonsBackgrounds=[],this.myFilterButtonsTexts=[],this.myFilterButtonsCursorTargets=[];for(let t in PP.ConsoleVRWidget.MessageType)this.myFilterButtonsPanels[PP.ConsoleVRWidget.MessageType[t]]=WL.scene.addObject(this.myButtonsPanel),this.myFilterButtonsBackgrounds[PP.ConsoleVRWidget.MessageType[t]]=WL.scene.addObject(this.myFilterButtonsPanels[PP.ConsoleVRWidget.MessageType[t]]),this.myFilterButtonsTexts[PP.ConsoleVRWidget.MessageType[t]]=WL.scene.addObject(this.myFilterButtonsPanels[PP.ConsoleVRWidget.MessageType[t]]),this.myFilterButtonsCursorTargets[PP.ConsoleVRWidget.MessageType[t]]=WL.scene.addObject(this.myFilterButtonsPanels[PP.ConsoleVRWidget.MessageType[t]]);this.myClearButtonPanel=WL.scene.addObject(this.myButtonsPanel),this.myClearButtonBackground=WL.scene.addObject(this.myClearButtonPanel),this.myClearButtonText=WL.scene.addObject(this.myClearButtonPanel),this.myClearButtonCursorTarget=WL.scene.addObject(this.myClearButtonPanel),this.myUpButtonPanel=WL.scene.addObject(this.myButtonsPanel),this.myUpButtonBackground=WL.scene.addObject(this.myUpButtonPanel),this.myUpButtonText=WL.scene.addObject(this.myUpButtonPanel),this.myUpButtonCursorTarget=WL.scene.addObject(this.myUpButtonPanel),this.myDownButtonPanel=WL.scene.addObject(this.myButtonsPanel),this.myDownButtonBackground=WL.scene.addObject(this.myDownButtonPanel),this.myDownButtonText=WL.scene.addObject(this.myDownButtonPanel),this.myDownButtonCursorTarget=WL.scene.addObject(this.myDownButtonPanel)}_createPointerSkeleton(){this.myPointerCursorTarget=WL.scene.addObject(this.myPivotObject)}_setTransforms(){this.myPivotObject.setDirty(),this._setMessagesTransforms(),this._setButtonsTransforms(),this._setPointerTransform()}_setMessagesTransforms(){this.myMessagesPanel.setTranslationLocal(this._mySetup.myMessagesPanelPosition),this.myMessagesBackground.scale(this._mySetup.myMessagesBackgroundScale),this.myMessagesTextsPanel.setTranslationLocal(this._mySetup.myMessagesTextsPanelPosition),this.myMessagesTextsPanel.scale(this._mySetup.myMessagesTextsPanelScale);for(let t in PP.ConsoleVRWidget.MessageType)this.myMessagesTexts[PP.ConsoleVRWidget.MessageType[t]].setTranslationLocal(this._mySetup.myMessagesTextPositions[PP.ConsoleVRWidget.MessageType[t]]);this.myNotifyIconPanel.setTranslationLocal(this._mySetup.myNotifyIconPanelPositions[this._myAdditionalSetup.myHandedness]),this.myNotifyIconBackground.scale(this._mySetup.myNotifyIconBackgroundScale),this.myNotifyIconCursorTarget.setTranslationLocal(this._mySetup.myNotifyIconCursorTargetPosition)}_setButtonsTransforms(){this.myButtonsPanel.setTranslationLocal(this._mySetup.myButtonsPanelPosition);for(let t in PP.ConsoleVRWidget.MessageType)this.myFilterButtonsPanels[PP.ConsoleVRWidget.MessageType[t]].setTranslationLocal(this._mySetup.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType[t]]),this.myFilterButtonsBackgrounds[PP.ConsoleVRWidget.MessageType[t]].scale(this._mySetup.myButtonBackgroundScale),this.myFilterButtonsTexts[PP.ConsoleVRWidget.MessageType[t]].setTranslationLocal(this._mySetup.myButtonTextPosition),this.myFilterButtonsTexts[PP.ConsoleVRWidget.MessageType[t]].scale(this._mySetup.myButtonTextScale),this.myFilterButtonsCursorTargets[PP.ConsoleVRWidget.MessageType[t]].setTranslationLocal(this._mySetup.myButtonCursorTargetPosition);this.myClearButtonPanel.setTranslationLocal(this._mySetup.myClearButtonPosition),this.myClearButtonBackground.scale(this._mySetup.myButtonBackgroundScale),this.myClearButtonText.setTranslationLocal(this._mySetup.myButtonTextPosition),this.myClearButtonText.scale(this._mySetup.myButtonTextScale),this.myClearButtonCursorTarget.setTranslationLocal(this._mySetup.myButtonCursorTargetPosition),this.myUpButtonPanel.setTranslationLocal(this._mySetup.myUpButtonPosition),this.myUpButtonBackground.scale(this._mySetup.myButtonBackgroundScale),this.myUpButtonText.setTranslationLocal(this._mySetup.myButtonTextPosition),this.myUpButtonText.scale(this._mySetup.myButtonTextScale),this.myUpButtonCursorTarget.setTranslationLocal(this._mySetup.myButtonCursorTargetPosition),this.myDownButtonPanel.setTranslationLocal(this._mySetup.myDownButtonPosition),this.myDownButtonBackground.scale(this._mySetup.myButtonBackgroundScale),this.myDownButtonText.setTranslationLocal(this._mySetup.myButtonTextPosition),this.myDownButtonText.scale(this._mySetup.myButtonTextScale),this.myDownButtonCursorTarget.setTranslationLocal(this._mySetup.myButtonCursorTargetPosition)}_setPointerTransform(){this.myPointerCursorTarget.setTranslationLocal(this._mySetup.myPointerCursorTargetPosition)}_addComponents(){this._addMessagesComponents(),this._addButtonsComponents(),this._addPointerComponents()}_addMessagesComponents(){let t=this.myMessagesBackground.addComponent("mesh");t.mesh=this._myPlaneMesh,t.material=this._myAdditionalSetup.myPlaneMaterial.clone(),t.material.color=this._mySetup.myBackgroundColor,this.myMessagesTextComponents=[];for(let i in PP.ConsoleVRWidget.MessageType){let s=this.myMessagesTexts[PP.ConsoleVRWidget.MessageType[i]].addComponent("text");s.alignment=this._mySetup.myMessagesTextAlignment,s.justification=this._mySetup.myMessagesTextJustification,s.material=this._myAdditionalSetup.myTextMaterial.clone(),s.material.color=this._mySetup.myMessagesTextColors[PP.ConsoleVRWidget.MessageType[i]],s.lineSpacing=1.2,s.text=this._mySetup.myMessagesTextStartString,this.myMessagesTextComponents[PP.ConsoleVRWidget.MessageType[i]]=s}this.myNotifyIconBackgroundComponent=this.myNotifyIconBackground.addComponent("mesh"),this.myNotifyIconBackgroundComponent.mesh=this._myPlaneMesh,this.myNotifyIconBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myNotifyIconBackgroundComponent.material.color=this._mySetup.myNotifyIconColor,this.myNotifyIconCursorTargetComponent=this.myNotifyIconCursorTarget.addComponent("cursor-target"),this.myNotifyIconCollisionComponent=this.myNotifyIconCursorTarget.addComponent("collision"),this.myNotifyIconCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myNotifyIconCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myNotifyIconCollisionComponent.extents=this._mySetup.myNotifyIconCollisionExtents}_addButtonsComponents(){this.myFilterButtonsBackgroundComponents=[],this.myFilterButtonsTextComponents=[],this.myFilterButtonsCursorTargetComponents=[],this.myFilterButtonsCollisionComponents=[];for(let t in PP.ConsoleVRWidget.MessageType){let i=this.myFilterButtonsBackgrounds[PP.ConsoleVRWidget.MessageType[t]].addComponent("mesh");i.mesh=this._myPlaneMesh,i.material=this._myAdditionalSetup.myPlaneMaterial.clone(),i.material.color=this._mySetup.myBackgroundColor;let s=this.myFilterButtonsTexts[PP.ConsoleVRWidget.MessageType[t]].addComponent("text");this._setupButtonTextComponent(s),s.material.color=this._mySetup.myFilterButtonsTextColors[PP.ConsoleVRWidget.MessageType[t]],s.text=this._mySetup.myFilterButtonsTextLabel[PP.ConsoleVRWidget.MessageType[t]];let n=this.myFilterButtonsCursorTargets[PP.ConsoleVRWidget.MessageType[t]].addComponent("cursor-target"),a=this.myFilterButtonsCursorTargets[PP.ConsoleVRWidget.MessageType[t]].addComponent("collision");a.collider=this._mySetup.myButtonsCollisionCollider,a.group=1<<this._mySetup.myButtonsCollisionGroup,a.extents=this._mySetup.myButtonsCollisionExtents,this.myFilterButtonsBackgroundComponents[PP.ConsoleVRWidget.MessageType[t]]=i,this.myFilterButtonsTextComponents[PP.ConsoleVRWidget.MessageType[t]]=s,this.myFilterButtonsCursorTargetComponents[PP.ConsoleVRWidget.MessageType[t]]=n,this.myFilterButtonsCollisionComponents[PP.ConsoleVRWidget.MessageType[t]]=a}{let t=this.myClearButtonBackground.addComponent("mesh");t.mesh=this._myPlaneMesh,t.material=this._myAdditionalSetup.myPlaneMaterial.clone(),t.material.color=this._mySetup.myBackgroundColor;let i=this.myClearButtonText.addComponent("text");this._setupButtonTextComponent(i),i.text=this._mySetup.myClearButtonTextLabel;let s=this.myClearButtonCursorTarget.addComponent("cursor-target"),n=this.myClearButtonCursorTarget.addComponent("collision");n.collider=this._mySetup.myButtonsCollisionCollider,n.group=1<<this._mySetup.myButtonsCollisionGroup,n.extents=this._mySetup.myButtonsCollisionExtents,this.myClearButtonBackgroundComponent=t,this.myClearButtonTextComponent=i,this.myClearButtonCursorTargetComponent=s,this.myClearButtonCollisionComponent=n}{let t=this.myUpButtonBackground.addComponent("mesh");t.mesh=this._myPlaneMesh,t.material=this._myAdditionalSetup.myPlaneMaterial.clone(),t.material.color=this._mySetup.myBackgroundColor;let i=this.myUpButtonText.addComponent("text");this._setupButtonTextComponent(i),i.text=this._mySetup.myUpButtonTextLabel;let s=this.myUpButtonCursorTarget.addComponent("cursor-target"),n=this.myUpButtonCursorTarget.addComponent("collision");n.collider=this._mySetup.myButtonsCollisionCollider,n.group=1<<this._mySetup.myButtonsCollisionGroup,n.extents=this._mySetup.myButtonsCollisionExtents,this.myUpButtonBackgroundComponent=t,this.myUpButtonTextComponent=i,this.myUpButtonCursorTargetComponent=s,this.myUpButtonCollisionComponent=n}{let t=this.myDownButtonBackground.addComponent("mesh");t.mesh=this._myPlaneMesh,t.material=this._myAdditionalSetup.myPlaneMaterial.clone(),t.material.color=this._mySetup.myBackgroundColor;let i=this.myDownButtonText.addComponent("text");this._setupButtonTextComponent(i),i.text=this._mySetup.myDownButtonTextLabel;let s=this.myDownButtonCursorTarget.addComponent("cursor-target"),n=this.myDownButtonCursorTarget.addComponent("collision");n.collider=this._mySetup.myButtonsCollisionCollider,n.group=1<<this._mySetup.myButtonsCollisionGroup,n.extents=this._mySetup.myButtonsCollisionExtents,this.myDownButtonBackgroundComponent=t,this.myDownButtonTextComponent=i,this.myDownButtonCursorTargetComponent=s,this.myDownButtonCollisionComponent=n}}_addPointerComponents(){this.myPointerCursorTargetComponent=this.myPointerCursorTarget.addComponent("cursor-target"),this.myPointerCursorTargetComponent.isSurface=!0;let t=this.myPointerCursorTarget.addComponent("collision");t.collider=this._mySetup.myPointerCollisionCollider,t.group=1<<this._mySetup.myPointerCollisionGroup,t.extents=this._mySetup.myPointerCollisionExtents,this.myPointerCollisionComponent=t}_setupButtonTextComponent(t){t.alignment=this._mySetup.myTextAlignment,t.justification=this._mySetup.myTextJustification,t.material=this._myAdditionalSetup.myTextMaterial.clone(),t.material.color=this._mySetup.myTextColor,t.text=""}_onXRSessionStart(){this._setTransformForVR()}_onXRSessionEnd(){this._setTransformForNonVR()}_setTransformForVR(){this.myNotifyIconPanel.setTranslationLocal(this._mySetup.myNotifyIconPanelPositions[this._myAdditionalSetup.myHandedness])}_setTransformForNonVR(){this.myNotifyIconPanel.setTranslationLocal(this._mySetup.myNotifyIconPanelPositions[PP.ToolHandedness.NONE])}}});var Es=T(()=>{PP.ConsoleVRWidget=class{constructor(){this._myWidgetFrame=new PP.WidgetFrame("C",0),this._myWidgetFrame.registerWidgetVisibleChangedEventListener(this,this._widgetVisibleChanged.bind(this)),this._mySetup=new PP.ConsoleVRWidgetSetup,this._myAdditionalSetup=null,this._myUI=new PP.ConsoleVRWidgetUI,this._myMessages=[],this._myOldBrowserConsole=[],this._myOldConsoleVR=[],this._myTypeFilters=[];for(let t in PP.ConsoleVRWidget.MessageType)this._myTypeFilters[PP.ConsoleVRWidget.MessageType[t]]=!1;this._myScrollUp=!1,this._myScrollDown=!1,this._myScrollOffset=0,this._myScrollTimer=0,this._myScrollThumbstickTimer=0,this._myPulseTimer=0,this._myGamepadScrollActive=!0,this._mySetup.myGamepadScrollOnlyOnHover&&(this._myGamepadScrollActive=!1)}setVisible(t){this._myWidgetFrame.setVisible(t)}isVisible(){return this._myWidgetFrame.isVisible()}start(t,i){this._myLeftGamepad=PP.myLeftGamepad,this._myRightGamepad=PP.myRightGamepad,this._myAdditionalSetup=i,this._myWidgetFrame.start(t,i),this._myUI.build(this._myWidgetFrame.getWidgetObject(),this._mySetup,i),this._myUI.setVisible(this._myWidgetFrame.myIsWidgetVisible),this._setNotifyIconActive(!1),this._addListeners(),this._overrideConsolesFunctions()}_overrideConsolesFunctions(){this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.LOG]=console.log,this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.ERROR]=console.error,this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.WARN]=console.warn,this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.INFO]=console.info,this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.DEBUG]=console.debug,this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.ASSERT]=console.assert,this._myOldBrowserConsoleClear=console.clear,this._myAdditionalSetup.myOverrideBrowserConsole&&(console.log=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.LOG,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.error=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.ERROR,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.warn=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.WARN,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.info=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.INFO,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.debug=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.DEBUG,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.assert=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.ASSERT,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.clear=this._clearConsole.bind(this,!0,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),window.addEventListener("error",function(t){t.error!=null?this._consolePrint(PP.ConsoleVRWidget.ConsoleFunction.ERROR,PP.ConsoleVRWidget.Sender.WINDOW,"Uncaught",t.error.stack):this._consolePrint(PP.ConsoleVRWidget.ConsoleFunction.ERROR,PP.ConsoleVRWidget.Sender.WINDOW,"Uncaught",t.message)}.bind(this)),window.addEventListener("unhandledrejection",function(t){this._consolePrint(PP.ConsoleVRWidget.ConsoleFunction.ERROR,PP.ConsoleVRWidget.Sender.WINDOW,"Uncaught (in promise)",t.reason)}.bind(this))),this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.LOG]=PP.ConsoleVR.log,this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.ERROR]=PP.ConsoleVR.error,this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.WARN]=PP.ConsoleVR.warn,this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.INFO]=PP.ConsoleVR.info,this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.DEBUG]=PP.ConsoleVR.debug,this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.ASSERT]=PP.ConsoleVR.assert,this._myOldConsoleVRClear=PP.ConsoleVR.clear,PP.ConsoleVR.log=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.LOG,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.error=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.ERROR,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.warn=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.WARN,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.info=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.INFO,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.debug=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.DEBUG,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.assert=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.ASSERT,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.clear=this._clearConsole.bind(this,!0,PP.ConsoleVRWidget.Sender.CONSOLE_VR)}update(t){this._myWidgetFrame.update(t),this._myWidgetFrame.myIsWidgetVisible&&this._updateScroll(t),this._updateGamepadsExtraActions(t)}_updateText(t){let i="";if(!this._myTypeFilters[t]){let s=0,n=this._myMessages.length-1,a=Math.round(this._myScrollOffset);for(;n>=0&&s<this._mySetup.myMaxLines;){let r=this._myMessages[n];if(this._myTypeFilters[r.myType]){n-=1;continue}let l=r.myLines.length,y=0;if(a>0){let o=0;n!=this._myMessages.length-1&&(o=this._mySetup.myLinesBetweenMessages),a>=l+o?(a-=l+o,y=l+o):(y=a,a=0)}if(n!=this._myMessages.length-1){let o=this._mySetup.myLinesBetweenMessages-Math.max(this._mySetup.myLinesBetweenMessages-y,0),m=this._mySetup.myLinesBetweenMessages-o;s+m>this._mySetup.myMaxLines&&(m=this._myMaxLines-s);for(let u=0;u<m;u++)i=`
`.concat(i);s+=m,y-=o}let c=l-y;if(s+c>this._mySetup.myMaxLines&&(c=this._mySetup.myMaxLines-s),c>0)if(r.myType==t)i=r.myLines.slice(l-c-y,l-y).join(`
`).concat(`
`).concat(i),s+=c;else{for(let o=0;o<c;o++)i=`
`.concat(i);s+=c}n-=1}}i=this._mySetup.myMessagesTextStartString.concat(i),this._myUI.myMessagesTextComponents[t].text=i}_consolePrint(t,i,...s){if(t!=PP.ConsoleVRWidget.ConsoleFunction.ASSERT||s.length>0&&!s[0]){let n=this._argsToMessage(t,...s);this._addMessage(n),this._myMessages.length>=this._mySetup.myMaxMessages+this._mySetup.myMaxMessagesDeletePad&&(this._myMessages=this._myMessages.slice(this._myMessages.length-this._mySetup.myMaxMessages),this._clampScrollOffset()),this._updateAllTexts(),this._pulseGamepad()}switch(i){case PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE:this._myOldBrowserConsole[t].apply(console,s);break;case PP.ConsoleVRWidget.Sender.CONSOLE_VR:this._myOldConsoleVR[t].apply(PP.ConsoleVR,s);break;default:this._myOldBrowserConsole[t].apply(console,s);break}}_argsToMessage(t,...i){t==PP.ConsoleVRWidget.ConsoleFunction.ASSERT&&(i=i.slice(1),i.splice(0,0,this._mySetup.myAssertStartString));let s=this._consoleFunctionToMessageType(t),n=this._formatArgs(...i),a=this._splitLongLines(n);return s==PP.ConsoleVRWidget.MessageType.DEBUG?s=PP.ConsoleVRWidget.MessageType.LOG:(s==PP.ConsoleVRWidget.MessageType.EXCEPTION||s==PP.ConsoleVRWidget.MessageType.ASSERT)&&(s=PP.ConsoleVRWidget.MessageType.ERROR),new PP.ConsoleVRWidget.Message(s,a)}_consoleFunctionToMessageType(t){let i=PP.ConsoleVRWidget.MessageType.LOG;return t<PP.ConsoleVRWidget.ConsoleFunction.DEBUG?i=t:t==PP.ConsoleVRWidget.ConsoleFunction.DEBUG?i=PP.ConsoleVRWidget.MessageType.LOG:i=PP.ConsoleVRWidget.MessageType.ERROR,i}_formatArgs(...t){let i=[];for(let n=0;n<t.length;n++)t[n]===void 0?i.push("undefined"):i.push(this._stringifyItem(t[n]));return i.join(" ")}_stringifyItem(t){if(typeof t=="object"){let i=null,s=2;try{i=JSON.stringify(t,this._jsonReplacer.bind(this),s)}catch{let a=new WeakSet;i=JSON.stringify(t,function(r,l){if(typeof l=="object"&&l!==null){if(a.has(l))return"<stringify error: object already stringified>";a.add(l)}return this._jsonReplacer(r,l)}.bind(this),s)}return i=i.replaceAll('"[',"["),i=i.replaceAll("'[","["),i=i.replaceAll(']"',"]"),i=i.replaceAll("]'","]"),i}return t}_splitLongLines(t){let i=t.split(`
`),s=[];for(let n=0;n<i.length;n++){let a=i[n];if(a.length>this._mySetup.myMaxCharactersPerLine){let r=this._getSpacesAtStart(a),l=this._mySetup.myTabString.concat(r),y=0;for(;a.length>this._mySetup.myMaxCharactersPerLine&&y<this._mySetup.myMaxLineSplits;){let c=a.substr(0,this._mySetup.myMaxCharactersPerLine-1),o=a.substr(this._mySetup.myMaxCharactersPerLine-1);o=l.concat(o),s.push(c),a=o,y++}s.push(a)}else s.push(a)}return s}_getSpacesAtStart(t){let i="",s=0;for(;s<t.length&&t[s]==" ";)i=i.concat(" "),s++;return i}_addMessage(t){let i=!1;if(this._myMessages.length>0){let s=this._myMessages[this._myMessages.length-1];s.hasSameInfo(t)&&(s.increaseCount(),i=!0)}i||this._myMessages.push(t),this._adjustScrollOffsetAfterMessageAdded(t,i),this._updateNotifyIcon(t)}_adjustScrollOffsetAfterMessageAdded(t,i){!i&&!this._myTypeFilters[t.myType]&&this._myScrollOffset>0&&(this._myScrollOffset+=t.myLines.length+this._mySetup.myLinesBetweenMessages)}_updateAllTexts(){if(this._myWidgetFrame.myIsWidgetVisible)for(let t in PP.ConsoleVRWidget.MessageType)this._updateText(PP.ConsoleVRWidget.MessageType[t])}_updateNotifyIcon(t){!this._myTypeFilters[t.myType]&&this._myScrollOffset>0&&this._setNotifyIconActive(!0)}_updateScroll(t){if(this._myScrollUp)for(this._myScrollTimer+=t;this._myScrollTimer>this._mySetup.myScrollDelay;)this._myScrollTimer-=this._mySetup.myScrollDelay,this._myScrollOffset+=this._mySetup.myScrollAmount;else if(this._myScrollDown)for(this._myScrollTimer+=t;this._myScrollTimer>this._mySetup.myScrollDelay;)this._myScrollTimer-=this._mySetup.myScrollDelay,this._myScrollOffset-=this._mySetup.myScrollAmount;this._clampScrollOffset(),(this._myScrollUp||this._myScrollDown)&&this._updateAllTexts(),this._myScrollOffset==0&&this._setNotifyIconActive(!1)}_clampScrollOffset(){let t=this._getMaxScrollOffset();this._myScrollOffset=Math.min(Math.max(this._myScrollOffset,0),t)}_getMaxScrollOffset(){return Math.max(this._getLinesCount()-this._mySetup.myMaxLines,0)}_getLinesCount(){let t=0;for(let i of this._myMessages)this._myTypeFilters[i.myType]||(t+=i.myLines.length+this._mySetup.myLinesBetweenMessages);return t-=this._mySetup.myLinesBetweenMessages,t=Math.max(t,0),t}_addListeners(){let t=this._myUI;for(let i in PP.ConsoleVRWidget.MessageType){let s=t.myFilterButtonsCursorTargetComponents[PP.ConsoleVRWidget.MessageType[i]],n=t.myFilterButtonsBackgroundComponents[PP.ConsoleVRWidget.MessageType[i]].material,a=t.myFilterButtonsTextComponents[PP.ConsoleVRWidget.MessageType[i]].material;s.addTripleClickFunction(this._resetFilters.bind(this,PP.ConsoleVRWidget.MessageType[i])),s.addDoubleClickFunction(this._filterAllButOne.bind(this,PP.ConsoleVRWidget.MessageType[i],a)),s.addClickFunction(this._toggleFilter.bind(this,PP.ConsoleVRWidget.MessageType[i],a)),s.addHoverFunction(this._filterHover.bind(this,PP.ConsoleVRWidget.MessageType[i],n)),s.addUnHoverFunction(this._filterUnHover.bind(this,PP.ConsoleVRWidget.MessageType[i],n))}{let i=t.myClearButtonCursorTargetComponent,s=t.myClearButtonBackgroundComponent.material;i.addClickFunction(this._clearConsole.bind(this,!1,null)),i.addHoverFunction(this._genericHover.bind(this,s)),i.addUnHoverFunction(this._genericUnHover.bind(this,s))}{let i=t.myUpButtonCursorTargetComponent,s=t.myUpButtonBackgroundComponent.material;i.addDoubleClickFunction(this._instantScrollUp.bind(this,!0)),i.addDownFunction(this._setScrollUp.bind(this,!0)),i.addUpFunction(this._setScrollUp.bind(this,!1)),i.addUnHoverFunction(this._setScrollUp.bind(this,!1)),i.addHoverFunction(this._genericHover.bind(this,s)),i.addUnHoverFunction(this._genericUnHover.bind(this,s))}{let i=t.myDownButtonCursorTargetComponent,s=t.myDownButtonBackgroundComponent.material;i.addDoubleClickFunction(this._instantScrollDown.bind(this)),i.addDownFunction(this._setScrollDown.bind(this,!0)),i.addUpFunction(this._setScrollDown.bind(this,!1)),i.addUnHoverFunction(this._setScrollDown.bind(this,!1)),i.addHoverFunction(this._genericHover.bind(this,s)),i.addUnHoverFunction(this._genericUnHover.bind(this,s))}{let i=t.myNotifyIconCursorTargetComponent,s=t.myNotifyIconBackgroundComponent.material;i.addClickFunction(this._instantScrollDown.bind(this)),i.addHoverFunction(this._genericHover.bind(this,s)),i.addUnHoverFunction(this._notifyIconUnHover.bind(this))}t.myPointerCursorTargetComponent.addHoverFunction(this._setGamepadScrollActive.bind(this,!0)),t.myPointerCursorTargetComponent.addUnHoverFunction(this._setGamepadScrollActive.bind(this,!1))}_resetFilters(t){if(this._myWidgetFrame.myIsWidgetVisible){for(let i in PP.ConsoleVRWidget.MessageType){let s=this._myUI.myFilterButtonsBackgroundComponents[PP.ConsoleVRWidget.MessageType[i]].material,n=this._myUI.myFilterButtonsTextComponents[PP.ConsoleVRWidget.MessageType[i]].material;this._myTypeFilters[PP.ConsoleVRWidget.MessageType[i]]=!1,n.color=this._mySetup.myMessageTypeColors[PP.ConsoleVRWidget.MessageType[i]],PP.ConsoleVRWidget.MessageType[i]!=t&&(s.color=this._mySetup.myBackgroundColor)}this._clampScrollOffset(),this._updateAllTexts()}}_filterAllButOne(t){if(this._myWidgetFrame.myIsWidgetVisible){for(let i in PP.ConsoleVRWidget.MessageType){let s=this._myUI.myFilterButtonsBackgroundComponents[PP.ConsoleVRWidget.MessageType[i]].material,n=this._myUI.myFilterButtonsTextComponents[PP.ConsoleVRWidget.MessageType[i]].material;PP.ConsoleVRWidget.MessageType[i]!=t?(this._myTypeFilters[PP.ConsoleVRWidget.MessageType[i]]=!0,s.color=this._mySetup.myFilterButtonDisabledBackgroundColor,n.color=this._mySetup.myFilterButtonDisabledTextColor):(this._myTypeFilters[PP.ConsoleVRWidget.MessageType[i]]=!1,n.color=this._mySetup.myMessageTypeColors[t])}this._clampScrollOffset(),this._updateAllTexts()}}_toggleFilter(t,i){this._myWidgetFrame.myIsWidgetVisible&&(this._myTypeFilters[t]=!this._myTypeFilters[t],this._myTypeFilters[t]?i.color=this._mySetup.myFilterButtonDisabledTextColor:i.color=this._mySetup.myMessageTypeColors[t],this._clampScrollOffset(),this._updateAllTexts())}_clearConsole(t=!1,i=null){if(this._myWidgetFrame.myIsWidgetVisible||t)if(this._myMessages=[],this._clampScrollOffset(),this._updateAllTexts(),t)switch(i){case PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE:this._myOldBrowserConsoleClear.apply(console);break;case PP.ConsoleVRWidget.Sender.CONSOLE_VR:this._myOldConsoleVRClear.apply(PP.ConsoleVR);break;default:break}else this._mySetup.myClearBrowserConsoleWhenClearPressed&&PP.ConsoleVR._myRealClear()}_setScrollUp(t){(this._myWidgetFrame.myIsWidgetVisible||!t)&&(t&&(this._myScrollTimer=0),this._myScrollUp=t)}_setScrollDown(t){(this._myWidgetFrame.myIsWidgetVisible||!t)&&(t&&(this._myScrollTimer=0),this._myScrollDown=t)}_instantScrollUp(){this._myWidgetFrame.myIsWidgetVisible&&(this._myScrollOffset=this._getMaxScrollOffset(),this._updateAllTexts())}_instantScrollDown(){this._myWidgetFrame.myIsWidgetVisible&&(this._myScrollOffset=0,this._setNotifyIconActive(!1),this._updateAllTexts())}_setNotifyIconActive(t){this._myUI.myNotifyIconPanel.pp_setActiveHierarchy(t&&this._myWidgetFrame.myIsWidgetVisible)}_notifyIconUnHover(){let t=this._myUI.myNotifyIconBackgroundComponent.material;t.color=this._mySetup.myNotifyIconColor}_filterHover(t,i){this._genericHover(i)}_filterUnHover(t,i){this._myTypeFilters[t]?i.color=this._mySetup.myFilterButtonDisabledBackgroundColor:i.color=this._mySetup.myBackgroundColor}_genericHover(t){t.color=this._mySetup.myButtonHoverColor}_genericUnHover(t){t.color=this._mySetup.myBackgroundColor}_updateGamepadsExtraActions(t){this._myLeftGamepad&&this._myRightGamepad&&((this._myLeftGamepad.getButtonInfo(PP.GamepadButtonID.THUMBSTICK).isPressStart()&&this._myRightGamepad.getButtonInfo(PP.GamepadButtonID.THUMBSTICK).myIsPressed||this._myRightGamepad.getButtonInfo(PP.GamepadButtonID.THUMBSTICK).isPressStart()&&this._myLeftGamepad.getButtonInfo(PP.GamepadButtonID.THUMBSTICK).myIsPressed)&&this._toggleVisibility(),this._myPulseTimer=Math.max(this._myPulseTimer-t,0),this._updateScrollWithThumbstick(t))}_toggleVisibility(){this._myWidgetFrame.toggleVisibility()}_widgetVisibleChanged(t){this._myUI.setVisible(t),t&&this._updateAllTexts()}_updateScrollWithThumbstick(t){if(this._myWidgetFrame.myIsWidgetVisible&&this._myGamepadScrollActive){let i=[0,0];if(this._mySetup.myScrollThumbstickHandedness==PP.ToolHandedness.LEFT?i=this._myLeftGamepad.getAxesInfo().myAxes:this._mySetup.myScrollThumbstickHandedness==PP.ToolHandedness.RIGHT&&(i=this._myRightGamepad.getAxesInfo().myAxes),Math.abs(i[1])>this._mySetup.myScrollThumbstickMinThreshold){for(this._myScrollThumbstickTimer+=t;this._myScrollThumbstickTimer>this._mySetup.myScrollThumbstickDelay;){this._myScrollThumbstickTimer-=this._mySetup.myScrollThumbstickDelay;let s=(Math.abs(i[1])-this._mySetup.myScrollThumbstickMinThreshold)/(1-this._mySetup.myScrollThumbstickMinThreshold);this._myScrollOffset+=Math.sign(i[1])*s*this._mySetup.myScrollThumbstickAmount}this._clampScrollOffset(),this._updateAllTexts()}else this._myScrollThumbstickTimer=0}}_pulseGamepad(){if(this._myLeftGamepad&&this._myRightGamepad){let t=this._myAdditionalSetup.myPulseOnNewMessage;(t==PP.ConsoleVRWidget.PulseOnNewMessage.ALWAYS||!this._myWidgetFrame.myIsWidgetVisible&&t==PP.ConsoleVRWidget.PulseOnNewMessage.WHEN_HIDDEN)&&this._myPulseTimer==0&&(this._myAdditionalSetup.myHandedness==PP.ToolHandedness.RIGHT?this._myRightGamepad.pulse(this._mySetup.myPulseIntensity,this._mySetup.myPulseDuration):this._myLeftGamepad.pulse(this._mySetup.myPulseIntensity,this._mySetup.myPulseDuration),this._myPulseTimer=this._mySetup.myPulseDelay)}}_isSimpleArray(t){if(this._isSpecialSimpleArray(t))return!0;if(Array.isArray(t)){let i=!0;for(let s of t)if(s instanceof Object){i=!1;break}return i}return!1}_isSpecialSimpleArray(t){return t&&t.constructor&&(t.constructor.name=="Uint32Array"||t.constructor.name=="Int32Array"||t.constructor.name=="Float32Array"||t.constructor.name=="Float64Array")}_setGamepadScrollActive(t){this._myGamepadScrollActive=t,this._mySetup.myGamepadScrollOnlyOnHover||(this._myGamepadScrollActive=!0)}_jsonReplacer(t,i){if(i instanceof Map)return Array.from(i.entries());if(this._isSimpleArray(i)){let s=i;if(this._isSpecialSimpleArray(s)){let a=[];for(let r=0;r<s.length;r++)a[r]=s[r];s=a}let n=JSON.stringify(s);return n=n.split(",").join(", "),n}else return i}};PP.ConsoleVRWidget.AdditionalSetup=class{constructor(){this.myHandedness=PP.ToolHandedness.NONE,this.myOverrideBrowserConsole=!1,this.myShowOnStart=!1,this.myShowVisibilityButton=!1,this.myPulseOnNewMessage=PP.ConsoleVRWidget.PulseOnNewMessage.NEVER,this.myPlaneMaterial=null,this.myTextMaterial=null}};PP.ConsoleVRWidget.ConsoleFunction={INFO:0,WARN:1,ERROR:2,LOG:3,DEBUG:4,ASSERT:5};PP.ConsoleVRWidget.Sender={BROWSER_CONSOLE:0,CONSOLE_VR:1,WINDOW:2};PP.ConsoleVRWidget.PulseOnNewMessage={NEVER:0,ALWAYS:1,WHEN_HIDDEN:2};PP.ConsoleVRWidget.MessageType={INFO:0,WARN:1,ERROR:2,LOG:3};PP.ConsoleVRWidget.Message=class{constructor(t,i){this.myType=t,this.myLines=i,this._myOriginalText=i.join(`
`),this._myMessagesCount=1}hasSameInfo(t){return this._myOriginalText==t._myOriginalText&&this.myType==t.myType}increaseCount(){this._myMessagesCount+=1;let t="(x".concat(this._myMessagesCount).concat(") "),i=this._myOriginalText.slice(0);i=t.concat(i),this.myLines=i.split(`
`)}}});var Os=T(()=>{PP.ConsoleVR={_myRealLog:console.log,_myRealError:console.error,_myRealWarn:console.warn,_myRealInfo:console.info,_myRealDebug:console.debug,_myRealAssert:console.assert,_myRealClear:console.clear,_myForwardToBrowserConsole:!0,log:function(...e){this._myForwardToBrowserConsole&&this._myRealLog.apply(console,e)},error:function(...e){this._myForwardToBrowserConsole&&this._myRealError.apply(console,e)},warn:function(...e){this._myForwardToBrowserConsole&&this._myRealWarn.apply(console,e)},info:function(...e){this._myForwardToBrowserConsole&&this._myRealInfo.apply(console,e)},debug:function(...e){this._myForwardToBrowserConsole&&this._myRealDebug.apply(console,e)},assert:function(...e){this._myForwardToBrowserConsole&&this._myRealAssert.apply(console,e)},clear:function(){this._myForwardToBrowserConsole&&this._myRealClear.apply(console)},setForwardToBrowserConsole:function(e){this._myForwardToBrowserConsole=e},isForwardToBrowserConsole:function(){return this._myForwardToBrowserConsole}}});var Ws=T(()=>{WL.registerComponent("pp-console-vr",{_myHandedness:{type:WL.Type.Enum,values:["none","left","right"],default:"none"},_myOverrideBrowserConsole:{type:WL.Type.Bool,default:!0},_myShowOnStart:{type:WL.Type.Bool,default:!1},_myShowVisibilityButton:{type:WL.Type.Bool,default:!1},_myPulseOnNewMessage:{type:WL.Type.Enum,values:["never","always","when hidden"],default:"never"}},{init:function(){this._myWidget=new PP.ConsoleVRWidget,this._myStarted=!1},start:function(){let e=new PP.ConsoleVRWidget.AdditionalSetup;e.myHandedness=[null,"left","right"][this._myHandedness],e.myOverrideBrowserConsole=this._myOverrideBrowserConsole,e.myShowOnStart=this._myShowOnStart,e.myShowVisibilityButton=this._myShowVisibilityButton,e.myPulseOnNewMessage=this._myPulseOnNewMessage,e.myPlaneMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),e.myTextMaterial=PP.myDefaultResources.myMaterials.myText.clone(),this._myWidget.start(this.object,e),this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._mySetVisibleNextUpdate=!1,this._myStarted=!0},update:function(e){this._mySetVisibleNextUpdate&&(this._mySetVisibleNextUpdate=!1,this._myWidget.setVisible(!1),this._myWidget.setVisible(this._myWidgetVisibleBackup)),this._myWidget.update(e)},onActivate(){this._mySetVisibleNextUpdate=!0},onDeactivate(){this._myStarted&&(this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._myWidget.setVisible(!1))}})});var ks=T(()=>{PP.EasyObjectTuner=class{constructor(t,i,s,n){this._myObject=t,this._myUseTuneTarget=n,this._mySetAsDefault=s,this._myEasyObject=this._myObject,this._myUseTuneTarget&&(this._myEasyObject=PP.myEasyTuneTarget),this._myPrevEasyObject=null;let a=this._getVariableNamePrefix();i==""?this._myEasyTuneVariableName=a.concat(this._myObject.objectId):this._myEasyTuneVariableName=a.concat(i)}start(){let t=this._createEasyTuneVariable(this._myEasyTuneVariableName);PP.myEasyTuneVariables.add(t),this._mySetAsDefault&&PP.setEasyTuneWidgetActiveVariable(this._myEasyTuneVariableName)}update(t){if(PP.myEasyTuneVariables.isActive(this._myEasyTuneVariableName)){if(this._myUseTuneTarget&&(this._myEasyObject=PP.myEasyTuneTarget),this._myPrevEasyObject!=this._myEasyObject)if(this._myPrevEasyObject=this._myEasyObject,this._myEasyObject){let i=this._getObjectValue(this._myEasyObject);PP.myEasyTuneVariables.set(this._myEasyTuneVariableName,i,!0)}else{let i=this._getDefaultValue();PP.myEasyTuneVariables.set(this._myEasyTuneVariableName,i,!0)}this._myEasyObject&&this._updateObjectValue(this._myEasyObject,PP.myEasyTuneVariables.get(this._myEasyTuneVariableName))}}updateVariableValue(t){PP.myEasyTuneVariables.set(this._myEasyTuneVariableName,t)}}});var js=T(()=>{WL.registerComponent("pp-easy-light-attenuation",{_myVariableName:{type:WL.Type.String,default:""},_mySetAsDefault:{type:WL.Type.Bool,default:!1},_myUseTuneTarget:{type:WL.Type.Bool,default:!1}},{init:function(){this._myEasyObjectTuner=new PP.EasyLightAttenuation(this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget)},start:function(){this._myEasyObjectTuner.start()},update:function(e){this._myEasyObjectTuner.update(e)}});PP.EasyLightAttenuation=class extends PP.EasyObjectTuner{constructor(t,i,s,n){super(t,i,s,n)}_getVariableNamePrefix(){return"Light Attenuation "}_createEasyTuneVariable(t){return new PP.EasyTuneNumber(t,this._getDefaultValue(),.01,3,0,1)}_getObjectValue(t){return this._getLightAttenuation(t)}_getDefaultValue(){return 0}_updateObjectValue(t,i){let s=i,n=t.pp_getComponent("light");n&&(n.color[3]=s)}_getLightAttenuation(t){let i=this._getDefaultValue(),s=t.pp_getComponent("light");return s&&(i=s.color[3]),i}}});var Fs=T(()=>{WL.registerComponent("pp-easy-light-color",{_myVariableName:{type:WL.Type.String,default:""},_mySetAsDefault:{type:WL.Type.Bool,default:!1},_myUseTuneTarget:{type:WL.Type.Bool,default:!1},_myColorModel:{type:WL.Type.Enum,values:["rgb","hsv"]}},{init:function(){this._myEasyObjectTuner=new PP.EasyLightColor(this._myColorModel,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget)},start:function(){this._myEasyObjectTuner.start()},update:function(e){this._myEasyObjectTuner.update(e)}});PP.EasyLightColor=class extends PP.EasyObjectTuner{constructor(t,i,s,n,a){super(i,s,n,a),this._myColorModel=t}_getVariableNamePrefix(){let t=null;return this._myColorModel==0?t="Light RGB ":t="Light HSV ",t}_createEasyTuneVariable(t){return new PP.EasyTuneIntArray(t,this._getDefaultValue(),100,0,255)}_getObjectValue(t){let i=null,s=this._getLightColor(t);return s?this._myColorModel==0?i=PP.ColorUtils.rgbCodeToHuman(s):i=PP.ColorUtils.hsvCodeToHuman(PP.ColorUtils.rgbToHsv(s)):i=this._getDefaultValue(),i}_getDefaultValue(){return PP.vec3_create()}_updateObjectValue(t,i){let s=i;this._myColorModel==0?s=PP.ColorUtils.rgbHumanToCode(s):s=PP.ColorUtils.hsvToRgb(PP.ColorUtils.hsvHumanToCode(s));let n=t.pp_getComponent("light");if(n&&(n.color[0]=s[0],n.color[1]=s[1],n.color[2]=s[2],n.color[3]=n.color[3]),PP.myRightGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressStart()&&PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).myIsPressed||PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressStart()&&PP.myRightGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).myIsPressed){let a=PP.ColorUtils.color1To255(PP.ColorUtils.rgbToHsv(s)),r=PP.ColorUtils.color1To255(s);console.log("RGB:",r.vec_toString(0),"- HSV:",a.vec_toString(0))}}_getLightColor(t){let i=null,s=t.pp_getComponent("light");return s&&(i=s.color.slice(0,3)),i}}});var Hs=T(()=>{WL.registerComponent("pp-easy-mesh-color",{_myVariableName:{type:WL.Type.String,default:""},_myUseTuneTarget:{type:WL.Type.Bool,default:!1},_mySetAsDefault:{type:WL.Type.Bool,default:!1},_myColorModel:{type:WL.Type.Enum,values:["rgb","hsv"],default:"hsv"},_myColorType:{type:WL.Type.Enum,values:["color","diffuse color","ambient color","specular color","emissive color","fog color","ambient factor"],default:"color"}},{init:function(){this._myEasyObjectTuner=new PP.EasyMeshColor(this._myColorModel,this._myColorType,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget)},start:function(){this._myEasyObjectTuner.start()},update:function(e){this._myEasyObjectTuner.update(e)}});PP.EasyMeshColor=class extends PP.EasyObjectTuner{constructor(t,i,s,n,a,r){super(s,n,a,r),this._myColorModel=t,this._myColorType=i,this._myColorVariableNames=["color","diffuseColor","ambientColor","specularColor","emissiveColor","fogColor","ambientFactor"]}_getVariableNamePrefix(){let t=null;return this._myColorModel==0?t="Mesh RGB ":t="Mesh HSV ",t}_createEasyTuneVariable(t){return this._myColorType==6?new PP.EasyTuneNumberArray(t,this._getDefaultValue(),.1,3,0,1):new PP.EasyTuneIntArray(t,this._getDefaultValue(),100,0,255)}_getObjectValue(t){let i=null,s=this._getMeshMaterial(t);return s?this._myColorType!=6?(i=s[this._myColorVariableNames[this._myColorType]].pp_clone(),this._myColorModel==0?i=PP.ColorUtils.rgbCodeToHuman(i):i=PP.ColorUtils.hsvCodeToHuman(PP.ColorUtils.rgbToHsv(i))):i=[s[this._myColorVariableNames[this._myColorType]]]:i=this._getDefaultValue(),i}_getDefaultValue(){return this._myColorType==6?[0]:PP.vec4_create()}_updateObjectValue(t,i){let s=i;this._myColorType!=6&&(this._myColorModel==0?s=PP.ColorUtils.rgbHumanToCode(s):s=PP.ColorUtils.hsvToRgb(PP.ColorUtils.hsvHumanToCode(s)));let n=this._getMeshMaterial(t);if(n&&(n[this._myColorVariableNames[this._myColorType]]=s),this._myColorType!=6&&(PP.myRightGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressStart()&&PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).myIsPressed||PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressStart()&&PP.myRightGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).myIsPressed)){let a=PP.ColorUtils.color1To255(PP.ColorUtils.rgbToHsv(s)),r=PP.ColorUtils.color1To255(s);console.log("RGB:",r.vec_toString(0),"- HSV:",a.vec_toString(0))}}_getMeshMaterial(t){let i=null,s=t.pp_getComponentHierarchy("mesh");return s&&(i=s.material),i}}});var ws=T(()=>{WL.registerComponent("pp-easy-scale",{_myVariableName:{type:WL.Type.String,default:""},_mySetAsDefault:{type:WL.Type.Bool,default:!1},_myUseTuneTarget:{type:WL.Type.Bool,default:!1},_myIsLocal:{type:WL.Type.Bool,default:!1},_myScaleAsOne:{type:WL.Type.Bool,default:!0}},{init:function(){this._myEasyObjectTuner=new PP.EasyScale(this._myIsLocal,this._myScaleAsOne,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget)},start:function(){this._myEasyObjectTuner.start()},update:function(e){this._myEasyObjectTuner.update(e)}});PP.EasyScale=class extends PP.EasyObjectTuner{constructor(t,i,s,n,a,r){super(s,n,a,r),this._myIsLocal=t,this._myScaleAsOne=i}_getVariableNamePrefix(){return"Scale "}_createEasyTuneVariable(t){return new PP.EasyTuneNumberArray(t,this._getDefaultValue(),1,3,.001,null,this._myScaleAsOne)}_getObjectValue(t){return this._myIsLocal?t.pp_getScaleLocal():t.pp_getScaleWorld()}_getDefaultValue(){return PP.vec3_create(1,1,1)}_updateObjectValue(t,i){this._myIsLocal?t.pp_setScaleLocal(i):t.pp_setScaleWorld(i)}}});var Ns=T(()=>{WL.registerComponent("pp-easy-set-tune-target-child-number",{_myVariableName:{type:WL.Type.String,default:""},_mySetAsDefault:{type:WL.Type.Bool,default:!1}},{init:function(){},start:function(){this._myEasyTuneVariableName="Target Child ",this._myVariableName==""?this._myEasyTuneVariableName=this._myEasyTuneVariableName.concat(this.object.objectId):this._myEasyTuneVariableName=this._myEasyTuneVariableName.concat(this._myVariableName);let e=this.object.pp_getChildren().length,t=1,i=e;e==0&&(t=0,i=0),PP.myEasyTuneVariables.add(new PP.EasyTuneInt(this._myEasyTuneVariableName,0,10,t,i)),this._mySetAsDefault&&PP.setEasyTuneWidgetActiveVariable(this._myEasyTuneVariableName),this._myCurrentChildIndex=-1,this._myCurrentChildrenCount=e},update:function(){if(PP.myEasyTuneVariables.isActive(this._myEasyTuneVariableName)){let e=this.object.pp_getChildren().length;if(e!=this._myCurrentChildrenCount){this._myCurrentChildrenCount=e;let i=1,s=e;e==0&&(i=0,s=0);let n=PP.myEasyTuneVariables.getEasyTuneVariable(this._myEasyTuneVariableName);n.setMin(i),n.setMax(s)}let t=PP.myEasyTuneVariables.get(this._myEasyTuneVariableName);t!=this._myCurrentChildIndex&&(t==0&&this._myCurrentChildIndex!=-1?PP.myEasyTuneTarget=null:t>0&&(PP.myEasyTuneTarget=this.object.pp_getChildren()[t-1]),this._myCurrentChildIndex=t)}}})});var Gs=T(()=>{WL.registerComponent("pp-easy-set-tune-target-grab",{},{init:function(){},start:function(){this._myGrabber=this.object.pp_getComponent("pp-grabber-hand")},update:function(){},_onRelease:function(e,t){PP.myEasyTuneTarget=t.object},_onGrab:function(e,t){},onActivate(){this._myGrabber.registerGrabEventListener(this,this._onGrab.bind(this)),this._myGrabber.registerThrowEventListener(this,this._onRelease.bind(this))},onDeactivate(){this._myGrabber.unregisterGrabEventListener(this),this._myGrabber.unregisterThrowEventListener(this)}})});var Us=T(()=>{WL.registerComponent("pp-easy-transform",{_myVariableName:{type:WL.Type.String,default:""},_mySetAsDefault:{type:WL.Type.Bool,default:!1},_myUseTuneTarget:{type:WL.Type.Bool,default:!1},_myIsLocal:{type:WL.Type.Bool,default:!1},_myScaleAsOne:{type:WL.Type.Bool,default:!0}},{init:function(){this._myEasyObjectTuner=new PP.EasyTransform(this._myIsLocal,this._myScaleAsOne,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget)},start:function(){this._myEasyObjectTuner.start()},update:function(e){this._myEasyObjectTuner.update(e)}});PP.EasyTransform=class extends PP.EasyObjectTuner{constructor(t,i,s,n,a,r){super(s,n,a,r),this._myIsLocal=t,this._myScaleAsOne=i}_getVariableNamePrefix(){return"Transform "}_createEasyTuneVariable(t){return new PP.EasyTuneTransform(t,this._getDefaultValue(),this._myScaleAsOne)}_getObjectValue(t){return this._myIsLocal?t.pp_getTransformLocal():t.pp_getTransformWorld()}_getDefaultValue(){return PP.mat4_create()}_updateObjectValue(t,i){this._myIsLocal?t.pp_setTransformLocal(i):t.pp_setTransformWorld(i)}}});var qs=T(()=>{PP.EasyTuneBaseWidgetParams=class{constructor(){this.myVariablesImportCallback=null,this.myVariablesExportCallback=null}};PP.EasyTuneBaseWidget=class{constructor(t){this._mySetup=null,this._myUI=null,this._myParams=t,this._myAdditionalSetup=null,this._myVariable=null,this._myIsVisible=!0,this._myScrollVariableRequestCallbacks=new Map,this._myAppendToVariableName="",this._myScrollVariableActive=!1,this._myScrollDirection=0,this._myScrollVariableTimer=0,this._myHasScrolled=!1,this._myResetImportLabelTimer=new PP.Timer(0,!1),this._myResetExportLabelTimer=new PP.Timer(0,!1)}setVisible(t){t&&this._refreshUI(),this._myUI.setVisible(t),this._myIsVisible=t}setEasyTuneVariable(t,i){this._myVariable=t,typeof i<"u"?this._myAppendToVariableName=i:this._myAppendToVariableName="",this._setEasyTuneVariableHook(),this._refreshUI()}isScrollVariableActive(){return this._myScrollVariableActive}getScrollVariableDirection(){return this._myScrollDirection}setScrollVariableActive(t,i){this._myScrollVariableActive=t,this._myScrollDirection=i,this._myScrollVariableTimer=this._mySetup.myScrollVariableDelay,this._myHasScrolled=!1}getWidget(){return this}syncWidget(t){t!=null?(t._myResetImportLabelTimer.isRunning()?this._myResetImportLabelTimer.start(t._myResetImportLabelTimer.getTimeLeft()):this._myResetImportLabelTimer.reset(),t._myResetExportLabelTimer.isRunning()?this._myResetExportLabelTimer.start(t._myResetExportLabelTimer.getTimeLeft()):this._myResetExportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=t._myUI.myImportButtonTextComponent.text,this._myUI.myExportButtonTextComponent.text=t._myUI.myExportButtonTextComponent.text,this.setScrollVariableActive(t.isScrollVariableActive(),t.getScrollVariableDirection())):(this._myResetImportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=this._mySetup.myImportButtonText,this._myResetExportLabelTimer.reset(),this._myUI.myExportButtonTextComponent.text=this._mySetup.myExportButtonText)}onImportSuccess(){this._myUI.myImportButtonTextComponent.text=this._mySetup.myImportSuccessButtonText,this._myResetImportLabelTimer.start(this._mySetup.myImportExportResetLabelSeconds)}onImportFailure(){this._myUI.myImportButtonTextComponent.text=this._mySetup.myImportFailureButtonText,this._myResetImportLabelTimer.start(this._mySetup.myImportExportResetLabelSeconds)}onExportSuccess(){this._myUI.myExportButtonTextComponent.text=this._mySetup.myExportSuccessButtonText,this._myResetExportLabelTimer.start(this._mySetup.myImportExportResetLabelSeconds)}onExportFailure(){this._myUI.myExportButtonTextComponent.text=this._mySetup.myExportFailureButtonText,this._myResetExportLabelTimer.start(this._mySetup.myImportExportResetLabelSeconds)}registerScrollVariableRequestEventListener(t,i){this._myScrollVariableRequestCallbacks.set(t,i)}unregisterScrollVariableRequestEventListener(t){this._myScrollVariableRequestCallbacks.delete(t)}start(t,i){this._myAdditionalSetup=i,this._mySetup.build(),this._myResetImportLabelTimer.setDuration(this._mySetup.myImportExportResetLabelSeconds),this._myResetExportLabelTimer.setDuration(this._mySetup.myImportExportResetLabelSeconds),this._myUI.build(t,this._mySetup,i),this._myUI.setImportExportButtonsActive(this._myAdditionalSetup.myEnableVariablesImportExportButtons),this._startHook(t,i),this._addListeners()}update(t){this._isActive()&&(this._updateHook(t),this._updateScrollVariable(t),this._updateImportExportLabel(t))}_setEasyTuneVariableHook(){}_refreshUIHook(){}_startHook(t,i){}_addListenersHook(){}_updateHook(t){}_refreshUI(){if(this._myVariable){if(this._myVariable.myName!=null)this._myUI.myVariableLabelTextComponent.text=this._myVariable.myName.concat(this._myAppendToVariableName);else{let t="Unknown";this._myUI.myVariableLabelTextComponent.text=t.concat(this._myAppendToVariableName)}this._refreshUIHook()}}_updateScrollVariable(t){this._myScrollVariableActive&&(this._myScrollVariableTimer<=0?(this._scrollVariableRequest(this._myScrollDirection),this._myScrollVariableTimer=this._mySetup.myScrollVariableDelay,this._myHasScrolled=!0):this._myScrollVariableTimer-=t)}_updateImportExportLabel(t){this._myResetImportLabelTimer.isRunning(t)&&(this._myResetImportLabelTimer.update(t),this._myResetImportLabelTimer.isDone()&&(this._myResetImportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=this._mySetup.myImportButtonText)),this._myResetExportLabelTimer.isRunning(t)&&(this._myResetExportLabelTimer.update(t),this._myResetExportLabelTimer.isDone()&&(this._myResetExportLabelTimer.reset(),this._myUI.myExportButtonTextComponent.text=this._mySetup.myExportButtonText))}_isActive(){return this._myIsVisible&&this._myVariable}_addListeners(){let t=this._myUI;t.myNextButtonCursorTargetComponent.addDownFunction(this._setScrollVariableActive.bind(this,!0,1,!1)),t.myNextButtonCursorTargetComponent.addDownOnHoverFunction(this._setScrollVariableActive.bind(this,!0,1,!1)),t.myNextButtonCursorTargetComponent.addUpFunction(this._setScrollVariableActive.bind(this,!1,0,!1)),t.myNextButtonCursorTargetComponent.addUpWithNoDownFunction(this._setScrollVariableActive.bind(this,!1,0,!0)),t.myNextButtonCursorTargetComponent.addUnHoverFunction(this._setScrollVariableActive.bind(this,!1,0,!0)),t.myNextButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myNextButtonBackgroundComponent.material)),t.myNextButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myNextButtonBackgroundComponent.material)),t.myPreviousButtonCursorTargetComponent.addDownFunction(this._setScrollVariableActive.bind(this,!0,-1,!1)),t.myPreviousButtonCursorTargetComponent.addDownOnHoverFunction(this._setScrollVariableActive.bind(this,!0,-1,!1)),t.myPreviousButtonCursorTargetComponent.addUpFunction(this._setScrollVariableActive.bind(this,!1,0,!1)),t.myPreviousButtonCursorTargetComponent.addUpWithNoDownFunction(this._setScrollVariableActive.bind(this,!1,0,!0)),t.myPreviousButtonCursorTargetComponent.addUnHoverFunction(this._setScrollVariableActive.bind(this,!1,0,!0)),t.myPreviousButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myPreviousButtonBackgroundComponent.material)),t.myPreviousButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myPreviousButtonBackgroundComponent.material)),t.myImportButtonCursorTargetComponent.addUpFunction(this._importVariables.bind(this)),t.myImportButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myImportButtonBackgroundComponent.material)),t.myImportButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myImportButtonBackgroundComponent.material)),t.myExportButtonCursorTargetComponent.addUpFunction(this._exportVariables.bind(this)),t.myExportButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myExportButtonBackgroundComponent.material)),t.myExportButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myExportButtonBackgroundComponent.material)),this._addListenersHook()}_setScrollVariableActive(t,i,s){if(this._isActive()||!t){let n=!t&&!this._myHasScrolled&&!s,a=this._myScrollDirection;this.setScrollVariableActive(t,i),n&&this._scrollVariableRequest(a)}}_scrollVariableRequest(t){if(this._isActive()&&t!=0)for(let i of this._myScrollVariableRequestCallbacks.values())i(t)}_genericHover(t){t.color=this._mySetup.myButtonHoverColor}_genericUnHover(t){t.color=this._mySetup.myBackgroundColor}_importVariables(){this._myUI.myImportButtonTextComponent.text==this._mySetup.myImportButtonText&&(this._myUI.myImportButtonTextComponent.text=this._mySetup.myImportingButtonText,this._myResetImportLabelTimer.reset(),this._myParams.myVariablesImportCallback())}_exportVariables(){this._myUI.myExportButtonTextComponent.text==this._mySetup.myExportButtonText&&(this._myUI.myExportButtonTextComponent.text=this._mySetup.myExportingButtonText,this._myResetExportLabelTimer.reset(),this._myParams.myVariablesExportCallback())}}});var zs=T(()=>{PP.EasyTuneBaseWidgetUI=class{build(t,i,s){this._myParentObject=t,this._mySetup=i,this._myAdditionalSetup=s,this._myImportExportButtonsActive=!0,this._myPlaneMesh=PP.myDefaultResources.myMeshes.myPlane,this._buildHook(),this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonVR(),WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}setVisible(t){this.myPivotObject.pp_setActiveHierarchy(t),t&&this.setImportExportButtonsActive(this._myImportExportButtonsActive),this._setVisibleHook(t)}setImportExportButtonsActive(t){this._myImportExportButtonsActive=t,this.myImportExportPanel.pp_setActiveHierarchy(this._myImportExportButtonsActive)}_buildHook(){}_setVisibleHook(t){}_createSkeletonHook(){}_setTransformHook(){}_addComponentsHook(){}_createSkeleton(){this.myPivotObject=WL.scene.addObject(this._myParentObject),this.myBackPanel=WL.scene.addObject(this.myPivotObject),this.myBackBackground=WL.scene.addObject(this.myBackPanel),this.myDisplayPanel=WL.scene.addObject(this.myPivotObject),this.myVariableLabelPanel=WL.scene.addObject(this.myDisplayPanel),this.myVariableLabelText=WL.scene.addObject(this.myVariableLabelPanel),this.myVariableLabelCursorTarget=WL.scene.addObject(this.myVariableLabelPanel),this.myNextButtonPanel=WL.scene.addObject(this.myVariableLabelPanel),this.myNextButtonBackground=WL.scene.addObject(this.myNextButtonPanel),this.myNextButtonText=WL.scene.addObject(this.myNextButtonPanel),this.myNextButtonCursorTarget=WL.scene.addObject(this.myNextButtonPanel),this.myPreviousButtonPanel=WL.scene.addObject(this.myVariableLabelPanel),this.myPreviousButtonBackground=WL.scene.addObject(this.myPreviousButtonPanel),this.myPreviousButtonText=WL.scene.addObject(this.myPreviousButtonPanel),this.myPreviousButtonCursorTarget=WL.scene.addObject(this.myPreviousButtonPanel),this.myImportExportPanel=WL.scene.addObject(this.myPivotObject),this.myImportButtonPanel=WL.scene.addObject(this.myImportExportPanel),this.myImportButtonBackground=WL.scene.addObject(this.myImportButtonPanel),this.myImportButtonText=WL.scene.addObject(this.myImportButtonPanel),this.myImportButtonCursorTarget=WL.scene.addObject(this.myImportButtonPanel),this.myExportButtonPanel=WL.scene.addObject(this.myImportExportPanel),this.myExportButtonBackground=WL.scene.addObject(this.myExportButtonPanel),this.myExportButtonText=WL.scene.addObject(this.myExportButtonPanel),this.myExportButtonCursorTarget=WL.scene.addObject(this.myExportButtonPanel),this.myPointerCursorTarget=WL.scene.addObject(this.myPivotObject),this._createSkeletonHook()}_setTransforms(){this.myPivotObject.setTranslationLocal(this._mySetup.myPivotObjectPositions[this._myAdditionalSetup.myHandedness]),this.myBackPanel.setTranslationLocal(this._mySetup.myBackPanelPosition),this.myBackBackground.scale(this._mySetup.myBackBackgroundScale),this.myDisplayPanel.setTranslationLocal(this._mySetup.myDisplayPanelPosition),this.myVariableLabelPanel.setTranslationLocal(this._mySetup.myVariableLabelPanelPosition),this.myVariableLabelText.scale(this._mySetup.myVariableLabelTextScale),this.myVariableLabelCursorTarget.setTranslationLocal(this._mySetup.myVariableLabelCursorTargetPosition),this.myNextButtonPanel.setTranslationLocal(this._mySetup.myRightSideButtonPosition),this.myNextButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myNextButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myNextButtonText.scale(this._mySetup.mySideButtonTextScale),this.myNextButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myPreviousButtonPanel.setTranslationLocal(this._mySetup.myLeftSideButtonPosition),this.myPreviousButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myPreviousButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myPreviousButtonText.scale(this._mySetup.mySideButtonTextScale),this.myPreviousButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myImportExportPanel.setTranslationLocal(this._mySetup.myImportExportPanelPosition),this.myImportButtonPanel.setTranslationLocal(this._mySetup.myImportButtonPosition),this.myImportButtonBackground.scale(this._mySetup.myImportExportButtonBackgroundScale),this.myImportButtonText.setTranslationLocal(this._mySetup.myImportExportButtonTextPosition),this.myImportButtonText.scale(this._mySetup.myImportExportButtonTextScale),this.myImportButtonCursorTarget.setTranslationLocal(this._mySetup.myImportExportButtonCursorTargetPosition),this.myExportButtonPanel.setTranslationLocal(this._mySetup.myExportButtonPosition),this.myExportButtonBackground.scale(this._mySetup.myImportExportButtonBackgroundScale),this.myExportButtonText.setTranslationLocal(this._mySetup.myImportExportButtonTextPosition),this.myExportButtonText.scale(this._mySetup.myImportExportButtonTextScale),this.myExportButtonCursorTarget.setTranslationLocal(this._mySetup.myImportExportButtonCursorTargetPosition),this.myPointerCursorTarget.setTranslationLocal(this._mySetup.myPointerCursorTargetPosition),this._setTransformHook()}_addComponents(){this.myBackBackgroundComponent=this.myBackBackground.addComponent("mesh"),this.myBackBackgroundComponent.mesh=this._myPlaneMesh,this.myBackBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myBackBackgroundComponent.material.color=this._mySetup.myBackBackgroundColor,this.myVariableLabelTextComponent=this.myVariableLabelText.addComponent("text"),this._setupTextComponent(this.myVariableLabelTextComponent),this.myVariableLabelTextComponent.text=" ",this.myVariableLabelCursorTargetComponent=this.myVariableLabelCursorTarget.addComponent("cursor-target"),this.myVariableLabelCollisionComponent=this.myVariableLabelCursorTarget.addComponent("collision"),this.myVariableLabelCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myVariableLabelCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myVariableLabelCollisionComponent.extents=this._mySetup.myVariableLabelCollisionExtents,this.myNextButtonBackgroundComponent=this.myNextButtonBackground.addComponent("mesh"),this.myNextButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myNextButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myNextButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myNextButtonTextComponent=this.myNextButtonText.addComponent("text"),this._setupTextComponent(this.myNextButtonTextComponent),this.myNextButtonTextComponent.text=this._mySetup.myNextButtonText,this.myNextButtonCursorTargetComponent=this.myNextButtonCursorTarget.addComponent("cursor-target"),this.myNextButtonCollisionComponent=this.myNextButtonCursorTarget.addComponent("collision"),this.myNextButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myNextButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myNextButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myPreviousButtonBackgroundComponent=this.myPreviousButtonBackground.addComponent("mesh"),this.myPreviousButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPreviousButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPreviousButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myPreviousButtonTextComponent=this.myPreviousButtonText.addComponent("text"),this._setupTextComponent(this.myPreviousButtonTextComponent),this.myPreviousButtonTextComponent.text=this._mySetup.myPreviousButtonText,this.myPreviousButtonCursorTargetComponent=this.myPreviousButtonCursorTarget.addComponent("cursor-target"),this.myPreviousButtonCollisionComponent=this.myPreviousButtonCursorTarget.addComponent("collision"),this.myPreviousButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPreviousButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPreviousButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myImportButtonBackgroundComponent=this.myImportButtonBackground.addComponent("mesh"),this.myImportButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myImportButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myImportButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myImportButtonTextComponent=this.myImportButtonText.addComponent("text"),this._setupTextComponent(this.myImportButtonTextComponent),this.myImportButtonTextComponent.text=this._mySetup.myImportButtonText,this.myImportButtonCursorTargetComponent=this.myImportButtonCursorTarget.addComponent("cursor-target"),this.myImportButtonCollisionComponent=this.myImportButtonCursorTarget.addComponent("collision"),this.myImportButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myImportButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myImportButtonCollisionComponent.extents=this._mySetup.myImportExportButtonCollisionExtents,this.myExportButtonBackgroundComponent=this.myExportButtonBackground.addComponent("mesh"),this.myExportButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myExportButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myExportButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myExportButtonTextComponent=this.myExportButtonText.addComponent("text"),this._setupTextComponent(this.myExportButtonTextComponent),this.myExportButtonTextComponent.text=this._mySetup.myExportButtonText,this.myExportButtonCursorTargetComponent=this.myExportButtonCursorTarget.addComponent("cursor-target"),this.myExportButtonCollisionComponent=this.myExportButtonCursorTarget.addComponent("collision"),this.myExportButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myExportButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myExportButtonCollisionComponent.extents=this._mySetup.myImportExportButtonCollisionExtents,this.myPointerCollisionComponent=this.myPointerCursorTarget.addComponent("collision"),this.myPointerCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPointerCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPointerCollisionComponent.extents=this._mySetup.myPointerCollisionExtents,this._addComponentsHook()}_setupTextComponent(t){t.alignment=this._mySetup.myTextAlignment,t.justification=this._mySetup.myTextJustification,t.material=this._myAdditionalSetup.myTextMaterial.clone(),t.material.color=this._mySetup.myTextColor,t.text=""}_onXRSessionStart(){this._setTransformForVR()}_onXRSessionEnd(){this._setTransformForNonVR()}_setTransformForVR(){this.myPivotObject.setTranslationLocal(this._mySetup.myPivotObjectPositions[this._myAdditionalSetup.myHandedness])}_setTransformForNonVR(){this.myPivotObject.setTranslationLocal(this._mySetup.myPivotObjectPositions[PP.ToolHandedness.NONE])}}});var Qs=T(()=>{PP.EasyTuneBaseWidgetSetup=class{constructor(){}build(){this._initializeBuildSetup(),this._initializeRuntimeSetup()}_getBackPanelMaxY(){return this.myDisplayPanelPosition[1]+this.myVariableLabelPanelPosition[1]+this.mySideButtonBackgroundScale[1]+this._mySideButtonDistanceFromBorder*1.25}_getBackPanelMinY(){return this.myDisplayPanelPosition[1]-this._mySideButtonDistanceFromBorder*1.25-this.mySideButtonBackgroundScale[1]}_getBackPanelMaxX(){return this._mySideButtonPanelHalfWidth}_getBackPanelMinX(){return-this._mySideButtonPanelHalfWidth}_getPivotZOffset(){return 0}_initializeBuildSetupHook(){}_initializeRuntimeSetupHook(){}_initializeBuildSetup(){this.myBackgroundColor=[46/255,46/255,46/255,1],this.myCursorTargetCollisionCollider=WL.Collider.Box,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=[255/255,255/255,255/255,1],this.myTextAlignment=WL.Alignment.Center,this.myTextJustification=WL.Justification.Middle,this.myTextColor=this.myDefaultTextColor,this.myLabelTextScale=[.19,.19,.19],this.myButtonTextScale=[.18,.18,.18],this._myPanelZOffset=.01,this._myColliderZOffset=.017,this._mySideButtonDistanceFromBorder=.0125,this._mySideButtonPanelHalfWidth=.2,this.myPivotObjectPositions=[],this.myPivotObjectPositions[PP.ToolHandedness.NONE]=[0,0,this._getPivotZOffset()],this.myPivotObjectPositions[PP.ToolHandedness.LEFT]=[-.04,.02,this._getPivotZOffset()],this.myPivotObjectPositions[PP.ToolHandedness.RIGHT]=[-.08,.02,this._getPivotZOffset()],this.mySideButtonBackgroundScale=[.015,.015,1],this.mySideButtonTextScale=this.myButtonTextScale,this.mySideButtonTextPosition=[0,0,.007],this.mySideButtonCursorTargetPosition=[0,0,0],this.mySideButtonCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.mySideButtonCollisionExtents=this.mySideButtonBackgroundScale.slice(0),this.mySideButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myLeftSideButtonPosition=[0,0,-1e-5],this.myLeftSideButtonPosition[0]=-this._mySideButtonPanelHalfWidth+this.mySideButtonBackgroundScale[0]+this._mySideButtonDistanceFromBorder,this.myRightSideButtonPosition=[0,0,-1e-5],this.myRightSideButtonPosition[0]=-this.myLeftSideButtonPosition[0],this.myDisplayPanelPosition=[0,.1,0],this.myVariableLabelPanelPosition=[0,.025,this._myPanelZOffset],this.myVariableLabelTextScale=this.myLabelTextScale,this.myVariableLabelCursorTargetPosition=[0,0,0],this.myVariableLabelCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myVariableLabelCollisionExtents=[.065,.0175,1],this.myVariableLabelCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myNextButtonText=">",this.myPreviousButtonText="<",this._initializeBuildSetupHook();{let t=this._getBackPanelMaxX(),i=this._getBackPanelMinX(),s=this._getBackPanelMaxY(),n=this._getBackPanelMinY();this.myBackPanelPosition=[(t+i)/2,(s+n)/2,0],this.myBackBackgroundScale=[(t-i)/2,(s-n)/2,1],this.myBackBackgroundColor=[70/255,70/255,70/255,1]}this.myImportExportButtonBackgroundScale=[.04,.02,1],this.myImportExportButtonTextScale=this.myButtonTextScale,this.myImportExportButtonTextPosition=[0,0,.007],this.myImportExportPanelPosition=[0,this._getBackPanelMaxY()+this._mySideButtonDistanceFromBorder+this.myImportExportButtonBackgroundScale[1],this._myPanelZOffset],this.myImportExportButtonCursorTargetPosition=[0,0,0],this.myImportExportButtonCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myImportExportButtonCollisionExtents=this.myImportExportButtonBackgroundScale.slice(0),this.myImportExportButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myImportButtonText="Import",this.myExportButtonText="Export",this.myImportExportResetLabelSeconds=2,this.myImportingButtonText="...",this.myImportSuccessButtonText="Done",this.myImportFailureButtonText="Error",this.myExportingButtonText="...",this.myExportSuccessButtonText="Done",this.myExportFailureButtonText="Error",this.myImportButtonPosition=[0,0,-1e-5],this.myImportButtonPosition[0]=-this.myImportExportButtonBackgroundScale[0]-this._mySideButtonDistanceFromBorder/2,this.myExportButtonPosition=[0,0,-1e-5],this.myExportButtonPosition[0]=-this.myImportButtonPosition[0],this.myPointerCollisionExtents=this.myBackBackgroundScale.slice(0),this.myPointerCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myPointerCursorTargetPosition=this.myBackPanelPosition.slice(0),this.myPointerCursorTargetPosition[2]=this._myColliderZOffset-1e-4}_initializeRuntimeSetup(){this.myButtonHoverColor=[150/255,150/255,150/255,1],this.myScrollVariableDelay=.5,this._initializeRuntimeSetupHook()}}});var Xs=T(()=>{PP.EasyTuneBoolArrayWidget=class extends PP.EasyTuneBaseWidget{constructor(t,i,s){super(t),this._mySetup=new PP.EasyTuneBoolArrayWidgetSetup(i),this._myUI=new PP.EasyTuneBoolArrayWidgetUI,this._myGamepad=s,this._myValueEditIndex=0,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myValueEditActive=!1}_refreshUIHook(){for(let t=0;t<this._mySetup.myArraySize;t++)this._myUI.myValueTextComponents[t].text=this._myVariable.myValue[t]?"true":"false"}_startHook(t,i){this._myUI.setAdditionalButtonsActive(i.myEnableAdditionalButtons)}_updateHook(t){this._updateValue(t)}_updateValue(t){let i=0;this._myGamepad&&(i=this._myGamepad.getAxesInfo().myAxes[1]);let s=0;this._myValueEditActive?s=i:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?s=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=t),Math.abs(s)>this._mySetup.myThumbstickToggleThreshold&&(this._myVariable.myValue[this._myValueEditIndex]=s>0,this._refreshUI())}_addListenersHook(){let t=this._myUI;t.myVariableLabelCursorTargetComponent.addClickFunction(this._resetAllValues.bind(this)),t.myVariableLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,t.myVariableLabelText)),t.myVariableLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,t.myVariableLabelText,this._mySetup.myVariableLabelTextScale));for(let i=0;i<this._mySetup.myArraySize;i++)t.myValueIncreaseButtonCursorTargetComponents[i].addDownFunction(this._setValueEditIntensity.bind(this,i,1)),t.myValueIncreaseButtonCursorTargetComponents[i].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,i,1)),t.myValueIncreaseButtonCursorTargetComponents[i].addUpFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueIncreaseButtonCursorTargetComponents[i].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueIncreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueDecreaseButtonCursorTargetComponents[i].addDownFunction(this._setValueEditIntensity.bind(this,i,-1)),t.myValueDecreaseButtonCursorTargetComponents[i].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,i,-1)),t.myValueDecreaseButtonCursorTargetComponents[i].addUpFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueDecreaseButtonCursorTargetComponents[i].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueDecreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueIncreaseButtonCursorTargetComponents[i].addHoverFunction(this._genericHover.bind(this,t.myValueIncreaseButtonBackgroundComponents[i].material)),t.myValueIncreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._genericUnHover.bind(this,t.myValueIncreaseButtonBackgroundComponents[i].material)),t.myValueDecreaseButtonCursorTargetComponents[i].addHoverFunction(this._genericHover.bind(this,t.myValueDecreaseButtonBackgroundComponents[i].material)),t.myValueDecreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._genericUnHover.bind(this,t.myValueDecreaseButtonBackgroundComponents[i].material)),t.myValueCursorTargetComponents[i].addClickFunction(this._resetValue.bind(this,i)),t.myValueCursorTargetComponents[i].addHoverFunction(this._setValueEditActive.bind(this,i,t.myValueTexts[i],!0)),t.myValueCursorTargetComponents[i].addUnHoverFunction(this._setValueEditActive.bind(this,i,t.myValueTexts[i],!1))}_setValueEditIntensity(t,i){(this._isActive()||i==0)&&(i!=0&&(this._myValueButtonEditIntensityTimer=this._mySetup.myButtonEditDelay,this._myValueEditIndex=t),this._myValueButtonEditIntensity=i)}_setValueEditActive(t,i,s){(this._isActive()||!s)&&(s?(this._myValueEditIndex=t,i.scale(this._mySetup.myTextHoverScaleMultiplier)):i.scalingWorld=this._mySetup.myValueTextScale,this._myValueEditActive=s)}_resetValue(t){this._isActive()&&(this._myVariable.myValue[t]=this._myVariable.myDefaultValue[t],this._myUI.myValueTextComponents[t].text=this._myVariable.myValue[t]?"true":"false")}_resetAllValues(){for(let t=0;t<this._mySetup.myArraySize;t++)this._resetValue(t)}_genericTextHover(t){t.scale(this._mySetup.myTextHoverScaleMultiplier)}_genericTextUnHover(t,i){t.scalingWorld=i}}});var Ks=T(()=>{PP.EasyTuneBoolArrayWidgetUI=class extends PP.EasyTuneBaseWidgetUI{setAdditionalButtonsActive(t){this._myAdditionalButtonsActive=t;for(let i=0;i<this._mySetup.myArraySize;i++)this.myValueIncreaseButtonPanels[i].pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myValueDecreaseButtonPanels[i].pp_setActiveHierarchy(this._myAdditionalButtonsActive)}_buildHook(){this._myAdditionalButtonsActive=!0}_createSkeletonHook(){this.myValuesPanel=WL.scene.addObject(this.myDisplayPanel),this.myValuePanels=[],this.myValueTexts=[],this.myValueCursorTargets=[],this.myValueIncreaseButtonPanels=[],this.myValueIncreaseButtonBackgrounds=[],this.myValueIncreaseButtonTexts=[],this.myValueIncreaseButtonCursorTargets=[],this.myValueDecreaseButtonPanels=[],this.myValueDecreaseButtonBackgrounds=[],this.myValueDecreaseButtonTexts=[],this.myValueDecreaseButtonCursorTargets=[];for(let t=0;t<this._mySetup.myArraySize;t++)this.myValuePanels[t]=WL.scene.addObject(this.myValuesPanel),this.myValueTexts[t]=WL.scene.addObject(this.myValuePanels[t]),this.myValueCursorTargets[t]=WL.scene.addObject(this.myValuePanels[t]),this.myValueIncreaseButtonPanels[t]=WL.scene.addObject(this.myValuePanels[t]),this.myValueIncreaseButtonBackgrounds[t]=WL.scene.addObject(this.myValueIncreaseButtonPanels[t]),this.myValueIncreaseButtonTexts[t]=WL.scene.addObject(this.myValueIncreaseButtonPanels[t]),this.myValueIncreaseButtonCursorTargets[t]=WL.scene.addObject(this.myValueIncreaseButtonPanels[t]),this.myValueDecreaseButtonPanels[t]=WL.scene.addObject(this.myValuePanels[t]),this.myValueDecreaseButtonBackgrounds[t]=WL.scene.addObject(this.myValueDecreaseButtonPanels[t]),this.myValueDecreaseButtonTexts[t]=WL.scene.addObject(this.myValueDecreaseButtonPanels[t]),this.myValueDecreaseButtonCursorTargets[t]=WL.scene.addObject(this.myValueDecreaseButtonPanels[t])}_setTransformHook(){this.myValuesPanel.setTranslationLocal(this._mySetup.myValuesPanelPosition);for(let t=0;t<this._mySetup.myArraySize;t++)this.myValuePanels[t].setTranslationLocal(this._mySetup.myValuePanelsPositions[t]),this.myValueTexts[t].scale(this._mySetup.myValueTextScale),this.myValueCursorTargets[t].setTranslationLocal(this._mySetup.myValueCursorTargetPosition),this.myValueIncreaseButtonPanels[t].setTranslationLocal(this._mySetup.myRightSideButtonPosition),this.myValueIncreaseButtonBackgrounds[t].scale(this._mySetup.mySideButtonBackgroundScale),this.myValueIncreaseButtonTexts[t].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myValueIncreaseButtonTexts[t].scale(this._mySetup.mySideButtonTextScale),this.myValueIncreaseButtonCursorTargets[t].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myValueDecreaseButtonPanels[t].setTranslationLocal(this._mySetup.myLeftSideButtonPosition),this.myValueDecreaseButtonBackgrounds[t].scale(this._mySetup.mySideButtonBackgroundScale),this.myValueDecreaseButtonTexts[t].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myValueDecreaseButtonTexts[t].scale(this._mySetup.mySideButtonTextScale),this.myValueDecreaseButtonCursorTargets[t].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myValueTextComponents=[],this.myValueCursorTargetComponents=[],this.myValueCollisionComponents=[],this.myValueIncreaseButtonBackgroundComponents=[],this.myValueIncreaseButtonTextComponents=[],this.myValueIncreaseButtonCursorTargetComponents=[],this.myValueIncreaseButtonCollisionComponents=[],this.myValueDecreaseButtonBackgroundComponents=[],this.myValueDecreaseButtonTextComponents=[],this.myValueDecreaseButtonCursorTargetComponents=[],this.myValueDecreaseButtonCollisionComponents=[];for(let t=0;t<this._mySetup.myArraySize;t++)this.myValueTextComponents[t]=this.myValueTexts[t].addComponent("text"),this._setupTextComponent(this.myValueTextComponents[t]),this.myValueTextComponents[t].text=" ",this.myValueCursorTargetComponents[t]=this.myValueCursorTargets[t].addComponent("cursor-target"),this.myValueCollisionComponents[t]=this.myValueCursorTargets[t].addComponent("collision"),this.myValueCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueCollisionComponents[t].extents=this._mySetup.myValueCollisionExtents,this.myValueIncreaseButtonBackgroundComponents[t]=this.myValueIncreaseButtonBackgrounds[t].addComponent("mesh"),this.myValueIncreaseButtonBackgroundComponents[t].mesh=this._myPlaneMesh,this.myValueIncreaseButtonBackgroundComponents[t].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myValueIncreaseButtonBackgroundComponents[t].material.color=this._mySetup.myBackgroundColor,this.myValueIncreaseButtonTextComponents[t]=this.myValueIncreaseButtonTexts[t].addComponent("text"),this._setupTextComponent(this.myValueIncreaseButtonTextComponents[t]),this.myValueIncreaseButtonTextComponents[t].text=this._mySetup.myIncreaseButtonText,this.myValueIncreaseButtonCursorTargetComponents[t]=this.myValueIncreaseButtonCursorTargets[t].addComponent("cursor-target"),this.myValueIncreaseButtonCollisionComponents[t]=this.myValueIncreaseButtonCursorTargets[t].addComponent("collision"),this.myValueIncreaseButtonCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueIncreaseButtonCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueIncreaseButtonCollisionComponents[t].extents=this._mySetup.mySideButtonCollisionExtents,this.myValueDecreaseButtonBackgroundComponents[t]=this.myValueDecreaseButtonBackgrounds[t].addComponent("mesh"),this.myValueDecreaseButtonBackgroundComponents[t].mesh=this._myPlaneMesh,this.myValueDecreaseButtonBackgroundComponents[t].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myValueDecreaseButtonBackgroundComponents[t].material.color=this._mySetup.myBackgroundColor,this.myValueDecreaseButtonTextComponents[t]=this.myValueDecreaseButtonTexts[t].addComponent("text"),this._setupTextComponent(this.myValueDecreaseButtonTextComponents[t]),this.myValueDecreaseButtonTextComponents[t].text=this._mySetup.myDecreaseButtonText,this.myValueDecreaseButtonCursorTargetComponents[t]=this.myValueDecreaseButtonCursorTargets[t].addComponent("cursor-target"),this.myValueDecreaseButtonCollisionComponents[t]=this.myValueDecreaseButtonCursorTargets[t].addComponent("collision"),this.myValueDecreaseButtonCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueDecreaseButtonCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueDecreaseButtonCollisionComponents[t].extents=this._mySetup.mySideButtonCollisionExtents}_setVisibleHook(t){t&&this.setAdditionalButtonsActive(this._myAdditionalButtonsActive)}}});var Js=T(()=>{PP.EasyTuneBoolArrayWidgetSetup=class extends PP.EasyTuneBaseWidgetSetup{constructor(t){super(),this.myArraySize=t}_getBackPanelMinY(){let t=this.myValuePanelsPositions[this.myArraySize-1]?this.myValuePanelsPositions[this.myArraySize-1][1]:0;return super._getBackPanelMinY()+this.myValuesPanelPosition[1]+t}_getPivotZOffset(){return .00802713}_initializeBuildSetupHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValuesPanelPosition=[0,this.myVariableLabelPanelPosition[1]-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myValueTextScale=[.4,.4,.4],this.myValueCursorTargetPosition=[0,0,0],this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=[.065,.02,1],this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=[0,0,0];for(let t=1;t<this.myArraySize;t++)this.myValuePanelsPositions[t]=this.myValuePanelsPositions[t-1].slice(0),this.myValuePanelsPositions[t][1]-=this._myDistanceBetweenValues}_initializeRuntimeSetupHook(){this.myTextHoverScaleMultiplier=[1.25,1.25,1.25],this.myThumbstickToggleThreshold=.6,this.myButtonEditDelay=0}}});var Ys=T(()=>{PP.EasyTuneBoolArrayWidgetSelector=class{constructor(t,i){this._myGamepad=i,this._myParentObject=null,this._myParams=t,this._myAdditionalSetup=null,this._myWidgets=new Map,this._myVariable=null,this._myIsVisible=!0,this._myAppendToVariableName=null,this._myScrollVariableRequestCallbacks=new Map,this._myCurrentArraySize=0}setEasyTuneVariable(t,i){this._myVariable=t,this._myCurrentArraySize=this._myVariable.myValue.length,this._myAppendToVariableName=i,this._myWidgets.has(this._myCurrentArraySize)||this._createWidget(this._myCurrentArraySize);let s=this._myWidgets.get(this._myCurrentArraySize);s&&s.setEasyTuneVariable(t,i),this.setVisible(this._myIsVisible)}setVisible(t){for(let i of this._myWidgets.values())i.setVisible(!1);if(this._myVariable){this._sizeChangedCheck();let i=this._myWidgets.get(this._myCurrentArraySize);i&&i.setVisible(t)}this._myIsVisible=t}isScrollVariableActive(){let t=this._myWidgets.get(this._myCurrentArraySize);return t?t.isScrollVariableActive():!1}getScrollVariableDirection(){let t=this._myWidgets.get(this._myCurrentArraySize);return t?t.getScrollVariableDirection():0}setScrollVariableActive(t,i){let s=this._myWidgets.get(this._myCurrentArraySize);s&&s.setScrollVariableActive(t,i)}getWidget(){return this._myWidgets.get(this._myCurrentArraySize)}registerScrollVariableRequestEventListener(t,i){this._myScrollVariableRequestCallbacks.set(t,i)}unregisterScrollVariableRequestEventListener(t){this._myScrollVariableRequestCallbacks.delete(t)}start(t,i){this._myParentObject=t,this._myAdditionalSetup=i,this._createWidget(1),this._myVariable&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}update(t){if(this._isActive()){this._sizeChangedCheck();let i=this._myWidgets.get(this._myCurrentArraySize);i&&i.update(t)}}onImportSuccess(){let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.onImportSuccess()}onImportFailure(){let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.onImportFailure()}onExportSuccess(){let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.onExportSuccess()}onExportFailure(){let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.onExportFailure()}_isActive(){return this._myIsVisible&&this._myVariable}_scrollVariableRequest(t){for(let i of this._myScrollVariableRequestCallbacks.values())i(t)}_createWidget(t){this._myWidgets.set(t,new PP.EasyTuneBoolArrayWidget(this._myParams,t,this._myGamepad)),this._myWidgets.get(t).start(this._myParentObject,this._myAdditionalSetup),this._myWidgets.get(t).setVisible(!1),this._myWidgets.get(t).registerScrollVariableRequestEventListener(this,this._scrollVariableRequest.bind(this))}_sizeChangedCheck(){this._myVariable.myValue.length!=this._myCurrentArraySize&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}}});var Zs=T(()=>{PP.EasyTuneNoneWidget=class extends PP.EasyTuneBaseWidget{constructor(t){super(t),this._mySetup=new PP.EasyTuneNoneWidgetSetup,this._myUI=new PP.EasyTuneNoneWidgetUI}}});var $s=T(()=>{PP.EasyTuneNoneWidgetUI=class extends PP.EasyTuneBaseWidgetUI{_createSkeletonHook(){this.myTypeNotSupportedPanel=WL.scene.addObject(this.myDisplayPanel),this.myTypeNotSupportedText=WL.scene.addObject(this.myTypeNotSupportedPanel),this.myTypeNotSupportedCursorTarget=WL.scene.addObject(this.myTypeNotSupportedPanel)}_setTransformHook(){this.myTypeNotSupportedPanel.setTranslationLocal(this._mySetup.myTypeNotSupportedPanelPosition),this.myTypeNotSupportedText.scale(this._mySetup.myTypeNotSupportedTextScale)}_addComponentsHook(){this.myTypeNotSupportedTextComponent=this.myTypeNotSupportedText.addComponent("text"),this._setupTextComponent(this.myTypeNotSupportedTextComponent),this.myTypeNotSupportedTextComponent.text=this._mySetup.myTypeNotSupportedText}}});var tn=T(()=>{PP.EasyTuneNoneWidgetSetup=class extends PP.EasyTuneBaseWidgetSetup{_getBackPanelMinY(){return super._getBackPanelMinY()+this.myTypeNotSupportedPanelPosition[1]}_getPivotZOffset(){return .00804713}_initializeBuildSetupHook(){this.myTypeNotSupportedPanelPosition=[0,-.03,this._myPanelZOffset],this.myTypeNotSupportedTextScale=[.275,.275,.275],this.myTypeNotSupportedText="Type Not Supported"}}});var en=T(()=>{PP.EasyTuneNumberArrayWidget=class extends PP.EasyTuneBaseWidget{constructor(t,i,s){super(t),this._myGamepad=s,this._mySetup=new PP.EasyTuneNumberArrayWidgetSetup(i),this._myUI=new PP.EasyTuneNumberArrayWidgetUI,this._myValueEditIndex=-1,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myStepButtonEditIntensity=0,this._myStepButtonEditIntensityTimer=0,this._myValueEditActive=!1,this._myStepEditActive=!1,this._myValueRealValue=0,this._myStepMultiplierValue=0,this._myStepFastEdit=!1}_setEasyTuneVariableHook(){this._myValueEditIndex>=0&&(this._myValueRealValue=this._myVariable.myValue[this._myValueEditIndex])}_refreshUIHook(){for(let t=0;t<this._mySetup.myArraySize;t++)this._myUI.myValueTextComponents[t].text=this._myVariable.myValue[t].toFixed(this._myVariable.myDecimalPlaces);this._myUI.myStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myStepPerSecond)}_startHook(t,i){this._myUI.setAdditionalButtonsActive(i.myEnableAdditionalButtons)}_updateHook(t){this._updateValue(t)}_updateValue(t){let i=0;if(this._myGamepad){let a=this._myGamepad.getAxesInfo().myAxes[1];if(Math.abs(a)>this._mySetup.myEditThumbstickMinThreshold){let r=(Math.abs(a)-this._mySetup.myEditThumbstickMinThreshold)/(1-this._mySetup.myEditThumbstickMinThreshold);i=Math.sign(a)*r}}let s=0;if(this._myValueEditActive?s=i:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?s=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=t),s!=0){let a=s*this._myVariable.myStepPerSecond*t;this._myValueRealValue+=a,this._myVariable.myMin!=null&&this._myVariable.myMax!=null?this._myValueRealValue=Math.pp_clamp(this._myValueRealValue,this._myVariable.myMin,this._myVariable.myMax):this._myVariable.myMin!=null?this._myValueRealValue=Math.max(this._myValueRealValue,this._myVariable.myMin):this._myVariable.myMax!=null&&(this._myValueRealValue=Math.min(this._myValueRealValue,this._myVariable.myMax));let r=Math.pow(10,this._myVariable.myDecimalPlaces);if(this._myVariable.myEditAllValuesTogether){let y=Math.round(this._myValueRealValue*r+Number.EPSILON)/r-this._myVariable.myValue[this._myValueEditIndex];for(let c=0;c<this._mySetup.myArraySize;c++)this._myVariable.myValue[c]=Math.round((this._myVariable.myValue[c]+y)*r+Number.EPSILON)/r,this._myVariable.myMin!=null&&this._myVariable.myMax!=null?this._myVariable.myValue[c]=Math.pp_clamp(this._myVariable.myValue[c],this._myVariable.myMin,this._myVariable.myMax):this._myVariable.myMin!=null?this._myVariable.myValue[c]=Math.max(this._myVariable.myValue[c],this._myVariable.myMin):this._myVariable.myMax!=null&&(this._myVariable.myValue[c]=Math.min(this._myVariable.myValue[c],this._myVariable.myMax)),this._myUI.myValueTextComponents[c].text=this._myVariable.myValue[c].toFixed(this._myVariable.myDecimalPlaces)}else this._myVariable.myValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*r+Number.EPSILON)/r,this._myVariable.myMin!=null&&this._myVariable.myMax!=null?this._myVariable.myValue[this._myValueEditIndex]=Math.pp_clamp(this._myVariable.myValue[this._myValueEditIndex],this._myVariable.myMin,this._myVariable.myMax):this._myVariable.myMin!=null?this._myVariable.myValue[this._myValueEditIndex]=Math.max(this._myVariable.myValue[this._myValueEditIndex],this._myVariable.myMin):this._myVariable.myMax!=null&&(this._myVariable.myValue[this._myValueEditIndex]=Math.min(this._myVariable.myValue[this._myValueEditIndex],this._myVariable.myMax)),this._myUI.myValueTextComponents[this._myValueEditIndex].text=this._myVariable.myValue[this._myValueEditIndex].toFixed(this._myVariable.myDecimalPlaces)}else this._myValueRealValue=this._myVariable.myValue[this._myValueEditIndex];let n=0;if(this._myStepEditActive?n=i:this._myStepButtonEditIntensity!=0&&(this._myStepButtonEditIntensityTimer<=0?n=this._myStepButtonEditIntensity:this._myStepButtonEditIntensityTimer-=t),n!=0){let a=0;this._myStepFastEdit?(a=Math.sign(n)*1,this._myStepFastEdit=!1):a=n*this._mySetup.myStepMultiplierStepPerSecond*t,this._myStepMultiplierValue+=a,Math.abs(this._myStepMultiplierValue)>=1&&(Math.sign(this._myStepMultiplierValue)>0?(this._myStepMultiplierValue-=1,this._changeStep(this._myVariable.myStepPerSecond*10)):(this._myStepMultiplierValue+=1,this._changeStep(this._myVariable.myStepPerSecond*.1)))}else this._myStepMultiplierValue=0,this._myStepFastEdit=!0}_addListenersHook(){let t=this._myUI;t.myVariableLabelCursorTargetComponent.addClickFunction(this._resetAllValues.bind(this)),t.myVariableLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,t.myVariableLabelText)),t.myVariableLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,t.myVariableLabelText,this._mySetup.myVariableLabelTextScale));for(let i=0;i<this._mySetup.myArraySize;i++)t.myValueIncreaseButtonCursorTargetComponents[i].addDownFunction(this._setValueEditIntensity.bind(this,i,1)),t.myValueIncreaseButtonCursorTargetComponents[i].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,i,1)),t.myValueIncreaseButtonCursorTargetComponents[i].addUpFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueIncreaseButtonCursorTargetComponents[i].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueIncreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueDecreaseButtonCursorTargetComponents[i].addDownFunction(this._setValueEditIntensity.bind(this,i,-1)),t.myValueDecreaseButtonCursorTargetComponents[i].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,i,-1)),t.myValueDecreaseButtonCursorTargetComponents[i].addUpFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueDecreaseButtonCursorTargetComponents[i].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueDecreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._setValueEditIntensity.bind(this,i,0)),t.myValueIncreaseButtonCursorTargetComponents[i].addHoverFunction(this._genericHover.bind(this,t.myValueIncreaseButtonBackgroundComponents[i].material)),t.myValueIncreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._genericUnHover.bind(this,t.myValueIncreaseButtonBackgroundComponents[i].material)),t.myValueDecreaseButtonCursorTargetComponents[i].addHoverFunction(this._genericHover.bind(this,t.myValueDecreaseButtonBackgroundComponents[i].material)),t.myValueDecreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._genericUnHover.bind(this,t.myValueDecreaseButtonBackgroundComponents[i].material)),t.myValueCursorTargetComponents[i].addClickFunction(this._resetValue.bind(this,i)),t.myValueCursorTargetComponents[i].addHoverFunction(this._setValueEditActive.bind(this,i,t.myValueTexts[i],!0)),t.myValueCursorTargetComponents[i].addUnHoverFunction(this._setValueEditActive.bind(this,i,t.myValueTexts[i],!1));t.myStepCursorTargetComponent.addClickFunction(this._resetStep.bind(this)),t.myStepCursorTargetComponent.addHoverFunction(this._setStepEditActive.bind(this,t.myStepText,!0)),t.myStepCursorTargetComponent.addUnHoverFunction(this._setStepEditActive.bind(this,t.myStepText,!1)),t.myStepIncreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,1)),t.myStepIncreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,1)),t.myStepIncreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,0)),t.myStepIncreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,0)),t.myStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,0)),t.myStepDecreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,-1)),t.myStepDecreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,-1)),t.myStepDecreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,0)),t.myStepDecreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,0)),t.myStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,0)),t.myStepIncreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myStepIncreaseButtonBackgroundComponent.material)),t.myStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myStepIncreaseButtonBackgroundComponent.material)),t.myStepDecreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myStepDecreaseButtonBackgroundComponent.material)),t.myStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myStepDecreaseButtonBackgroundComponent.material))}_setValueEditIntensity(t,i){(this._isActive()||i==0)&&(i!=0&&(this._myValueButtonEditIntensityTimer=this._mySetup.myButtonEditDelay,this._myValueRealValue=this._myVariable.myValue[t],this._myValueEditIndex=t),this._myValueButtonEditIntensity=i)}_setStepEditIntensity(t){(this._isActive()||t==0)&&(t!=0&&(this._myStepButtonEditIntensityTimer=this._mySetup.myButtonEditDelay),this._myStepButtonEditIntensity=t)}_setValueEditActive(t,i,s){(this._isActive()||!s)&&(s?(this._myValueRealValue=this._myVariable.myValue[t],this._myValueEditIndex=t,i.scale(this._mySetup.myTextHoverScaleMultiplier)):i.scalingWorld=this._mySetup.myValueTextScale,this._myValueEditActive=s)}_setStepEditActive(t,i){(this._isActive()||!i)&&(i?t.scale(this._mySetup.myTextHoverScaleMultiplier):t.scalingWorld=this._mySetup.myStepTextScale,this._myStepEditActive=i)}_resetValue(t){this._isActive()&&(this._myVariable.myValue[t]=this._myVariable.myDefaultValue[t],this._myUI.myValueTextComponents[t].text=this._myVariable.myValue[t].toFixed(this._myVariable.myDecimalPlaces))}_resetAllValues(){for(let t=0;t<this._mySetup.myArraySize;t++)this._resetValue(t)}_resetStep(){this._isActive()&&this._changeStep(this._myVariable.myDefaultStepPerSecond)}_changeStep(t){t=Math.pp_roundDecimal(t,10),this._myVariable.myStepPerSecond=t,this._myUI.myStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myStepPerSecond)}_genericTextHover(t){t.scale(this._mySetup.myTextHoverScaleMultiplier)}_genericTextUnHover(t,i){t.scalingWorld=i}}});var sn=T(()=>{PP.EasyTuneNumberArrayWidgetUI=class extends PP.EasyTuneBaseWidgetUI{setAdditionalButtonsActive(t){this._myAdditionalButtonsActive=t;for(let i=0;i<this._mySetup.myArraySize;i++)this.myValueIncreaseButtonPanels[i].pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myValueDecreaseButtonPanels[i].pp_setActiveHierarchy(this._myAdditionalButtonsActive);this.myStepIncreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myStepDecreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive)}_buildHook(){this._myAdditionalButtonsActive=!0}_createSkeletonHook(){this.myValuesPanel=WL.scene.addObject(this.myDisplayPanel),this.myValuePanels=[],this.myValueTexts=[],this.myValueCursorTargets=[],this.myValueIncreaseButtonPanels=[],this.myValueIncreaseButtonBackgrounds=[],this.myValueIncreaseButtonTexts=[],this.myValueIncreaseButtonCursorTargets=[],this.myValueDecreaseButtonPanels=[],this.myValueDecreaseButtonBackgrounds=[],this.myValueDecreaseButtonTexts=[],this.myValueDecreaseButtonCursorTargets=[];for(let t=0;t<this._mySetup.myArraySize;t++)this.myValuePanels[t]=WL.scene.addObject(this.myValuesPanel),this.myValueTexts[t]=WL.scene.addObject(this.myValuePanels[t]),this.myValueCursorTargets[t]=WL.scene.addObject(this.myValuePanels[t]),this.myValueIncreaseButtonPanels[t]=WL.scene.addObject(this.myValuePanels[t]),this.myValueIncreaseButtonBackgrounds[t]=WL.scene.addObject(this.myValueIncreaseButtonPanels[t]),this.myValueIncreaseButtonTexts[t]=WL.scene.addObject(this.myValueIncreaseButtonPanels[t]),this.myValueIncreaseButtonCursorTargets[t]=WL.scene.addObject(this.myValueIncreaseButtonPanels[t]),this.myValueDecreaseButtonPanels[t]=WL.scene.addObject(this.myValuePanels[t]),this.myValueDecreaseButtonBackgrounds[t]=WL.scene.addObject(this.myValueDecreaseButtonPanels[t]),this.myValueDecreaseButtonTexts[t]=WL.scene.addObject(this.myValueDecreaseButtonPanels[t]),this.myValueDecreaseButtonCursorTargets[t]=WL.scene.addObject(this.myValueDecreaseButtonPanels[t]);this.myStepPanel=WL.scene.addObject(this.myPivotObject),this.myStepText=WL.scene.addObject(this.myStepPanel),this.myStepCursorTarget=WL.scene.addObject(this.myStepPanel),this.myStepIncreaseButtonPanel=WL.scene.addObject(this.myStepPanel),this.myStepIncreaseButtonBackground=WL.scene.addObject(this.myStepIncreaseButtonPanel),this.myStepIncreaseButtonText=WL.scene.addObject(this.myStepIncreaseButtonPanel),this.myStepIncreaseButtonCursorTarget=WL.scene.addObject(this.myStepIncreaseButtonPanel),this.myStepDecreaseButtonPanel=WL.scene.addObject(this.myStepPanel),this.myStepDecreaseButtonBackground=WL.scene.addObject(this.myStepDecreaseButtonPanel),this.myStepDecreaseButtonText=WL.scene.addObject(this.myStepDecreaseButtonPanel),this.myStepDecreaseButtonCursorTarget=WL.scene.addObject(this.myStepDecreaseButtonPanel)}_setTransformHook(){this.myValuesPanel.setTranslationLocal(this._mySetup.myValuesPanelPosition);for(let t=0;t<this._mySetup.myArraySize;t++)this.myValuePanels[t].setTranslationLocal(this._mySetup.myValuePanelsPositions[t]),this.myValueTexts[t].scale(this._mySetup.myValueTextScale),this.myValueCursorTargets[t].setTranslationLocal(this._mySetup.myValueCursorTargetPosition),this.myValueIncreaseButtonPanels[t].setTranslationLocal(this._mySetup.myRightSideButtonPosition),this.myValueIncreaseButtonBackgrounds[t].scale(this._mySetup.mySideButtonBackgroundScale),this.myValueIncreaseButtonTexts[t].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myValueIncreaseButtonTexts[t].scale(this._mySetup.mySideButtonTextScale),this.myValueIncreaseButtonCursorTargets[t].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myValueDecreaseButtonPanels[t].setTranslationLocal(this._mySetup.myLeftSideButtonPosition),this.myValueDecreaseButtonBackgrounds[t].scale(this._mySetup.mySideButtonBackgroundScale),this.myValueDecreaseButtonTexts[t].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myValueDecreaseButtonTexts[t].scale(this._mySetup.mySideButtonTextScale),this.myValueDecreaseButtonCursorTargets[t].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition);this.myStepPanel.setTranslationLocal(this._mySetup.myStepPanelPosition),this.myStepText.scale(this._mySetup.myStepTextScale),this.myStepCursorTarget.setTranslationLocal(this._mySetup.myStepCursorTargetPosition),this.myStepIncreaseButtonPanel.setTranslationLocal(this._mySetup.myRightSideButtonPosition),this.myStepIncreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myStepIncreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myStepIncreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myStepIncreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myStepDecreaseButtonPanel.setTranslationLocal(this._mySetup.myLeftSideButtonPosition),this.myStepDecreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myStepDecreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myStepDecreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myStepDecreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myValueTextComponents=[],this.myValueCursorTargetComponents=[],this.myValueCollisionComponents=[],this.myValueIncreaseButtonBackgroundComponents=[],this.myValueIncreaseButtonTextComponents=[],this.myValueIncreaseButtonCursorTargetComponents=[],this.myValueIncreaseButtonCollisionComponents=[],this.myValueDecreaseButtonBackgroundComponents=[],this.myValueDecreaseButtonTextComponents=[],this.myValueDecreaseButtonCursorTargetComponents=[],this.myValueDecreaseButtonCollisionComponents=[];for(let t=0;t<this._mySetup.myArraySize;t++)this.myValueTextComponents[t]=this.myValueTexts[t].addComponent("text"),this._setupTextComponent(this.myValueTextComponents[t]),this.myValueTextComponents[t].text=" ",this.myValueCursorTargetComponents[t]=this.myValueCursorTargets[t].addComponent("cursor-target"),this.myValueCollisionComponents[t]=this.myValueCursorTargets[t].addComponent("collision"),this.myValueCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueCollisionComponents[t].extents=this._mySetup.myValueCollisionExtents,this.myValueIncreaseButtonBackgroundComponents[t]=this.myValueIncreaseButtonBackgrounds[t].addComponent("mesh"),this.myValueIncreaseButtonBackgroundComponents[t].mesh=this._myPlaneMesh,this.myValueIncreaseButtonBackgroundComponents[t].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myValueIncreaseButtonBackgroundComponents[t].material.color=this._mySetup.myBackgroundColor,this.myValueIncreaseButtonTextComponents[t]=this.myValueIncreaseButtonTexts[t].addComponent("text"),this._setupTextComponent(this.myValueIncreaseButtonTextComponents[t]),this.myValueIncreaseButtonTextComponents[t].text=this._mySetup.myIncreaseButtonText,this.myValueIncreaseButtonCursorTargetComponents[t]=this.myValueIncreaseButtonCursorTargets[t].addComponent("cursor-target"),this.myValueIncreaseButtonCollisionComponents[t]=this.myValueIncreaseButtonCursorTargets[t].addComponent("collision"),this.myValueIncreaseButtonCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueIncreaseButtonCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueIncreaseButtonCollisionComponents[t].extents=this._mySetup.mySideButtonCollisionExtents,this.myValueDecreaseButtonBackgroundComponents[t]=this.myValueDecreaseButtonBackgrounds[t].addComponent("mesh"),this.myValueDecreaseButtonBackgroundComponents[t].mesh=this._myPlaneMesh,this.myValueDecreaseButtonBackgroundComponents[t].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myValueDecreaseButtonBackgroundComponents[t].material.color=this._mySetup.myBackgroundColor,this.myValueDecreaseButtonTextComponents[t]=this.myValueDecreaseButtonTexts[t].addComponent("text"),this._setupTextComponent(this.myValueDecreaseButtonTextComponents[t]),this.myValueDecreaseButtonTextComponents[t].text=this._mySetup.myDecreaseButtonText,this.myValueDecreaseButtonCursorTargetComponents[t]=this.myValueDecreaseButtonCursorTargets[t].addComponent("cursor-target"),this.myValueDecreaseButtonCollisionComponents[t]=this.myValueDecreaseButtonCursorTargets[t].addComponent("collision"),this.myValueDecreaseButtonCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueDecreaseButtonCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueDecreaseButtonCollisionComponents[t].extents=this._mySetup.mySideButtonCollisionExtents;this.myStepTextComponent=this.myStepText.addComponent("text"),this._setupTextComponent(this.myStepTextComponent),this.myStepTextComponent.text=" ",this.myStepCursorTargetComponent=this.myStepCursorTarget.addComponent("cursor-target"),this.myStepCollisionComponent=this.myStepCursorTarget.addComponent("collision"),this.myStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myStepIncreaseButtonBackgroundComponent=this.myStepIncreaseButtonBackground.addComponent("mesh"),this.myStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myStepIncreaseButtonTextComponent=this.myStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myStepIncreaseButtonTextComponent),this.myStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myStepIncreaseButtonCursorTargetComponent=this.myStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myStepIncreaseButtonCollisionComponent=this.myStepIncreaseButtonCursorTarget.addComponent("collision"),this.myStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myStepDecreaseButtonBackgroundComponent=this.myStepDecreaseButtonBackground.addComponent("mesh"),this.myStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myStepDecreaseButtonTextComponent=this.myStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myStepDecreaseButtonTextComponent),this.myStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myStepDecreaseButtonCursorTargetComponent=this.myStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myStepDecreaseButtonCollisionComponent=this.myStepDecreaseButtonCursorTarget.addComponent("collision"),this.myStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents}_setVisibleHook(t){t&&this.setAdditionalButtonsActive(this._myAdditionalButtonsActive)}}});var nn=T(()=>{PP.EasyTuneNumberArrayWidgetSetup=class extends PP.EasyTuneBaseWidgetSetup{constructor(t){super(),this.myArraySize=t}_getBackPanelMinY(){return this.myStepPanelPosition[1]-this._mySideButtonDistanceFromBorder*1.25-this.mySideButtonBackgroundScale[1]}_getPivotZOffset(){return .00803713}_initializeBuildSetupHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValuesPanelPosition=[0,this.myVariableLabelPanelPosition[1]-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myValueTextScale=[.4,.4,.4],this.myValueCursorTargetPosition=[0,0,0],this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=[.065,.02,1],this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=[0,0,0];for(let i=1;i<this.myArraySize;i++)this.myValuePanelsPositions[i]=this.myValuePanelsPositions[i-1].slice(0),this.myValuePanelsPositions[i][1]-=this._myDistanceBetweenValues;let t=this.myValuePanelsPositions[this.myArraySize-1]?this.myValuePanelsPositions[this.myArraySize-1][1]:0;this.myStepPanelPosition=[0,this.myDisplayPanelPosition[1]+this.myValuesPanelPosition[1]+t-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myStepTextScale=this.myLabelTextScale,this.myStepStartString="Step: ",this.myStepCursorTargetPosition=[0,0,0],this.myStepCursorTargetPosition[2]=this._myColliderZOffset-this.myStepPanelPosition[2],this.myStepCollisionExtents=[.065,.0175,1],this.myStepCollisionExtents[2]=this.myCursorTargetCollisionThickness}_initializeRuntimeSetupHook(){this.myTextHoverScaleMultiplier=[1.25,1.25,1.25],this.myEditThumbstickMinThreshold=.35,this.myStepMultiplierStepPerSecond=2.25,this.myButtonEditDelay=0}}});var an=T(()=>{PP.EasyTuneNumberArrayWidgetSelector=class{constructor(t,i){this._myGamepad=i,this._myParentObject=null,this._myParams=t,this._myAdditionalSetup=null,this._myWidgets=new Map,this._myVariable=null,this._myIsVisible=!0,this._myAppendToVariableName=null,this._myScrollVariableRequestCallbacks=new Map,this._myCurrentArraySize=0}setEasyTuneVariable(t,i){this._myVariable=t,this._myCurrentArraySize=this._myVariable.myValue.length,this._myAppendToVariableName=i,this._myWidgets.has(this._myCurrentArraySize)||this._createWidget(this._myCurrentArraySize);let s=this._myWidgets.get(this._myCurrentArraySize);s&&s.setEasyTuneVariable(t,i),this.setVisible(this._myIsVisible)}setVisible(t){for(let i of this._myWidgets.values())i.setVisible(!1);if(this._myVariable){this._sizeChangedCheck();let i=this._myWidgets.get(this._myCurrentArraySize);i&&i.setVisible(t)}this._myIsVisible=t}isScrollVariableActive(){let t=this._myWidgets.get(this._myCurrentArraySize);return t?t.isScrollVariableActive():!1}getScrollVariableDirection(){let t=this._myWidgets.get(this._myCurrentArraySize);return t?t.getScrollVariableDirection():0}setScrollVariableActive(t,i){let s=this._myWidgets.get(this._myCurrentArraySize);s&&s.setScrollVariableActive(t,i)}getWidget(){return this._myWidgets.get(this._myCurrentArraySize)}registerScrollVariableRequestEventListener(t,i){this._myScrollVariableRequestCallbacks.set(t,i)}unregisterScrollVariableRequestEventListener(t){this._myScrollVariableRequestCallbacks.delete(t)}start(t,i){this._myParentObject=t,this._myAdditionalSetup=i,this._createWidget(1),this._myVariable&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}update(t){if(this._isActive()){this._sizeChangedCheck();let i=this._myWidgets.get(this._myCurrentArraySize);i&&i.update(t)}}onImportSuccess(){let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.onImportSuccess()}onImportFailure(){let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.onImportFailure()}onExportSuccess(){let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.onExportSuccess()}onExportFailure(){let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.onExportFailure()}_isActive(){return this._myIsVisible&&this._myVariable}_scrollVariableRequest(t){for(let i of this._myScrollVariableRequestCallbacks.values())i(t)}_createWidget(t){this._myWidgets.set(t,new PP.EasyTuneNumberArrayWidget(this._myParams,t,this._myGamepad)),this._myWidgets.get(t).start(this._myParentObject,this._myAdditionalSetup),this._myWidgets.get(t).setVisible(!1),this._myWidgets.get(t).registerScrollVariableRequestEventListener(this,this._scrollVariableRequest.bind(this))}_sizeChangedCheck(){this._myVariable.myValue.length!=this._myCurrentArraySize&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}}});var on=T(()=>{PP.EasyTuneTransformWidget=class extends PP.EasyTuneBaseWidget{constructor(t,i){super(t),this._myGamepad=i,this._mySetup=new PP.EasyTuneTransformWidgetSetup,this._myUI=new PP.EasyTuneTransformWidgetUI,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myStepButtonEditIntensity=0,this._myStepButtonEditIntensityTimer=0,this._myValueEditActive=!1,this._myStepEditActive=!1,this._myValueRealValue=0,this._myComponentStepValue=0,this._myStepMultiplierValue=0,this._myStepFastEdit=!1,this._myValueEditIndex=-1,this._myComponentIndex=0,this._myStepIndex=0}_setEasyTuneVariableHook(){if(this._myValueEditIndex>=0)switch(this._myComponentIndex){case 0:this._myValueRealValue=this._myVariable.myPosition[this._myValueEditIndex],this._myComponentStepValue=this._myVariable.myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable.myRotation[this._myValueEditIndex],this._myComponentStepValue=this._myVariable.myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable.myScale[this._myValueEditIndex],this._myComponentStepValue=this._myVariable.myScaleStepPerSecond;break}}_refreshUIHook(){for(let t=0;t<3;t++)this._myUI.myPositionTextComponents[t].text=this._myVariable.myPosition[t].toFixed(this._myVariable.myDecimalPlaces);this._myUI.myPositionStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myPositionStepPerSecond);for(let t=0;t<3;t++)this._myUI.myRotationTextComponents[t].text=this._myVariable.myRotation[t].toFixed(this._myVariable.myDecimalPlaces);this._myUI.myRotationStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myRotationStepPerSecond);for(let t=0;t<3;t++)this._myUI.myScaleTextComponents[t].text=this._myVariable.myScale[t].toFixed(this._myVariable.myDecimalPlaces);this._myUI.myScaleStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myScaleStepPerSecond)}_startHook(t,i){this._myUI.setAdditionalButtonsActive(i.myEnableAdditionalButtons)}_updateHook(t){this._updateValue(t)}_updateValue(t){let i=0;if(this._myGamepad){let a=this._myGamepad.getAxesInfo().myAxes[1];if(Math.abs(a)>this._mySetup.myEditThumbstickMinThreshold){let r=(Math.abs(a)-this._mySetup.myEditThumbstickMinThreshold)/(1-this._mySetup.myEditThumbstickMinThreshold);i=Math.sign(a)*r}}let s=0;if(this._myValueEditActive?s=i:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?s=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=t),s!=0){let a=s*this._myComponentStepValue*t;this._myValueRealValue+=a;let r=Math.pow(10,this._myVariable.myDecimalPlaces);switch(this._myComponentIndex){case 0:this._myVariable.myPosition[this._myValueEditIndex]=Math.round(this._myValueRealValue*r+Number.EPSILON)/r,this._myUI.myPositionTextComponents[this._myValueEditIndex].text=this._myVariable.myPosition[this._myValueEditIndex].toFixed(this._myVariable.myDecimalPlaces);break;case 1:if(this._myValueRealValue>180){for(;this._myValueRealValue>180;)this._myValueRealValue-=180;this._myValueRealValue=-180+this._myValueRealValue}if(this._myValueRealValue<-180){for(;this._myValueRealValue<-180;)this._myValueRealValue+=180;this._myValueRealValue=180-this._myValueRealValue}this._myVariable.myRotation[this._myValueEditIndex]=Math.round(this._myValueRealValue*r+Number.EPSILON)/r,this._myUI.myRotationTextComponents[this._myValueEditIndex].text=this._myVariable.myRotation[this._myValueEditIndex].toFixed(this._myVariable.myDecimalPlaces);break;case 2:if(this._myValueRealValue<=0&&(this._myValueRealValue=1/r),this._myVariable.myScaleAsOne){let y=Math.round(this._myValueRealValue*r+Number.EPSILON)/r-this._myVariable.myScale[this._myValueEditIndex];for(let c=0;c<3;c++)this._myVariable.myScale[c]=Math.round((this._myVariable.myScale[c]+y)*r+Number.EPSILON)/r,this._myVariable.myScale[c]=Math.max(this._myVariable.myScale[c],1/r),this._myUI.myScaleTextComponents[c].text=this._myVariable.myScale[c].toFixed(this._myVariable.myDecimalPlaces)}else this._myVariable.myScale[this._myValueEditIndex]=Math.round(this._myValueRealValue*r+Number.EPSILON)/r,this._myVariable.myScale[this._myValueEditIndex]=Math.max(this._myVariable.myScale[this._myValueEditIndex],1/r),this._myUI.myScaleTextComponents[this._myValueEditIndex].text=this._myVariable.myScale[this._myValueEditIndex].toFixed(this._myVariable.myDecimalPlaces);break}}else switch(this._myComponentIndex){case 0:this._myValueRealValue=this._myVariable.myPosition[this._myValueEditIndex];break;case 1:this._myValueRealValue=this._myVariable.myRotation[this._myValueEditIndex];break;case 2:this._myValueRealValue=this._myVariable.myScale[this._myValueEditIndex];break}let n=0;if(this._myStepEditActive?n=i:this._myStepButtonEditIntensity!=0&&(this._myStepButtonEditIntensityTimer<=0?n=this._myStepButtonEditIntensity:this._myStepButtonEditIntensityTimer-=t),n!=0){let a=0;if(this._myStepFastEdit?(a=Math.sign(n)*1,this._myStepFastEdit=!1):a=n*this._mySetup.myStepMultiplierStepPerSecond*t,this._myStepMultiplierValue+=a,Math.abs(this._myStepMultiplierValue)>=1){let r=0;switch(this._myStepIndex){case 0:r=this._myVariable.myPositionStepPerSecond;break;case 1:r=this._myVariable.myRotationStepPerSecond;break;case 2:r=this._myVariable.myScaleStepPerSecond;break;default:r=0}Math.sign(this._myStepMultiplierValue)>0?(this._myStepMultiplierValue-=1,this._changeStep(this._myStepIndex,r*10)):(this._myStepMultiplierValue+=1,this._changeStep(this._myStepIndex,r*.1))}}else this._myStepMultiplierValue=0,this._myStepFastEdit=!0}_addListenersHook(){let t=this._myUI;t.myVariableLabelCursorTargetComponent.addClickFunction(this._resetAllValues.bind(this)),t.myVariableLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,t.myVariableLabelText)),t.myVariableLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,t.myVariableLabelText,this._mySetup.myVariableLabelTextScale)),t.myPositionLabelCursorTargetComponent.addClickFunction(this._resetComponentValues.bind(this,0)),t.myPositionLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,t.myPositionLabelText)),t.myPositionLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,t.myPositionLabelText,this._mySetup.myComponentLabelTextScale));for(let i=0;i<3;i++)t.myPositionIncreaseButtonCursorTargetComponents[i].addDownFunction(this._setValueEditIntensity.bind(this,0,i,1)),t.myPositionIncreaseButtonCursorTargetComponents[i].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,0,i,1)),t.myPositionIncreaseButtonCursorTargetComponents[i].addUpFunction(this._setValueEditIntensity.bind(this,0,i,0)),t.myPositionIncreaseButtonCursorTargetComponents[i].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,0,i,0)),t.myPositionIncreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._setValueEditIntensity.bind(this,0,i,0)),t.myPositionDecreaseButtonCursorTargetComponents[i].addDownFunction(this._setValueEditIntensity.bind(this,0,i,-1)),t.myPositionDecreaseButtonCursorTargetComponents[i].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,0,i,-1)),t.myPositionDecreaseButtonCursorTargetComponents[i].addUpFunction(this._setValueEditIntensity.bind(this,0,i,0)),t.myPositionDecreaseButtonCursorTargetComponents[i].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,0,i,0)),t.myPositionDecreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._setValueEditIntensity.bind(this,0,i,0)),t.myPositionIncreaseButtonCursorTargetComponents[i].addHoverFunction(this._genericHover.bind(this,t.myPositionIncreaseButtonBackgroundComponents[i].material)),t.myPositionIncreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._genericUnHover.bind(this,t.myPositionIncreaseButtonBackgroundComponents[i].material)),t.myPositionDecreaseButtonCursorTargetComponents[i].addHoverFunction(this._genericHover.bind(this,t.myPositionDecreaseButtonBackgroundComponents[i].material)),t.myPositionDecreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._genericUnHover.bind(this,t.myPositionDecreaseButtonBackgroundComponents[i].material)),t.myPositionCursorTargetComponents[i].addClickFunction(this._resetValue.bind(this,0,i)),t.myPositionCursorTargetComponents[i].addHoverFunction(this._setValueEditActive.bind(this,0,i,t.myPositionTexts[i],!0)),t.myPositionCursorTargetComponents[i].addUnHoverFunction(this._setValueEditActive.bind(this,0,i,t.myPositionTexts[i],!1));t.myRotationLabelCursorTargetComponent.addClickFunction(this._resetComponentValues.bind(this,1)),t.myRotationLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,t.myRotationLabelText)),t.myRotationLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,t.myRotationLabelText,this._mySetup.myComponentLabelTextScale));for(let i=0;i<3;i++)t.myRotationIncreaseButtonCursorTargetComponents[i].addDownFunction(this._setValueEditIntensity.bind(this,1,i,1)),t.myRotationIncreaseButtonCursorTargetComponents[i].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,1,i,1)),t.myRotationIncreaseButtonCursorTargetComponents[i].addUpFunction(this._setValueEditIntensity.bind(this,1,i,0)),t.myRotationIncreaseButtonCursorTargetComponents[i].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,1,i,0)),t.myRotationIncreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._setValueEditIntensity.bind(this,1,i,0)),t.myRotationDecreaseButtonCursorTargetComponents[i].addDownFunction(this._setValueEditIntensity.bind(this,1,i,-1)),t.myRotationDecreaseButtonCursorTargetComponents[i].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,1,i,-1)),t.myRotationDecreaseButtonCursorTargetComponents[i].addUpFunction(this._setValueEditIntensity.bind(this,1,i,0)),t.myRotationDecreaseButtonCursorTargetComponents[i].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,1,i,0)),t.myRotationDecreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._setValueEditIntensity.bind(this,1,i,0)),t.myRotationIncreaseButtonCursorTargetComponents[i].addHoverFunction(this._genericHover.bind(this,t.myRotationIncreaseButtonBackgroundComponents[i].material)),t.myRotationIncreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._genericUnHover.bind(this,t.myRotationIncreaseButtonBackgroundComponents[i].material)),t.myRotationDecreaseButtonCursorTargetComponents[i].addHoverFunction(this._genericHover.bind(this,t.myRotationDecreaseButtonBackgroundComponents[i].material)),t.myRotationDecreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._genericUnHover.bind(this,t.myRotationDecreaseButtonBackgroundComponents[i].material)),t.myRotationCursorTargetComponents[i].addClickFunction(this._resetValue.bind(this,1,i)),t.myRotationCursorTargetComponents[i].addHoverFunction(this._setValueEditActive.bind(this,1,i,t.myRotationTexts[i],!0)),t.myRotationCursorTargetComponents[i].addUnHoverFunction(this._setValueEditActive.bind(this,1,i,t.myRotationTexts[i],!1));t.myScaleLabelCursorTargetComponent.addClickFunction(this._resetComponentValues.bind(this,2)),t.myScaleLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,t.myScaleLabelText)),t.myScaleLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,t.myScaleLabelText,this._mySetup.myComponentLabelTextScale));for(let i=0;i<3;i++)t.myScaleIncreaseButtonCursorTargetComponents[i].addDownFunction(this._setValueEditIntensity.bind(this,2,i,1)),t.myScaleIncreaseButtonCursorTargetComponents[i].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,2,i,1)),t.myScaleIncreaseButtonCursorTargetComponents[i].addUpFunction(this._setValueEditIntensity.bind(this,2,i,0)),t.myScaleIncreaseButtonCursorTargetComponents[i].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,2,i,0)),t.myScaleIncreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._setValueEditIntensity.bind(this,2,i,0)),t.myScaleDecreaseButtonCursorTargetComponents[i].addDownFunction(this._setValueEditIntensity.bind(this,2,i,-1)),t.myScaleDecreaseButtonCursorTargetComponents[i].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,2,i,-1)),t.myScaleDecreaseButtonCursorTargetComponents[i].addUpFunction(this._setValueEditIntensity.bind(this,2,i,0)),t.myScaleDecreaseButtonCursorTargetComponents[i].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,2,i,0)),t.myScaleDecreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._setValueEditIntensity.bind(this,2,i,0)),t.myScaleIncreaseButtonCursorTargetComponents[i].addHoverFunction(this._genericHover.bind(this,t.myScaleIncreaseButtonBackgroundComponents[i].material)),t.myScaleIncreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._genericUnHover.bind(this,t.myScaleIncreaseButtonBackgroundComponents[i].material)),t.myScaleDecreaseButtonCursorTargetComponents[i].addHoverFunction(this._genericHover.bind(this,t.myScaleDecreaseButtonBackgroundComponents[i].material)),t.myScaleDecreaseButtonCursorTargetComponents[i].addUnHoverFunction(this._genericUnHover.bind(this,t.myScaleDecreaseButtonBackgroundComponents[i].material)),t.myScaleCursorTargetComponents[i].addClickFunction(this._resetValue.bind(this,2,i)),t.myScaleCursorTargetComponents[i].addHoverFunction(this._setValueEditActive.bind(this,2,i,t.myScaleTexts[i],!0)),t.myScaleCursorTargetComponents[i].addUnHoverFunction(this._setValueEditActive.bind(this,2,i,t.myScaleTexts[i],!1));t.myPositionStepCursorTargetComponent.addClickFunction(this._resetStep.bind(this,0)),t.myPositionStepCursorTargetComponent.addHoverFunction(this._setStepEditActive.bind(this,0,t.myPositionStepText,!0)),t.myPositionStepCursorTargetComponent.addUnHoverFunction(this._setStepEditActive.bind(this,0,t.myPositionStepText,!1)),t.myPositionStepIncreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,0,1)),t.myPositionStepIncreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,0,1)),t.myPositionStepIncreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,0,0)),t.myPositionStepIncreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,0,0)),t.myPositionStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,0,0)),t.myPositionStepDecreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,0,-1)),t.myPositionStepDecreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,0,-1)),t.myPositionStepDecreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,0,0)),t.myPositionStepDecreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,0,0)),t.myPositionStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,0,0)),t.myPositionStepIncreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myPositionStepIncreaseButtonBackgroundComponent.material)),t.myPositionStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myPositionStepIncreaseButtonBackgroundComponent.material)),t.myPositionStepDecreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myPositionStepDecreaseButtonBackgroundComponent.material)),t.myPositionStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myPositionStepDecreaseButtonBackgroundComponent.material)),t.myRotationStepCursorTargetComponent.addClickFunction(this._resetStep.bind(this,1)),t.myRotationStepCursorTargetComponent.addHoverFunction(this._setStepEditActive.bind(this,1,t.myRotationStepText,!0)),t.myRotationStepCursorTargetComponent.addUnHoverFunction(this._setStepEditActive.bind(this,1,t.myRotationStepText,!1)),t.myRotationStepIncreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,1,1)),t.myRotationStepIncreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,1,1)),t.myRotationStepIncreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,1,0)),t.myRotationStepIncreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,1,0)),t.myRotationStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,1,0)),t.myRotationStepDecreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,1,-1)),t.myRotationStepDecreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,1,-1)),t.myRotationStepDecreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,1,0)),t.myRotationStepDecreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,1,0)),t.myRotationStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,1,0)),t.myRotationStepIncreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myRotationStepIncreaseButtonBackgroundComponent.material)),t.myRotationStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myRotationStepIncreaseButtonBackgroundComponent.material)),t.myRotationStepDecreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myRotationStepDecreaseButtonBackgroundComponent.material)),t.myRotationStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myRotationStepDecreaseButtonBackgroundComponent.material)),t.myScaleStepCursorTargetComponent.addClickFunction(this._resetStep.bind(this,2)),t.myScaleStepCursorTargetComponent.addHoverFunction(this._setStepEditActive.bind(this,2,t.myScaleStepText,!0)),t.myScaleStepCursorTargetComponent.addUnHoverFunction(this._setStepEditActive.bind(this,2,t.myScaleStepText,!1)),t.myScaleStepIncreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,2,1)),t.myScaleStepIncreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,2,1)),t.myScaleStepIncreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,2,0)),t.myScaleStepIncreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,2,0)),t.myScaleStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,2,0)),t.myScaleStepDecreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,2,-1)),t.myScaleStepDecreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,2,-1)),t.myScaleStepDecreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,2,0)),t.myScaleStepDecreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,2,0)),t.myScaleStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,2,0)),t.myScaleStepIncreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myScaleStepIncreaseButtonBackgroundComponent.material)),t.myScaleStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myScaleStepIncreaseButtonBackgroundComponent.material)),t.myScaleStepDecreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myScaleStepDecreaseButtonBackgroundComponent.material)),t.myScaleStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,t.myScaleStepDecreaseButtonBackgroundComponent.material))}_setValueEditIntensity(t,i,s){if(this._isActive()||s==0){if(s!=0){switch(t){case 0:this._myValueRealValue=this._myVariable.myPosition[i],this._myComponentStepValue=this._myVariable.myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable.myRotation[i],this._myComponentStepValue=this._myVariable.myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable.myScale[i],this._myComponentStepValue=this._myVariable.myScaleStepPerSecond;break}this._myValueButtonEditIntensityTimer=this._mySetup.myButtonEditDelay,this._myValueEditIndex=i,this._myComponentIndex=t}this._myValueButtonEditIntensity=s}}_setStepEditIntensity(t,i){(this._isActive()||i==0)&&(i!=0&&(this._myStepButtonEditIntensityTimer=this._mySetup.myButtonEditDelay),this._myStepButtonEditIntensity=i,this._myStepIndex=t)}_setValueEditActive(t,i,s,n){if(this._isActive()||!n){if(n){switch(t){case 0:this._myValueRealValue=this._myVariable.myPosition[i],this._myComponentStepValue=this._myVariable.myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable.myRotation[i],this._myComponentStepValue=this._myVariable.myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable.myScale[i],this._myComponentStepValue=this._myVariable.myScaleStepPerSecond;break}this._myValueEditIndex=i,this._myComponentIndex=t,s.scale(this._mySetup.myTextHoverScaleMultiplier)}else s.scalingWorld=this._mySetup.myValueTextScale;this._myValueEditActive=n}}_setStepEditActive(t,i,s){(this._isActive()||!s)&&(s?i.scale(this._mySetup.myTextHoverScaleMultiplier):i.scalingWorld=this._mySetup.myStepTextScale,this._myStepEditActive=s,this._myStepIndex=t)}_resetValue(t,i){if(this._isActive())switch(t){case 0:this._myVariable.myPosition[i]=this._myVariable.myDefaultPosition[i],this._myUI.myPositionTextComponents[i].text=this._myVariable.myPosition[i].toFixed(this._myVariable.myDecimalPlaces);break;case 1:this._myVariable.myRotation[i]=this._myVariable.myDefaultRotation[i],this._myUI.myRotationTextComponents[i].text=this._myVariable.myRotation[i].toFixed(this._myVariable.myDecimalPlaces);break;case 2:this._myVariable.myScale[i]=this._myVariable.myDefaultScale[i],this._myUI.myScaleTextComponents[i].text=this._myVariable.myScale[i].toFixed(this._myVariable.myDecimalPlaces);break;default:defaultValue=0}}_resetAllValues(){for(let t=0;t<3;t++)this._resetComponentValues(t)}_resetComponentValues(t){for(let i=0;i<3;i++)this._resetValue(t,i)}_resetStep(t){if(this._isActive()){let i=0;switch(t){case 0:i=this._myVariable.myDefaultPositionStepPerSecond;break;case 1:i=this._myVariable.myDefaultRotationStepPerSecond;break;case 2:i=this._myVariable.myDefaultScaleStepPerSecond;break;default:i=0}this._changeStep(t,i)}}_changeStep(t,i){switch(i=Math.pp_roundDecimal(i,10),t){case 0:this._myVariable.myPositionStepPerSecond=i,this._myUI.myPositionStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myPositionStepPerSecond);break;case 1:this._myVariable.myRotationStepPerSecond=i,this._myUI.myRotationStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myRotationStepPerSecond);break;case 2:this._myVariable.myScaleStepPerSecond=i,this._myUI.myScaleStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myScaleStepPerSecond);break}}_genericTextHover(t){t.scale(this._mySetup.myTextHoverScaleMultiplier)}_genericTextUnHover(t,i){t.scalingWorld=i}}});var rn=T(()=>{PP.EasyTuneTransformWidgetUI=class extends PP.EasyTuneBaseWidgetUI{setAdditionalButtonsActive(t){this._myAdditionalButtonsActive=t;for(let i=0;i<3;i++)this.myPositionIncreaseButtonPanels[i].pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myPositionDecreaseButtonPanels[i].pp_setActiveHierarchy(this._myAdditionalButtonsActive);this.myPositionStepIncreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myPositionStepDecreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive);for(let i=0;i<3;i++)this.myRotationIncreaseButtonPanels[i].pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myRotationDecreaseButtonPanels[i].pp_setActiveHierarchy(this._myAdditionalButtonsActive);this.myRotationStepIncreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myRotationStepDecreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive);for(let i=0;i<3;i++)this.myScaleIncreaseButtonPanels[i].pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myScaleDecreaseButtonPanels[i].pp_setActiveHierarchy(this._myAdditionalButtonsActive);this.myScaleStepIncreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myScaleStepDecreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive)}_buildHook(){this._myAdditionalButtonsActive=!0}_createSkeletonHook(){this.myPositionPanel=WL.scene.addObject(this.myDisplayPanel),this.myPositionLabelText=WL.scene.addObject(this.myPositionPanel),this.myPositionLabelCursorTarget=WL.scene.addObject(this.myPositionPanel),this.myPositionPanels=[],this.myPositionTexts=[],this.myPositionCursorTargets=[],this.myPositionIncreaseButtonPanels=[],this.myPositionIncreaseButtonBackgrounds=[],this.myPositionIncreaseButtonTexts=[],this.myPositionIncreaseButtonCursorTargets=[],this.myPositionDecreaseButtonPanels=[],this.myPositionDecreaseButtonBackgrounds=[],this.myPositionDecreaseButtonTexts=[],this.myPositionDecreaseButtonCursorTargets=[];for(let t=0;t<3;t++)this.myPositionPanels[t]=WL.scene.addObject(this.myPositionPanel),this.myPositionTexts[t]=WL.scene.addObject(this.myPositionPanels[t]),this.myPositionCursorTargets[t]=WL.scene.addObject(this.myPositionPanels[t]),this.myPositionIncreaseButtonPanels[t]=WL.scene.addObject(this.myPositionPanels[t]),this.myPositionIncreaseButtonBackgrounds[t]=WL.scene.addObject(this.myPositionIncreaseButtonPanels[t]),this.myPositionIncreaseButtonTexts[t]=WL.scene.addObject(this.myPositionIncreaseButtonPanels[t]),this.myPositionIncreaseButtonCursorTargets[t]=WL.scene.addObject(this.myPositionIncreaseButtonPanels[t]),this.myPositionDecreaseButtonPanels[t]=WL.scene.addObject(this.myPositionPanels[t]),this.myPositionDecreaseButtonBackgrounds[t]=WL.scene.addObject(this.myPositionDecreaseButtonPanels[t]),this.myPositionDecreaseButtonTexts[t]=WL.scene.addObject(this.myPositionDecreaseButtonPanels[t]),this.myPositionDecreaseButtonCursorTargets[t]=WL.scene.addObject(this.myPositionDecreaseButtonPanels[t]);this.myRotationPanel=WL.scene.addObject(this.myDisplayPanel),this.myRotationLabelText=WL.scene.addObject(this.myRotationPanel),this.myRotationLabelCursorTarget=WL.scene.addObject(this.myRotationPanel),this.myRotationPanels=[],this.myRotationTexts=[],this.myRotationCursorTargets=[],this.myRotationIncreaseButtonPanels=[],this.myRotationIncreaseButtonBackgrounds=[],this.myRotationIncreaseButtonTexts=[],this.myRotationIncreaseButtonCursorTargets=[],this.myRotationDecreaseButtonPanels=[],this.myRotationDecreaseButtonBackgrounds=[],this.myRotationDecreaseButtonTexts=[],this.myRotationDecreaseButtonCursorTargets=[];for(let t=0;t<3;t++)this.myRotationPanels[t]=WL.scene.addObject(this.myRotationPanel),this.myRotationTexts[t]=WL.scene.addObject(this.myRotationPanels[t]),this.myRotationCursorTargets[t]=WL.scene.addObject(this.myRotationPanels[t]),this.myRotationIncreaseButtonPanels[t]=WL.scene.addObject(this.myRotationPanels[t]),this.myRotationIncreaseButtonBackgrounds[t]=WL.scene.addObject(this.myRotationIncreaseButtonPanels[t]),this.myRotationIncreaseButtonTexts[t]=WL.scene.addObject(this.myRotationIncreaseButtonPanels[t]),this.myRotationIncreaseButtonCursorTargets[t]=WL.scene.addObject(this.myRotationIncreaseButtonPanels[t]),this.myRotationDecreaseButtonPanels[t]=WL.scene.addObject(this.myRotationPanels[t]),this.myRotationDecreaseButtonBackgrounds[t]=WL.scene.addObject(this.myRotationDecreaseButtonPanels[t]),this.myRotationDecreaseButtonTexts[t]=WL.scene.addObject(this.myRotationDecreaseButtonPanels[t]),this.myRotationDecreaseButtonCursorTargets[t]=WL.scene.addObject(this.myRotationDecreaseButtonPanels[t]);this.myScalePanel=WL.scene.addObject(this.myDisplayPanel),this.myScaleLabelText=WL.scene.addObject(this.myScalePanel),this.myScaleLabelCursorTarget=WL.scene.addObject(this.myScalePanel),this.myScalePanels=[],this.myScaleTexts=[],this.myScaleCursorTargets=[],this.myScaleIncreaseButtonPanels=[],this.myScaleIncreaseButtonBackgrounds=[],this.myScaleIncreaseButtonTexts=[],this.myScaleIncreaseButtonCursorTargets=[],this.myScaleDecreaseButtonPanels=[],this.myScaleDecreaseButtonBackgrounds=[],this.myScaleDecreaseButtonTexts=[],this.myScaleDecreaseButtonCursorTargets=[];for(let t=0;t<3;t++)this.myScalePanels[t]=WL.scene.addObject(this.myScalePanel),this.myScaleTexts[t]=WL.scene.addObject(this.myScalePanels[t]),this.myScaleCursorTargets[t]=WL.scene.addObject(this.myScalePanels[t]),this.myScaleIncreaseButtonPanels[t]=WL.scene.addObject(this.myScalePanels[t]),this.myScaleIncreaseButtonBackgrounds[t]=WL.scene.addObject(this.myScaleIncreaseButtonPanels[t]),this.myScaleIncreaseButtonTexts[t]=WL.scene.addObject(this.myScaleIncreaseButtonPanels[t]),this.myScaleIncreaseButtonCursorTargets[t]=WL.scene.addObject(this.myScaleIncreaseButtonPanels[t]),this.myScaleDecreaseButtonPanels[t]=WL.scene.addObject(this.myScalePanels[t]),this.myScaleDecreaseButtonBackgrounds[t]=WL.scene.addObject(this.myScaleDecreaseButtonPanels[t]),this.myScaleDecreaseButtonTexts[t]=WL.scene.addObject(this.myScaleDecreaseButtonPanels[t]),this.myScaleDecreaseButtonCursorTargets[t]=WL.scene.addObject(this.myScaleDecreaseButtonPanels[t]);this.myPositionStepPanel=WL.scene.addObject(this.myPositionPanel),this.myPositionStepText=WL.scene.addObject(this.myPositionStepPanel),this.myPositionStepCursorTarget=WL.scene.addObject(this.myPositionStepPanel),this.myPositionStepIncreaseButtonPanel=WL.scene.addObject(this.myPositionStepPanel),this.myPositionStepIncreaseButtonBackground=WL.scene.addObject(this.myPositionStepIncreaseButtonPanel),this.myPositionStepIncreaseButtonText=WL.scene.addObject(this.myPositionStepIncreaseButtonPanel),this.myPositionStepIncreaseButtonCursorTarget=WL.scene.addObject(this.myPositionStepIncreaseButtonPanel),this.myPositionStepDecreaseButtonPanel=WL.scene.addObject(this.myPositionStepPanel),this.myPositionStepDecreaseButtonBackground=WL.scene.addObject(this.myPositionStepDecreaseButtonPanel),this.myPositionStepDecreaseButtonText=WL.scene.addObject(this.myPositionStepDecreaseButtonPanel),this.myPositionStepDecreaseButtonCursorTarget=WL.scene.addObject(this.myPositionStepDecreaseButtonPanel),this.myRotationStepPanel=WL.scene.addObject(this.myRotationPanel),this.myRotationStepText=WL.scene.addObject(this.myRotationStepPanel),this.myRotationStepCursorTarget=WL.scene.addObject(this.myRotationStepPanel),this.myRotationStepIncreaseButtonPanel=WL.scene.addObject(this.myRotationStepPanel),this.myRotationStepIncreaseButtonBackground=WL.scene.addObject(this.myRotationStepIncreaseButtonPanel),this.myRotationStepIncreaseButtonText=WL.scene.addObject(this.myRotationStepIncreaseButtonPanel),this.myRotationStepIncreaseButtonCursorTarget=WL.scene.addObject(this.myRotationStepIncreaseButtonPanel),this.myRotationStepDecreaseButtonPanel=WL.scene.addObject(this.myRotationStepPanel),this.myRotationStepDecreaseButtonBackground=WL.scene.addObject(this.myRotationStepDecreaseButtonPanel),this.myRotationStepDecreaseButtonText=WL.scene.addObject(this.myRotationStepDecreaseButtonPanel),this.myRotationStepDecreaseButtonCursorTarget=WL.scene.addObject(this.myRotationStepDecreaseButtonPanel),this.myScaleStepPanel=WL.scene.addObject(this.myScalePanel),this.myScaleStepText=WL.scene.addObject(this.myScaleStepPanel),this.myScaleStepCursorTarget=WL.scene.addObject(this.myScaleStepPanel),this.myScaleStepIncreaseButtonPanel=WL.scene.addObject(this.myScaleStepPanel),this.myScaleStepIncreaseButtonBackground=WL.scene.addObject(this.myScaleStepIncreaseButtonPanel),this.myScaleStepIncreaseButtonText=WL.scene.addObject(this.myScaleStepIncreaseButtonPanel),this.myScaleStepIncreaseButtonCursorTarget=WL.scene.addObject(this.myScaleStepIncreaseButtonPanel),this.myScaleStepDecreaseButtonPanel=WL.scene.addObject(this.myScaleStepPanel),this.myScaleStepDecreaseButtonBackground=WL.scene.addObject(this.myScaleStepDecreaseButtonPanel),this.myScaleStepDecreaseButtonText=WL.scene.addObject(this.myScaleStepDecreaseButtonPanel),this.myScaleStepDecreaseButtonCursorTarget=WL.scene.addObject(this.myScaleStepDecreaseButtonPanel)}_setTransformHook(){this.myPositionPanel.setTranslationLocal(this._mySetup.myPositionPanelPosition),this.myPositionLabelText.scale(this._mySetup.myComponentLabelTextScale),this.myPositionLabelCursorTarget.setTranslationLocal(this._mySetup.myComponentLabelCursorTargetPosition);for(let t=0;t<3;t++)this.myPositionPanels[t].setTranslationLocal(this._mySetup.myValuePanelsPositions[t]),this.myPositionTexts[t].scale(this._mySetup.myValueTextScale),this.myPositionCursorTargets[t].setTranslationLocal(this._mySetup.myValueCursorTargetPosition),this.myPositionIncreaseButtonPanels[t].setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myPositionIncreaseButtonBackgrounds[t].scale(this._mySetup.mySideButtonBackgroundScale),this.myPositionIncreaseButtonTexts[t].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myPositionIncreaseButtonTexts[t].scale(this._mySetup.mySideButtonTextScale),this.myPositionIncreaseButtonCursorTargets[t].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myPositionDecreaseButtonPanels[t].setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myPositionDecreaseButtonBackgrounds[t].scale(this._mySetup.mySideButtonBackgroundScale),this.myPositionDecreaseButtonTexts[t].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myPositionDecreaseButtonTexts[t].scale(this._mySetup.mySideButtonTextScale),this.myPositionDecreaseButtonCursorTargets[t].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition);this.myRotationPanel.setTranslationLocal(this._mySetup.myRotationPanelPosition),this.myRotationLabelText.scale(this._mySetup.myComponentLabelTextScale),this.myRotationLabelCursorTarget.setTranslationLocal(this._mySetup.myComponentLabelCursorTargetPosition);for(let t=0;t<3;t++)this.myRotationPanels[t].setTranslationLocal(this._mySetup.myValuePanelsPositions[t]),this.myRotationTexts[t].scale(this._mySetup.myValueTextScale),this.myRotationCursorTargets[t].setTranslationLocal(this._mySetup.myValueCursorTargetPosition),this.myRotationIncreaseButtonPanels[t].setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myRotationIncreaseButtonBackgrounds[t].scale(this._mySetup.mySideButtonBackgroundScale),this.myRotationIncreaseButtonTexts[t].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myRotationIncreaseButtonTexts[t].scale(this._mySetup.mySideButtonTextScale),this.myRotationIncreaseButtonCursorTargets[t].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myRotationDecreaseButtonPanels[t].setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myRotationDecreaseButtonBackgrounds[t].scale(this._mySetup.mySideButtonBackgroundScale),this.myRotationDecreaseButtonTexts[t].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myRotationDecreaseButtonTexts[t].scale(this._mySetup.mySideButtonTextScale),this.myRotationDecreaseButtonCursorTargets[t].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition);this.myScalePanel.setTranslationLocal(this._mySetup.myScalePanelPosition),this.myScaleLabelText.scale(this._mySetup.myComponentLabelTextScale),this.myScaleLabelCursorTarget.setTranslationLocal(this._mySetup.myComponentLabelCursorTargetPosition);for(let t=0;t<3;t++)this.myScalePanels[t].setTranslationLocal(this._mySetup.myValuePanelsPositions[t]),this.myScaleTexts[t].scale(this._mySetup.myValueTextScale),this.myScaleCursorTargets[t].setTranslationLocal(this._mySetup.myValueCursorTargetPosition),this.myScaleIncreaseButtonPanels[t].setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myScaleIncreaseButtonBackgrounds[t].scale(this._mySetup.mySideButtonBackgroundScale),this.myScaleIncreaseButtonTexts[t].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myScaleIncreaseButtonTexts[t].scale(this._mySetup.mySideButtonTextScale),this.myScaleIncreaseButtonCursorTargets[t].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myScaleDecreaseButtonPanels[t].setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myScaleDecreaseButtonBackgrounds[t].scale(this._mySetup.mySideButtonBackgroundScale),this.myScaleDecreaseButtonTexts[t].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myScaleDecreaseButtonTexts[t].scale(this._mySetup.mySideButtonTextScale),this.myScaleDecreaseButtonCursorTargets[t].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition);this.myPositionStepPanel.setTranslationLocal(this._mySetup.myStepPanelPosition),this.myPositionStepText.scale(this._mySetup.myStepTextScale),this.myPositionStepCursorTarget.setTranslationLocal(this._mySetup.myStepCursorTargetPosition),this.myPositionStepIncreaseButtonPanel.setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myPositionStepIncreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myPositionStepIncreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myPositionStepIncreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myPositionStepIncreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myPositionStepDecreaseButtonPanel.setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myPositionStepDecreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myPositionStepDecreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myPositionStepDecreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myPositionStepDecreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myRotationStepPanel.setTranslationLocal(this._mySetup.myStepPanelPosition),this.myRotationStepText.scale(this._mySetup.myStepTextScale),this.myRotationStepCursorTarget.setTranslationLocal(this._mySetup.myStepCursorTargetPosition),this.myRotationStepIncreaseButtonPanel.setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myRotationStepIncreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myRotationStepIncreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myRotationStepIncreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myRotationStepIncreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myRotationStepDecreaseButtonPanel.setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myRotationStepDecreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myRotationStepDecreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myRotationStepDecreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myRotationStepDecreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myScaleStepPanel.setTranslationLocal(this._mySetup.myStepPanelPosition),this.myScaleStepText.scale(this._mySetup.myStepTextScale),this.myScaleStepCursorTarget.setTranslationLocal(this._mySetup.myStepCursorTargetPosition),this.myScaleStepIncreaseButtonPanel.setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myScaleStepIncreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myScaleStepIncreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myScaleStepIncreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myScaleStepIncreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myScaleStepDecreaseButtonPanel.setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myScaleStepDecreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myScaleStepDecreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myScaleStepDecreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myScaleStepDecreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myPositionLabelTextComponent=this.myPositionLabelText.addComponent("text"),this._setupTextComponent(this.myPositionLabelTextComponent),this.myPositionLabelTextComponent.text=this._mySetup.myPositionText,this.myPositionLabelCursorTargetComponent=this.myPositionLabelCursorTarget.addComponent("cursor-target"),this.myPositionLabelCollisionComponent=this.myPositionLabelCursorTarget.addComponent("collision"),this.myPositionLabelCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionLabelCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionLabelCollisionComponent.extents=this._mySetup.myComponentLabelCollisionExtents,this.myPositionTextComponents=[],this.myPositionCursorTargetComponents=[],this.myPositionCollisionComponents=[],this.myPositionIncreaseButtonBackgroundComponents=[],this.myPositionIncreaseButtonTextComponents=[],this.myPositionIncreaseButtonCursorTargetComponents=[],this.myPositionIncreaseButtonCollisionComponents=[],this.myPositionDecreaseButtonBackgroundComponents=[],this.myPositionDecreaseButtonTextComponents=[],this.myPositionDecreaseButtonCursorTargetComponents=[],this.myPositionDecreaseButtonCollisionComponents=[];for(let t=0;t<3;t++)this.myPositionTextComponents[t]=this.myPositionTexts[t].addComponent("text"),this._setupTextComponent(this.myPositionTextComponents[t]),this.myPositionTextComponents[t].text=" ",this.myPositionCursorTargetComponents[t]=this.myPositionCursorTargets[t].addComponent("cursor-target"),this.myPositionCollisionComponents[t]=this.myPositionCursorTargets[t].addComponent("collision"),this.myPositionCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionCollisionComponents[t].extents=this._mySetup.myValueCollisionExtents,this.myPositionIncreaseButtonBackgroundComponents[t]=this.myPositionIncreaseButtonBackgrounds[t].addComponent("mesh"),this.myPositionIncreaseButtonBackgroundComponents[t].mesh=this._myPlaneMesh,this.myPositionIncreaseButtonBackgroundComponents[t].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionIncreaseButtonBackgroundComponents[t].material.color=this._mySetup.myBackgroundColor,this.myPositionIncreaseButtonTextComponents[t]=this.myPositionIncreaseButtonTexts[t].addComponent("text"),this._setupTextComponent(this.myPositionIncreaseButtonTextComponents[t]),this.myPositionIncreaseButtonTextComponents[t].text=this._mySetup.myIncreaseButtonText,this.myPositionIncreaseButtonCursorTargetComponents[t]=this.myPositionIncreaseButtonCursorTargets[t].addComponent("cursor-target"),this.myPositionIncreaseButtonCollisionComponents[t]=this.myPositionIncreaseButtonCursorTargets[t].addComponent("collision"),this.myPositionIncreaseButtonCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionIncreaseButtonCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionIncreaseButtonCollisionComponents[t].extents=this._mySetup.mySideButtonCollisionExtents,this.myPositionDecreaseButtonBackgroundComponents[t]=this.myPositionDecreaseButtonBackgrounds[t].addComponent("mesh"),this.myPositionDecreaseButtonBackgroundComponents[t].mesh=this._myPlaneMesh,this.myPositionDecreaseButtonBackgroundComponents[t].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionDecreaseButtonBackgroundComponents[t].material.color=this._mySetup.myBackgroundColor,this.myPositionDecreaseButtonTextComponents[t]=this.myPositionDecreaseButtonTexts[t].addComponent("text"),this._setupTextComponent(this.myPositionDecreaseButtonTextComponents[t]),this.myPositionDecreaseButtonTextComponents[t].text=this._mySetup.myDecreaseButtonText,this.myPositionDecreaseButtonCursorTargetComponents[t]=this.myPositionDecreaseButtonCursorTargets[t].addComponent("cursor-target"),this.myPositionDecreaseButtonCollisionComponents[t]=this.myPositionDecreaseButtonCursorTargets[t].addComponent("collision"),this.myPositionDecreaseButtonCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionDecreaseButtonCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionDecreaseButtonCollisionComponents[t].extents=this._mySetup.mySideButtonCollisionExtents;this.myRotationLabelTextComponent=this.myRotationLabelText.addComponent("text"),this._setupTextComponent(this.myRotationLabelTextComponent),this.myRotationLabelTextComponent.text=this._mySetup.myRotationText,this.myRotationLabelCursorTargetComponent=this.myRotationLabelCursorTarget.addComponent("cursor-target"),this.myRotationLabelCollisionComponent=this.myRotationLabelCursorTarget.addComponent("collision"),this.myRotationLabelCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationLabelCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationLabelCollisionComponent.extents=this._mySetup.myComponentLabelCollisionExtents,this.myRotationTextComponents=[],this.myRotationCursorTargetComponents=[],this.myRotationCollisionComponents=[],this.myRotationIncreaseButtonBackgroundComponents=[],this.myRotationIncreaseButtonTextComponents=[],this.myRotationIncreaseButtonCursorTargetComponents=[],this.myRotationIncreaseButtonCollisionComponents=[],this.myRotationDecreaseButtonBackgroundComponents=[],this.myRotationDecreaseButtonTextComponents=[],this.myRotationDecreaseButtonCursorTargetComponents=[],this.myRotationDecreaseButtonCollisionComponents=[];for(let t=0;t<3;t++)this.myRotationTextComponents[t]=this.myRotationTexts[t].addComponent("text"),this._setupTextComponent(this.myRotationTextComponents[t]),this.myRotationTextComponents[t].text=" ",this.myRotationCursorTargetComponents[t]=this.myRotationCursorTargets[t].addComponent("cursor-target"),this.myRotationCollisionComponents[t]=this.myRotationCursorTargets[t].addComponent("collision"),this.myRotationCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationCollisionComponents[t].extents=this._mySetup.myValueCollisionExtents,this.myRotationIncreaseButtonBackgroundComponents[t]=this.myRotationIncreaseButtonBackgrounds[t].addComponent("mesh"),this.myRotationIncreaseButtonBackgroundComponents[t].mesh=this._myPlaneMesh,this.myRotationIncreaseButtonBackgroundComponents[t].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationIncreaseButtonBackgroundComponents[t].material.color=this._mySetup.myBackgroundColor,this.myRotationIncreaseButtonTextComponents[t]=this.myRotationIncreaseButtonTexts[t].addComponent("text"),this._setupTextComponent(this.myRotationIncreaseButtonTextComponents[t]),this.myRotationIncreaseButtonTextComponents[t].text=this._mySetup.myIncreaseButtonText,this.myRotationIncreaseButtonCursorTargetComponents[t]=this.myRotationIncreaseButtonCursorTargets[t].addComponent("cursor-target"),this.myRotationIncreaseButtonCollisionComponents[t]=this.myRotationIncreaseButtonCursorTargets[t].addComponent("collision"),this.myRotationIncreaseButtonCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationIncreaseButtonCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationIncreaseButtonCollisionComponents[t].extents=this._mySetup.mySideButtonCollisionExtents,this.myRotationDecreaseButtonBackgroundComponents[t]=this.myRotationDecreaseButtonBackgrounds[t].addComponent("mesh"),this.myRotationDecreaseButtonBackgroundComponents[t].mesh=this._myPlaneMesh,this.myRotationDecreaseButtonBackgroundComponents[t].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationDecreaseButtonBackgroundComponents[t].material.color=this._mySetup.myBackgroundColor,this.myRotationDecreaseButtonTextComponents[t]=this.myRotationDecreaseButtonTexts[t].addComponent("text"),this._setupTextComponent(this.myRotationDecreaseButtonTextComponents[t]),this.myRotationDecreaseButtonTextComponents[t].text=this._mySetup.myDecreaseButtonText,this.myRotationDecreaseButtonCursorTargetComponents[t]=this.myRotationDecreaseButtonCursorTargets[t].addComponent("cursor-target"),this.myRotationDecreaseButtonCollisionComponents[t]=this.myRotationDecreaseButtonCursorTargets[t].addComponent("collision"),this.myRotationDecreaseButtonCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationDecreaseButtonCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationDecreaseButtonCollisionComponents[t].extents=this._mySetup.mySideButtonCollisionExtents;this.myScaleLabelTextComponent=this.myScaleLabelText.addComponent("text"),this._setupTextComponent(this.myScaleLabelTextComponent),this.myScaleLabelTextComponent.text=this._mySetup.myScaleText,this.myScaleLabelCursorTargetComponent=this.myScaleLabelCursorTarget.addComponent("cursor-target"),this.myScaleLabelCollisionComponent=this.myScaleLabelCursorTarget.addComponent("collision"),this.myScaleLabelCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleLabelCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleLabelCollisionComponent.extents=this._mySetup.myComponentLabelCollisionExtents,this.myScaleTextComponents=[],this.myScaleCursorTargetComponents=[],this.myScaleCollisionComponents=[],this.myScaleIncreaseButtonBackgroundComponents=[],this.myScaleIncreaseButtonTextComponents=[],this.myScaleIncreaseButtonCursorTargetComponents=[],this.myScaleIncreaseButtonCollisionComponents=[],this.myScaleDecreaseButtonBackgroundComponents=[],this.myScaleDecreaseButtonTextComponents=[],this.myScaleDecreaseButtonCursorTargetComponents=[],this.myScaleDecreaseButtonCollisionComponents=[];for(let t=0;t<3;t++)this.myScaleTextComponents[t]=this.myScaleTexts[t].addComponent("text"),this._setupTextComponent(this.myScaleTextComponents[t]),this.myScaleTextComponents[t].text=" ",this.myScaleCursorTargetComponents[t]=this.myScaleCursorTargets[t].addComponent("cursor-target"),this.myScaleCollisionComponents[t]=this.myScaleCursorTargets[t].addComponent("collision"),this.myScaleCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleCollisionComponents[t].extents=this._mySetup.myValueCollisionExtents,this.myScaleIncreaseButtonBackgroundComponents[t]=this.myScaleIncreaseButtonBackgrounds[t].addComponent("mesh"),this.myScaleIncreaseButtonBackgroundComponents[t].mesh=this._myPlaneMesh,this.myScaleIncreaseButtonBackgroundComponents[t].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleIncreaseButtonBackgroundComponents[t].material.color=this._mySetup.myBackgroundColor,this.myScaleIncreaseButtonTextComponents[t]=this.myScaleIncreaseButtonTexts[t].addComponent("text"),this._setupTextComponent(this.myScaleIncreaseButtonTextComponents[t]),this.myScaleIncreaseButtonTextComponents[t].text=this._mySetup.myIncreaseButtonText,this.myScaleIncreaseButtonCursorTargetComponents[t]=this.myScaleIncreaseButtonCursorTargets[t].addComponent("cursor-target"),this.myScaleIncreaseButtonCollisionComponents[t]=this.myScaleIncreaseButtonCursorTargets[t].addComponent("collision"),this.myScaleIncreaseButtonCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleIncreaseButtonCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleIncreaseButtonCollisionComponents[t].extents=this._mySetup.mySideButtonCollisionExtents,this.myScaleDecreaseButtonBackgroundComponents[t]=this.myScaleDecreaseButtonBackgrounds[t].addComponent("mesh"),this.myScaleDecreaseButtonBackgroundComponents[t].mesh=this._myPlaneMesh,this.myScaleDecreaseButtonBackgroundComponents[t].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleDecreaseButtonBackgroundComponents[t].material.color=this._mySetup.myBackgroundColor,this.myScaleDecreaseButtonTextComponents[t]=this.myScaleDecreaseButtonTexts[t].addComponent("text"),this._setupTextComponent(this.myScaleDecreaseButtonTextComponents[t]),this.myScaleDecreaseButtonTextComponents[t].text=this._mySetup.myDecreaseButtonText,this.myScaleDecreaseButtonCursorTargetComponents[t]=this.myScaleDecreaseButtonCursorTargets[t].addComponent("cursor-target"),this.myScaleDecreaseButtonCollisionComponents[t]=this.myScaleDecreaseButtonCursorTargets[t].addComponent("collision"),this.myScaleDecreaseButtonCollisionComponents[t].collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleDecreaseButtonCollisionComponents[t].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleDecreaseButtonCollisionComponents[t].extents=this._mySetup.mySideButtonCollisionExtents;this.myPositionStepTextComponent=this.myPositionStepText.addComponent("text"),this._setupTextComponent(this.myPositionStepTextComponent),this.myPositionStepTextComponent.text=" ",this.myPositionStepCursorTargetComponent=this.myPositionStepCursorTarget.addComponent("cursor-target"),this.myPositionStepCollisionComponent=this.myPositionStepCursorTarget.addComponent("collision"),this.myPositionStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myPositionStepIncreaseButtonBackgroundComponent=this.myPositionStepIncreaseButtonBackground.addComponent("mesh"),this.myPositionStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myPositionStepIncreaseButtonTextComponent=this.myPositionStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myPositionStepIncreaseButtonTextComponent),this.myPositionStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myPositionStepIncreaseButtonCursorTargetComponent=this.myPositionStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myPositionStepIncreaseButtonCollisionComponent=this.myPositionStepIncreaseButtonCursorTarget.addComponent("collision"),this.myPositionStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myPositionStepDecreaseButtonBackgroundComponent=this.myPositionStepDecreaseButtonBackground.addComponent("mesh"),this.myPositionStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myPositionStepDecreaseButtonTextComponent=this.myPositionStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myPositionStepDecreaseButtonTextComponent),this.myPositionStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myPositionStepDecreaseButtonCursorTargetComponent=this.myPositionStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myPositionStepDecreaseButtonCollisionComponent=this.myPositionStepDecreaseButtonCursorTarget.addComponent("collision"),this.myPositionStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myRotationStepTextComponent=this.myRotationStepText.addComponent("text"),this._setupTextComponent(this.myRotationStepTextComponent),this.myRotationStepTextComponent.text=" ",this.myRotationStepCursorTargetComponent=this.myRotationStepCursorTarget.addComponent("cursor-target"),this.myRotationStepCollisionComponent=this.myRotationStepCursorTarget.addComponent("collision"),this.myRotationStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myRotationStepIncreaseButtonBackgroundComponent=this.myRotationStepIncreaseButtonBackground.addComponent("mesh"),this.myRotationStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myRotationStepIncreaseButtonTextComponent=this.myRotationStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myRotationStepIncreaseButtonTextComponent),this.myRotationStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myRotationStepIncreaseButtonCursorTargetComponent=this.myRotationStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myRotationStepIncreaseButtonCollisionComponent=this.myRotationStepIncreaseButtonCursorTarget.addComponent("collision"),this.myRotationStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myRotationStepDecreaseButtonBackgroundComponent=this.myRotationStepDecreaseButtonBackground.addComponent("mesh"),this.myRotationStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myRotationStepDecreaseButtonTextComponent=this.myRotationStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myRotationStepDecreaseButtonTextComponent),this.myRotationStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myRotationStepDecreaseButtonCursorTargetComponent=this.myRotationStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myRotationStepDecreaseButtonCollisionComponent=this.myRotationStepDecreaseButtonCursorTarget.addComponent("collision"),this.myRotationStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myScaleStepTextComponent=this.myScaleStepText.addComponent("text"),this._setupTextComponent(this.myScaleStepTextComponent),this.myScaleStepTextComponent.text=" ",this.myScaleStepCursorTargetComponent=this.myScaleStepCursorTarget.addComponent("cursor-target"),this.myScaleStepCollisionComponent=this.myScaleStepCursorTarget.addComponent("collision"),this.myScaleStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myScaleStepIncreaseButtonBackgroundComponent=this.myScaleStepIncreaseButtonBackground.addComponent("mesh"),this.myScaleStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myScaleStepIncreaseButtonTextComponent=this.myScaleStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myScaleStepIncreaseButtonTextComponent),this.myScaleStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myScaleStepIncreaseButtonCursorTargetComponent=this.myScaleStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myScaleStepIncreaseButtonCollisionComponent=this.myScaleStepIncreaseButtonCursorTarget.addComponent("collision"),this.myScaleStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myScaleStepDecreaseButtonBackgroundComponent=this.myScaleStepDecreaseButtonBackground.addComponent("mesh"),this.myScaleStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myScaleStepDecreaseButtonTextComponent=this.myScaleStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myScaleStepDecreaseButtonTextComponent),this.myScaleStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myScaleStepDecreaseButtonCursorTargetComponent=this.myScaleStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myScaleStepDecreaseButtonCollisionComponent=this.myScaleStepDecreaseButtonCursorTarget.addComponent("collision"),this.myScaleStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents}_addStepComponents(){this.myPositionStepTextComponent=this.myPositionStepText.addComponent("text"),this._setupTextComponent(this.myPositionStepTextComponent),this.myPositionStepTextComponent.text=" ",this.myPositionStepCursorTargetComponent=this.myPositionStepCursorTarget.addComponent("cursor-target"),this.myPositionStepCollisionComponent=this.myPositionStepCursorTarget.addComponent("collision"),this.myPositionStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myPositionStepIncreaseButtonBackgroundComponent=this.myPositionStepIncreaseButtonBackground.addComponent("mesh"),this.myPositionStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myPositionStepIncreaseButtonTextComponent=this.myPositionStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myPositionStepIncreaseButtonTextComponent),this.myPositionStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myPositionStepIncreaseButtonCursorTargetComponent=this.myPositionStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myPositionStepIncreaseButtonCollisionComponent=this.myPositionStepIncreaseButtonCursorTarget.addComponent("collision"),this.myPositionStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myPositionStepDecreaseButtonBackgroundComponent=this.myPositionStepDecreaseButtonBackground.addComponent("mesh"),this.myPositionStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myPositionStepDecreaseButtonTextComponent=this.myPositionStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myPositionStepDecreaseButtonTextComponent),this.myPositionStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myPositionStepDecreaseButtonCursorTargetComponent=this.myPositionStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myPositionStepDecreaseButtonCollisionComponent=this.myPositionStepDecreaseButtonCursorTarget.addComponent("collision"),this.myPositionStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myRotationStepTextComponent=this.myRotationStepText.addComponent("text"),this._setupTextComponent(this.myRotationStepTextComponent),this.myRotationStepTextComponent.text=" ",this.myRotationStepCursorTargetComponent=this.myRotationStepCursorTarget.addComponent("cursor-target"),this.myRotationStepCollisionComponent=this.myRotationStepCursorTarget.addComponent("collision"),this.myRotationStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myRotationStepIncreaseButtonBackgroundComponent=this.myRotationStepIncreaseButtonBackground.addComponent("mesh"),this.myRotationStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myRotationStepIncreaseButtonTextComponent=this.myRotationStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myRotationStepIncreaseButtonTextComponent),this.myRotationStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myRotationStepIncreaseButtonCursorTargetComponent=this.myRotationStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myRotationStepIncreaseButtonCollisionComponent=this.myRotationStepIncreaseButtonCursorTarget.addComponent("collision"),this.myRotationStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myRotationStepDecreaseButtonBackgroundComponent=this.myRotationStepDecreaseButtonBackground.addComponent("mesh"),this.myRotationStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myRotationStepDecreaseButtonTextComponent=this.myRotationStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myRotationStepDecreaseButtonTextComponent),this.myRotationStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myRotationStepDecreaseButtonCursorTargetComponent=this.myRotationStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myRotationStepDecreaseButtonCollisionComponent=this.myRotationStepDecreaseButtonCursorTarget.addComponent("collision"),this.myRotationStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myScaleStepTextComponent=this.myScaleStepText.addComponent("text"),this._setupTextComponent(this.myScaleStepTextComponent),this.myScaleStepTextComponent.text=" ",this.myScaleStepCursorTargetComponent=this.myScaleStepCursorTarget.addComponent("cursor-target"),this.myScaleStepCollisionComponent=this.myScaleStepCursorTarget.addComponent("collision"),this.myScaleStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myScaleStepIncreaseButtonBackgroundComponent=this.myScaleStepIncreaseButtonBackground.addComponent("mesh"),this.myScaleStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myScaleStepIncreaseButtonTextComponent=this.myScaleStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myScaleStepIncreaseButtonTextComponent),this.myScaleStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myScaleStepIncreaseButtonCursorTargetComponent=this.myScaleStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myScaleStepIncreaseButtonCollisionComponent=this.myScaleStepIncreaseButtonCursorTarget.addComponent("collision"),this.myScaleStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myScaleStepDecreaseButtonBackgroundComponent=this.myScaleStepDecreaseButtonBackground.addComponent("mesh"),this.myScaleStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myScaleStepDecreaseButtonTextComponent=this.myScaleStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myScaleStepDecreaseButtonTextComponent),this.myScaleStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myScaleStepDecreaseButtonCursorTargetComponent=this.myScaleStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myScaleStepDecreaseButtonCollisionComponent=this.myScaleStepDecreaseButtonCursorTarget.addComponent("collision"),this.myScaleStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents}}});var ln=T(()=>{PP.EasyTuneTransformWidgetSetup=class extends PP.EasyTuneBaseWidgetSetup{_getBackPanelMinY(){return super._getBackPanelMinY()+this.myPositionPanelPosition[1]+this.myStepPanelPosition[1]}_getBackPanelMaxX(){return this.myDisplayPanelPosition[0]+this.myRotationPanelPosition[0]+this.myIncreaseButtonPosition[0]+this.mySideButtonBackgroundScale[0]+this._mySideButtonDistanceFromBorder}_getBackPanelMinX(){return this.myDisplayPanelPosition[0]+this.myScalePanelPosition[0]+this.myDecreaseButtonPosition[0]-this.mySideButtonBackgroundScale[0]-this._mySideButtonDistanceFromBorder}_getPivotZOffset(){return .00805713}_initializeBuildSetupHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this.myDecreaseButtonPosition=[-.13,0,-1e-5],this.myIncreaseButtonPosition=[-this.myDecreaseButtonPosition[0],0,-1e-5];let t=Math.abs(this.myIncreaseButtonPosition[0])+Math.abs(this.myRightSideButtonPosition[0]),i=.045;this.myPositionPanelPosition=[0,this.myVariableLabelPanelPosition[1]-i,this._myPanelZOffset],this.myRotationPanelPosition=[this.myPositionPanelPosition[0]+t,this.myVariableLabelPanelPosition[1]-i,this._myPanelZOffset],this.myScalePanelPosition=[this.myPositionPanelPosition[0]-t,this.myVariableLabelPanelPosition[1]-i,this._myPanelZOffset],this.myPositionText="Position",this.myRotationText="Rotation",this.myScaleText="Scale",this.myComponentLabelTextScale=this.myLabelTextScale,this.myComponentLabelCursorTargetPosition=[0,0,0],this.myComponentLabelCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myComponentLabelCollisionExtents=[.065,.0175,1],this.myComponentLabelCollisionExtents[2]=this.myCursorTargetCollisionThickness,this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValueTextScale=[.4,.4,.4],this.myValueCursorTargetPosition=[0,0,0],this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=[.065,.02,1],this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=[0,-this._myValuePanelDistanceFromVariableLabelPanel,0];for(let n=1;n<3;n++)this.myValuePanelsPositions[n]=this.myValuePanelsPositions[n-1].slice(0),this.myValuePanelsPositions[n][1]-=this._myDistanceBetweenValues;let s=this.myValuePanelsPositions[2][1];this.myStepPanelPosition=[0,s-this._myValuePanelDistanceFromVariableLabelPanel,0],this.myStepTextScale=this.myLabelTextScale,this.myStepStartString="Step: ",this.myStepCursorTargetPosition=[0,0,0],this.myStepCursorTargetPosition[2]=this._myColliderZOffset-this.myStepPanelPosition[2],this.myStepCollisionExtents=[.065,.0175,1],this.myStepCollisionExtents[2]=this.myCursorTargetCollisionThickness}_initializeRuntimeSetupHook(){this.myTextHoverScaleMultiplier=[1.25,1.25,1.25],this.myEditThumbstickMinThreshold=.35,this.myStepMultiplierStepPerSecond=2.25,this.myButtonEditDelay=0}}});var mn=T(()=>{PP.EasyTuneWidgetAdditionalSetup=class{constructor(){this.myHandedness=PP.ToolHandedness.NONE,this.myShowOnStart=!1,this.myShowVisibilityButton=!1,this.myEnableAdditionalButtons=!1,this.myEnableGamepadScrollVariable=!1,this.myPlaneMaterial=null,this.myTextMaterial=null,this.myEnableVariablesImportExportButtons=!1,this.myVariablesImportCallback=null,this.myVariablesExportCallback=null}};PP.EasyTuneWidget=class{constructor(){this._myIsStarted=!1,this._myStartVariable=null,this._myWidgetFrame=new PP.WidgetFrame("E",1),this._myWidgetFrame.registerWidgetVisibleChangedEventListener(this,this._widgetVisibleChanged.bind(this)),this._mySetup=new PP.EasyTuneWidgetSetup,this._myAdditionalSetup=null,this._myWidgets=[],this._myEasyTuneVariables=null,this._myEasyTuneLastSize=0,this._myVariableNames=null,this._myCurrentWidget=null,this._myCurrentVariable=null,this._myScrollVariableTimer=0,this._myGamepad=null,this._myRefreshVariablesTimer=0,this._myDirty=!1}setActiveVariable(t){this._myIsStarted?this._myEasyTuneVariables.has(t)?(this._myCurrentVariable=this._myEasyTuneVariables.get(t),this._selectCurrentWidget()):console.log("Can't set easy tune active variable"):this._myStartVariable=t}refresh(){this._myWidgetFrame.myIsWidgetVisible&&(this._myDirty=!0)}setVisible(t){this._myWidgetFrame.setVisible(t)}isVisible(){return this._myWidgetFrame.isVisible()}start(t,i,s){this._myRightGamepad=PP.myRightGamepad,this._myLeftGamepad=PP.myLeftGamepad,this._mySetup.myGamepadHandedness==PP.ToolHandedness.RIGHT?this._myGamepad=this._myRightGamepad:this._mySetup.myGamepadHandedness==PP.ToolHandedness.LEFT&&(this._myGamepad=this._myLeftGamepad),this._myIsStarted=!0,this._myAdditionalSetup=i,this._myWidgetFrame.start(t,i),this._myEasyTuneVariables=s,this._myEasyTuneLastSize=this._myEasyTuneVariables.size,this._myVariableNames=Array.from(this._myEasyTuneVariables.keys()),this._myEasyTuneVariables.size>0&&(this._myCurrentVariable=this._myEasyTuneVariables.get(this._myVariableNames[0])),this._myStartVariable&&(this._myEasyTuneVariables.has(this._myStartVariable)?this._myCurrentVariable=this._myEasyTuneVariables.get(this._myStartVariable):console.log("Can't set easy tune active variable")),this._initializeWidgets()}update(t){this._myWidgetFrame.update(t),(this._myEasyTuneVariables.size!=this._myEasyTuneLastSize||this._myDirty)&&this._refreshEasyTuneVariables(),this._myWidgetFrame.myIsWidgetVisible&&this._myEasyTuneVariables.size>0&&(this._mySetup.myRefreshVariablesDelay!=null&&(this._myRefreshVariablesTimer+=t,this._myRefreshVariablesTimer>this._mySetup.myRefreshVariablesDelay&&(this._myRefreshVariablesTimer=0,this._refreshEasyTuneVariables())),this._myCurrentWidget&&this._myCurrentWidget.update(t),this._myAdditionalSetup.myEnableGamepadScrollVariable&&this._updateGamepadScrollVariable(t)),this._updateGamepadWidgetVisibility(),this._updateActiveVariable()}_initializeWidgets(){let t=new PP.EasyTuneBaseWidgetParams;t.myVariablesImportCallback=this._importVariables.bind(this),t.myVariablesExportCallback=this._exportVariables.bind(this),this._myWidgets[PP.EasyTuneVariableType.NONE]=new PP.EasyTuneNoneWidget(t),this._myWidgets[PP.EasyTuneVariableType.NUMBER]=new PP.EasyTuneNumberArrayWidgetSelector(t,this._myGamepad),this._myWidgets[PP.EasyTuneVariableType.BOOL]=new PP.EasyTuneBoolArrayWidgetSelector(t,this._myGamepad),this._myWidgets[PP.EasyTuneVariableType.TRANSFORM]=new PP.EasyTuneTransformWidget(t,this._myGamepad);for(let i of this._myWidgets)i!=null&&(i.start(this._myWidgetFrame.getWidgetObject(),this._myAdditionalSetup),i.setVisible(!1),i.registerScrollVariableRequestEventListener(this,this._scrollVariable.bind(this)));this._selectCurrentWidget()}_selectCurrentWidget(){if(this._myEasyTuneVariables.size<=0)return;let t=null;this._myCurrentWidget!=null&&(t=this._myCurrentWidget.getWidget()),this._myCurrentVariable.myType in this._myWidgets?this._myCurrentWidget=this._myWidgets[this._myCurrentVariable.myType]:this._myCurrentWidget=this._myWidgets[PP.EasyTuneVariableType.NONE],this._myCurrentWidget.setEasyTuneVariable(this._myCurrentVariable,this._createIndexString()),this._myCurrentWidget.getWidget().syncWidget(t),t?.setVisible(!1),this._myCurrentWidget.setVisible(this._myWidgetFrame.myIsWidgetVisible)}_refreshEasyTuneVariables(){this._myVariableNames=Array.from(this._myEasyTuneVariables.keys()),this._myEasyTuneLastSize=this._myEasyTuneVariables.size,this._myEasyTuneVariables.size>0?(this._myCurrentVariable&&this._myEasyTuneVariables.has(this._myCurrentVariable.myName)?this._myCurrentVariable=this._myEasyTuneVariables.get(this._myCurrentVariable.myName):this._myCurrentVariable=this._myEasyTuneVariables.get(this._myVariableNames[0]),this._selectCurrentWidget()):(this._myCurrentVariable=null,this._myCurrentWidget&&(this._myCurrentWidget.setVisible(!1),this._myCurrentWidget=null)),this._myDirty=!1}_updateGamepadWidgetVisibility(){this._myGamepad&&(this._myGamepad.getButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON).isPressStart()&&this._myGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).myIsPressed||this._myGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressStart()&&this._myGamepad.getButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON).myIsPressed)&&this._toggleVisibility()}_toggleVisibility(){this._myWidgetFrame.toggleVisibility()}_widgetVisibleChanged(t){for(let i of this._myWidgets)i?.setVisible(!1);this._myCurrentWidget&&(this._myEasyTuneVariables.size>0?this._myCurrentWidget.setVisible(t):this._myCurrentWidget.setVisible(!1)),t&&this._refreshEasyTuneVariables()}_updateGamepadScrollVariable(t){if(this._myGamepad&&(!this._mySetup.myScrollVariableButtonID||this._myGamepad.getButtonInfo(this._mySetup.myScrollVariableButtonID).myIsPressed)){let i=this._myGamepad.getAxesInfo().myAxes[0],s=this._myGamepad.getAxesInfo().myAxes[1];if(Math.abs(i)>this._mySetup.myScrollVariableMinXThreshold&&Math.abs(s)<this._mySetup.myScrollVariableMaxYThreshold)for(this._myScrollVariableTimer+=t;this._myScrollVariableTimer>this._mySetup.myScrollVariableDelay;)this._myScrollVariableTimer-=this._mySetup.myScrollVariableDelay,this._scrollVariable(Math.sign(i));else this._myScrollVariableTimer=this._mySetup.myScrollVariableDelay}else this._myScrollVariableTimer=this._mySetup.myScrollVariableDelay}_scrollVariable(t){if(this._myEasyTuneVariables.size<=0)return;let i=this._getVariableIndex(this._myCurrentVariable);if(i>=0){let s=((i+t)%this._myVariableNames.length+this._myVariableNames.length)%this._myVariableNames.length;this._myEasyTuneVariables.has(this._myVariableNames[s])?(this._myCurrentVariable=this._myEasyTuneVariables.get(this._myVariableNames[s]),this._selectCurrentWidget()):this._refreshEasyTuneVariables()}else this._refreshEasyTuneVariables()}_createIndexString(){let t=" (",i=(this._getVariableIndex(this._myCurrentVariable)+1).toString(),s=this._myEasyTuneVariables.size.toString();for(;i.length<s.length;)i="0".concat(i);return t=t.concat(i).concat(" - ").concat(s).concat(")"),t}_getVariableIndex(t){return this._myVariableNames.indexOf(t.myName)}_updateActiveVariable(){this._myEasyTuneVariables.forEach(function(t){t.myIsActive=!1}),this._myWidgetFrame.myIsWidgetVisible&&this._myCurrentVariable&&(this._myCurrentVariable.myIsActive=!0)}_importVariables(){this._myAdditionalSetup.myVariablesImportCallback(this._onImportSuccess.bind(this),this._onImportFailure.bind(this))}_exportVariables(){this._myAdditionalSetup.myVariablesExportCallback(this._onExportSuccess.bind(this),this._onExportFailure.bind(this))}_onImportSuccess(){this._myCurrentWidget&&this._myCurrentWidget.onImportSuccess()}_onImportFailure(){this._myCurrentWidget&&this._myCurrentWidget.onImportFailure()}_onExportSuccess(){this._myCurrentWidget&&this._myCurrentWidget.onExportSuccess()}_onExportFailure(){this._myCurrentWidget&&this._myCurrentWidget.onExportFailure()}}});var yn=T(()=>{PP.EasyTuneWidgetSetup=class{constructor(){this._initializeRuntimeSetup()}_initializeRuntimeSetup(){this.myGamepadHandedness=PP.ToolHandedness.RIGHT,this.myScrollVariableDelay=.5,this.myScrollVariableMinXThreshold=.6,this.myScrollVariableMaxYThreshold=.25,this.myScrollVariableButtonID=null,this.myRefreshVariablesDelay=null}}});var un=T(()=>{PP.EasyTuneVariables=class{constructor(){this._myMap=new Map}add(t){this._myMap.set(t.myName,t)}remove(t){this._myMap.delete(t)}get(t){let i=this._myMap.get(t);return i?i.getValue():null}set(t,i,s=!1){let n=this._myMap.get(t);n&&n.setValue(i,s)}isActive(t){let i=this._myMap.get(t);return i?i.myIsActive:!1}getEasyTuneVariable(t){return this._myMap.get(t)}fromJSON(t,i=!1){let s=JSON.parse(t);for(let n of this._myMap.values()){let a=s[n.myName];a!==void 0&&n.fromJSON(a,i)}}toJSON(){let t={};for(let i of this._myMap.values())t[i.myName]=i.toJSON();return JSON.stringify(t)}registerValueChangedEventListener(t,i,s){this._myMap.get(t).registerValueChangedEventListener(i,s)}unregisterValueChangedEventListener(t,i,s){this._myMap.get(t).unregisterValueChangedEventListener(i)}_getInternalMap(){return this._myMap}}});var cn=T(()=>{PP.EasyTuneVariableType={NONE:0,NUMBER:1,BOOL:2,TRANSFORM:3};PP.EasyTuneVariable=class{constructor(t,i){this.myName=t.slice(0),this.myType=i,this.myValue=null,this.myDefaultValue=null,this.myIsActive=!1,this._myValueChangedCallbacks=new Map}getValue(){return this.myValue}setValue(t,i=!1){let s=this.myValue;this.myValue=t,i&&PP.EasyTuneVariable.prototype.setDefaultValue.call(this,t),PP.refreshEasyTuneWidget(),s!=t&&this._triggerValueChangedCallback()}setDefaultValue(t){this.myDefaultValue=t}fromJSON(t,i=!1){this.setValue(JSON.parse(t),i)}toJSON(){return JSON.stringify(this.getValue())}registerValueChangedEventListener(t,i){this._myValueChangedCallbacks.set(t,i)}unregisterValueChangedEventListener(t){this._myValueChangedCallbacks.delete(t)}_triggerValueChangedCallback(){this._myValueChangedCallbacks.size>0&&this._myValueChangedCallbacks.forEach(function(t){t(this.myName,this.getValue())}.bind(this))}};PP.EasyTuneVariableArray=class extends PP.EasyTuneVariable{constructor(t,i,s){super(t,i),PP.EasyTuneVariableArray.prototype.setValue.call(this,s,!0)}getValue(){return this.myValue.slice(0)}setValue(t,i=!1){let s=this.myValue;this.myValue=t.slice(0),i&&PP.EasyTuneVariableArray.prototype.setDefaultValue.call(this,t),PP.refreshEasyTuneWidget(),(s==null||!s.pp_equals(t))&&this._triggerValueChangedCallback()}setDefaultValue(t){this.myDefaultValue=t.slice(0)}};PP.EasyTuneNumberArray=class extends PP.EasyTuneVariableArray{constructor(t,i,s,n,a=null,r=null,l=!1){super(t,PP.EasyTuneVariableType.NUMBER,i),this.myDecimalPlaces=n,this.myStepPerSecond=s,this.myDefaultStepPerSecond=this.myStepPerSecond,this.myMin=a,this.myMax=r,this.myEditAllValuesTogether=l,this._clampValue(!0)}setMax(t){this.myMax=t,this._clampValue(!1)}setMin(t){this.myMin=t,this._clampValue(!1)}_clampValue(t){let i=this.myValue.vec_clamp(this.myMin,this.myMax);if(!t){let s=this.myDefaultValue.vec_clamp(this.myMin,this.myMax);!s.vec_equals(this.myDefaultValue,1e-5)&&PP.EasyTuneVariableArray.prototype.setDefaultValue.call(this,s)}PP.EasyTuneVariableArray.prototype.setValue.call(this,i,t)}};PP.EasyTuneNumber=class extends PP.EasyTuneNumberArray{constructor(t,i,s,n,a,r){super(t,[i],s,n,a,r)}getValue(){return this.myValue[0]}setValue(t,i=!1){super.setValue([t],i)}setDefaultValue(t){super.setValue([t])}};PP.EasyTuneInt=class extends PP.EasyTuneNumber{constructor(t,i,s,n,a){super(t,i,s,0,n,a)}};PP.EasyTuneIntArray=class extends PP.EasyTuneNumberArray{constructor(t,i,s,n,a,r){let l=i.slice(0);for(let y=0;y<i.length;y++)l[y]=Math.round(l[y]);super(t,l,s,0,n!=null?Math.round(n):null,a!=null?Math.round(a):a,r)}};PP.EasyTuneBoolArray=class extends PP.EasyTuneVariableArray{constructor(t,i){super(t,PP.EasyTuneVariableType.BOOL,i)}};PP.EasyTuneBool=class extends PP.EasyTuneBoolArray{constructor(t,i){super(t,[i])}getValue(){return this.myValue[0]}setValue(t,i=!1){super.setValue([t],i)}setDefaultValue(t){super.setValue([t])}};PP.EasyTuneTransform=class extends PP.EasyTuneVariable{constructor(t,i,s=!0,n=1,a=50,r=1){super(t,PP.EasyTuneVariableType.TRANSFORM),this.myDecimalPlaces=3,this.myPosition=i.mat4_getPosition(),this.myRotation=i.mat4_getRotationDegrees(),this.myScale=i.mat4_getScale();let l=Math.pow(10,this.myDecimalPlaces);for(let y=0;y<3;y++)this.myScale[y]=Math.max(this.myScale[y],1/l);this.myScaleAsOne=s,this.myPositionStepPerSecond=n,this.myRotationStepPerSecond=a,this.myScaleStepPerSecond=r,this.myDefaultPosition=this.myPosition.vec3_clone(),this.myDefaultRotation=this.myRotation.vec3_clone(),this.myDefaultScale=this.myScale.vec3_clone(),this.myDefaultPositionStepPerSecond=this.myPositionStepPerSecond,this.myDefaultRotationStepPerSecond=this.myRotationStepPerSecond,this.myDefaultScaleStepPerSecond=this.myScaleStepPerSecond,this.myTransform=PP.mat4_create(),this.myTransform.mat4_setPositionRotationDegreesScale(this.myPosition,this.myRotation,this.myScale),this.myTempTransform=PP.mat4_create()}getValue(){return this.myTransform.mat4_setPositionRotationDegreesScale(this.myPosition,this.myRotation,this.myScale),this.myTransform.slice(0)}setValue(t,i=!1){this.myTempTransform.mat4_setPositionRotationDegreesScale(this.myPosition,this.myRotation,this.myScale),t.mat4_getPosition(this.myPosition),t.mat4_getRotationDegrees(this.myRotation),t.mat4_getScale(this.myScale),this.myTransform.mat4_setPositionRotationDegreesScale(this.myPosition,this.myRotation,this.myScale),i&&PP.EasyTuneTransform.prototype.setDefaultValue.call(this,t),PP.refreshEasyTuneWidget(),this.myTempTransform.pp_equals(this.myTransform)||this._triggerValueChangedCallback()}setDefaultValue(t){this.myDefaultPosition=t.mat4_getPosition(),this.myDefaultRotation=t.mat4_getRotationDegrees(),this.myDefaultScale=t.mat4_getScale()}fromJSON(t,i=!1){this.setValue(JSON.parse(t),i)}toJSON(){return this.getValue().vec_toString()}}});var hn=T(()=>{PP.myEasyTuneVariables=new PP.EasyTuneVariables;PP.myEasyTuneTarget=null;PP.importEasyTuneVariables=function(e=null,t=!1,i=null,s=null){if(e==null||e.length==0)navigator.clipboard&&navigator.clipboard.readText().then(function(n){PP.myEasyTuneVariables.fromJSON(n,t),PP.refreshEasyTuneWidget(),i?.(),console.log("Easy Tune Variables Imported from: clipboard"),console.log(n)},function(){s?.(),console.error("An error occurred while importing the easy tune variables from: clipboard")}).catch(function(n){s?.(),console.error("An error occurred while importing the easy tune variables from: clipboard"),console.error(n)});else{let n=PP._importExportEasyTuneVariablesReplaceFileURLParams(e);fetch(n).then(function(a){a.ok?a.text().then(function(r){PP.myEasyTuneVariables.fromJSON(r,t),PP.refreshEasyTuneWidget(),i?.(),console.log("Easy Tune Variables Imported from:",n),console.log(r)},function(r){s?.(),console.error("An error occurred while importing the easy tune variables from:",n),console.error(r)}):(s?.(),console.error("An error occurred while importing the easy tune variables from:",n),console.error(a))},function(a){s?.(),console.error("An error occurred while importing the easy tune variables from:",n),console.error(a)}).catch(function(a){s?.(),console.error("An error occurred while importing the easy tune variables from:",n),console.error(a)})}PP.refreshEasyTuneWidget()};PP.exportEasyTuneVariables=function(e=null,t=null,i=null){let s=PP.myEasyTuneVariables.toJSON();if(e==null||e.length==0)navigator.clipboard&&navigator.clipboard.writeText(s).then(function(){t?.(),console.log("Easy Tune Variables Exported to: clipboard"),console.log(s)},function(){i?.(),console.error("An error occurred while exporting the easy tune variables to: clipboard")}).catch(function(n){i?.(),console.error("An error occurred while exporting the easy tune variables to: clipboard"),console.error(n)});else{let n=PP._importExportEasyTuneVariablesReplaceFileURLParams(e);fetch(n,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:s}).then(function(a){a.ok?(t?.(),console.log("Easy Tune Variables Exported to:",n),console.log(s)):(i?.(),console.error("An error occurred while exporting the easy tune variables to:",n),console.error(a))},function(a){i?.(),console.error("An error occurred while exporting the easy tune variables to:",n),console.error(a)}).catch(function(a){i?.(),console.error("An error occurred while exporting the easy tune variables to:",n),console.error(a)})}};PP.mySetEasyTuneWidgetActiveVariableCallbacks=[];PP.setEasyTuneWidgetActiveVariable=function(e){for(let t of PP.mySetEasyTuneWidgetActiveVariableCallbacks)t(e)};PP.myRefreshEasyTuneWidgetCallbacks=[];PP.refreshEasyTuneWidget=function(){for(let e of PP.myRefreshEasyTuneWidgetCallbacks)e()};PP._importExportEasyTuneVariablesReplaceFileURLParams=function(e){let t=e.match(/\{.+?\}/g);if(t==null||t.length==0)return e;for(let n=0;n<t.length;n++)t[n]=t[n].replace("{",""),t[n]=t[n].replace("}","");let i=new URL(document.location).searchParams,s=e;for(let n of t){let a=i.get(n);a!=null&&(s=s.replace("{"+n+"}",a))}return s}});var pn=T(()=>{WL.registerComponent("pp-easy-tune",{_myHandedness:{type:WL.Type.Enum,values:["none","left","right"],default:"none"},_myShowOnStart:{type:WL.Type.Bool,default:!1},_myShowVisibilityButton:{type:WL.Type.Bool,default:!1},_myEnableGamepadScrollVariable:{type:WL.Type.Bool,default:!0},_myEnableVariablesImportExportButtons:{type:WL.Type.Bool,default:!1},_myVariablesImportURL:{type:WL.Type.String,default:""},_myVariablesExportURL:{type:WL.Type.String,default:""},_myImportVariablesOnStart:{type:WL.Type.Bool,default:!1},_myResetVariablesDefaultValueOnImport:{type:WL.Type.Bool,default:!1}},{init:function(){this._myWidget=new PP.EasyTuneWidget,PP.mySetEasyTuneWidgetActiveVariableCallbacks.push(function(e){this._myWidget.setActiveVariable(e)}.bind(this)),PP.myRefreshEasyTuneWidgetCallbacks.push(function(){this._myWidget.refresh()}.bind(this)),this._myStarted=!1},start:function(){let e=new PP.EasyTuneWidgetAdditionalSetup;e.myHandedness=[null,"left","right"][this._myHandedness],e.myShowOnStart=this._myShowOnStart,e.myShowVisibilityButton=this._myShowVisibilityButton,e.myEnableAdditionalButtons=!0,e.myEnableGamepadScrollVariable=this._myEnableGamepadScrollVariable,e.myPlaneMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),e.myTextMaterial=PP.myDefaultResources.myMaterials.myText.clone(),e.myEnableVariablesImportExportButtons=this._myEnableVariablesImportExportButtons,e.myVariablesImportCallback=function(t,i){PP.importEasyTuneVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport,t,i)}.bind(this),e.myVariablesExportCallback=function(t,i){PP.exportEasyTuneVariables(this._myVariablesExportURL,t,i)}.bind(this),this._myWidget.start(this.object,e,PP.myEasyTuneVariables._getInternalMap()),this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._mySetVisibleNextUpdate=!1,this._myStarted=!0,this._myFirstUpdate=!0},update:function(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,this._myImportVariablesOnStart&&PP.importEasyTuneVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport)),this._mySetVisibleNextUpdate&&(this._mySetVisibleNextUpdate=!1,this._myWidget.setVisible(!1),this._myWidget.setVisible(this._myWidgetVisibleBackup)),this._myWidget.update(e)},onActivate(){this._mySetVisibleNextUpdate=!0},onDeactivate(){this._myStarted&&(this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._myWidget.setVisible(!1))}})});var dn=T(()=>{WL.registerComponent("pp-easy-tune-import-variables",{_myVariablesImportURL:{type:WL.Type.String,default:""},_myResetVariablesDefaultValueOnImport:{type:WL.Type.Bool,default:!0}},{init:function(){},start:function(){this._myFirstUpdate=!0},update:function(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,PP.importEasyTuneVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport))}})});var _n=T(()=>{PP.WidgetFrameSetup=class{constructor(t,i){this._initializeBuildSetup(t,i),this._initializeRuntimeSetup()}_initializeBuildSetup(t,i){this.myBackgroundColor=[46/255,46/255,46/255,1],this.myCursorTargetCollisionCollider=2,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=[255/255,255/255,255/255,1],this.myTextAlignment=2,this.myTextJustification=2,this.myTextColor=this.myDefaultTextColor,this.myButtonTextScale=[.18,.18,.18],this.myVisibilityButtonBackgroundScale=[.015,.015,1],this.myVisibilityButtonTextPosition=[0,0,.007],this.myVisibilityButtonTextScale=this.myButtonTextScale;let s=.01,n=this.myVisibilityButtonBackgroundScale[0]*(2*i)+s*i;this.myVisibilityButtonPosition=[],this.myVisibilityButtonPosition[PP.ToolHandedness.NONE]={},this.myVisibilityButtonPosition[PP.ToolHandedness.NONE].myPosition=[-.3+n,-.205,.035],this.myVisibilityButtonPosition[PP.ToolHandedness.LEFT]={},this.myVisibilityButtonPosition[PP.ToolHandedness.LEFT].myPosition=[-.2+n,.025,.015],this.myVisibilityButtonPosition[PP.ToolHandedness.RIGHT]={},this.myVisibilityButtonPosition[PP.ToolHandedness.RIGHT].myPosition=[.2-n,.025,.015],this.myVisibilityButtonText=t,this.myVisibilityButtonCursorTargetPosition=[0,0,0],this.myVisibilityButtonCursorTargetPosition[2]=this.myVisibilityButtonTextPosition[2],this.myVisibilityButtonCollisionExtents=this.myVisibilityButtonBackgroundScale.slice(0),this.myVisibilityButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myFlagButtonBackgroundScale=[.0125,.0125,1],this.myFlagButtonTextPosition=[0,0,.007],this.myFlagButtonTextScale=[.15,.15,.15];let a=.0075,r=0,l=this.myVisibilityButtonBackgroundScale[1]+this.myFlagButtonBackgroundScale[1]+a+this.myFlagButtonBackgroundScale[1]*(2*r)+a*r;this.myPinButtonPosition=[],this.myPinButtonPosition[PP.ToolHandedness.NONE]={},this.myPinButtonPosition[PP.ToolHandedness.NONE].myPosition=this.myVisibilityButtonPosition[PP.ToolHandedness.NONE].myPosition.slice(0),this.myPinButtonPosition[PP.ToolHandedness.NONE].myPosition[1]+=l,this.myPinButtonPosition[PP.ToolHandedness.LEFT]={},this.myPinButtonPosition[PP.ToolHandedness.LEFT].myPosition=this.myVisibilityButtonPosition[PP.ToolHandedness.LEFT].myPosition.slice(0),this.myPinButtonPosition[PP.ToolHandedness.LEFT].myPosition[1]+=l,this.myPinButtonPosition[PP.ToolHandedness.RIGHT]={},this.myPinButtonPosition[PP.ToolHandedness.RIGHT].myPosition=this.myVisibilityButtonPosition[PP.ToolHandedness.RIGHT].myPosition.slice(0),this.myPinButtonPosition[PP.ToolHandedness.RIGHT].myPosition[1]+=l,this.myPinButtonText="P",this.myPinButtonCursorTargetPosition=[0,0,0],this.myPinButtonCursorTargetPosition[2]=this.myFlagButtonTextPosition[2],this.myPinButtonCollisionExtents=this.myFlagButtonBackgroundScale.slice(0),this.myPinButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness}_initializeRuntimeSetup(){this._initializeObjectsTransforms(),this.myButtonHoverColor=[150/255,150/255,150/255,1],this.myButtonDisabledTextColor=this.myBackgroundColor,this.myButtonDisabledBackgroundColor=[110/255,110/255,110/255,1]}_initializeObjectsTransforms(){this.myPivotObjectTransforms=this._createDefaultObjectTransforms(),this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.LEFT].myRotation=[-.645,.425,.25,.584],this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.LEFT].myRotation.quat_normalize(this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.LEFT].myRotation),this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.RIGHT].myRotation=[-.645,-.425,-.25,.584],this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.RIGHT].myRotation.quat_normalize(this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.RIGHT].myRotation),this.myPivotObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.LEFT].myRotation=[-.645,.425,.25,.584],this.myPivotObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.LEFT].myRotation.quat_normalize(this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.LEFT].myRotation),this.myPivotObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.RIGHT].myRotation=[-.645,-.425,-.25,.584],this.myPivotObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.RIGHT].myRotation.quat_normalize(this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.RIGHT].myRotation),this.myWidgetObjectTransforms=this._createDefaultObjectTransforms(),this.myWidgetObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.LEFT].myPosition=[.1,.23,-.02],this.myWidgetObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.RIGHT].myPosition=[.07,.23,-.02],this.myWidgetObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.LEFT].myPosition=[.1,.23,-.02],this.myWidgetObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.RIGHT].myPosition=[.07,.23,-.02],this._myPivotObjectDistanceFromNonVRHead=.6}_createDefaultObjectTransforms(){let t=[];for(let i in PP.ToolInputSourceType){let s=PP.ToolInputSourceType[i];t[s]=[];for(let n in PP.ToolHandedness){let a=PP.ToolHandedness[n];t[s][a]={},t[s][a].myPosition=[0,0,0],t[s][a].myRotation=[0,0,0,1]}}return t}}});var Pn=T(()=>{PP.WidgetFrameUI=class{constructor(){this._myInputSourceType=null,this._myParentObject=null,this._myIsPinned=!1,this._myWidgetVisible=!0,this._myVisibilityButtonVisible=!0}build(t,i,s){this._myParentObject=t,this._mySetup=i,this._myAdditionalSetup=s,this._myPlaneMesh=PP.MeshUtils.createPlaneMesh(),this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonVR(),WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}setWidgetVisible(t){this._myWidgetVisible=t,this.myFlagsButtonPanel.pp_setActiveHierarchy(t),t&&this._updateObjectsTransforms(!0)}setVisibilityButtonVisible(t){this._myVisibilityButtonVisible=t,this.myVisibilityButtonPanel.pp_setActiveHierarchy(t)}setPinned(t){t!=this._myIsPinned&&(this._myIsPinned=t,this._myIsPinned?this.myPivotObject.pp_setParent(null):(this.myPivotObject.pp_setParent(this.myFixForwardObject),PP.XRUtils.isSessionActive()||this._setTransformForNonVR(),this._updateObjectsTransforms(!0)))}update(t){this._updateObjectsTransforms(!1)}_updateObjectsTransforms(t){if(PP.XRUtils.isSessionActive()){let i=PP.InputUtils.getInputSourceTypeByHandedness(this._myAdditionalSetup.myHandedness);(i!=this._myInputSourceType||t)&&(this._myInputSourceType=i,this._myIsPinned||(this.myPivotObject.setTranslationLocal(this._mySetup.myPivotObjectTransforms[this._myInputSourceType][this._myAdditionalSetup.myHandedness].myPosition),this.myPivotObject.resetRotation(),this.myPivotObject.rotateObject(this._mySetup.myPivotObjectTransforms[this._myInputSourceType][this._myAdditionalSetup.myHandedness].myRotation),this.myWidgetObject.setTranslationLocal(this._mySetup.myWidgetObjectTransforms[this._myInputSourceType][this._myAdditionalSetup.myHandedness].myPosition),this.myWidgetObject.resetRotation(),this.myWidgetObject.rotateObject(this._mySetup.myWidgetObjectTransforms[this._myInputSourceType][this._myAdditionalSetup.myHandedness].myRotation),this.myVisibilityButtonPanel.setTranslationLocal(this._mySetup.myVisibilityButtonPosition[this._myAdditionalSetup.myHandedness].myPosition),this.myPinButtonPanel.setTranslationLocal(this._mySetup.myPinButtonPosition[this._myAdditionalSetup.myHandedness].myPosition)))}else this.myVisibilityButtonPanel.pp_setActiveHierarchy(this._myWidgetVisible||this._myVisibilityButtonVisible)}_createSkeleton(){this.myFixForwardObject=WL.scene.addObject(this._myParentObject),this.myFixForwardObject.pp_rotateObject([0,180,0]),this.myPivotObject=WL.scene.addObject(this.myFixForwardObject),this.myWidgetObject=WL.scene.addObject(this.myPivotObject),this.myVisibilityButtonPanel=WL.scene.addObject(this.myPivotObject),this.myVisibilityButtonBackground=WL.scene.addObject(this.myVisibilityButtonPanel),this.myVisibilityButtonText=WL.scene.addObject(this.myVisibilityButtonPanel),this.myVisibilityButtonCursorTarget=WL.scene.addObject(this.myVisibilityButtonPanel),this.myFlagsButtonPanel=WL.scene.addObject(this.myPivotObject),this.myPinButtonPanel=WL.scene.addObject(this.myFlagsButtonPanel),this.myPinButtonBackground=WL.scene.addObject(this.myPinButtonPanel),this.myPinButtonText=WL.scene.addObject(this.myPinButtonPanel),this.myPinButtonCursorTarget=WL.scene.addObject(this.myPinButtonPanel),this.myNonVRParentObject=WL.scene.addObject(PP.myPlayerObjects.myNonVRCamera),this.myNonVRParentObject.pp_translateLocal([0,0,-this._mySetup._myPivotObjectDistanceFromNonVRHead]),this.myNonVRParentObject.pp_lookToLocal([0,0,1],[0,1,0])}_setTransforms(){this.myPivotObject.setDirty(),this.myVisibilityButtonPanel.setTranslationLocal(this._mySetup.myVisibilityButtonPosition[this._myAdditionalSetup.myHandedness].myPosition),this.myVisibilityButtonBackground.scale(this._mySetup.myVisibilityButtonBackgroundScale),this.myVisibilityButtonText.setTranslationLocal(this._mySetup.myVisibilityButtonTextPosition),this.myVisibilityButtonText.scale(this._mySetup.myVisibilityButtonTextScale),this.myVisibilityButtonCursorTarget.setTranslationLocal(this._mySetup.myVisibilityButtonCursorTargetPosition),this.myPinButtonPanel.setTranslationLocal(this._mySetup.myPinButtonPosition[this._myAdditionalSetup.myHandedness].myPosition),this.myPinButtonBackground.scale(this._mySetup.myFlagButtonBackgroundScale),this.myPinButtonText.setTranslationLocal(this._mySetup.myFlagButtonTextPosition),this.myPinButtonText.scale(this._mySetup.myFlagButtonTextScale),this.myPinButtonCursorTarget.setTranslationLocal(this._mySetup.myPinButtonCursorTargetPosition)}_addComponents(){this.myVisibilityButtonBackgroundComponent=this.myVisibilityButtonBackground.addComponent("mesh"),this.myVisibilityButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myVisibilityButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myVisibilityButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myVisibilityButtonTextComponent=this.myVisibilityButtonText.addComponent("text"),this._setupButtonTextComponent(this.myVisibilityButtonTextComponent),this.myVisibilityButtonTextComponent.text=this._mySetup.myVisibilityButtonText,this.myVisibilityButtonCursorTargetComponent=this.myVisibilityButtonCursorTarget.addComponent("cursor-target"),this.myVisibilityButtonCollisionComponent=this.myVisibilityButtonCursorTarget.addComponent("collision"),this.myVisibilityButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myVisibilityButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myVisibilityButtonCollisionComponent.extents=this._mySetup.myVisibilityButtonCollisionExtents,this.myPinButtonBackgroundComponent=this.myPinButtonBackground.addComponent("mesh"),this.myPinButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPinButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPinButtonBackgroundComponent.material.color=this._mySetup.myButtonDisabledBackgroundColor,this.myPinButtonTextComponent=this.myPinButtonText.addComponent("text"),this._setupButtonTextComponent(this.myPinButtonTextComponent),this.myPinButtonTextComponent.material.color=this._mySetup.myButtonDisabledTextColor,this.myPinButtonTextComponent.text=this._mySetup.myPinButtonText,this.myPinButtonCursorTargetComponent=this.myPinButtonCursorTarget.addComponent("cursor-target"),this.myPinButtonCollisionComponent=this.myPinButtonCursorTarget.addComponent("collision"),this.myPinButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPinButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPinButtonCollisionComponent.extents=this._mySetup.myPinButtonCollisionExtents}_setupButtonTextComponent(t){t.alignment=this._mySetup.myTextAlignment,t.justification=this._mySetup.myTextJustification,t.material=this._myAdditionalSetup.myTextMaterial.clone(),t.material.color=this._mySetup.myTextColor,t.text=""}_onXRSessionStart(){this.myVisibilityButtonPanel.pp_setActiveHierarchy(this._myVisibilityButtonVisible),this._setTransformForVR()}_onXRSessionEnd(){this._setTransformForNonVR()}_setTransformForVR(){this.myFixForwardObject.pp_setParent(this._myParentObject),this.myFixForwardObject.pp_resetTransformLocal(),this.myFixForwardObject.pp_rotateObject([0,180,0]),this._updateObjectsTransforms(!0)}_setTransformForNonVR(){this._myIsPinned||(this.myFixForwardObject.pp_setParent(this.myNonVRParentObject),this.myFixForwardObject.pp_resetTransformLocal(),this.myPivotObject.setTranslationLocal(this._mySetup.myPivotObjectTransforms[PP.ToolInputSourceType.NONE][PP.ToolHandedness.NONE].myPosition),this.myPivotObject.resetRotation(),this.myPivotObject.rotateObject(this._mySetup.myPivotObjectTransforms[PP.ToolInputSourceType.NONE][PP.ToolHandedness.NONE].myRotation),this.myWidgetObject.setTranslationLocal(this._mySetup.myWidgetObjectTransforms[PP.ToolInputSourceType.NONE][PP.ToolHandedness.NONE].myPosition),this.myWidgetObject.resetRotation(),this.myWidgetObject.rotateObject(this._mySetup.myWidgetObjectTransforms[PP.ToolInputSourceType.NONE][PP.ToolHandedness.NONE].myRotation),this.myVisibilityButtonPanel.setTranslationLocal(this._mySetup.myVisibilityButtonPosition[PP.ToolHandedness.NONE].myPosition),this.myPinButtonPanel.setTranslationLocal(this._mySetup.myPinButtonPosition[PP.ToolHandedness.NONE].myPosition))}}});var gn=T(()=>{PP.WidgetFrame=class{constructor(t,i){this.myIsWidgetVisible=!0,this.myIsPinned=!1,this._mySetup=new PP.WidgetFrameSetup(t,i),this._myAdditionalSetup=null,this._myUI=new PP.WidgetFrameUI,this._myShowVisibilityButton=!1,this._myWidgetVisibleChangedCallbacks=new Map,this._myPinChangedCallbacks=new Map}getWidgetObject(){return this._myUI.myWidgetObject}setVisible(t){this.myIsWidgetVisible=!t,this._toggleVisibility(!1,!0)}isVisible(){return this.myIsWidgetVisible}toggleVisibility(){this._toggleVisibility(!1,!0)}togglePin(){this._togglePin(!1)}registerWidgetVisibleChangedEventListener(t,i){this._myWidgetVisibleChangedCallbacks.set(t,i)}unregisterWidgetVisibleChangedEventListener(t){this._myWidgetVisibleChangedCallbacks.delete(t)}registerPinChangedEventListener(t,i){this._myPinChangedCallbacks.set(t,i)}unregisterPinChangedEventListener(t){this._myPinChangedCallbacks.delete(t)}start(t,i){this._myAdditionalSetup=i,this._myUI.build(t,this._mySetup,i),this._myUI.setVisibilityButtonVisible(i.myShowVisibilityButton),this._myShowVisibilityButton=i.myShowVisibilityButton,i.myShowOnStart||this._toggleVisibility(!1,!1),this._addListeners()}update(t){this._myUI.update(t)}_addListeners(){let t=this._myUI;t.myPinButtonCursorTargetComponent.addClickFunction(this._togglePin.bind(this,!0)),t.myPinButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myPinButtonBackgroundComponent.material)),t.myPinButtonCursorTargetComponent.addUnHoverFunction(this._pinUnHover.bind(this,t.myPinButtonBackgroundComponent.material)),t.myVisibilityButtonCursorTargetComponent.addClickFunction(this._toggleVisibility.bind(this,!0,!0)),t.myVisibilityButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,t.myVisibilityButtonBackgroundComponent.material)),t.myVisibilityButtonCursorTargetComponent.addUnHoverFunction(this._visibilityUnHover.bind(this,t.myVisibilityButtonBackgroundComponent.material))}_toggleVisibility(t,i){this.myIsWidgetVisible=!this.myIsWidgetVisible,this._myUI.setWidgetVisible(this.myIsWidgetVisible);let s=this._myUI.myVisibilityButtonTextComponent.material,n=this._myUI.myVisibilityButtonBackgroundComponent.material;if(this.myIsWidgetVisible?(s.color=this._mySetup.myDefaultTextColor,t||(n.color=this._mySetup.myBackgroundColor)):(s.color=this._mySetup.myButtonDisabledTextColor,t||(n.color=this._mySetup.myButtonDisabledBackgroundColor)),i)for(let a of this._myWidgetVisibleChangedCallbacks.values())a(this.myIsWidgetVisible);this._myUI.setVisibilityButtonVisible(this._myShowVisibilityButton)}_togglePin(t){if(this.myIsWidgetVisible){this.myIsPinned=!this.myIsPinned,this._myUI.setPinned(this.myIsPinned);let i=this._myUI.myPinButtonTextComponent.material,s=this._myUI.myPinButtonBackgroundComponent.material;this.myIsPinned?(i.color=this._mySetup.myDefaultTextColor,t||(s.color=this._mySetup.myBackgroundColor)):(i.color=this._mySetup.myButtonDisabledTextColor,t||(s.color=this._mySetup.myButtonDisabledBackgroundColor));for(let n of this._myPinChangedCallbacks.values())n(this.myIsPinned)}}_genericHover(t){t.color=this._mySetup.myButtonHoverColor}_visibilityUnHover(t){this.myIsWidgetVisible?t.color=this._mySetup.myBackgroundColor:t.color=this._mySetup.myButtonDisabledBackgroundColor}_pinUnHover(t){this.myIsPinned?t.color=this._mySetup.myBackgroundColor:t.color=this._mySetup.myButtonDisabledBackgroundColor}}});qt();Oe();We();ke();je();Fe();He();we();Ne();Ge();Ue();qe();ze();Qe();Ke();Je();Ye();Ze();$e();ti();ei();ii();si();ni();ai();oi();ri();li();mi();yi();ui();ci();hi();pi();di();_i();Pi();gi();fi();Ti();bi();Ci();Si();xi();vi();Bi();Mi();Ii();Li();Vi();Ai();Di();Ri();Ei();Oi();Wi();ki();ji();Fi();Hi();wi();Ni();Gi();Ui();qi();zi();Qi();Xi();Ki();Ji();Yi();Zi();$i();ts();es();is();ss();ns();as();os();rs();ls();ms();ys();us();cs();hs();ps();ds();_s();Ps();gs();fs();Ts();bs();Cs();Ss();xs();vs();Bs();Ms();Is();Ls();Vs();As();Ds();Rs();Es();Os();Ws();ks();js();Fs();Hs();ws();Ns();Gs();Us();qs();zs();Qs();Xs();Ks();Js();Ys();Zs();$s();tn();en();sn();nn();an();on();rn();ln();mn();yn();un();cn();hn();pn();dn();_n();Pn();gn();})();
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
//# sourceMappingURL=wle_pp_bundle.js.map

//# sourceMappingURL=PeerTest-bundle.js.map